<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="ì‹œê³„ì—´ ë°ì´í„°ì˜ ê¸°ë³¸ ê°œë…ê³¼ ì „í†µì  í†µê³„ ë°©ë²•, Prophetì˜ ë“±ì¥ê¹Œì§€ ì²´ê³„ì ìœ¼ë¡œ í•™ìŠµí•˜ê³  ì‹¤ì œ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ì„¸ìš”.">



<title>Part 1: ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê¸°ì´ˆ - ARIMAë¶€í„° Prophetê¹Œì§€ - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 1: ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê¸°ì´ˆ - ARIMAë¶€í„° Prophetê¹Œì§€">
<meta property="og:description" content="ì‹œê³„ì—´ ë°ì´í„°ì˜ ê¸°ë³¸ ê°œë…ê³¼ ì „í†µì  í†µê³„ ë°©ë²•, Prophetì˜ ë“±ì¥ê¹Œì§€ ì²´ê³„ì ìœ¼ë¡œ í•™ìŠµí•˜ê³  ì‹¤ì œ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ì„¸ìš”.">
<meta property="og:url" content="http://localhost:4000/data-ai/2025/08/31/time-series-basics.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 1: ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê¸°ì´ˆ - ARIMAë¶€í„° Prophetê¹Œì§€">
<meta name="twitter:description" content="ì‹œê³„ì—´ ë°ì´í„°ì˜ ê¸°ë³¸ ê°œë…ê³¼ ì „í†µì  í†µê³„ ë°©ë²•, Prophetì˜ ë“±ì¥ê¹Œì§€ ì²´ê³„ì ìœ¼ë¡œ í•™ìŠµí•˜ê³  ì‹¤ì œ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ì„¸ìš”.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-ai/2025/08/31/time-series-basics.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-08-31-time-series-basics.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data ai</span>
      <span class="post-date">2025ë…„ 08ì›” 31ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 1: ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê¸°ì´ˆ - ARIMAë¶€í„° Prophetê¹Œì§€</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">ì‹œê³„ì—´ì˜ˆì¸¡</span>
      
        <span class="tag">ARIMA</span>
      
        <span class="tag">Prophet</span>
      
        <span class="tag">í†µê³„</span>
      
        <span class="tag">Python</span>
      
        <span class="tag">ì‹œê³„ì—´ë¶„ì„</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Time series forecasting ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 2</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 25ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ì´ˆê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-1-ì‹œê³„ì—´-ì˜ˆì¸¡ì˜-ê¸°ì´ˆ---arimaë¶€í„°-prophetê¹Œì§€">Part 1: ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ê¸°ì´ˆ - ARIMAë¶€í„° Prophetê¹Œì§€</h1>

<blockquote>
  <p>ì‹œê³„ì—´ ë°ì´í„°ì˜ ê¸°ë³¸ ê°œë…ê³¼ ì „í†µì  í†µê³„ ë°©ë²•, Prophetì˜ ë“±ì¥ê¹Œì§€ ì²´ê³„ì ìœ¼ë¡œ í•™ìŠµí•˜ê³  ì‹¤ì œ ì½”ë“œë¡œ êµ¬í˜„í•´ë³´ì„¸ìš”.</p>
</blockquote>

<h2 id="-ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#ì‹œê³„ì—´-ì˜ˆì¸¡ì´ë€-ë¬´ì—‡ì¸ê°€">ì‹œê³„ì—´ ì˜ˆì¸¡ì´ë€ ë¬´ì—‡ì¸ê°€?</a></li>
  <li><a href="#ì‹œê³„ì—´-ë°ì´í„°ì˜-íŠ¹ì„±">ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¹ì„±</a></li>
  <li><a href="#ì „í†µì -í†µê³„-ë°©ë²•">ì „í†µì  í†µê³„ ë°©ë²•</a></li>
  <li><a href="#arima-ëª¨ë¸">ARIMA ëª¨ë¸</a></li>
  <li><a href="#prophet-ì†Œê°œ">Prophet ì†Œê°œ</a></li>
  <li><a href="#ì‹¤ìŠµ-êµ¬í˜„">ì‹¤ìŠµ êµ¬í˜„</a></li>
  <li><a href="#ë°©ë²•ë¡ -ë¹„êµ">ë°©ë²•ë¡  ë¹„êµ</a></li>
  <li><a href="#ë‹¤ìŒ-ë‹¨ê³„">ë‹¤ìŒ ë‹¨ê³„</a></li>
</ol>

<h2 id="-ì‹œê³„ì—´-ì˜ˆì¸¡ì´ë€-ë¬´ì—‡ì¸ê°€">ğŸ¯ ì‹œê³„ì—´ ì˜ˆì¸¡ì´ë€ ë¬´ì—‡ì¸ê°€?</h2>

<p>ì‹œê³„ì—´ ì˜ˆì¸¡ì€ <strong>ì‹œê°„ ìˆœì„œëŒ€ë¡œ ë°°ì—´ëœ ë°ì´í„°ì˜ íŒ¨í„´ì„ í•™ìŠµí•˜ì—¬ ë¯¸ë˜ ê°’ì„ ì˜ˆì¸¡í•˜ëŠ” ê¸°ìˆ </strong>ì…ë‹ˆë‹¤. ì£¼ì‹ ê°€ê²©, íŒë§¤ëŸ‰, ì„¼ì„œ ë°ì´í„° ë“± ë‹¤ì–‘í•œ ë¶„ì•¼ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>

<h3 id="-ì‹œê³„ì—´-ë°ì´í„°ì˜-íŠ¹ì„±">ğŸ” ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¹ì„±</h3>

<ul>
  <li><strong>ì¶”ì„¸(Trend)</strong>: ì¥ê¸°ì ì¸ ì¦ê°€/ê°ì†Œ íŒ¨í„´</li>
  <li><strong>ê³„ì ˆì„±(Seasonality)</strong>: ì£¼ê¸°ì ìœ¼ë¡œ ë°˜ë³µë˜ëŠ” íŒ¨í„´</li>
  <li><strong>ë…¸ì´ì¦ˆ(Noise)</strong>: ì˜ˆì¸¡í•˜ê¸° ì–´ë ¤ìš´ ë¬´ì‘ìœ„ ë³€ë™</li>
  <li><strong>êµ¬ì¡°ì  ë³€í™”(Structural Changes)</strong>: íŠ¹ì • ì‹œì ì—ì„œ ë°œìƒí•˜ëŠ” íŒ¨í„´ ë³€í™”</li>
</ul>

<h2 id="-ì‹œê³„ì—´-ë°ì´í„°ì˜-íŠ¹ì„±-1">ğŸ“Š ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¹ì„±</h2>

<h3 id="1-ì •ìƒì„±stationarity">1. ì •ìƒì„±(Stationarity)</h3>
<p>ì •ìƒì„±ì€ ì‹œê³„ì—´ì˜ í†µê³„ì  íŠ¹ì„±ì´ ì‹œê°„ì— ë”°ë¼ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì •ìƒì„± ê²€ì • ì˜ˆì œ
</span><span class="kn">from</span> <span class="n">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>

<span class="k">def</span> <span class="nf">check_stationarity</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="nf">adfuller</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">ADF í†µê³„ëŸ‰: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">p-value: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">ì„ê³„ê°’: </span><span class="si">{</span><span class="n">result</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ì‹œê³„ì—´ì´ ì •ìƒì ì…ë‹ˆë‹¤ (H0 ê¸°ê°)</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ì‹œê³„ì—´ì´ ë¹„ì •ìƒì ì…ë‹ˆë‹¤ (H0 ì±„íƒ)</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2-ìê¸°ìƒê´€autocorrelation">2. ìê¸°ìƒê´€(Autocorrelation)</h3>
<p>ìê¸°ìƒê´€ì€ ì‹œê³„ì—´ì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ì‹œê°„ ê°„ê²©ì˜ ê°’ë“¤ ê°„ì˜ ìƒê´€ê´€ê³„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ìê¸°ìƒê´€í•¨ìˆ˜(ACF)ì™€ ë¶€ë¶„ìê¸°ìƒê´€í•¨ìˆ˜(PACF)
</span><span class="kn">from</span> <span class="n">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>

<span class="k">def</span> <span class="nf">plot_correlation_functions</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">40</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    
    <span class="nf">plot_acf</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
    <span class="nf">plot_pacf</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="n">lags</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="-ì „í†µì -í†µê³„-ë°©ë²•">ğŸ“ˆ ì „í†µì  í†µê³„ ë°©ë²•</h2>

<h3 id="1-ì´ë™í‰ê· moving-average">1. ì´ë™í‰ê· (Moving Average)</h3>
<p>ì´ë™í‰ê· ì€ ë…¸ì´ì¦ˆë¥¼ ì¤„ì´ê¸° ìœ„í•´ íŠ¹ì • ê¸°ê°„ì˜ í‰ê· ì„ ê³„ì‚°í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">simple_moving_average</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ë‹¨ìˆœ ì´ë™í‰ê·  ê³„ì‚°</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">rolling</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">exponential_moving_average</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì§€ìˆ˜ ì´ë™í‰ê·  ê³„ì‚°</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">ewm</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">).</span><span class="nf">mean</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="2-ì°¨ë¶„differencing">2. ì°¨ë¶„(Differencing)</h3>
<p>ì°¨ë¶„ì€ ì‹œê³„ì—´ì—ì„œ ì •ìƒì„±ì„ ë‹¬ì„±í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">difference_series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì°¨ë¶„ ê³„ì‚°</span><span class="sh">"""</span>
    <span class="k">return</span> <span class="n">data</span><span class="p">.</span><span class="nf">diff</span><span class="p">(</span><span class="n">order</span><span class="p">).</span><span class="nf">dropna</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="ï¸-arima-ëª¨ë¸">ğŸ—ï¸ ARIMA ëª¨ë¸</h2>

<p>ARIMA (AutoRegressive Integrated Moving Average)ëŠ” ì‹œê³„ì—´ ì˜ˆì¸¡ì„ ìœ„í•œ ê°€ì¥ ê¸°ë³¸ì ì¸ ëª¨ë¸ì…ë‹ˆë‹¤.</p>

<h3 id="arima-ëª¨ë¸ì˜-êµ¬ì„±-ìš”ì†Œ">ARIMA ëª¨ë¸ì˜ êµ¬ì„± ìš”ì†Œ</h3>

<ol>
  <li><strong>AR (ìê¸°íšŒê·€)</strong>: ê³¼ê±° ê°’ë“¤ì˜ ì„ í˜• ê²°í•©</li>
  <li><strong>I (í†µí•©)</strong>: ì°¨ë¶„ì„ í†µí•œ ì •ìƒì„± ë‹¬ì„±</li>
  <li><strong>MA (ì´ë™í‰ê· )</strong>: ê³¼ê±° ì˜¤ì°¨ë“¤ì˜ ì„ í˜• ê²°í•©</li>
</ol>

<h3 id="arimap-d-q-ë§¤ê°œë³€ìˆ˜">ARIMA(p, d, q) ë§¤ê°œë³€ìˆ˜</h3>

<ul>
  <li><strong>p</strong>: AR ì°¨ìˆ˜ (ì‚¬ìš©ë˜ëŠ” ê³¼ê±° ê°’ì˜ ê°œìˆ˜)</li>
  <li><strong>d</strong>: ì°¨ë¶„ ì°¨ìˆ˜ (ì •ìƒì„±ì„ ìœ„í•œ ì°¨ë¶„ ì—°ì‚° íšŸìˆ˜)</li>
  <li><strong>q</strong>: MA ì°¨ìˆ˜ (ì‚¬ìš©ë˜ëŠ” ê³¼ê±° ì˜¤ì°¨ì˜ ê°œìˆ˜)</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span> <span class="n">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># ìƒ˜í”Œ ì‹œê³„ì—´ ë°ì´í„° ìƒì„±
</span><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">noise</span>

<span class="c1"># pandas Seriesë¡œ ë³€í™˜
</span><span class="n">ts</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="sh">'</span><span class="s">2020-01-01</span><span class="sh">'</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">))</span>

<span class="c1"># ì •ìƒì„± ê²€ì •
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ì›ë³¸ ì‹œê³„ì—´ ì •ìƒì„± ê²€ì •:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">check_stationarity</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>

<span class="c1"># ì°¨ë¶„ì„ í†µí•œ ì •ìƒì„± ë‹¬ì„±
</span><span class="n">ts_diff</span> <span class="o">=</span> <span class="nf">difference_series</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">1ì°¨ ì°¨ë¶„ í›„ ì •ìƒì„± ê²€ì •:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">check_stationarity</span><span class="p">(</span><span class="n">ts_diff</span><span class="p">)</span>

<span class="c1"># ACFì™€ PACF ê·¸ë˜í”„
</span><span class="nf">plot_correlation_functions</span><span class="p">(</span><span class="n">ts_diff</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># ARIMA ëª¨ë¸ ì í•© (p=2, d=1, q=2)
</span><span class="n">model</span> <span class="o">=</span> <span class="nc">ARIMA</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">()</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">ARIMA ëª¨ë¸ ìš”ì•½:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">fitted_model</span><span class="p">.</span><span class="nf">summary</span><span class="p">())</span>

<span class="c1"># ì˜ˆì¸¡
</span><span class="n">forecast_steps</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">forecast</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">.</span><span class="nf">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>

<span class="c1"># ê²°ê³¼ ì‹œê°í™”
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">ts</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì›ë³¸ ë°ì´í„°</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecast</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì˜ˆì¸¡ê°’</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ARIMA ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ë‚ ì§œ</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># ëª¨ë¸ ì„±ëŠ¥ í‰ê°€
</span><span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>

<span class="c1"># í›ˆë ¨ ë°ì´í„°ì™€ ê²€ì¦ ë°ì´í„° ë¶„í• 
</span><span class="n">train_size</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">ts</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">ts</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># í›ˆë ¨ ë°ì´í„°ë¡œ ëª¨ë¸ ì¬ì í•©
</span><span class="n">model_train</span> <span class="o">=</span> <span class="nc">ARIMA</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">fitted_model_train</span> <span class="o">=</span> <span class="n">model_train</span><span class="p">.</span><span class="nf">fit</span><span class="p">()</span>

<span class="c1"># ê²€ì¦ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡
</span><span class="n">forecast_test</span> <span class="o">=</span> <span class="n">fitted_model_train</span><span class="p">.</span><span class="nf">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>

<span class="c1"># ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°
</span><span class="n">mse</span> <span class="o">=</span> <span class="nf">mean_squared_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">forecast_test</span><span class="p">)</span>
<span class="n">mae</span> <span class="o">=</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">test</span><span class="p">,</span> <span class="n">forecast_test</span><span class="p">)</span>
<span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">ëª¨ë¸ ì„±ëŠ¥ í‰ê°€:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="-prophet-ì†Œê°œ">ğŸš€ Prophet ì†Œê°œ</h2>

<p>Prophetì€ Facebookì—ì„œ ê°œë°œí•œ ìë™í™”ëœ ì‹œê³„ì—´ ì˜ˆì¸¡ ë„êµ¬ë¡œ, ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œê³„ì—´ ë°ì´í„°ì— íŠ¹í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>

<h3 id="prophetì˜-ì¥ì ">Prophetì˜ ì¥ì </h3>

<ol>
  <li><strong>ìë™í™”ëœ ëª¨ë¸ë§</strong>: í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ì´ ìë™í™”ë¨</li>
  <li><strong>ê³„ì ˆì„± ì²˜ë¦¬</strong>: ë‹¤ì–‘í•œ ê³„ì ˆì  íŒ¨í„´ì„ ìë™ìœ¼ë¡œ ê°ì§€</li>
  <li><strong>ì´ìƒì¹˜ ì²˜ë¦¬</strong>: íœ´ì¼ì´ë‚˜ ì´ë²¤íŠ¸ ê°™ì€ íŠ¹ë³„í•œ ë‚ ì§œë“¤ì„ ì²˜ë¦¬</li>
  <li><strong>í•´ì„ ê°€ëŠ¥ì„±</strong>: ì¶”ì„¸ì™€ ê³„ì ˆì„± êµ¬ì„± ìš”ì†Œë¥¼ ë¶„ì„</li>
</ol>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">fbprophet</span> <span class="kn">import</span> <span class="n">Prophet</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="c1"># Prophetìš© ë°ì´í„° ì¤€ë¹„ (ì»¬ëŸ¼: ds, y)
</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
    <span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="sh">'</span><span class="s">2020-01-01</span><span class="sh">'</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">),</span>
    <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">:</span> <span class="n">ts</span><span class="p">.</span><span class="n">values</span>
<span class="p">})</span>

<span class="c1"># Prophet ëª¨ë¸ ìƒì„± ë° ì í•©
</span><span class="n">model_prophet</span> <span class="o">=</span> <span class="nc">Prophet</span><span class="p">(</span>
    <span class="n">yearly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>    <span class="c1"># ì—°ê°„ ê³„ì ˆì„±
</span>    <span class="n">weekly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>    <span class="c1"># ì£¼ê°„ ê³„ì ˆì„±
</span>    <span class="n">daily_seasonality</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>    <span class="c1"># ì¼ê°„ ê³„ì ˆì„± (ë°ì´í„° ë¶€ì¡±ì‹œ False)
</span>    <span class="n">seasonality_mode</span><span class="o">=</span><span class="sh">'</span><span class="s">additive</span><span class="sh">'</span> <span class="c1"># ê°€ë²•ì  ê³„ì ˆì„±
</span><span class="p">)</span>

<span class="n">model_prophet</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># ë¯¸ë˜ ì˜ˆì¸¡
</span><span class="n">future</span> <span class="o">=</span> <span class="n">model_prophet</span><span class="p">.</span><span class="nf">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="n">forecast_prophet</span> <span class="o">=</span> <span class="n">model_prophet</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>

<span class="c1"># ì˜ˆì¸¡ ê²°ê³¼ ì‹œê°í™”
</span><span class="n">fig1</span> <span class="o">=</span> <span class="n">model_prophet</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">forecast_prophet</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Prophet ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># êµ¬ì„± ìš”ì†Œ ë¶„ì„
</span><span class="n">fig2</span> <span class="o">=</span> <span class="n">model_prophet</span><span class="p">.</span><span class="nf">plot_components</span><span class="p">(</span><span class="n">forecast_prophet</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># Prophet ëª¨ë¸ ì„±ëŠ¥ í‰ê°€
# í›ˆë ¨ ë°ì´í„°ì™€ ê²€ì¦ ë°ì´í„° ë¶„í• 
</span><span class="n">train_size</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="n">train_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>

<span class="c1"># í›ˆë ¨ ë°ì´í„°ë¡œ ëª¨ë¸ ì¬ì í•©
</span><span class="n">model_prophet_train</span> <span class="o">=</span> <span class="nc">Prophet</span><span class="p">(</span>
    <span class="n">yearly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">weekly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">daily_seasonality</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">seasonality_mode</span><span class="o">=</span><span class="sh">'</span><span class="s">additive</span><span class="sh">'</span>
<span class="p">)</span>
<span class="n">model_prophet_train</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>

<span class="c1"># ê²€ì¦ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡
</span><span class="n">future_test</span> <span class="o">=</span> <span class="n">model_prophet_train</span><span class="p">.</span><span class="nf">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">test_df</span><span class="p">))</span>
<span class="n">forecast_prophet_test</span> <span class="o">=</span> <span class="n">model_prophet_train</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">future_test</span><span class="p">)</span>

<span class="c1"># ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°
</span><span class="n">y_true</span> <span class="o">=</span> <span class="n">test_df</span><span class="p">[</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">forecast_prophet_test</span><span class="p">[</span><span class="sh">'</span><span class="s">yhat</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">test_df</span><span class="p">):]</span>

<span class="n">mse_prophet</span> <span class="o">=</span> <span class="nf">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">mae_prophet</span> <span class="o">=</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
<span class="n">rmse_prophet</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mse_prophet</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">Prophet ëª¨ë¸ ì„±ëŠ¥ í‰ê°€:</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">MSE: </span><span class="si">{</span><span class="n">mse_prophet</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">MAE: </span><span class="si">{</span><span class="n">mae_prophet</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">RMSE: </span><span class="si">{</span><span class="n">rmse_prophet</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="ï¸-ì‹¤ìŠµ-êµ¬í˜„">ğŸ› ï¸ ì‹¤ìŠµ êµ¬í˜„</h2>

<h3 id="1-í™˜ê²½-ì„¤ì •-ë°-ë°ì´í„°-ì¤€ë¹„">1. í™˜ê²½ ì„¤ì • ë° ë°ì´í„° ì¤€ë¹„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
# pip install pandas numpy matplotlib seaborn statsmodels fbprophet scikit-learn
</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="n">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span> <span class="n">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="n">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span> <span class="n">fbprophet</span> <span class="kn">import</span> <span class="n">Prophet</span>
<span class="kn">from</span> <span class="n">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">mean_absolute_error</span>
<span class="kn">import</span> <span class="n">warnings</span>
<span class="n">warnings</span><span class="p">.</span><span class="nf">filterwarnings</span><span class="p">(</span><span class="sh">'</span><span class="s">ignore</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># ì‹œê°í™” ì„¤ì •
</span><span class="n">plt</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="nf">use</span><span class="p">(</span><span class="sh">'</span><span class="s">seaborn-v0_8</span><span class="sh">'</span><span class="p">)</span>
<span class="n">sns</span><span class="p">.</span><span class="nf">set_palette</span><span class="p">(</span><span class="sh">"</span><span class="s">husl</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2-ë³µì¡í•œ-ì‹œê³„ì—´-ë°ì´í„°-ìƒì„±">2. ë³µì¡í•œ ì‹œê³„ì—´ ë°ì´í„° ìƒì„±</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">generate_complex_timeseries</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ë³µì¡í•œ ì‹œê³„ì—´ ë°ì´í„° ìƒì„±</span><span class="sh">"""</span>
    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>
    
    <span class="c1"># ì‹œê°„ ì¸ë±ìŠ¤
</span>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># ì¶”ì„¸ (ë¹„ì„ í˜•)
</span>    <span class="n">trend</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.00001</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mi">3</span>
    
    <span class="c1"># ê³„ì ˆì„± (ë‹¤ì¤‘ ì£¼ê¸°)
</span>    <span class="n">seasonality_1</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">365</span><span class="p">)</span>  <span class="c1"># ì—°ê°„
</span>    <span class="n">seasonality_2</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">7</span><span class="p">)</span>     <span class="c1"># ì£¼ê°„
</span>    <span class="n">seasonality_3</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">24</span><span class="p">)</span>    <span class="c1"># ì¼ê°„
</span>    
    <span class="c1"># êµ¬ì¡°ì  ë³€í™” (ì¤‘ê°„ì— íŒ¨í„´ ë³€í™”)
</span>    <span class="n">structural_change</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">n</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">t</span> <span class="o">/</span> <span class="mi">100</span><span class="p">))</span>
    
    <span class="c1"># ë…¸ì´ì¦ˆ (ì‹œê°„ì— ë”°ë¼ ì¦ê°€í•˜ëŠ” ë³€ë™ì„±)
</span>    <span class="n">noise</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    
    <span class="c1"># ì´ìƒì¹˜ ì¶”ê°€
</span>    <span class="n">outliers</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="o">//</span><span class="mi">50</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">noise</span><span class="p">[</span><span class="n">outliers</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">outliers</span><span class="p">))</span>
    
    <span class="c1"># ì™„ì „í•œ ì‹œê³„ì—´
</span>    <span class="n">ts</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality_1</span> <span class="o">+</span> <span class="n">seasonality_2</span> <span class="o">+</span> <span class="n">seasonality_3</span> <span class="o">+</span> <span class="n">structural_change</span> <span class="o">+</span> <span class="n">noise</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">Series</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="p">.</span><span class="nf">date_range</span><span class="p">(</span><span class="sh">'</span><span class="s">2020-01-01</span><span class="sh">'</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="sh">'</span><span class="s">D</span><span class="sh">'</span><span class="p">))</span>

<span class="c1"># ë³µì¡í•œ ì‹œê³„ì—´ ìƒì„±
</span><span class="n">complex_ts</span> <span class="o">=</span> <span class="nf">generate_complex_timeseries</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># ì‹œê°í™”
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">complex_ts</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">complex_ts</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ë³µì¡í•œ ì‹œê³„ì—´ ë°ì´í„°</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">complex_ts</span><span class="p">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">complex_ts</span><span class="p">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">100</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ì²« 100ì¼ ë°ì´í„° (í™•ëŒ€)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">complex_ts</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">complex_ts</span><span class="p">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">:],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ë§ˆì§€ë§‰ 100ì¼ ë°ì´í„° (í™•ëŒ€)</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="3-arima-ëª¨ë¸-ì‹¤ìŠµ">3. ARIMA ëª¨ë¸ ì‹¤ìŠµ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">arima_practice</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ARIMA ëª¨ë¸ ì‹¤ìŠµ</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=== ARIMA ëª¨ë¸ ì‹¤ìŠµ ===</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 1. ì •ìƒì„± ê²€ì •
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">1. ì •ìƒì„± ê²€ì •</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">check_stationarity</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
    
    <span class="c1"># 2. ì°¨ë¶„ì„ í†µí•œ ì •ìƒì„± ë‹¬ì„±
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">2. ì°¨ë¶„ì„ í†µí•œ ì •ìƒì„± ë‹¬ì„±</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">ts_diff</span> <span class="o">=</span> <span class="nf">difference_series</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span>
    <span class="nf">check_stationarity</span><span class="p">(</span><span class="n">ts_diff</span><span class="p">)</span>
    
    <span class="c1"># 3. ACFì™€ PACF ë¶„ì„
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">3. ACFì™€ PACF ë¶„ì„</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">plot_correlation_functions</span><span class="p">(</span><span class="n">ts_diff</span><span class="p">,</span> <span class="n">lags</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    
    <span class="c1"># 4. ARIMA ëª¨ë¸ ì í•© (ì—¬ëŸ¬ ë§¤ê°œë³€ìˆ˜ ì‹œë„)
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">4. ARIMA ëª¨ë¸ ì í•©</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">best_aic</span> <span class="o">=</span> <span class="nf">float</span><span class="p">(</span><span class="sh">'</span><span class="s">inf</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">best_order</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="c1"># ë§¤ê°œë³€ìˆ˜ ê·¸ë¦¬ë“œ íƒìƒ‰
</span>    <span class="n">p_values</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">d_values</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">q_values</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">p_values</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">d_values</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">q</span> <span class="ow">in</span> <span class="n">q_values</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">model</span> <span class="o">=</span> <span class="nc">ARIMA</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">))</span>
                    <span class="n">fitted_model</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">()</span>
                    <span class="n">aic</span> <span class="o">=</span> <span class="n">fitted_model</span><span class="p">.</span><span class="n">aic</span>
                    
                    <span class="k">if</span> <span class="n">aic</span> <span class="o">&lt;</span> <span class="n">best_aic</span><span class="p">:</span>
                        <span class="n">best_aic</span> <span class="o">=</span> <span class="n">aic</span>
                        <span class="n">best_order</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
                        <span class="n">best_model</span> <span class="o">=</span> <span class="n">fitted_model</span>
                        
                    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ARIMA(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s">,</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s">,</span><span class="si">{</span><span class="n">q</span><span class="si">}</span><span class="s">) - AIC: </span><span class="si">{</span><span class="n">aic</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                    
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">continue</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">ìµœì  ëª¨ë¸: ARIMA</span><span class="si">{</span><span class="n">best_order</span><span class="si">}</span><span class="s"> (AIC: </span><span class="si">{</span><span class="n">best_aic</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 5. ìµœì  ëª¨ë¸ë¡œ ì˜ˆì¸¡
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">5. ìµœì  ëª¨ë¸ë¡œ ì˜ˆì¸¡</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">forecast_steps</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">forecast</span> <span class="o">=</span> <span class="n">best_model</span><span class="p">.</span><span class="nf">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
    
    <span class="c1"># 6. ê²°ê³¼ ì‹œê°í™”
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">timeseries</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì›ë³¸ ë°ì´í„°</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecast</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì˜ˆì¸¡ê°’</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">ARIMA</span><span class="si">{</span><span class="n">best_order</span><span class="si">}</span><span class="s"> ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ë‚ ì§œ</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">best_model</span><span class="p">,</span> <span class="n">forecast</span>

<span class="c1"># ARIMA ì‹¤ìŠµ ì‹¤í–‰
</span><span class="n">arima_model</span><span class="p">,</span> <span class="n">arima_forecast</span> <span class="o">=</span> <span class="nf">arima_practice</span><span class="p">(</span><span class="n">complex_ts</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="4-prophet-ëª¨ë¸-ì‹¤ìŠµ">4. Prophet ëª¨ë¸ ì‹¤ìŠµ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">prophet_practice</span><span class="p">(</span><span class="n">timeseries</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">Prophet ëª¨ë¸ ì‹¤ìŠµ</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=== Prophet ëª¨ë¸ ì‹¤ìŠµ ===</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 1. Prophetìš© ë°ì´í„° ì¤€ë¹„
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">1. Prophetìš© ë°ì´í„° ì¤€ë¹„</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
        <span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">:</span> <span class="n">timeseries</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">:</span> <span class="n">timeseries</span><span class="p">.</span><span class="n">values</span>
    <span class="p">})</span>
    
    <span class="c1"># 2. ëª¨ë¸ ìƒì„± ë° ì í•©
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">2. Prophet ëª¨ë¸ ì í•©</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="nc">Prophet</span><span class="p">(</span>
        <span class="n">yearly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">weekly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">daily_seasonality</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
        <span class="n">seasonality_mode</span><span class="o">=</span><span class="sh">'</span><span class="s">additive</span><span class="sh">'</span><span class="p">,</span>
        <span class="n">changepoint_prior_scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># ì¶”ì„¸ ë³€í™”ì  ë¯¼ê°ë„
</span>        <span class="n">seasonality_prior_scale</span><span class="o">=</span><span class="mf">10.0</span>   <span class="c1"># ê³„ì ˆì„± ê°•ë„
</span>    <span class="p">)</span>
    
    <span class="c1"># íœ´ì¼ ì •ë³´ ì¶”ê°€ (ì˜ˆì œ)
</span>    <span class="n">holidays</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
        <span class="sh">'</span><span class="s">holiday</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">new_year</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">:</span> <span class="n">pd</span><span class="p">.</span><span class="nf">to_datetime</span><span class="p">([</span><span class="sh">'</span><span class="s">2020-01-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2021-01-01</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">2022-01-01</span><span class="sh">'</span><span class="p">]),</span>
        <span class="sh">'</span><span class="s">lower_window</span><span class="sh">'</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">upper_window</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">})</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">add_country_holidays</span><span class="p">(</span><span class="n">country_name</span><span class="o">=</span><span class="sh">'</span><span class="s">US</span><span class="sh">'</span><span class="p">)</span>  <span class="c1"># ë¯¸êµ­ íœ´ì¼ ì¶”ê°€
</span>    
    <span class="n">model</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
    
    <span class="c1"># 3. ë¯¸ë˜ ì˜ˆì¸¡
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">3. ë¯¸ë˜ ì˜ˆì¸¡</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">future</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">forecast</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
    
    <span class="c1"># 4. ì˜ˆì¸¡ ê²°ê³¼ ì‹œê°í™”
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">4. ì˜ˆì¸¡ ê²°ê³¼ ì‹œê°í™”</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">fig1</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Prophet ëª¨ë¸ ì˜ˆì¸¡ ê²°ê³¼</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    
    <span class="c1"># 5. êµ¬ì„± ìš”ì†Œ ë¶„ì„
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">5. êµ¬ì„± ìš”ì†Œ ë¶„ì„</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">plot_components</span><span class="p">(</span><span class="n">forecast</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    
    <span class="c1"># 6. ì¶”ì„¸ ë³€í™”ì  ë¶„ì„
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">6. ì¶”ì„¸ ë³€í™”ì  ë¶„ì„</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">changepoints</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="n">changepoints</span>
    <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">changepoints</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì›ë³¸ ë°ì´í„°</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">forecast</span><span class="p">[</span><span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">],</span> <span class="n">forecast</span><span class="p">[</span><span class="sh">'</span><span class="s">yhat</span><span class="sh">'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì˜ˆì¸¡ê°’</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">vlines</span><span class="p">(</span><span class="n">changepoints</span><span class="p">,</span> <span class="n">ymin</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">].</span><span class="nf">min</span><span class="p">(),</span> <span class="n">ymax</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">].</span><span class="nf">max</span><span class="p">(),</span> 
                  <span class="n">colors</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ë³€í™”ì </span><span class="sh">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">Prophet ëª¨ë¸ - ì¶”ì„¸ ë³€í™”ì </span><span class="sh">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ë‚ ì§œ</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">model</span><span class="p">,</span> <span class="n">forecast</span>

<span class="c1"># Prophet ì‹¤ìŠµ ì‹¤í–‰
</span><span class="n">prophet_model</span><span class="p">,</span> <span class="n">prophet_forecast</span> <span class="o">=</span> <span class="nf">prophet_practice</span><span class="p">(</span><span class="n">complex_ts</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="5-ëª¨ë¸-ì„±ëŠ¥-ë¹„êµ-ë°-ë¶„ì„">5. ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ ë° ë¶„ì„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">compare_models</span><span class="p">(</span><span class="n">timeseries</span><span class="p">,</span> <span class="n">arima_forecast</span><span class="p">,</span> <span class="n">prophet_forecast</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ARIMAì™€ Prophet ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ</span><span class="sh">"""</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">=== ëª¨ë¸ ì„±ëŠ¥ ë¹„êµ ===</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># ë°ì´í„° ë¶„í•  (í›ˆë ¨:ê²€ì¦ = 8:2)
</span>    <span class="n">train_size</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">timeseries</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">train</span> <span class="o">=</span> <span class="n">timeseries</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
    <span class="n">test</span> <span class="o">=</span> <span class="n">timeseries</span><span class="p">[</span><span class="n">train_size</span><span class="p">:]</span>
    
    <span class="c1"># ARIMA ëª¨ë¸ ì¬ì í•© ë° ê²€ì¦
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">1. ARIMA ëª¨ë¸ ê²€ì¦</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">model_arima</span> <span class="o">=</span> <span class="nc">ARIMA</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># ê°„ë‹¨í•œ ëª¨ë¸ ì‚¬ìš©
</span>    <span class="n">fitted_arima</span> <span class="o">=</span> <span class="n">model_arima</span><span class="p">.</span><span class="nf">fit</span><span class="p">()</span>
    <span class="n">forecast_arima_test</span> <span class="o">=</span> <span class="n">fitted_arima</span><span class="p">.</span><span class="nf">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>
    
    <span class="c1"># Prophet ëª¨ë¸ ì¬ì í•© ë° ê²€ì¦
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">2. Prophet ëª¨ë¸ ê²€ì¦</span><span class="sh">"</span><span class="p">)</span>
    <span class="n">train_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
        <span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">:</span> <span class="n">train</span><span class="p">.</span><span class="n">index</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">y</span><span class="sh">'</span><span class="p">:</span> <span class="n">train</span><span class="p">.</span><span class="n">values</span>
    <span class="p">})</span>
    
    <span class="n">model_prophet</span> <span class="o">=</span> <span class="nc">Prophet</span><span class="p">(</span>
        <span class="n">yearly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">weekly_seasonality</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
        <span class="n">daily_seasonality</span><span class="o">=</span><span class="bp">False</span>
    <span class="p">)</span>
    <span class="n">model_prophet</span><span class="p">.</span><span class="nf">fit</span><span class="p">(</span><span class="n">train_df</span><span class="p">)</span>
    
    <span class="n">future_test</span> <span class="o">=</span> <span class="n">model_prophet</span><span class="p">.</span><span class="nf">make_future_dataframe</span><span class="p">(</span><span class="n">periods</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">test</span><span class="p">))</span>
    <span class="n">forecast_prophet_test</span> <span class="o">=</span> <span class="n">model_prophet</span><span class="p">.</span><span class="nf">predict</span><span class="p">(</span><span class="n">future_test</span><span class="p">)</span>
    <span class="n">yhat_prophet</span> <span class="o">=</span> <span class="n">forecast_prophet_test</span><span class="p">[</span><span class="sh">'</span><span class="s">yhat</span><span class="sh">'</span><span class="p">].</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="nf">len</span><span class="p">(</span><span class="n">test</span><span class="p">):]</span>
    
    <span class="c1"># ì„±ëŠ¥ ì§€í‘œ ê³„ì‚°
</span>    <span class="k">def</span> <span class="nf">calculate_metrics</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">model_name</span><span class="p">):</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="nf">mean_squared_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">mae</span> <span class="o">=</span> <span class="nf">mean_absolute_error</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
        <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s"> ì„±ëŠ¥:</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">  RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">mse</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span>
    
    <span class="c1"># ARIMA ì„±ëŠ¥
</span>    <span class="n">arima_metrics</span> <span class="o">=</span> <span class="nf">calculate_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">forecast_arima_test</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="sh">"</span><span class="s">ARIMA</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># Prophet ì„±ëŠ¥
</span>    <span class="n">prophet_metrics</span> <span class="o">=</span> <span class="nf">calculate_metrics</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">yhat_prophet</span><span class="p">,</span> <span class="sh">"</span><span class="s">Prophet</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># ì„±ëŠ¥ ë¹„êµ ì‹œê°í™”
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    
    <span class="c1"># ì „ì²´ ì‹œê³„ì—´
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">timeseries</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">timeseries</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì›ë³¸ ë°ì´í„°</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">arima_forecast</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">arima_forecast</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ARIMA ì˜ˆì¸¡</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">prophet_forecast</span><span class="p">[</span><span class="sh">'</span><span class="s">ds</span><span class="sh">'</span><span class="p">],</span> <span class="n">prophet_forecast</span><span class="p">[</span><span class="sh">'</span><span class="s">yhat</span><span class="sh">'</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Prophet ì˜ˆì¸¡</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">test</span><span class="p">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">black</span><span class="sh">'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ê²€ì¦ ì‹œì‘</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ì „ì²´ ì‹œê³„ì—´ ë° ì˜ˆì¸¡ ë¹„êµ</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ë‚ ì§œ</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="c1"># ê²€ì¦ ê¸°ê°„ í™•ëŒ€
</span>    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì‹¤ì œê°’</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">forecast_arima_test</span><span class="p">.</span><span class="n">values</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ARIMA ì˜ˆì¸¡</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">test</span><span class="p">.</span><span class="n">index</span><span class="p">,</span> <span class="n">yhat_prophet</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Prophet ì˜ˆì¸¡</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">green</span><span class="sh">'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ê²€ì¦ ê¸°ê°„ ì˜ˆì¸¡ ë¹„êµ</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ë‚ ì§œ</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">ê°’</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    
    <span class="c1"># ì„±ëŠ¥ ìš”ì•½ í…Œì´ë¸”
</span>    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">({</span>
        <span class="sh">'</span><span class="s">ëª¨ë¸</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">ARIMA</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Prophet</span><span class="sh">'</span><span class="p">],</span>
        <span class="sh">'</span><span class="s">MSE</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">arima_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prophet_metrics</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
        <span class="sh">'</span><span class="s">MAE</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">arima_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">prophet_metrics</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
        <span class="sh">'</span><span class="s">RMSE</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="n">arima_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">prophet_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
    <span class="p">})</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="s">=== ì„±ëŠ¥ ë¹„êµ ìš”ì•½ ===</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">.</span><span class="nf">to_string</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
    
    <span class="c1"># ìŠ¹ì ê²°ì •
</span>    <span class="k">if</span> <span class="n">arima_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">prophet_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>  <span class="c1"># RMSE ê¸°ì¤€
</span>        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">ğŸ† ARIMA ëª¨ë¸ì´ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ë³´ì…ë‹ˆë‹¤! (RMSE: </span><span class="si">{</span><span class="n">arima_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="se">\n</span><span class="s">ğŸ† Prophet ëª¨ë¸ì´ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ë³´ì…ë‹ˆë‹¤! (RMSE: </span><span class="si">{</span><span class="n">prophet_metrics</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">:</span><span class="p">.</span><span class="mi">4</span><span class="n">f</span><span class="si">}</span><span class="s">)</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ëª¨ë¸ ë¹„êµ ì‹¤í–‰
</span><span class="nf">compare_models</span><span class="p">(</span><span class="n">complex_ts</span><span class="p">,</span> <span class="n">arima_forecast</span><span class="p">,</span> <span class="n">prophet_forecast</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="-ë°©ë²•ë¡ -ë¹„êµ">ğŸ“Š ë°©ë²•ë¡  ë¹„êµ</h2>

<h3 id="arima-vs-prophet">ARIMA vs Prophet</h3>

<table>
  <thead>
    <tr>
      <th>íŠ¹ì„±</th>
      <th>ARIMA</th>
      <th>Prophet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì ìš© ë²”ìœ„</strong></td>
      <td>ì„ í˜• ì‹œê³„ì—´</td>
      <td>ë¹„ì„ í˜• ì‹œê³„ì—´</td>
    </tr>
    <tr>
      <td><strong>ê³„ì ˆì„± ì²˜ë¦¬</strong></td>
      <td>ìˆ˜ë™ ì„¤ì •</td>
      <td>ìë™ ê°ì§€</td>
    </tr>
    <tr>
      <td><strong>ì´ìƒì¹˜ ì²˜ë¦¬</strong></td>
      <td>ë¯¼ê°í•¨</td>
      <td>ê°•ê±´í•¨</td>
    </tr>
    <tr>
      <td><strong>í•´ì„ ê°€ëŠ¥ì„±</strong></td>
      <td>ë†’ìŒ</td>
      <td>ë†’ìŒ</td>
    </tr>
    <tr>
      <td><strong>ìë™í™” ìˆ˜ì¤€</strong></td>
      <td>ë‚®ìŒ</td>
      <td>ë†’ìŒ</td>
    </tr>
    <tr>
      <td><strong>ê³„ì‚° íš¨ìœ¨ì„±</strong></td>
      <td>ë†’ìŒ</td>
      <td>ì¤‘ê°„</td>
    </tr>
    <tr>
      <td><strong>í•˜ì´í¼íŒŒë¼ë¯¸í„°</strong></td>
      <td>ìˆ˜ë™ íŠœë‹</td>
      <td>ìë™ ìµœì í™”</td>
    </tr>
  </tbody>
</table>

<h3 id="ì–¸ì œ-ì–´ë–¤-ëª¨ë¸ì„-ì‚¬ìš©í• ê¹Œ">ì–¸ì œ ì–´ë–¤ ëª¨ë¸ì„ ì‚¬ìš©í• ê¹Œ?</h3>

<h4 id="arimaë¥¼-ì‚¬ìš©í•˜ëŠ”-ê²½ìš°"><strong>ARIMAë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:</strong></h4>
<ul>
  <li>ì„ í˜• ì¶”ì„¸ë¥¼ ê°€ì§„ ì‹œê³„ì—´</li>
  <li>ëª…í™•í•œ ê³„ì ˆì  íŒ¨í„´</li>
  <li>ë¹ ë¥¸ ì˜ˆì¸¡ì´ í•„ìš”í•œ ê²½ìš°</li>
  <li>ëª¨ë¸ í•´ì„ì´ ì¤‘ìš”í•œ ê²½ìš°</li>
</ul>

<h4 id="prophetì„-ì‚¬ìš©í•˜ëŠ”-ê²½ìš°"><strong>Prophetì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°:</strong></h4>
<ul>
  <li>ë³µì¡í•œ ê³„ì ˆì  íŒ¨í„´</li>
  <li>íœ´ì¼ì´ë‚˜ ì´ë²¤íŠ¸ ê°™ì€ íŠ¹ë³„í•œ ë‚ ì§œë“¤</li>
  <li>ìë™í™”ëœ ëª¨ë¸ë§ì´ í•„ìš”í•œ ê²½ìš°</li>
  <li>ë¹„ì¦ˆë‹ˆìŠ¤ ì‹œê³„ì—´ ë°ì´í„°</li>
</ul>

<h2 id="-ë‹¤ìŒ-ë‹¨ê³„">ğŸš€ ë‹¤ìŒ ë‹¨ê³„</h2>

<p>ì´ì œ <strong>Part 2: ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡</strong>ìœ¼ë¡œ ë„˜ì–´ê°€ì„œ N-BEATSì™€ DeepARì„ í†µí•´ ë” ê°•ë ¥í•œ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤ì„ í•™ìŠµí•´ë³´ì„¸ìš”!</p>

<h3 id="ë‹¤ìŒ-íŒŒíŠ¸ì—ì„œ-ë‹¤ë£°-ë‚´ìš©">ë‹¤ìŒ íŒŒíŠ¸ì—ì„œ ë‹¤ë£° ë‚´ìš©</h3>

<ol>
  <li><strong>ë”¥ëŸ¬ë‹ ê¸°ë°˜ ëª¨ë¸ì˜ ë°°ê²½</strong></li>
  <li><strong>N-BEATSì˜ í•´ì„ ê°€ëŠ¥í•œ ë¸”ë¡ ê¸°ë°˜ ì•„í‚¤í…ì²˜</strong></li>
  <li><strong>DeepARì˜ í™•ë¥ ì  ì˜ˆì¸¡ê³¼ ë¶ˆí™•ì‹¤ì„± ì •ëŸ‰í™”</strong></li>
  <li><strong>PyTorchë¥¼ ì´ìš©í•œ ì‹¤ì œ ëª¨ë¸ êµ¬í˜„</strong></li>
  <li><strong>ì „í†µì  ë°©ë²•ê³¼ì˜ ì„±ëŠ¥ ë¹„êµ</strong></li>
</ol>

<hr />

<p><em>ì´ë²ˆ íŒŒíŠ¸ì—ì„œëŠ” ARIMAì™€ Prophetì„ í†µí•´ ì „í†µì  í†µê³„ ë°©ë²•ì˜ í•µì‹¬ì„ ë‹¤ë¤˜ìŠµë‹ˆë‹¤. ë‹¤ìŒ íŒŒíŠ¸ì—ì„œëŠ” ë”¥ëŸ¬ë‹ì˜ í˜ì„ í™œìš©í•œ ë” ì •êµí•œ ì‹œê³„ì—´ ì˜ˆì¸¡ì„ ê²½í—˜í•´ë³´ì„¸ìš”!</em> ğŸ¯</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
          
          
      
      
        
        
        <a href="/data-ai/2025/08/31/time-series-evolution-overview.html" class="nav-link prev">
          â† ì´ì „: ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ì§„í™”: ì „í†µì  ë°©ë²•ë¶€í„° ìµœì‹  AI ëª¨ë¸ê¹Œì§€
        </a>
      
      
      
        
        
        <a href="/data-ai/2025/09/01/time-series-deep-learning.html" class="nav-link next">
          ë‹¤ìŒ: Part 2: ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ - N-BEATSì™€ DeepAR â†’
        </a>
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-ai/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

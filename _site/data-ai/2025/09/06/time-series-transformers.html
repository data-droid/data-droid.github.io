<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="Informer, Autoformer, FEDformer, PatchTST ë“± ìµœì‹  íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤ì„ ì‚´í´ë³´ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.">



<title>Part 3: íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤ - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 3: íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤">
<meta property="og:description" content="Informer, Autoformer, FEDformer, PatchTST ë“± ìµœì‹  íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤ì„ ì‚´í´ë³´ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.">
<meta property="og:url" content="http://localhost:4000/data-ai/2025/09/06/time-series-transformers.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 3: íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤">
<meta name="twitter:description" content="Informer, Autoformer, FEDformer, PatchTST ë“± ìµœì‹  íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤ì„ ì‚´í´ë³´ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-ai/2025/09/06/time-series-transformers.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-06-time-series-transformers.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data ai</span>
      <span class="post-date">2025ë…„ 09ì›” 06ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 3: íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">ì‹œê³„ì—´ì˜ˆì¸¡</span>
      
        <span class="tag">íŠ¸ëœìŠ¤í¬ë¨¸</span>
      
        <span class="tag">Informer</span>
      
        <span class="tag">Autoformer</span>
      
        <span class="tag">FEDformer</span>
      
        <span class="tag">PatchTST</span>
      
        <span class="tag">ë”¥ëŸ¬ë‹</span>
      
        <span class="tag">AI</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Time series forecasting ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 4</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 15</span>
      
      
        <span class="difficulty">ğŸ“Š ì¤‘ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-3-íŠ¸ëœìŠ¤í¬ë¨¸-ê¸°ë°˜-ì‹œê³„ì—´-ì˜ˆì¸¡-ëª¨ë¸ë“¤">Part 3: íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤</h1>

<p>ì•ˆë…•í•˜ì„¸ìš”! ì‹œê³„ì—´ ì˜ˆì¸¡ ì‹œë¦¬ì¦ˆì˜ ì„¸ ë²ˆì§¸ íŒŒíŠ¸ì…ë‹ˆë‹¤. ì´ë²ˆì—ëŠ” ìì—°ì–´ ì²˜ë¦¬ì—ì„œ í˜ëª…ì„ ì¼ìœ¼í‚¨ íŠ¸ëœìŠ¤í¬ë¨¸(Transformer) ì•„í‚¤í…ì²˜ê°€ ì‹œê³„ì—´ ì˜ˆì¸¡ì— ì–´ë–»ê²Œ ì ìš©ë˜ì—ˆëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h2 id="-í•™ìŠµ-ëª©í‘œ">ğŸ“š í•™ìŠµ ëª©í‘œ</h2>

<p>ì´ íŒŒíŠ¸ë¥¼ í†µí•´ ë‹¤ìŒì„ í•™ìŠµí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>

<ul>
  <li>íŠ¸ëœìŠ¤í¬ë¨¸ê°€ ì‹œê³„ì—´ ì˜ˆì¸¡ì— ì ìš©ëœ ë°°ê²½ê³¼ í•„ìš”ì„±</li>
  <li>Informer, Autoformer, FEDformer, PatchTST ë“± ì£¼ìš” ëª¨ë¸ë“¤ì˜ íŠ¹ì§•</li>
  <li>ê° ëª¨ë¸ì˜ ì¥ë‹¨ì ê³¼ ì ìš© ë¶„ì•¼</li>
  <li>ì‹¤ì œ ë°ì´í„°ë¥¼ í™œìš©í•œ íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ì‹¤ìŠµ</li>
</ul>

<h2 id="-íŠ¸ëœìŠ¤í¬ë¨¸ê°€-ì‹œê³„ì—´ì—-ì ìš©ëœ-ë°°ê²½">ğŸ” íŠ¸ëœìŠ¤í¬ë¨¸ê°€ ì‹œê³„ì—´ì— ì ìš©ëœ ë°°ê²½</h2>

<h3 id="ê¸°ì¡´-ë°©ë²•ë“¤ì˜-í•œê³„">ê¸°ì¡´ ë°©ë²•ë“¤ì˜ í•œê³„</h3>

<p><strong>RNN/LSTMì˜ ë¬¸ì œì :</strong></p>
<ul>
  <li>ìˆœì°¨ì  ì²˜ë¦¬ë¡œ ì¸í•œ ê¸´ í•™ìŠµ ì‹œê°„</li>
  <li>ì¥ê¸° ì˜ì¡´ì„± í•™ìŠµì˜ ì–´ë ¤ì›€</li>
  <li>ë³‘ë ¬ ì²˜ë¦¬ ë¶ˆê°€ëŠ¥</li>
</ul>

<p><strong>CNNì˜ í•œê³„:</strong></p>
<ul>
  <li>ì§€ì—­ì  íŒ¨í„´ì—ë§Œ ì§‘ì¤‘</li>
  <li>ì¥ê±°ë¦¬ ì˜ì¡´ì„± í¬ì°© ì–´ë ¤ì›€</li>
</ul>

<h3 id="íŠ¸ëœìŠ¤í¬ë¨¸ì˜-ì¥ì ">íŠ¸ëœìŠ¤í¬ë¨¸ì˜ ì¥ì </h3>

<ol>
  <li><strong>ë³‘ë ¬ ì²˜ë¦¬</strong>: ëª¨ë“  ì‹œì ì„ ë™ì‹œì— ì²˜ë¦¬</li>
  <li><strong>ì¥ê±°ë¦¬ ì˜ì¡´ì„±</strong>: Self-attentionìœ¼ë¡œ ê¸´ ì‹œí€€ìŠ¤ì˜ ê´€ê³„ í•™ìŠµ</li>
  <li><strong>í™•ì¥ì„±</strong>: ë” í° ëª¨ë¸ê³¼ ë°ì´í„°ì…‹ìœ¼ë¡œ ì„±ëŠ¥ í–¥ìƒ ê°€ëŠ¥</li>
</ol>

<h2 id="-ì£¼ìš”-íŠ¸ëœìŠ¤í¬ë¨¸-ê¸°ë°˜-ì‹œê³„ì—´-ëª¨ë¸ë“¤">ğŸš€ ì£¼ìš” íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ëª¨ë¸ë“¤</h2>

<h3 id="1-informer-2021">1. Informer (2021)</h3>

<p><strong>í•µì‹¬ ì•„ì´ë””ì–´:</strong></p>
<ul>
  <li>ProbSparse Self-attentionìœ¼ë¡œ ê³„ì‚° ë³µì¡ë„ O(LÂ²) â†’ O(L log L)ë¡œ ê°ì†Œ</li>
  <li>Self-attention Distillingìœ¼ë¡œ ê³„ì¸µë³„ ì •ë³´ ì••ì¶•</li>
  <li>Generative Decoderë¡œ í•œ ë²ˆì— ê¸´ ì‹œí€€ìŠ¤ ì˜ˆì¸¡</li>
</ul>

<p><strong>ì£¼ìš” íŠ¹ì§•:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Informerì˜ í•µì‹¬ êµ¬ì¡°
</span><span class="k">class</span> <span class="nc">Informer</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">enc_in</span><span class="p">,</span> <span class="n">dec_in</span><span class="p">,</span> <span class="n">c_out</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">label_len</span><span class="p">,</span> <span class="n">out_len</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">(</span><span class="n">Informer</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="nf">__init__</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">enc_in</span> <span class="o">=</span> <span class="n">enc_in</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dec_in</span> <span class="o">=</span> <span class="n">dec_in</span>
        <span class="n">self</span><span class="p">.</span><span class="n">c_out</span> <span class="o">=</span> <span class="n">c_out</span>
        <span class="n">self</span><span class="p">.</span><span class="n">seq_len</span> <span class="o">=</span> <span class="n">seq_len</span>
        <span class="n">self</span><span class="p">.</span><span class="n">label_len</span> <span class="o">=</span> <span class="n">label_len</span>
        <span class="n">self</span><span class="p">.</span><span class="n">out_len</span> <span class="o">=</span> <span class="n">out_len</span>
        
        <span class="c1"># ProbSparse Attention ì‚¬ìš©
</span>        <span class="n">self</span><span class="p">.</span><span class="n">attn</span> <span class="o">=</span> <span class="nc">ProbAttention</span><span class="p">(</span><span class="n">attention_dropout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        
        <span class="c1"># Encoderì™€ Decoder
</span>        <span class="n">self</span><span class="p">.</span><span class="n">encoder</span> <span class="o">=</span> <span class="nc">Encoder</span><span class="p">(...)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">decoder</span> <span class="o">=</span> <span class="nc">Decoder</span><span class="p">(...)</span>
</code></pre></div></div>

<p><strong>ì¥ì :</strong></p>
<ul>
  <li>ê¸´ ì‹œí€€ìŠ¤ì—ì„œë„ íš¨ìœ¨ì </li>
  <li>ë‹¤ì–‘í•œ ë°ì´í„°ì…‹ì—ì„œ ìš°ìˆ˜í•œ ì„±ëŠ¥</li>
</ul>

<p><strong>ë‹¨ì :</strong></p>
<ul>
  <li>ë³µì¡í•œ êµ¬ì¡°ë¡œ ì¸í•œ ê¸´ í•™ìŠµ ì‹œê°„</li>
  <li>í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ì´ ì–´ë ¤ì›€</li>
</ul>

<h3 id="2-autoformer-2021">2. Autoformer (2021)</h3>

<p><strong>í•µì‹¬ ì•„ì´ë””ì–´:</strong></p>
<ul>
  <li>Auto-Correlation ë©”ì»¤ë‹ˆì¦˜ìœ¼ë¡œ ì‹œê³„ì—´ì˜ ì£¼ê¸°ì„± ìë™ í•™ìŠµ</li>
  <li>Decomposition Blockìœ¼ë¡œ íŠ¸ë Œë“œì™€ ê³„ì ˆì„± ë¶„ë¦¬</li>
  <li>Series-wise Connectionìœ¼ë¡œ ì •ë³´ ì†ì‹¤ ìµœì†Œí™”</li>
</ul>

<p><strong>ì£¼ìš” íŠ¹ì§•:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Autoformerì˜ Auto-Correlation
</span><span class="k">class</span> <span class="nc">AutoCorrelation</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">queries</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="c1"># ì‹œê³„ì—´ì˜ ì£¼ê¸°ì„±ì„ ì°¾ëŠ” ìƒê´€ê´€ê³„ ê³„ì‚°
</span>        <span class="n">autocorr</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">autocorrelation</span><span class="p">(</span><span class="n">queries</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">value_projection</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">*</span> <span class="n">autocorr</span>
</code></pre></div></div>

<p><strong>ì¥ì :</strong></p>
<ul>
  <li>ì‹œê³„ì—´ì˜ ì£¼ê¸°ì„± ìë™ í•™ìŠµ</li>
  <li>íŠ¸ë Œë“œì™€ ê³„ì ˆì„± ë¶„í•´ë¡œ í•´ì„ ê°€ëŠ¥ì„± í–¥ìƒ</li>
</ul>

<p><strong>ë‹¨ì :</strong></p>
<ul>
  <li>ì£¼ê¸°ì„±ì´ ì—†ëŠ” ë°ì´í„°ì—ì„œëŠ” ì„±ëŠ¥ ì œí•œ</li>
  <li>ë³µì¡í•œ íŒ¨í„´ í•™ìŠµì— ì–´ë ¤ì›€</li>
</ul>

<h3 id="3-fedformer-2022">3. FEDformer (2022)</h3>

<p><strong>í•µì‹¬ ì•„ì´ë””ì–´:</strong></p>
<ul>
  <li>Fourier Enhanced Decomposed Transformer</li>
  <li>FFTë¥¼ í™œìš©í•œ ì£¼íŒŒìˆ˜ ë„ë©”ì¸ì—ì„œì˜ attention</li>
  <li>ëª¨ë¸ ì•™ìƒë¸”ë¡œ ì„±ëŠ¥ í–¥ìƒ</li>
</ul>

<p><strong>ì£¼ìš” íŠ¹ì§•:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># FEDformerì˜ Fourier Attention
</span><span class="k">class</span> <span class="nc">FourierAttention</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># FFTë¡œ ì£¼íŒŒìˆ˜ ë„ë©”ì¸ ë³€í™˜
</span>        <span class="n">x_freq</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="nf">rfft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="c1"># ì£¼íŒŒìˆ˜ ë„ë©”ì¸ì—ì„œ attention ê³„ì‚°
</span>        <span class="n">attn_freq</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">frequency_attention</span><span class="p">(</span><span class="n">x_freq</span><span class="p">)</span>
        <span class="c1"># ì—­ë³€í™˜ìœ¼ë¡œ ì‹œê°„ ë„ë©”ì¸ ë³µì›
</span>        <span class="k">return</span> <span class="n">torch</span><span class="p">.</span><span class="n">fft</span><span class="p">.</span><span class="nf">irfft</span><span class="p">(</span><span class="n">attn_freq</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>ì¥ì :</strong></p>
<ul>
  <li>ì£¼íŒŒìˆ˜ ë„ë©”ì¸ì—ì„œì˜ íš¨ìœ¨ì  ì²˜ë¦¬</li>
  <li>ë‹¤ì–‘í•œ ì£¼ê¸°ì„± íŒ¨í„´ í•™ìŠµ ê°€ëŠ¥</li>
</ul>

<p><strong>ë‹¨ì :</strong></p>
<ul>
  <li>FFT ê³„ì‚° ë¹„ìš©</li>
  <li>ì‹¤ì‹œê°„ ì˜ˆì¸¡ì— ë¶€ì í•©í•  ìˆ˜ ìˆìŒ</li>
</ul>

<h3 id="4-patchtst-2023">4. PatchTST (2023)</h3>

<p><strong>í•µì‹¬ ì•„ì´ë””ì–´:</strong></p>
<ul>
  <li>ì‹œê³„ì—´ì„ íŒ¨ì¹˜ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ ì²˜ë¦¬</li>
  <li>Channel Independenceë¡œ ë‹¤ë³€ëŸ‰ ì‹œê³„ì—´ ì²˜ë¦¬</li>
  <li>ë‹¨ìˆœí•œ êµ¬ì¡°ë¡œë„ ìš°ìˆ˜í•œ ì„±ëŠ¥</li>
</ul>

<p><strong>ì£¼ìš” íŠ¹ì§•:</strong></p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># PatchTSTì˜ íŒ¨ì¹˜ ë¶„í• 
</span><span class="k">def</span> <span class="nf">create_patch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">patch_len</span><span class="p">,</span> <span class="n">stride</span><span class="p">):</span>
    <span class="c1"># ì‹œê³„ì—´ì„ íŒ¨ì¹˜ë¡œ ë¶„í• 
</span>    <span class="n">patches</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nf">unfold</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">patch_len</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">stride</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">patches</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></div>

<p><strong>ì¥ì :</strong></p>
<ul>
  <li>ë‹¨ìˆœí•˜ê³  íš¨ìœ¨ì ì¸ êµ¬ì¡°</li>
  <li>ë‹¤ë³€ëŸ‰ ì‹œê³„ì—´ì—ì„œ ìš°ìˆ˜í•œ ì„±ëŠ¥</li>
  <li>ë¹ ë¥¸ í•™ìŠµê³¼ ì¶”ë¡ </li>
</ul>

<p><strong>ë‹¨ì :</strong></p>
<ul>
  <li>íŒ¨ì¹˜ í¬ê¸°ì— ë¯¼ê°</li>
  <li>ë§¤ìš° ê¸´ ì‹œí€€ìŠ¤ì—ì„œëŠ” ì œí•œì </li>
</ul>

<h2 id="ï¸-ì‹¤ìŠµ-patchtstë¡œ-ì£¼ì‹-ê°€ê²©-ì˜ˆì¸¡">ğŸ› ï¸ ì‹¤ìŠµ: PatchTSTë¡œ ì£¼ì‹ ê°€ê²© ì˜ˆì¸¡</h2>

<p>ì´ì œ ì‹¤ì œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ PatchTST ëª¨ë¸ì„ êµ¬í˜„í•´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<h3 id="1-ë°ì´í„°-ì¤€ë¹„">1. ë°ì´í„° ì¤€ë¹„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">torch</span>
<span class="kn">import</span> <span class="n">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="n">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="n">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span><span class="p">,</span> <span class="n">TensorDataset</span>

<span class="c1"># ì£¼ì‹ ë°ì´í„° ìƒì„± (ì‹¤ì œë¡œëŠ” yfinance ë“± ì‚¬ìš©)
</span><span class="k">def</span> <span class="nf">generate_stock_data</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ê°€ìƒì˜ ì£¼ì‹ ë°ì´í„° ìƒì„±</span><span class="sh">"""</span>
    <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    
    <span class="c1"># íŠ¸ë Œë“œì™€ ê³„ì ˆì„±ì„ ê°€ì§„ ë°ì´í„° ìƒì„±
</span>    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="n">trend</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">t</span>
    <span class="n">seasonal</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
    <span class="n">noise</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
    
    <span class="c1"># ë‹¤ë³€ëŸ‰ ì‹œê³„ì—´ ìƒì„±
</span>    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonal</span> <span class="o">+</span> <span class="n">noise</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="mf">0.1</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="sh">'</span><span class="s">stock_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sh">'</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">)])</span>

<span class="c1"># ë°ì´í„° ìƒì„±
</span><span class="n">data</span> <span class="o">=</span> <span class="nf">generate_stock_data</span><span class="p">()</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ë°ì´í„° í˜•íƒœ: </span><span class="si">{</span><span class="n">data</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">data</span><span class="p">.</span><span class="nf">head</span><span class="p">())</span>
</code></pre></div></div>

<h3 id="2-patchtst-ëª¨ë¸-êµ¬í˜„">2. PatchTST ëª¨ë¸ êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">PatchTST</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">pred_len</span><span class="p">,</span> <span class="n">patch_len</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">d_model</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">n_heads</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">(</span><span class="n">PatchTST</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="nf">__init__</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">seq_len</span> <span class="o">=</span> <span class="n">seq_len</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pred_len</span> <span class="o">=</span> <span class="n">pred_len</span>
        <span class="n">self</span><span class="p">.</span><span class="n">patch_len</span> <span class="o">=</span> <span class="n">patch_len</span>
        <span class="n">self</span><span class="p">.</span><span class="n">stride</span> <span class="o">=</span> <span class="n">stride</span>
        <span class="n">self</span><span class="p">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="n">n_features</span>
        <span class="n">self</span><span class="p">.</span><span class="n">d_model</span> <span class="o">=</span> <span class="n">d_model</span>
        
        <span class="c1"># íŒ¨ì¹˜ ê°œìˆ˜ ê³„ì‚°
</span>        <span class="n">self</span><span class="p">.</span><span class="n">num_patches</span> <span class="o">=</span> <span class="p">(</span><span class="n">seq_len</span> <span class="o">-</span> <span class="n">patch_len</span><span class="p">)</span> <span class="o">//</span> <span class="n">stride</span> <span class="o">+</span> <span class="mi">1</span>
        
        <span class="c1"># ì…ë ¥ í”„ë¡œì ì…˜
</span>        <span class="n">self</span><span class="p">.</span><span class="n">input_projection</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">patch_len</span><span class="p">,</span> <span class="n">d_model</span><span class="p">)</span>
        
        <span class="c1"># ìœ„ì¹˜ ì¸ì½”ë”©
</span>        <span class="n">self</span><span class="p">.</span><span class="n">pos_encoding</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">num_patches</span><span class="p">,</span> <span class="n">d_model</span><span class="p">))</span>
        
        <span class="c1"># íŠ¸ëœìŠ¤í¬ë¨¸ ì¸ì½”ë”
</span>        <span class="n">encoder_layer</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">TransformerEncoderLayer</span><span class="p">(</span>
            <span class="n">d_model</span><span class="o">=</span><span class="n">d_model</span><span class="p">,</span> 
            <span class="n">nhead</span><span class="o">=</span><span class="n">n_heads</span><span class="p">,</span> 
            <span class="n">dim_feedforward</span><span class="o">=</span><span class="n">d_model</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span>
            <span class="n">dropout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">batch_first</span><span class="o">=</span><span class="bp">True</span>
        <span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">transformer</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">TransformerEncoder</span><span class="p">(</span><span class="n">encoder_layer</span><span class="p">,</span> <span class="n">num_layers</span><span class="o">=</span><span class="n">n_layers</span><span class="p">)</span>
        
        <span class="c1"># ì¶œë ¥ í”„ë¡œì ì…˜
</span>        <span class="n">self</span><span class="p">.</span><span class="n">output_projection</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">d_model</span><span class="p">,</span> <span class="n">pred_len</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">create_patches</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹œê³„ì—´ì„ íŒ¨ì¹˜ë¡œ ë¶„í• </span><span class="sh">"""</span>
        <span class="c1"># x: (batch_size, n_features, seq_len)
</span>        <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        
        <span class="c1"># ê° í”¼ì²˜ë³„ë¡œ íŒ¨ì¹˜ ìƒì„±
</span>        <span class="n">patches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
            <span class="n">feature_patches</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:].</span><span class="nf">unfold</span><span class="p">(</span><span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">patch_len</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">stride</span><span class="p">)</span>
            <span class="n">patches</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">feature_patches</span><span class="p">)</span>
        
        <span class="c1"># (batch_size, n_features, num_patches, patch_len)
</span>        <span class="n">patches</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">stack</span><span class="p">(</span><span class="n">patches</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">patches</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="c1"># x: (batch_size, n_features, seq_len)
</span>        <span class="n">batch_size</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span>
        
        <span class="c1"># íŒ¨ì¹˜ ìƒì„±
</span>        <span class="n">patches</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">create_patches</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  <span class="c1"># (batch_size, n_features, num_patches, patch_len)
</span>        
        <span class="c1"># ê° í”¼ì²˜ë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ ì²˜ë¦¬ (Channel Independence)
</span>        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_features</span><span class="p">):</span>
            <span class="n">feature_patches</span> <span class="o">=</span> <span class="n">patches</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>  <span class="c1"># (batch_size, num_patches, patch_len)
</span>            
            <span class="c1"># ì…ë ¥ í”„ë¡œì ì…˜
</span>            <span class="n">projected</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">input_projection</span><span class="p">(</span><span class="n">feature_patches</span><span class="p">)</span>  <span class="c1"># (batch_size, num_patches, d_model)
</span>            
            <span class="c1"># ìœ„ì¹˜ ì¸ì½”ë”© ì¶”ê°€
</span>            <span class="n">projected</span> <span class="o">=</span> <span class="n">projected</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">pos_encoding</span>
            
            <span class="c1"># íŠ¸ëœìŠ¤í¬ë¨¸ ì¸ì½”ë”
</span>            <span class="n">encoded</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">transformer</span><span class="p">(</span><span class="n">projected</span><span class="p">)</span>  <span class="c1"># (batch_size, num_patches, d_model)
</span>            
            <span class="c1"># ê¸€ë¡œë²Œ í‰ê·  í’€ë§
</span>            <span class="n">pooled</span> <span class="o">=</span> <span class="n">encoded</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (batch_size, d_model)
</span>            
            <span class="c1"># ì¶œë ¥ í”„ë¡œì ì…˜
</span>            <span class="n">output</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">output_projection</span><span class="p">(</span><span class="n">pooled</span><span class="p">)</span>  <span class="c1"># (batch_size, pred_len)
</span>            <span class="n">outputs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        
        <span class="c1"># ëª¨ë“  í”¼ì²˜ì˜ ì¶œë ¥ì„ ê²°í•©
</span>        <span class="n">final_output</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">stack</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (batch_size, n_features, pred_len)
</span>        <span class="k">return</span> <span class="n">final_output</span>

<span class="c1"># ëª¨ë¸ íŒŒë¼ë¯¸í„° ì„¤ì •
</span><span class="n">seq_len</span> <span class="o">=</span> <span class="mi">96</span>      <span class="c1"># ì…ë ¥ ì‹œí€€ìŠ¤ ê¸¸ì´
</span><span class="n">pred_len</span> <span class="o">=</span> <span class="mi">24</span>     <span class="c1"># ì˜ˆì¸¡ ê¸¸ì´
</span><span class="n">patch_len</span> <span class="o">=</span> <span class="mi">16</span>    <span class="c1"># íŒ¨ì¹˜ ê¸¸ì´
</span><span class="n">stride</span> <span class="o">=</span> <span class="mi">8</span>        <span class="c1"># ìŠ¤íŠ¸ë¼ì´ë“œ
</span><span class="n">n_features</span> <span class="o">=</span> <span class="mi">5</span>    <span class="c1"># í”¼ì²˜ ìˆ˜
</span>
<span class="n">model</span> <span class="o">=</span> <span class="nc">PatchTST</span><span class="p">(</span>
    <span class="n">seq_len</span><span class="o">=</span><span class="n">seq_len</span><span class="p">,</span>
    <span class="n">pred_len</span><span class="o">=</span><span class="n">pred_len</span><span class="p">,</span>
    <span class="n">patch_len</span><span class="o">=</span><span class="n">patch_len</span><span class="p">,</span>
    <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="n">n_features</span>
<span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ëª¨ë¸ íŒŒë¼ë¯¸í„° ìˆ˜: </span><span class="si">{</span><span class="nf">sum</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="nf">numel</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="p">.</span><span class="nf">parameters</span><span class="p">())</span><span class="si">:</span><span class="p">,</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="3-ë°ì´í„°-ì „ì²˜ë¦¬-ë°-í•™ìŠµ">3. ë°ì´í„° ì „ì²˜ë¦¬ ë° í•™ìŠµ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">prepare_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">pred_len</span><span class="p">,</span> <span class="n">train_ratio</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">val_ratio</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ë°ì´í„°ë¥¼ í•™ìŠµìš©ìœ¼ë¡œ ì¤€ë¹„</span><span class="sh">"""</span>
    <span class="c1"># ì •ê·œí™”
</span>    <span class="n">scaler</span> <span class="o">=</span> <span class="nc">StandardScaler</span><span class="p">()</span>
    <span class="n">scaled_data</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    
    <span class="c1"># ì‹œí€€ìŠ¤ ìƒì„±
</span>    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">)</span> <span class="o">-</span> <span class="n">seq_len</span> <span class="o">-</span> <span class="n">pred_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">X</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">seq_len</span><span class="p">])</span>
        <span class="n">y</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">scaled_data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">seq_len</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">seq_len</span><span class="o">+</span><span class="n">pred_len</span><span class="p">])</span>
    
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    
    <span class="c1"># í•™ìŠµ/ê²€ì¦/í…ŒìŠ¤íŠ¸ ë¶„í• 
</span>    <span class="n">n_train</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="n">train_ratio</span><span class="p">)</span>
    <span class="n">n_val</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">*</span> <span class="n">val_ratio</span><span class="p">)</span>
    
    <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="n">n_train</span><span class="p">],</span> <span class="n">y</span><span class="p">[:</span><span class="n">n_train</span><span class="p">]</span>
    <span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">n_train</span><span class="p">:</span><span class="n">n_train</span><span class="o">+</span><span class="n">n_val</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">n_train</span><span class="p">:</span><span class="n">n_train</span><span class="o">+</span><span class="n">n_val</span><span class="p">]</span>
    <span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">n_train</span><span class="o">+</span><span class="n">n_val</span><span class="p">:],</span> <span class="n">y</span><span class="p">[</span><span class="n">n_train</span><span class="o">+</span><span class="n">n_val</span><span class="p">:]</span>
    
    <span class="nf">return </span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">scaler</span>

<span class="c1"># ë°ì´í„° ì¤€ë¹„
</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span> <span class="n">scaler</span> <span class="o">=</span> <span class="nf">prepare_data</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">pred_len</span>
<span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í•™ìŠµ ë°ì´í„°: </span><span class="si">{</span><span class="n">X_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">y_train</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ê²€ì¦ ë°ì´í„°: </span><span class="si">{</span><span class="n">X_val</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">y_val</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í…ŒìŠ¤íŠ¸ ë°ì´í„°: </span><span class="si">{</span><span class="n">X_test</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="s">, </span><span class="si">{</span><span class="n">y_test</span><span class="p">.</span><span class="n">shape</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># DataLoader ìƒì„±
</span><span class="k">def</span> <span class="nf">create_dataloader</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">X_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nc">FloatTensor</span><span class="p">(</span><span class="n">X</span><span class="p">).</span><span class="nf">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># (batch, features, seq_len)
</span>    <span class="n">y_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nc">FloatTensor</span><span class="p">(</span><span class="n">y</span><span class="p">).</span><span class="nf">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># (batch, features, pred_len)
</span>    <span class="n">dataset</span> <span class="o">=</span> <span class="nc">TensorDataset</span><span class="p">(</span><span class="n">X_tensor</span><span class="p">,</span> <span class="n">y_tensor</span><span class="p">)</span>
    <span class="k">return</span> <span class="nc">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="n">shuffle</span><span class="p">)</span>

<span class="n">train_loader</span> <span class="o">=</span> <span class="nf">create_dataloader</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">)</span>
<span class="n">val_loader</span> <span class="o">=</span> <span class="nf">create_dataloader</span><span class="p">(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="4-ëª¨ë¸-í•™ìŠµ">4. ëª¨ë¸ í•™ìŠµ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ëª¨ë¸ í•™ìŠµ</span><span class="sh">"""</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">device</span><span class="p">(</span><span class="sh">'</span><span class="s">cuda</span><span class="sh">'</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="sh">'</span><span class="s">cpu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
    
    <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">MSELoss</span><span class="p">()</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="nc">Adam</span><span class="p">(</span><span class="n">model</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="n">lr_scheduler</span><span class="p">.</span><span class="nc">ReduceLROnPlateau</span><span class="p">(</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">patience</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">factor</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    
    <span class="n">train_losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">val_losses</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
        <span class="c1"># í•™ìŠµ
</span>        <span class="n">model</span><span class="p">.</span><span class="nf">train</span><span class="p">()</span>
        <span class="n">train_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
            <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">batch_X</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">batch_y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            
            <span class="n">optimizer</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">batch_X</span><span class="p">)</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span>
            <span class="n">loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
            <span class="n">optimizer</span><span class="p">.</span><span class="nf">step</span><span class="p">()</span>
            
            <span class="n">train_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span>
        
        <span class="c1"># ê²€ì¦
</span>        <span class="n">model</span><span class="p">.</span><span class="nf">eval</span><span class="p">()</span>
        <span class="n">val_loss</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="ow">in</span> <span class="n">val_loader</span><span class="p">:</span>
                <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">batch_X</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">batch_y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
                <span class="n">outputs</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">batch_X</span><span class="p">)</span>
                <span class="n">loss</span> <span class="o">=</span> <span class="nf">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span>
                <span class="n">val_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span>
        
        <span class="n">train_loss</span> <span class="o">/=</span> <span class="nf">len</span><span class="p">(</span><span class="n">train_loader</span><span class="p">)</span>
        <span class="n">val_loss</span> <span class="o">/=</span> <span class="nf">len</span><span class="p">(</span><span class="n">val_loader</span><span class="p">)</span>
        
        <span class="n">train_losses</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">train_loss</span><span class="p">)</span>
        <span class="n">val_losses</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
        
        <span class="n">scheduler</span><span class="p">.</span><span class="nf">step</span><span class="p">(</span><span class="n">val_loss</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">epoch</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="si">:</span><span class="mi">3</span><span class="n">d</span><span class="si">}</span><span class="s">: Train Loss = </span><span class="si">{</span><span class="n">train_loss</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="s">, Val Loss = </span><span class="si">{</span><span class="n">val_loss</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">train_losses</span><span class="p">,</span> <span class="n">val_losses</span>

<span class="c1"># ëª¨ë¸ í•™ìŠµ
</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ëª¨ë¸ í•™ìŠµ ì‹œì‘...</span><span class="sh">"</span><span class="p">)</span>
<span class="n">train_losses</span><span class="p">,</span> <span class="n">val_losses</span> <span class="o">=</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">í•™ìŠµ ì™„ë£Œ!</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="5-ê²°ê³¼-ì‹œê°í™”">5. ê²°ê³¼ ì‹œê°í™”</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">scaler</span><span class="p">,</span> <span class="n">n_samples</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ê²°ê³¼ ì‹œê°í™”</span><span class="sh">"""</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">device</span><span class="p">(</span><span class="sh">'</span><span class="s">cuda</span><span class="sh">'</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="sh">'</span><span class="s">cpu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">eval</span><span class="p">()</span>
    
    <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span><span class="p">)</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">test_loader</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n_samples</span><span class="p">:</span>
                <span class="k">break</span>
                
            <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">batch_X</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">batch_y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">batch_X</span><span class="p">)</span>
            
            <span class="c1"># ì²« ë²ˆì§¸ ìƒ˜í”Œë§Œ ì‹œê°í™”
</span>            <span class="n">X_sample</span> <span class="o">=</span> <span class="n">batch_X</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">().</span><span class="n">T</span>  <span class="c1"># (seq_len, n_features)
</span>            <span class="n">y_true</span> <span class="o">=</span> <span class="n">batch_y</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">().</span><span class="n">T</span>    <span class="c1"># (pred_len, n_features)
</span>            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">().</span><span class="n">T</span> <span class="c1"># (pred_len, n_features)
</span>            
            <span class="c1"># ì—­ì •ê·œí™”
</span>            <span class="n">X_sample</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">X_sample</span><span class="p">)</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">y_true</span><span class="p">)</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">y_pred</span><span class="p">)</span>
            
            <span class="c1"># ì‹œê°í™”
</span>            <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="p">.</span><span class="nf">flatten</span><span class="p">()</span>
            
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                
                <span class="c1"># ê³¼ê±° ë°ì´í„°
</span>                <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="nf">range</span><span class="p">(</span><span class="n">seq_len</span><span class="p">),</span> <span class="n">X_sample</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ê³¼ê±°</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                
                <span class="c1"># ì‹¤ì œ ë¯¸ë˜
</span>                <span class="n">future_x</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="n">seq_len</span><span class="p">,</span> <span class="n">seq_len</span> <span class="o">+</span> <span class="n">pred_len</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">future_x</span><span class="p">,</span> <span class="n">y_true</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="sh">'</span><span class="s">g-</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì‹¤ì œ</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                
                <span class="c1"># ì˜ˆì¸¡
</span>                <span class="n">ax</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">future_x</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="sh">'</span><span class="s">r--</span><span class="sh">'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">ì˜ˆì¸¡</span><span class="sh">'</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
                
                <span class="n">ax</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Stock </span><span class="si">{</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
                <span class="n">ax</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
                <span class="n">ax</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
            
            <span class="c1"># ë§ˆì§€ë§‰ subplot ìˆ¨ê¸°ê¸°
</span>            <span class="k">if</span> <span class="n">n_features</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">:</span>
                <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_visible</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            
            <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
            <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

<span class="c1"># ê²°ê³¼ ì‹œê°í™”
</span><span class="n">test_loader</span> <span class="o">=</span> <span class="nf">create_dataloader</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="nf">plot_results</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)</span>

<span class="c1"># í•™ìŠµ ê³¡ì„  ì‹œê°í™”
</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">train_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Train Loss</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">val_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Validation Loss</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">í•™ìŠµ ê³¡ì„ </span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Epoch</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Loss</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">train_losses</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Train Loss (Last 20)</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">blue</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">val_losses</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">:],</span> <span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Validation Loss (Last 20)</span><span class="sh">'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">red</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="sh">'</span><span class="s">ìµœê·¼ í•™ìŠµ ê³¡ì„ </span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Epoch</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="sh">'</span><span class="s">Loss</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">grid</span><span class="p">(</span><span class="bp">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="6-ì„±ëŠ¥-í‰ê°€">6. ì„±ëŠ¥ í‰ê°€</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">scaler</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ëª¨ë¸ ì„±ëŠ¥ í‰ê°€</span><span class="sh">"""</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">device</span><span class="p">(</span><span class="sh">'</span><span class="s">cuda</span><span class="sh">'</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="sh">'</span><span class="s">cpu</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">model</span><span class="p">.</span><span class="nf">eval</span><span class="p">()</span>
    
    <span class="n">all_predictions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">all_targets</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="ow">in</span> <span class="n">test_loader</span><span class="p">:</span>
            <span class="n">batch_X</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">batch_X</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">),</span> <span class="n">batch_y</span><span class="p">.</span><span class="nf">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="nf">model</span><span class="p">(</span><span class="n">batch_X</span><span class="p">)</span>
            
            <span class="n">all_predictions</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">predictions</span><span class="p">.</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">())</span>
            <span class="n">all_targets</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">batch_y</span><span class="p">.</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">())</span>
    
    <span class="c1"># ì˜ˆì¸¡ê³¼ íƒ€ê²Ÿ ê²°í•©
</span>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(</span><span class="n">all_predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">concatenate</span><span class="p">(</span><span class="n">all_targets</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># ì—­ì •ê·œí™”
</span>    <span class="n">predictions</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">predictions</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">scaler</span><span class="p">.</span><span class="nf">inverse_transform</span><span class="p">(</span><span class="n">targets</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nf">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_features</span><span class="p">))</span>
    
    <span class="c1"># MSE, MAE ê³„ì‚°
</span>    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">((</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">targets</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">mean</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">targets</span><span class="p">))</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í…ŒìŠ¤íŠ¸ ì„±ëŠ¥:</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">MAE: </span><span class="si">{</span><span class="n">mae</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">RMSE: </span><span class="si">{</span><span class="n">rmse</span><span class="si">:</span><span class="p">.</span><span class="mi">6</span><span class="n">f</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">mse</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span>

<span class="c1"># ì„±ëŠ¥ í‰ê°€
</span><span class="n">mse</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">rmse</span> <span class="o">=</span> <span class="nf">evaluate_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_loader</span><span class="p">,</span> <span class="n">scaler</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="-ëª¨ë¸-ë¹„êµ-ë°-ì„ íƒ-ê°€ì´ë“œ">ğŸ“Š ëª¨ë¸ ë¹„êµ ë° ì„ íƒ ê°€ì´ë“œ</h2>

<h3 id="ì„±ëŠ¥-ë¹„êµ">ì„±ëŠ¥ ë¹„êµ</h3>

<table>
  <thead>
    <tr>
      <th>ëª¨ë¸</th>
      <th>ì¥ì </th>
      <th>ë‹¨ì </th>
      <th>ì ìš© ë¶„ì•¼</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Informer</strong></td>
      <td>ê¸´ ì‹œí€€ìŠ¤ íš¨ìœ¨ì , ê°•ë ¥í•œ ì„±ëŠ¥</td>
      <td>ë³µì¡í•œ êµ¬ì¡°, ê¸´ í•™ìŠµ ì‹œê°„</td>
      <td>ì¥ê¸° ì˜ˆì¸¡, ëŒ€ìš©ëŸ‰ ë°ì´í„°</td>
    </tr>
    <tr>
      <td><strong>Autoformer</strong></td>
      <td>ì£¼ê¸°ì„± ìë™ í•™ìŠµ, í•´ì„ ê°€ëŠ¥</td>
      <td>ì£¼ê¸°ì„± ì—†ëŠ” ë°ì´í„° ì œí•œ</td>
      <td>ê³„ì ˆì„± ë°ì´í„°, ë¹„ì¦ˆë‹ˆìŠ¤ ë¶„ì„</td>
    </tr>
    <tr>
      <td><strong>FEDformer</strong></td>
      <td>ì£¼íŒŒìˆ˜ ë„ë©”ì¸ ì²˜ë¦¬, ì•™ìƒë¸”</td>
      <td>FFT ê³„ì‚° ë¹„ìš©</td>
      <td>ì‹ í˜¸ ì²˜ë¦¬, ì£¼ê¸°ì„± ë°ì´í„°</td>
    </tr>
    <tr>
      <td><strong>PatchTST</strong></td>
      <td>ë‹¨ìˆœí•˜ê³  íš¨ìœ¨ì , ë¹ ë¥¸ í•™ìŠµ</td>
      <td>íŒ¨ì¹˜ í¬ê¸° ë¯¼ê°</td>
      <td>ì‹¤ì‹œê°„ ì˜ˆì¸¡, ë‹¤ë³€ëŸ‰ ì‹œê³„ì—´</td>
    </tr>
  </tbody>
</table>

<h3 id="ëª¨ë¸-ì„ íƒ-ê°€ì´ë“œ">ëª¨ë¸ ì„ íƒ ê°€ì´ë“œ</h3>

<p><strong>1. ë°ì´í„° íŠ¹ì„±ì— ë”°ë¥¸ ì„ íƒ:</strong></p>
<ul>
  <li><strong>ì£¼ê¸°ì„±ì´ ê°•í•œ ë°ì´í„°</strong>: Autoformer, FEDformer</li>
  <li><strong>ê¸´ ì‹œí€€ìŠ¤ ë°ì´í„°</strong>: Informer, PatchTST</li>
  <li><strong>ë‹¤ë³€ëŸ‰ ì‹œê³„ì—´</strong>: PatchTST, Informer</li>
  <li><strong>ì‹¤ì‹œê°„ ì˜ˆì¸¡</strong>: PatchTST</li>
</ul>

<p><strong>2. ë¦¬ì†ŒìŠ¤ ì œì•½ì— ë”°ë¥¸ ì„ íƒ:</strong></p>
<ul>
  <li><strong>ì œí•œëœ ê³„ì‚° ìì›</strong>: PatchTST</li>
  <li><strong>ì¶©ë¶„í•œ ìì›</strong>: Informer, FEDformer</li>
  <li><strong>ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘</strong>: PatchTST</li>
</ul>

<h2 id="-ë‹¤ìŒ-ë‹¨ê³„">ğŸ¯ ë‹¤ìŒ ë‹¨ê³„</h2>

<p>ì´ë²ˆ íŒŒíŠ¸ì—ì„œëŠ” íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ ëª¨ë¸ë“¤ì„ ì‚´í´ë³´ì•˜ìŠµë‹ˆë‹¤. ë‹¤ìŒ íŒŒíŠ¸ì—ì„œëŠ”:</p>

<ul>
  <li><strong>Part 4</strong>: ìµœì‹  ìƒì„±í˜• AI ëª¨ë¸ë“¤ (TimeGPT, Lag-Llama, Moirai, Chronos)</li>
  <li><strong>Part 5</strong>: ì‹¤ë¬´ ì ìš©ê³¼ MLOps (ëª¨ë¸ ë°°í¬, ëª¨ë‹ˆí„°ë§, A/B í…ŒìŠ¤íŠ¸)</li>
</ul>

<h2 id="-í•µì‹¬-í¬ì¸íŠ¸">ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸</h2>

<ol>
  <li><strong>íŠ¸ëœìŠ¤í¬ë¨¸ì˜ ì¥ì </strong>: ë³‘ë ¬ ì²˜ë¦¬, ì¥ê±°ë¦¬ ì˜ì¡´ì„± í•™ìŠµ, í™•ì¥ì„±</li>
  <li><strong>ëª¨ë¸ë³„ íŠ¹ì„±</strong>: ê° ëª¨ë¸ë§ˆë‹¤ ê³ ìœ í•œ ê°•ì ê³¼ ì ìš© ë¶„ì•¼ê°€ ìˆìŒ</li>
  <li><strong>ì‹¤ë¬´ ê³ ë ¤ì‚¬í•­</strong>: ë°ì´í„° íŠ¹ì„±, ë¦¬ì†ŒìŠ¤ ì œì•½, ì„±ëŠ¥ ìš”êµ¬ì‚¬í•­ì„ ì¢…í•©ì ìœ¼ë¡œ ê³ ë ¤</li>
  <li><strong>ì‹¤ìŠµì˜ ì¤‘ìš”ì„±</strong>: ì´ë¡ ê³¼ ì½”ë“œë¥¼ í•¨ê»˜ í•™ìŠµí•˜ì—¬ ì‹¤ì œ ì ìš© ëŠ¥ë ¥ í–¥ìƒ</li>
</ol>

<p>íŠ¸ëœìŠ¤í¬ë¨¸ ê¸°ë°˜ ëª¨ë¸ë“¤ì€ ì‹œê³„ì—´ ì˜ˆì¸¡ì˜ ìƒˆë¡œìš´ íŒ¨ëŸ¬ë‹¤ì„ì„ ì œì‹œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë‹¤ìŒ íŒŒíŠ¸ì—ì„œ ë”ìš± í¥ë¯¸ë¡œìš´ ìµœì‹  ëª¨ë¸ë“¤ì„ ë§Œë‚˜ë³´ì„¸ìš”!</p>

<hr />

<h2 id="-ì‹œë¦¬ì¦ˆ-ë„¤ë¹„ê²Œì´ì…˜">ğŸ”— ì‹œë¦¬ì¦ˆ ë„¤ë¹„ê²Œì´ì…˜</h2>

<p><strong>â† ì´ì „</strong>: <a href="/data-ai/2025/09/01/time-series-deep-learning.html">Part 2: ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ - N-BEATSì™€ DeepAR</a></p>

<p><strong>ë‹¤ìŒ â†’</strong>: <a href="/data-ai/2025/09/07/time-series-llm-models.html">Part 4: ìµœì‹  ìƒì„±í˜• AI ëª¨ë¸ë“¤ - TimeGPT, Lag-Llama, Moirai, Chronos</a></p>

<hr />

<p><strong>ë‹¤ìŒ íŒŒíŠ¸ ë¯¸ë¦¬ë³´ê¸°</strong>: Part 4ì—ì„œëŠ” TimeGPT, Lag-Llama ë“± ìµœì‹  ìƒì„±í˜• AI ëª¨ë¸ë“¤ì´ ì‹œê³„ì—´ ì˜ˆì¸¡ì— ì–´ë–»ê²Œ í™œìš©ë˜ëŠ”ì§€ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ğŸš€</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
      
        
      
        
          
          
      
      
        
        
        <a href="/data-ai/2025/09/01/time-series-deep-learning.html" class="nav-link prev">
          â† ì´ì „: Part 2: ë”¥ëŸ¬ë‹ ê¸°ë°˜ ì‹œê³„ì—´ ì˜ˆì¸¡ - N-BEATSì™€ DeepAR
        </a>
      
      
      
        
        
        <a href="/data-ai/2025/09/07/time-series-llm-models.html" class="nav-link next">
          ë‹¤ìŒ: Part 4: ìµœì‹  ìƒì„±í˜• AI ëª¨ë¸ë“¤ - TimeGPT, Lag-Llama, Moirai, Chronos â†’
        </a>
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-ai/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

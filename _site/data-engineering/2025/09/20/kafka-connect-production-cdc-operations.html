<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜, ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ, ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜ ì „ëµ, ì„±ëŠ¥ ìµœì í™”ì™€ ì¥ì•  ë³µêµ¬ê¹Œì§€ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">



<title>Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜ - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜ - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸">
<meta property="og:description" content="Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜, ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ, ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜ ì „ëµ, ì„±ëŠ¥ ìµœì í™”ì™€ ì¥ì•  ë³µêµ¬ê¹Œì§€ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">
<meta property="og:url" content="https://data-droid.github.io/data-engineering/2025/09/20/kafka-connect-production-cdc-operations.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜ - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸">
<meta name="twitter:description" content="Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜, ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ, ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜ ì „ëµ, ì„±ëŠ¥ ìµœì í™”ì™€ ì¥ì•  ë³µêµ¬ê¹Œì§€ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-engineering/2025/09/20/kafka-connect-production-cdc-operations.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-20-kafka-connect-production-cdc-operations.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 20ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜ - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">Kafka-Connect</span>
      
        <span class="tag">CDC-ìš´ì˜</span>
      
        <span class="tag">ì»¤ìŠ¤í…€ì»¤ë„¥í„°</span>
      
        <span class="tag">ì„±ëŠ¥ìµœì í™”</span>
      
        <span class="tag">ëª¨ë‹ˆí„°ë§</span>
      
        <span class="tag">ì¥ì• ë³µêµ¬</span>
      
        <span class="tag">ì—”í„°í”„ë¼ì´ì¦ˆ</span>
      
        <span class="tag">í”„ë¡œë•ì…˜</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Change data capture complete guide ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 3</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 55ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ê³ ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-2-kafka-connectì™€-í”„ë¡œë•ì…˜-cdc-ìš´ì˜---ì—”í„°í”„ë¼ì´ì¦ˆê¸‰-ì‹¤ì‹œê°„-ë°ì´í„°-íŒŒì´í”„ë¼ì¸">Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜ - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸</h1>

<blockquote>
  <p>Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜, ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ, ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜ ì „ëµ, ì„±ëŠ¥ ìµœì í™”ì™€ ì¥ì•  ë³µêµ¬ê¹Œì§€ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#kafka-connect-ê³ ê¸‰-ì•„í‚¤í…ì²˜">Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜</a></li>
  <li><a href="#ì»¤ìŠ¤í…€-ì»¤ë„¥í„°-ê°œë°œ">ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ</a></li>
  <li><a href="#ëŒ€ê·œëª¨-cdc-íŒŒì´í”„ë¼ì¸-ìš´ì˜">ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜</a></li>
  <li><a href="#ì„±ëŠ¥-ìµœì í™”ì™€-ë³‘ëª©-í•´ê²°">ì„±ëŠ¥ ìµœì í™”ì™€ ë³‘ëª© í•´ê²°</a></li>
  <li><a href="#ë°ì´í„°-ì¼ê´€ì„±-ë³´ì¥ê³¼-ê²€ì¦">ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ê³¼ ê²€ì¦</a></li>
  <li><a href="#ëª¨ë‹ˆí„°ë§ê³¼-ì¥ì• -ë³µêµ¬-ì „ëµ">ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµ</a></li>
  <li><a href="#ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì—”í„°í”„ë¼ì´ì¦ˆ-cdc-ìš´ì˜-ì‹œìŠ¤í…œ">ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì—”í„°í”„ë¼ì´ì¦ˆ CDC ìš´ì˜ ì‹œìŠ¤í…œ</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<h2 id="kafka-connect-ê³ ê¸‰-ì•„í‚¤í…ì²˜">ğŸ— ï¸ Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜</h2>

<h3 id="kafka-connect-ì•„í‚¤í…ì²˜-ì‹¬í™”">Kafka Connect ì•„í‚¤í…ì²˜ ì‹¬í™”</h3>

<p>Kafka ConnectëŠ” ë¶„ì‚° ìŠ¤íŠ¸ë¦¬ë° í”Œë«í¼ìœ¼ë¡œ, ë°ì´í„°ë² ì´ìŠ¤ì™€ ì‹œìŠ¤í…œ ê°„ì˜ ë°ì´í„° ë™ê¸°í™”ë¥¼ ìœ„í•œ í™•ì¥ ê°€ëŠ¥í•œ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.</p>

<h3 id="í•µì‹¬-ì»´í¬ë„ŒíŠ¸-ìƒì„¸-ë¶„ì„">í•µì‹¬ ì»´í¬ë„ŒíŠ¸ ìƒì„¸ ë¶„ì„</h3>

<table>
  <thead>
    <tr>
      <th>ì»´í¬ë„ŒíŠ¸</th>
      <th>ì—­í• </th>
      <th>í™•ì¥ì„± ê³ ë ¤ì‚¬í•­</th>
      <th>ìš´ì˜ í¬ì¸íŠ¸</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Connect Workers</strong></td>
      <td>ì»¤ë„¥í„° ì‹¤í–‰ í™˜ê²½</td>
      <td>â€¢ ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥<br />â€¢ CPU/ë©”ëª¨ë¦¬ ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§</td>
      <td>â€¢ ë¦¬ì†ŒìŠ¤ ëª¨ë‹ˆí„°ë§<br />â€¢ ì¥ì•  ë³µêµ¬ ìë™í™”</td>
    </tr>
    <tr>
      <td><strong>Connectors</strong></td>
      <td>ë°ì´í„° ì†ŒìŠ¤/ì‹±í¬ ë¡œì§</td>
      <td>â€¢ í”ŒëŸ¬ê·¸ì¸ ì•„í‚¤í…ì²˜<br />â€¢ ë…ë¦½ì  ë°°í¬</td>
      <td>â€¢ ë²„ì „ ê´€ë¦¬<br />â€¢ í˜¸í™˜ì„± í…ŒìŠ¤íŠ¸</td>
    </tr>
    <tr>
      <td><strong>Tasks</strong></td>
      <td>ì‹¤ì œ ë°ì´í„° ì²˜ë¦¬</td>
      <td>â€¢ íŒŒí‹°ì…˜ ê¸°ë°˜ ë³‘ë ¬í™”<br />â€¢ ë™ì  íƒœìŠ¤í¬ í• ë‹¹</td>
      <td>â€¢ ë¶€í•˜ ë¶„ì‚°<br />â€¢ ì¥ì•  ê²©ë¦¬</td>
    </tr>
    <tr>
      <td><strong>Transforms</strong></td>
      <td>ë°ì´í„° ë³€í™˜ ë¡œì§</td>
      <td>â€¢ ì²´ì¸ ê°€ëŠ¥í•œ ë³€í™˜<br />â€¢ ì»¤ìŠ¤í…€ SMT ì§€ì›</td>
      <td>â€¢ ì„±ëŠ¥ ìµœì í™”<br />â€¢ ë©”ëª¨ë¦¬ ê´€ë¦¬</td>
    </tr>
  </tbody>
</table>

<h3 id="í´ëŸ¬ìŠ¤í„°-êµ¬ì„±-ì „ëµ">í´ëŸ¬ìŠ¤í„° êµ¬ì„± ì „ëµ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">KafkaConnectClusterManager</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cluster_config</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">design_cluster_architecture</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">requirements</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëŒ€ê·œëª¨ CDC ìš”êµ¬ì‚¬í•­ì— ë§ëŠ” í´ëŸ¬ìŠ¤í„° ì•„í‚¤í…ì²˜ ì„¤ê³„</span><span class="sh">"""</span>
        
        <span class="n">architecture</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">cluster_size</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">workers</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_worker_count</span><span class="p">(</span><span class="n">requirements</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">:</span> <span class="n">requirements</span><span class="p">[</span><span class="sh">"</span><span class="s">estimated_connectors</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">tasks_per_connector</span><span class="sh">"</span><span class="p">:</span> <span class="n">requirements</span><span class="p">[</span><span class="sh">"</span><span class="s">max_concurrency</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">resource_allocation</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">worker_specs</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4 cores</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8GB</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">heap</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4GB</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">disk</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">100GB SSD</span><span class="sh">"</span>
                <span class="p">},</span>
                <span class="sh">"</span><span class="s">jvm_settings</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">Xmx</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">Xms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">GC_algorithm</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">G1GC</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">GC_tuning</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">-XX:+UseG1GC -XX:MaxGCPauseMillis=200</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">network_topology</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">worker_distribution</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">multi_zone</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">replication_strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rack_aware</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">load_balancing</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">round_robin</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">architecture</span>
    
    <span class="k">def</span> <span class="nf">_calculate_worker_count</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">requirements</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì›Œì»¤ ìˆ˜ ê³„ì‚°</span><span class="sh">"""</span>
        
        <span class="c1"># ê¸°ë³¸ ê³„ì‚° ê³µì‹
</span>        <span class="n">base_workers</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">requirements</span><span class="p">[</span><span class="sh">"</span><span class="s">estimated_connectors</span><span class="sh">"</span><span class="p">]</span> <span class="o">//</span> <span class="mi">10</span><span class="p">)</span>
        
        <span class="c1"># ê³ ê°€ìš©ì„±ì„ ìœ„í•œ ìµœì†Œ ì›Œì»¤ ìˆ˜
</span>        <span class="n">ha_workers</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">base_workers</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        
        <span class="c1"># ë¶€í•˜ ë¶„ì‚°ì„ ìœ„í•œ ì—¬ìœ ë¶„
</span>        <span class="n">buffer_workers</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">ha_workers</span> <span class="o">*</span> <span class="mf">0.3</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">ha_workers</span> <span class="o">+</span> <span class="n">buffer_workers</span>
    
    <span class="k">def</span> <span class="nf">configure_distributed_mode</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cluster_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì‚° ëª¨ë“œ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">distributed_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">bootstrap.servers</span><span class="sh">"</span><span class="p">:</span> <span class="n">cluster_config</span><span class="p">[</span><span class="sh">"</span><span class="s">kafka_bootstrap_servers</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">group.id</span><span class="sh">"</span><span class="p">:</span> <span class="n">cluster_config</span><span class="p">[</span><span class="sh">"</span><span class="s">connect_cluster_id</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">key.converter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.json.JsonConverter</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">value.converter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.json.JsonConverter</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">key.converter.schemas.enable</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">value.converter.schemas.enable</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">offset.storage.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">cluster_config</span><span class="p">[</span><span class="sh">'</span><span class="s">connect_cluster_id</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">-offsets</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">offset.storage.replication.factor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">offset.storage.partitions</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">25</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config.storage.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">cluster_config</span><span class="p">[</span><span class="sh">'</span><span class="s">connect_cluster_id</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">-configs</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config.storage.replication.factor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">status.storage.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">cluster_config</span><span class="p">[</span><span class="sh">'</span><span class="s">connect_cluster_id</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">-status</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">status.storage.replication.factor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">status.storage.partitions</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">5</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">rest.host.name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.0.0.0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">rest.port</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8083</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">plugin.path</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">/opt/connectors</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">connector.client.config.override.policy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">All</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">producer.security.protocol</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">SASL_SSL</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">consumer.security.protocol</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">SASL_SSL</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">distributed_config</span>
</code></pre></div></div>

<h3 id="ê³ ê°€ìš©ì„±ê³¼-ì¥ì• -ë³µêµ¬">ê³ ê°€ìš©ì„±ê³¼ ì¥ì•  ë³µêµ¬</h3>

<table>
  <thead>
    <tr>
      <th>ì¥ì•  ì‹œë‚˜ë¦¬ì˜¤</th>
      <th>ë³µêµ¬ ì „ëµ</th>
      <th>ìë™í™” ìˆ˜ì¤€</th>
      <th>ë³µêµ¬ ì‹œê°„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Worker ë…¸ë“œ ì¥ì• </strong></td>
      <td>â€¢ ìë™ íƒœìŠ¤í¬ ì¬ë°°ì¹˜<br />â€¢ í—¬ìŠ¤ì²´í¬ ê¸°ë°˜ ê°ì§€</td>
      <td>ì™„ì „ ìë™</td>
      <td>30-60ì´ˆ</td>
    </tr>
    <tr>
      <td><strong>Connector ì¥ì• </strong></td>
      <td>â€¢ ë°±ì˜¤í”„ ì¬ì‹œë„<br />â€¢ ì¥ì•  ê²©ë¦¬</td>
      <td>ìë™</td>
      <td>1-5ë¶„</td>
    </tr>
    <tr>
      <td><strong>Kafka ë¸Œë¡œì»¤ ì¥ì• </strong></td>
      <td>â€¢ ë¦¬ë” ì„ ì¶œ<br />â€¢ íŒŒí‹°ì…˜ ì¬í• ë‹¹</td>
      <td>ì™„ì „ ìë™</td>
      <td>10-30ì´ˆ</td>
    </tr>
    <tr>
      <td><strong>ë„¤íŠ¸ì›Œí¬ ë¶„í• </strong></td>
      <td>â€¢ ì¿ ëŸ¼ ê¸°ë°˜ í•©ì˜<br />â€¢ ì¥ì•  ë³µêµ¬</td>
      <td>ìë™</td>
      <td>1-2ë¶„</td>
    </tr>
  </tbody>
</table>

<h2 id="ì»¤ìŠ¤í…€-ì»¤ë„¥í„°-ê°œë°œ">ğŸ”§ ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ</h2>

<h3 id="ì»¤ìŠ¤í…€-ì»¤ë„¥í„°-ì•„í‚¤í…ì²˜">ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ì•„í‚¤í…ì²˜</h3>

<p>ì»¤ìŠ¤í…€ ì»¤ë„¥í„°ëŠ” íŠ¹ì • ë°ì´í„° ì†ŒìŠ¤ë‚˜ ì‹±í¬ì— ìµœì í™”ëœ ì „ìš© ì»¤ë„¥í„°ë¥¼ ê°œë°œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>

<h3 id="source-connector-ê°œë°œ">Source Connector ê°œë°œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CustomSourceConnector</span><span class="p">(</span><span class="n">SourceConnector</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì»¤ìŠ¤í…€ ì†ŒìŠ¤ ì»¤ë„¥í„° ì˜ˆì œ</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">version</span> <span class="o">=</span> <span class="sh">"</span><span class="s">1.0.0</span><span class="sh">"</span>
    
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">props</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ì‹œì‘</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">database.name</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database.name</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">custom</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">table.whitelist</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">table.whitelist</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í…ŒìŠ¤íŠ¸
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">_validate_connection</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">task_configs</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">maxTasks</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒœìŠ¤í¬ ì„¤ì • ìƒì„±</span><span class="sh">"""</span>
        
        <span class="c1"># í…Œì´ë¸”ì„ íƒœìŠ¤í¬ ìˆ˜ì— ë”°ë¼ ë¶„í• 
</span>        <span class="n">tables</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">table.whitelist</span><span class="sh">"</span><span class="p">]</span>
        <span class="n">tasks_config</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">maxTasks</span><span class="p">):</span>
            <span class="n">task_config</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
            <span class="n">task_config</span><span class="p">[</span><span class="sh">"</span><span class="s">task.id</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            
            <span class="c1"># í…Œì´ë¸” ë¶„í•  ë¡œì§
</span>            <span class="k">if</span> <span class="n">tables</span><span class="p">:</span>
                <span class="n">start_idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="nf">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span> <span class="o">//</span> <span class="n">maxTasks</span>
                <span class="n">end_idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="nf">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span> <span class="o">//</span> <span class="n">maxTasks</span>
                <span class="n">task_config</span><span class="p">[</span><span class="sh">"</span><span class="s">table.whitelist</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="n">start_idx</span><span class="p">:</span><span class="n">end_idx</span><span class="p">]</span>
            
            <span class="n">tasks_config</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">task_config</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">tasks_config</span>
    
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ì¤‘ì§€</span><span class="sh">"""</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì„¤ì • ìŠ¤í‚¤ë§ˆ ì •ì˜</span><span class="sh">"""</span>
        
        <span class="k">return</span> <span class="nc">ConfigDef</span><span class="p">()</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ í˜¸ìŠ¤íŠ¸ëª…</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">INT</span><span class="p">,</span> <span class="mi">3306</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ í¬íŠ¸</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ìš©ìëª…</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">PASSWORD</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ë¹„ë°€ë²ˆí˜¸</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">database.name</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">INT</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">MEDIUM</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°°ì¹˜ í¬ê¸°</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">INT</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">MEDIUM</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">í´ë§ ê°„ê²© (ë°€ë¦¬ì´ˆ)</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="sh">"</span><span class="s">custom</span><span class="sh">"</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">í† í”½ ì ‘ë‘ì‚¬</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">table.whitelist</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">í…Œì´ë¸” í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ (ì‰¼í‘œ êµ¬ë¶„)</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_validate_connection</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ê²€ì¦</span><span class="sh">"""</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ì‹¤ì œ ì—°ê²° ê²€ì¦ ë¡œì§
</span>            <span class="n">connection</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_create_connection</span><span class="p">()</span>
            <span class="n">connection</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ê²€ì¦ ì„±ê³µ</span><span class="sh">"</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ConnectException</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ì‹¤íŒ¨: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_create_connection</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° ìƒì„±</span><span class="sh">"""</span>
        <span class="c1"># ì‹¤ì œ ì—°ê²° ìƒì„± ë¡œì§
</span>        <span class="k">pass</span>


<span class="k">class</span> <span class="nc">CustomSourceTask</span><span class="p">(</span><span class="n">SourceTask</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì»¤ìŠ¤í…€ ì†ŒìŠ¤ íƒœìŠ¤í¬</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">last_offset</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">props</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒœìŠ¤í¬ ì‹œì‘</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">props</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_create_connection</span><span class="p">()</span>
        
        <span class="c1"># ì˜¤í”„ì…‹ ë³µì›
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">_restore_offset</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">poll</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°ì´í„° í´ë§</span><span class="sh">"""</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ë°°ì¹˜ í¬ê¸°ë§Œí¼ ë°ì´í„° ì¡°íšŒ
</span>            <span class="n">records</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_fetch_records</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">records</span><span class="p">:</span>
                <span class="c1"># ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ì§§ì€ ëŒ€ê¸°
</span>                <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">[]</span>
            
            <span class="c1"># SourceRecordë¡œ ë³€í™˜
</span>            <span class="n">source_records</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
                <span class="n">source_record</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_convert_to_source_record</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
                <span class="n">source_records</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">source_record</span><span class="p">)</span>
                
                <span class="c1"># ì˜¤í”„ì…‹ ì—…ë°ì´íŠ¸
</span>                <span class="n">self</span><span class="p">.</span><span class="nf">_update_offset</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">source_records</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ë°ì´í„° í´ë§ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">raise</span>
    
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒœìŠ¤í¬ ì¤‘ì§€</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">connection</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">connection</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_fetch_records</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹¤ì œ ë°ì´í„° ì¡°íšŒ</span><span class="sh">"""</span>
        
        <span class="c1"># ë°°ì¹˜ í¬ê¸°
</span>        <span class="n">batch_size</span> <span class="o">=</span> <span class="nf">int</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
        
        <span class="c1"># í…Œì´ë¸” ëª©ë¡
</span>        <span class="n">tables</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">table.whitelist</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">).</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">tables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">table</span><span class="p">.</span><span class="nf">strip</span><span class="p">():</span>
                <span class="n">table_records</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_fetch_table_records</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="nf">strip</span><span class="p">(),</span> <span class="n">batch_size</span><span class="p">)</span>
                <span class="n">records</span><span class="p">.</span><span class="nf">extend</span><span class="p">(</span><span class="n">table_records</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">records</span>
    
    <span class="k">def</span> <span class="nf">_convert_to_source_record</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë ˆì½”ë“œë¥¼ SourceRecordë¡œ ë³€í™˜</span><span class="sh">"""</span>
        
        <span class="n">topic</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">topic.prefix</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">.</span><span class="si">{</span><span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">table</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>
        
        <span class="c1"># ìŠ¤í‚¤ë§ˆ ì •ì˜
</span>        <span class="n">key_schema</span> <span class="o">=</span> <span class="n">SchemaBuilder</span><span class="p">.</span><span class="nf">struct</span><span class="p">()</span> \
            <span class="p">.</span><span class="nf">field</span><span class="p">(</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">,</span> <span class="n">Schema</span><span class="p">.</span><span class="n">INT64_SCHEMA</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">build</span><span class="p">()</span>
        
        <span class="n">value_schema</span> <span class="o">=</span> <span class="n">SchemaBuilder</span><span class="p">.</span><span class="nf">struct</span><span class="p">()</span> \
            <span class="p">.</span><span class="nf">field</span><span class="p">(</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">,</span> <span class="n">Schema</span><span class="p">.</span><span class="n">INT64_SCHEMA</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">field</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">,</span> <span class="n">Schema</span><span class="p">.</span><span class="n">STRING_SCHEMA</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">field</span><span class="p">(</span><span class="sh">"</span><span class="s">created_at</span><span class="sh">"</span><span class="p">,</span> <span class="n">Schema</span><span class="p">.</span><span class="n">STRING_SCHEMA</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">build</span><span class="p">()</span>
        
        <span class="c1"># í‚¤ì™€ ê°’ ìƒì„±
</span>        <span class="n">key</span> <span class="o">=</span> <span class="nc">Struct</span><span class="p">(</span><span class="n">key_schema</span><span class="p">).</span><span class="nf">put</span><span class="p">(</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">,</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">])</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nc">Struct</span><span class="p">(</span><span class="n">value_schema</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">,</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">])</span> \
            <span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">,</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">])</span> \
            <span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="sh">"</span><span class="s">created_at</span><span class="sh">"</span><span class="p">,</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">created_at</span><span class="sh">"</span><span class="p">])</span>
        
        <span class="c1"># ì˜¤í”„ì…‹ ì •ë³´
</span>        <span class="n">offset</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">table</span><span class="sh">"</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">table</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="nc">SourceRecord</span><span class="p">(</span>
            <span class="n">partition</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
            <span class="n">offset</span><span class="o">=</span><span class="n">offset</span><span class="p">,</span>
            <span class="n">topic</span><span class="o">=</span><span class="n">topic</span><span class="p">,</span>
            <span class="n">key_schema</span><span class="o">=</span><span class="n">key_schema</span><span class="p">,</span>
            <span class="n">key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
            <span class="n">value_schema</span><span class="o">=</span><span class="n">value_schema</span><span class="p">,</span>
            <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">]</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_update_offset</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì˜¤í”„ì…‹ ì—…ë°ì´íŠ¸</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">last_offset</span><span class="p">[</span><span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">table</span><span class="sh">"</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">]</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_restore_offset</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì˜¤í”„ì…‹ ë³µì›</span><span class="sh">"""</span>
        
        <span class="c1"># Kafka Connectì—ì„œ ìë™ìœ¼ë¡œ ì˜¤í”„ì…‹ ê´€ë¦¬
</span>        <span class="k">pass</span>
</code></pre></div></div>

<h3 id="sink-connector-ê°œë°œ">Sink Connector ê°œë°œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CustomSinkConnector</span><span class="p">(</span><span class="n">SinkConnector</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì»¤ìŠ¤í…€ ì‹±í¬ ì»¤ë„¥í„°</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">props</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ì‹œì‘</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">target.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">target.hostname</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">target.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">target.port</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">target.database</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">target.database</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">target.username</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">target.username</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">target.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">target.password</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">flush.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">flush.timeout.ms</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">5000</span><span class="sh">"</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">auto.create</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">auto.create</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">delete.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="n">props</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">delete.enabled</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">task_configs</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">maxTasks</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒœìŠ¤í¬ ì„¤ì • ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">tasks_config</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">maxTasks</span><span class="p">):</span>
            <span class="n">task_config</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
            <span class="n">task_config</span><span class="p">[</span><span class="sh">"</span><span class="s">task.id</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="nf">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">tasks_config</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">task_config</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">tasks_config</span>
    
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ì¤‘ì§€</span><span class="sh">"""</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì„¤ì • ìŠ¤í‚¤ë§ˆ</span><span class="sh">"""</span>
        
        <span class="k">return</span> <span class="nc">ConfigDef</span><span class="p">()</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">target.hostname</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ëŒ€ìƒ ì‹œìŠ¤í…œ í˜¸ìŠ¤íŠ¸ëª…</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">target.port</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">INT</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ëŒ€ìƒ ì‹œìŠ¤í…œ í¬íŠ¸</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">target.database</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ëŒ€ìƒ ë°ì´í„°ë² ì´ìŠ¤</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">target.username</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">STRING</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ëŒ€ìƒ ì‹œìŠ¤í…œ ì‚¬ìš©ìëª…</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">target.password</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">PASSWORD</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">HIGH</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ëŒ€ìƒ ì‹œìŠ¤í…œ ë¹„ë°€ë²ˆí˜¸</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">INT</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">MEDIUM</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ë°°ì¹˜ í¬ê¸°</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">flush.timeout.ms</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">INT</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">MEDIUM</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">í”ŒëŸ¬ì‹œ íƒ€ì„ì•„ì›ƒ</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">auto.create</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">BOOLEAN</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">LOW</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ìë™ í…Œì´ë¸” ìƒì„±</span><span class="sh">"</span><span class="p">)</span> \
            <span class="p">.</span><span class="nf">define</span><span class="p">(</span><span class="sh">"</span><span class="s">delete.enabled</span><span class="sh">"</span><span class="p">,</span> <span class="n">Type</span><span class="p">.</span><span class="n">BOOLEAN</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="n">ConfigDef</span><span class="p">.</span><span class="n">Importance</span><span class="p">.</span><span class="n">MEDIUM</span><span class="p">,</span>
                   <span class="sh">"</span><span class="s">ì‚­ì œ ì‘ì—… í™œì„±í™”</span><span class="sh">"</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">CustomSinkTask</span><span class="p">(</span><span class="n">SinkTask</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì»¤ìŠ¤í…€ ì‹±í¬ íƒœìŠ¤í¬</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">self</span><span class="p">.</span><span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">last_flush_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">props</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒœìŠ¤í¬ ì‹œì‘</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">props</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_create_connection</span><span class="p">()</span>
        
        <span class="c1"># í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ ìºì‹œ ì´ˆê¸°í™”
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">_initialize_table_schemas</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">put</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë ˆì½”ë“œ ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">batch</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            
            <span class="c1"># ë°°ì¹˜ í¬ê¸° ë˜ëŠ” íƒ€ì„ì•„ì›ƒì— ë„ë‹¬í•˜ë©´ í”ŒëŸ¬ì‹œ
</span>            <span class="nf">if </span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">batch</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nf">int</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">])</span> <span class="ow">or</span>
                <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">last_flush_time</span> <span class="o">&gt;</span> <span class="nf">int</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">flush.timeout.ms</span><span class="sh">"</span><span class="p">])</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">):</span>
                <span class="n">self</span><span class="p">.</span><span class="nf">_flush_batch</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">flush</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">offsets</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìˆ˜ë™ í”ŒëŸ¬ì‹œ</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">_flush_batch</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒœìŠ¤í¬ ì¤‘ì§€</span><span class="sh">"""</span>
        
        <span class="c1"># ë‚¨ì€ ë°°ì¹˜ ì²˜ë¦¬
</span>        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">batch</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">_flush_batch</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">connection</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">connection</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_flush_batch</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°°ì¹˜ í”ŒëŸ¬ì‹œ</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">batch</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ë°°ì¹˜ë¥¼ í…Œì´ë¸”ë³„ë¡œ ê·¸ë£¹í™”
</span>            <span class="n">grouped_records</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_group_by_table</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">batch</span><span class="p">)</span>
            
            <span class="c1"># ê° í…Œì´ë¸”ë³„ë¡œ ì²˜ë¦¬
</span>            <span class="k">for</span> <span class="n">table</span><span class="p">,</span> <span class="n">records</span> <span class="ow">in</span> <span class="n">grouped_records</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
                <span class="n">self</span><span class="p">.</span><span class="nf">_process_table_batch</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">records</span><span class="p">)</span>
            
            <span class="c1"># ë°°ì¹˜ ì´ˆê¸°í™”
</span>            <span class="n">self</span><span class="p">.</span><span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">self</span><span class="p">.</span><span class="n">last_flush_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ë°°ì¹˜ í”ŒëŸ¬ì‹œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">raise</span>
    
    <span class="k">def</span> <span class="nf">_process_table_batch</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í…Œì´ë¸”ë³„ ë°°ì¹˜ ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="c1"># INSERT, UPDATE, DELETEë¡œ ë¶„ë¥˜
</span>        <span class="n">inserts</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">]</span>
        <span class="n">deletes</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">]</span>
        
        <span class="c1"># INSERT/UPDATE ì²˜ë¦¬
</span>        <span class="k">if</span> <span class="n">inserts</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">_upsert_records</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">inserts</span><span class="p">)</span>
        
        <span class="c1"># DELETE ì²˜ë¦¬
</span>        <span class="k">if</span> <span class="n">deletes</span> <span class="ow">and</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">delete.enabled</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">_delete_records</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">deletes</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_upsert_records</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë ˆì½”ë“œ ì—…ì„œíŠ¸</span><span class="sh">"""</span>
        
        <span class="c1"># ì‹¤ì œ ì—…ì„œíŠ¸ ë¡œì§ êµ¬í˜„
</span>        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">_delete_records</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">records</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë ˆì½”ë“œ ì‚­ì œ</span><span class="sh">"""</span>
        
        <span class="c1"># ì‹¤ì œ ì‚­ì œ ë¡œì§ êµ¬í˜„
</span>        <span class="k">pass</span>
</code></pre></div></div>

<h3 id="ì»¤ìŠ¤í…€-transform-ê°œë°œ">ì»¤ìŠ¤í…€ Transform ê°œë°œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CustomTransform</span><span class="p">(</span><span class="n">Transform</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì»¤ìŠ¤í…€ Single Message Transform</span><span class="sh">"""</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">configure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">configs</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì„¤ì • êµ¬ì„±</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">field.mapping</span><span class="sh">"</span><span class="p">:</span> <span class="n">configs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">field.mapping</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">data.type</span><span class="sh">"</span><span class="p">:</span> <span class="n">configs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">data.type</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">json</span><span class="sh">"</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">validation.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="n">configs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">validation.enabled</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">).</span><span class="nf">lower</span><span class="p">()</span> <span class="o">==</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="c1"># í•„ë“œ ë§¤í•‘ íŒŒì‹±
</span>        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">field.mapping</span><span class="sh">"</span><span class="p">]:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">field_mapping</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_parse_field_mapping</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">field.mapping</span><span class="sh">"</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">field_mapping</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">record</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë ˆì½”ë“œ ë³€í™˜ ì ìš©</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">record</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ê°’ ì¶”ì¶œ
</span>            <span class="n">value</span> <span class="o">=</span> <span class="n">record</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">record</span>
            
            <span class="c1"># ë°ì´í„° íƒ€ì…ë³„ ì²˜ë¦¬
</span>            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">data.type</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">json</span><span class="sh">"</span><span class="p">:</span>
                <span class="n">transformed_value</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_transform_json</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">data.type</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">avro</span><span class="sh">"</span><span class="p">:</span>
                <span class="n">transformed_value</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_transform_avro</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">transformed_value</span> <span class="o">=</span> <span class="n">value</span>
            
            <span class="c1"># ê²€ì¦
</span>            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">config</span><span class="p">[</span><span class="sh">"</span><span class="s">validation.enabled</span><span class="sh">"</span><span class="p">]:</span>
                <span class="n">self</span><span class="p">.</span><span class="nf">_validate_record</span><span class="p">(</span><span class="n">transformed_value</span><span class="p">)</span>
            
            <span class="c1"># ìƒˆ ë ˆì½”ë“œ ìƒì„±
</span>            <span class="k">return</span> <span class="n">record</span><span class="p">.</span><span class="nf">new_record</span><span class="p">(</span>
                <span class="n">topic</span><span class="o">=</span><span class="n">record</span><span class="p">.</span><span class="nf">topic</span><span class="p">(),</span>
                <span class="n">partition</span><span class="o">=</span><span class="n">record</span><span class="p">.</span><span class="nf">kafkaPartition</span><span class="p">(),</span>
                <span class="n">key_schema</span><span class="o">=</span><span class="n">record</span><span class="p">.</span><span class="nf">keySchema</span><span class="p">(),</span>
                <span class="n">key</span><span class="o">=</span><span class="n">record</span><span class="p">.</span><span class="nf">key</span><span class="p">(),</span>
                <span class="n">value_schema</span><span class="o">=</span><span class="n">record</span><span class="p">.</span><span class="nf">valueSchema</span><span class="p">(),</span>
                <span class="n">value</span><span class="o">=</span><span class="n">transformed_value</span><span class="p">,</span>
                <span class="n">timestamp</span><span class="o">=</span><span class="n">record</span><span class="p">.</span><span class="nf">timestamp</span><span class="p">()</span>
            <span class="p">)</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">log</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ë ˆì½”ë“œ ë³€í™˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">record</span>  <span class="c1"># ì›ë³¸ ë ˆì½”ë“œ ë°˜í™˜
</span>    
    <span class="k">def</span> <span class="nf">_transform_json</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">JSON ë°ì´í„° ë³€í™˜</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">transformed</span> <span class="o">=</span> <span class="n">value</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span>
            
            <span class="c1"># í•„ë“œ ë§¤í•‘ ì ìš©
</span>            <span class="k">for</span> <span class="n">old_field</span><span class="p">,</span> <span class="n">new_field</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">field_mapping</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">old_field</span> <span class="ow">in</span> <span class="n">transformed</span><span class="p">:</span>
                    <span class="n">transformed</span><span class="p">[</span><span class="n">new_field</span><span class="p">]</span> <span class="o">=</span> <span class="n">transformed</span><span class="p">.</span><span class="nf">pop</span><span class="p">(</span><span class="n">old_field</span><span class="p">)</span>
            
            <span class="c1"># ì¶”ê°€ ë³€í™˜ ë¡œì§
</span>            <span class="n">transformed</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_apply_business_rules</span><span class="p">(</span><span class="n">transformed</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="n">transformed</span>
        
        <span class="k">return</span> <span class="n">value</span>
    
    <span class="k">def</span> <span class="nf">_transform_avro</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Avro ë°ì´í„° ë³€í™˜</span><span class="sh">"""</span>
        
        <span class="c1"># Avro ìŠ¤í‚¤ë§ˆ ë³€í™˜ ë¡œì§
</span>        <span class="k">return</span> <span class="n">value</span>
    
    <span class="k">def</span> <span class="nf">_apply_business_rules</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ì ìš©</span><span class="sh">"""</span>
        
        <span class="c1"># ì˜ˆ: íƒ€ì„ìŠ¤íƒ¬í”„ í¬ë§· ë³€í™˜
</span>        <span class="k">if</span> <span class="sh">"</span><span class="s">created_at</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">created_at</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_format_timestamp</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">created_at</span><span class="sh">"</span><span class="p">])</span>
        
        <span class="c1"># ì˜ˆ: ë°ì´í„° ì •ê·œí™”
</span>        <span class="k">if</span> <span class="sh">"</span><span class="s">email</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">email</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sh">"</span><span class="s">email</span><span class="sh">"</span><span class="p">].</span><span class="nf">lower</span><span class="p">().</span><span class="nf">strip</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">data</span>
    
    <span class="k">def</span> <span class="nf">_validate_record</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë ˆì½”ë“œ ê²€ì¦</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nf">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span>
        
        <span class="c1"># í•„ìˆ˜ í•„ë“œ ê²€ì¦
</span>        <span class="n">required_fields</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">id</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">required_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í•„ìˆ˜ í•„ë“œ </span><span class="sh">'</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="sh">'</span><span class="s">ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_parse_field_mapping</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">mapping_str</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í•„ë“œ ë§¤í•‘ íŒŒì‹±</span><span class="sh">"""</span>
        
        <span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">mapping_str</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">):</span>
            <span class="k">if</span> <span class="sh">"</span><span class="s">:</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">pair</span><span class="p">:</span>
                <span class="n">old_field</span><span class="p">,</span> <span class="n">new_field</span> <span class="o">=</span> <span class="n">pair</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">"</span><span class="s">:</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">mapping</span><span class="p">[</span><span class="n">old_field</span><span class="p">.</span><span class="nf">strip</span><span class="p">()]</span> <span class="o">=</span> <span class="n">new_field</span><span class="p">.</span><span class="nf">strip</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">mapping</span>
    
    <span class="k">def</span> <span class="nf">_format_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒ€ì„ìŠ¤íƒ¬í”„ í¬ë§·íŒ…</span><span class="sh">"""</span>
        
        <span class="c1"># ì‹¤ì œ í¬ë§·íŒ… ë¡œì§
</span>        <span class="k">return</span> <span class="n">timestamp</span>
</code></pre></div></div>

<h2 id="ëŒ€ê·œëª¨-cdc-íŒŒì´í”„ë¼ì¸-ìš´ì˜">ğŸš€ ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜</h2>

<h3 id="íŒŒì´í”„ë¼ì¸-ì•„í‚¤í…ì²˜-ì„¤ê³„">íŒŒì´í”„ë¼ì¸ ì•„í‚¤í…ì²˜ ì„¤ê³„</h3>

<p>ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ì€ ìˆ˜ë°± ê°œì˜ í…Œì´ë¸”ê³¼ ìˆ˜ì‹­ ê°œì˜ ì‹œìŠ¤í…œì„ ë™ì‹œì— ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<h3 id="íŒŒì´í”„ë¼ì¸-êµ¬ì„±-ìš”ì†Œ">íŒŒì´í”„ë¼ì¸ êµ¬ì„± ìš”ì†Œ</h3>

<table>
  <thead>
    <tr>
      <th>êµ¬ì„± ìš”ì†Œ</th>
      <th>ì—­í• </th>
      <th>í™•ì¥ì„± ì „ëµ</th>
      <th>ëª¨ë‹ˆí„°ë§ í¬ì¸íŠ¸</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Source Connectors</strong></td>
      <td>ë°ì´í„° ì†ŒìŠ¤ì—ì„œ ë³€ê²½ì‚¬í•­ ìº¡ì²˜</td>
      <td>â€¢ í…Œì´ë¸”ë³„ ì»¤ë„¥í„° ë¶„ë¦¬<br />â€¢ íŒŒí‹°ì…˜ ê¸°ë°˜ ë³‘ë ¬í™”</td>
      <td>â€¢ ì§€ì—°ì‹œê°„<br />â€¢ ì²˜ë¦¬ëŸ‰<br />â€¢ ì˜¤ë¥˜ìœ¨</td>
    </tr>
    <tr>
      <td><strong>Transform Layer</strong></td>
      <td>ë°ì´í„° ë³€í™˜ ë° ì •ì œ</td>
      <td>â€¢ ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜ ë³€í™˜<br />â€¢ ë³‘ë ¬ ì²˜ë¦¬</td>
      <td>â€¢ ë³€í™˜ ì§€ì—°ì‹œê°„<br />â€¢ ë°ì´í„° í’ˆì§ˆ</td>
    </tr>
    <tr>
      <td><strong>Sink Connectors</strong></td>
      <td>ëŒ€ìƒ ì‹œìŠ¤í…œìœ¼ë¡œ ë°ì´í„° ì „ì†¡</td>
      <td>â€¢ ëŒ€ìƒë³„ ì»¤ë„¥í„° ë¶„ë¦¬<br />â€¢ ë°°ì¹˜ ìµœì í™”</td>
      <td>â€¢ ì „ì†¡ ì§€ì—°ì‹œê°„<br />â€¢ ì„±ê³µë¥ </td>
    </tr>
    <tr>
      <td><strong>Schema Registry</strong></td>
      <td>ìŠ¤í‚¤ë§ˆ ê´€ë¦¬ ë° í˜¸í™˜ì„±</td>
      <td>â€¢ ë¶„ì‚° ìºì‹±<br />â€¢ ë²„ì „ ê´€ë¦¬</td>
      <td>â€¢ ìŠ¤í‚¤ë§ˆ ë³€ê²½<br />â€¢ í˜¸í™˜ì„± ê²€ì‚¬</td>
    </tr>
  </tbody>
</table>

<h3 id="íŒŒì´í”„ë¼ì¸-ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜">íŒŒì´í”„ë¼ì¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CDCPipelineOrchestrator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">pipeline_configs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span> <span class="o">=</span> <span class="nc">ConnectorManager</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">monitoring_system</span> <span class="o">=</span> <span class="nc">MonitoringSystem</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">deploy_large_scale_pipeline</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">pipeline_spec</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ë°°í¬</span><span class="sh">"""</span>
        
        <span class="n">deployment_plan</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">phase_1</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_deploy_source_connectors</span><span class="p">(</span><span class="n">pipeline_spec</span><span class="p">[</span><span class="sh">"</span><span class="s">sources</span><span class="sh">"</span><span class="p">]),</span>
            <span class="sh">"</span><span class="s">phase_2</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_configure_transformations</span><span class="p">(</span><span class="n">pipeline_spec</span><span class="p">[</span><span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">]),</span>
            <span class="sh">"</span><span class="s">phase_3</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_deploy_sink_connectors</span><span class="p">(</span><span class="n">pipeline_spec</span><span class="p">[</span><span class="sh">"</span><span class="s">sinks</span><span class="sh">"</span><span class="p">]),</span>
            <span class="sh">"</span><span class="s">phase_4</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_setup_monitoring</span><span class="p">(</span><span class="n">pipeline_spec</span><span class="p">[</span><span class="sh">"</span><span class="s">monitoring</span><span class="sh">"</span><span class="p">])</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">deployment_plan</span>
    
    <span class="k">def</span> <span class="nf">_deploy_source_connectors</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sources</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì†ŒìŠ¤ ì»¤ë„¥í„° ë°°í¬</span><span class="sh">"""</span>
        
        <span class="n">source_deployment</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
            <span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ë³„ ì»¤ë„¥í„° ì„¤ì •
</span>            <span class="n">connector_config</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">source-</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">database</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">-</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">schema</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_connector_class</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">tasks_max</span><span class="sh">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">hostname</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">port</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">username</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.server.id</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">server_id</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">database</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">.</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">schema</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">table.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">tables</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">unwrap,route,addTimestamp</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transforms.unwrap.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.transforms.ExtractNewRecordState</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transforms.route.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.RegexRouter</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transforms.route.regex</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">database</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="se">\\</span><span class="s">.</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">schema</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="se">\\</span><span class="s">.([^.]+)</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transforms.route.replacement</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">source</span><span class="p">[</span><span class="sh">'</span><span class="s">database</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">.$1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">batch_size</span><span class="sh">"</span><span class="p">,</span> <span class="mi">4096</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">poll_interval</span><span class="sh">"</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="c1"># ì»¤ë„¥í„° ë°°í¬
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span><span class="p">.</span><span class="nf">deploy_connector</span><span class="p">(</span><span class="n">connector_config</span><span class="p">)</span>
            <span class="n">source_deployment</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">connector_name</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_config</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">tables</span><span class="sh">"</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="sh">"</span><span class="s">tables</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">source_deployment</span>
    
    <span class="k">def</span> <span class="nf">_configure_transformations</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">transforms</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë³€í™˜ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">transform_configs</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">transform</span> <span class="ow">in</span> <span class="n">transforms</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">transform-</span><span class="si">{</span><span class="n">transform</span><span class="p">[</span><span class="sh">'</span><span class="s">name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">transform</span><span class="p">[</span><span class="sh">"</span><span class="s">steps</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">topics</span><span class="sh">"</span><span class="p">:</span> <span class="n">transform</span><span class="p">[</span><span class="sh">"</span><span class="s">input_topics</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">output_topic</span><span class="sh">"</span><span class="p">:</span> <span class="n">transform</span><span class="p">[</span><span class="sh">"</span><span class="s">output_topic</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">}</span>
            
            <span class="c1"># ê° ë³€í™˜ ë‹¨ê³„ë³„ ì„¤ì •
</span>            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">step</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">transform</span><span class="p">[</span><span class="sh">"</span><span class="s">steps</span><span class="sh">"</span><span class="p">]):</span>
                <span class="n">step_config</span> <span class="o">=</span> <span class="n">transform</span><span class="p">[</span><span class="sh">"</span><span class="s">step_configs</span><span class="sh">"</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                    <span class="sa">f</span><span class="sh">"</span><span class="s">transforms.</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s">.type</span><span class="sh">"</span><span class="p">:</span> <span class="n">step_config</span><span class="p">[</span><span class="sh">"</span><span class="s">class</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sa">f</span><span class="sh">"</span><span class="s">transforms.</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s">.field.mapping</span><span class="sh">"</span><span class="p">:</span> <span class="n">step_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">field_mapping</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">),</span>
                    <span class="sa">f</span><span class="sh">"</span><span class="s">transforms.</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s">.validation.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="n">step_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">validation</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">)</span>
                <span class="p">})</span>
            
            <span class="n">transform_configs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">transform_configs</span>
    
    <span class="k">def</span> <span class="nf">_deploy_sink_connectors</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">sinks</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹±í¬ ì»¤ë„¥í„° ë°°í¬</span><span class="sh">"""</span>
        
        <span class="n">sink_deployment</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">sink</span> <span class="ow">in</span> <span class="n">sinks</span><span class="p">:</span>
            <span class="n">sink_config</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">sink-</span><span class="si">{</span><span class="n">sink</span><span class="p">[</span><span class="sh">'</span><span class="s">target</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s">-</span><span class="si">{</span><span class="n">sink</span><span class="p">[</span><span class="sh">'</span><span class="s">database</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_sink_connector_class</span><span class="p">(</span><span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">tasks_max</span><span class="sh">"</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">topics</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">topics</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">batch_size</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">flush.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">flush_timeout</span><span class="sh">"</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
            <span class="p">}</span>
            
            <span class="c1"># ëŒ€ìƒ ì‹œìŠ¤í…œë³„ ì„¤ì • ì¶”ê°€
</span>            <span class="k">if</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">elasticsearch</span><span class="sh">"</span><span class="p">:</span>
                <span class="n">sink_config</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">connection.url</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_url</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">type.name</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">type_name</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">_doc</span><span class="sh">"</span><span class="p">),</span>
                    <span class="sh">"</span><span class="s">key.ignore</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">schema.ignore</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span>
                <span class="p">})</span>
            <span class="k">elif</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">postgresql</span><span class="sh">"</span><span class="p">:</span>
                <span class="n">sink_config</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">connection.url</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_url</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">auto.create</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">delete.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span>
                <span class="p">})</span>
            <span class="k">elif</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">s3</span><span class="sh">"</span><span class="p">:</span>
                <span class="n">sink_config</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">s3.bucket.name</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">bucket</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">s3.region</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">region</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">flush.size</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">flush_size</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10000</span><span class="p">),</span>
                    <span class="sh">"</span><span class="s">format.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.confluent.connect.s3.format.parquet.ParquetFormat</span><span class="sh">"</span>
                <span class="p">})</span>
            
            <span class="c1"># ì»¤ë„¥í„° ë°°í¬
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span><span class="p">.</span><span class="nf">deploy_connector</span><span class="p">(</span><span class="n">sink_config</span><span class="p">)</span>
            <span class="n">sink_deployment</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">connector_name</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink_config</span><span class="p">[</span><span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">target</span><span class="sh">"</span><span class="p">:</span> <span class="n">sink</span><span class="p">[</span><span class="sh">"</span><span class="s">target</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">sink_deployment</span>
    
    <span class="k">def</span> <span class="nf">_setup_monitoring</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">monitoring_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëª¨ë‹ˆí„°ë§ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">monitoring_setup</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">monitoring_system</span><span class="p">.</span><span class="nf">setup_metrics</span><span class="p">(</span><span class="n">monitoring_config</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">alerts</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">monitoring_system</span><span class="p">.</span><span class="nf">setup_alerts</span><span class="p">(</span><span class="n">monitoring_config</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">dashboards</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">monitoring_system</span><span class="p">.</span><span class="nf">setup_dashboards</span><span class="p">(</span><span class="n">monitoring_config</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">monitoring_setup</span>
</code></pre></div></div>

<h3 id="íŒŒì´í”„ë¼ì¸-ìš´ì˜-ì „ëµ">íŒŒì´í”„ë¼ì¸ ìš´ì˜ ì „ëµ</h3>

<table>
  <thead>
    <tr>
      <th>ìš´ì˜ ì˜ì—­</th>
      <th>ì „ëµ</th>
      <th>êµ¬í˜„ ë°©ë²•</th>
      <th>ëª¨ë‹ˆí„°ë§</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë¶€í•˜ ë¶„ì‚°</strong></td>
      <td>â€¢ í…Œì´ë¸”ë³„ íŒŒí‹°ì…˜ ë¶„ì‚°<br />â€¢ ì›Œì»¤ ë…¸ë“œ ê· ë“± ë¶„ë°°</td>
      <td>â€¢ íŒŒí‹°ì…˜ ìˆ˜ ìµœì í™”<br />â€¢ ì›Œì»¤ ìˆ˜ ë™ì  ì¡°ì •</td>
      <td>â€¢ íŒŒí‹°ì…˜ë³„ ì²˜ë¦¬ëŸ‰<br />â€¢ ì›Œì»¤ë³„ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ </td>
    </tr>
    <tr>
      <td><strong>ì¥ì•  ê²©ë¦¬</strong></td>
      <td>â€¢ ì»¤ë„¥í„°ë³„ ë…ë¦½ ì‹¤í–‰<br />â€¢ ì¥ì•  ì „íŒŒ ë°©ì§€</td>
      <td>â€¢ ì„œí‚· ë¸Œë ˆì´ì»¤ íŒ¨í„´<br />â€¢ ë°±ì˜¤í”„ ì¬ì‹œë„</td>
      <td>â€¢ ì¥ì•  ë°œìƒë¥ <br />â€¢ ë³µêµ¬ ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>í™•ì¥ì„±</strong></td>
      <td>â€¢ ìˆ˜í‰ í™•ì¥ ìš°ì„ <br />â€¢ ìë™ ìŠ¤ì¼€ì¼ë§</td>
      <td>â€¢ Kubernetes HPA<br />â€¢ ë©”íŠ¸ë¦­ ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§</td>
      <td>â€¢ ì²˜ë¦¬ ìš©ëŸ‰<br />â€¢ í™•ì¥ ì´ë²¤íŠ¸</td>
    </tr>
    <tr>
      <td><strong>ë°ì´í„° ì¼ê´€ì„±</strong></td>
      <td>â€¢ Exactly-once ì²˜ë¦¬<br />â€¢ ìˆœì„œ ë³´ì¥</td>
      <td>â€¢ íŠ¸ëœì­ì…˜ ê¸°ë°˜ ì²˜ë¦¬<br />â€¢ ì˜¤í”„ì…‹ ê´€ë¦¬</td>
      <td>â€¢ ë°ì´í„° ì¼ê´€ì„± ê²€ì¦<br />â€¢ ì¤‘ë³µ ë°ì´í„° ê°ì§€</td>
    </tr>
  </tbody>
</table>

<h2 id="ì„±ëŠ¥-ìµœì í™”ì™€-ë³‘ëª©-í•´ê²°">âš¡ ì„±ëŠ¥ ìµœì í™”ì™€ ë³‘ëª© í•´ê²°</h2>

<h3 id="ì„±ëŠ¥-ìµœì í™”-ì „ëµ">ì„±ëŠ¥ ìµœì í™” ì „ëµ</h3>

<p>CDC íŒŒì´í”„ë¼ì¸ì˜ ì„±ëŠ¥ì„ ìµœì í™”í•˜ê¸° ìœ„í•œ ì¢…í•©ì ì¸ ì ‘ê·¼ ë°©ë²•ì…ë‹ˆë‹¤.</p>

<h3 id="ë³‘ëª©-ì§€ì -ë¶„ì„">ë³‘ëª© ì§€ì  ë¶„ì„</h3>

<table>
  <thead>
    <tr>
      <th>ë³‘ëª© ì§€ì </th>
      <th>ì›ì¸</th>
      <th>í•´ê²° ë°©ë²•</th>
      <th>ëª¨ë‹ˆí„°ë§ ì§€í‘œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë°ì´í„°ë² ì´ìŠ¤ ì½ê¸°</strong></td>
      <td>â€¢ ì¸ë±ìŠ¤ ë¶€ì¡±<br />â€¢ ë½ ê²½í•©<br />â€¢ ë„¤íŠ¸ì›Œí¬ ì§€ì—°</td>
      <td>â€¢ ì½ê¸° ì „ìš© ë³µì œë³¸ í™œìš©<br />â€¢ ë°°ì¹˜ í¬ê¸° ìµœì í™”<br />â€¢ ì—°ê²° í’€ íŠœë‹</td>
      <td>â€¢ ì½ê¸° ì§€ì—°ì‹œê°„<br />â€¢ ì—°ê²° í’€ ì‚¬ìš©ë¥ <br />â€¢ ì¿¼ë¦¬ ì‹¤í–‰ ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>Kafka ì²˜ë¦¬</strong></td>
      <td>â€¢ íŒŒí‹°ì…˜ ìˆ˜ ë¶€ì¡±<br />â€¢ ë¸Œë¡œì»¤ ë¦¬ì†ŒìŠ¤ ë¶€ì¡±<br />â€¢ ì••ì¶• ì„¤ì •</td>
      <td>â€¢ íŒŒí‹°ì…˜ ìˆ˜ ì¦ê°€<br />â€¢ ë¸Œë¡œì»¤ ìŠ¤ì¼€ì¼ë§<br />â€¢ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ ìµœì í™”</td>
      <td>â€¢ í† í”½ë³„ ì²˜ë¦¬ëŸ‰<br />â€¢ ë¸Œë¡œì»¤ CPU/ë©”ëª¨ë¦¬<br />â€¢ ì••ì¶• ë¹„ìœ¨</td>
    </tr>
    <tr>
      <td><strong>ì»¤ë„¥í„° ì²˜ë¦¬</strong></td>
      <td>â€¢ ë°°ì¹˜ í¬ê¸° ë¶€ì ì ˆ<br />â€¢ ë³€í™˜ ë¡œì§ ë¹„íš¨ìœ¨<br />â€¢ ë©”ëª¨ë¦¬ ë¶€ì¡±</td>
      <td>â€¢ ë°°ì¹˜ í¬ê¸° ë™ì  ì¡°ì •<br />â€¢ ë³€í™˜ ë¡œì§ ìµœì í™”<br />â€¢ JVM íŠœë‹</td>
      <td>â€¢ ì»¤ë„¥í„° ì²˜ë¦¬ëŸ‰<br />â€¢ GC ì‹œê°„<br />â€¢ ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ </td>
    </tr>
    <tr>
      <td><strong>ë„¤íŠ¸ì›Œí¬ ì „ì†¡</strong></td>
      <td>â€¢ ëŒ€ì—­í­ ë¶€ì¡±<br />â€¢ ë„¤íŠ¸ì›Œí¬ ì§€ì—°<br />â€¢ ì••ì¶• íš¨ìœ¨</td>
      <td>â€¢ ë„¤íŠ¸ì›Œí¬ ìµœì í™”<br />â€¢ ì••ì¶• ì„¤ì • ì¡°ì •<br />â€¢ ë°°ì¹˜ ì „ì†¡</td>
      <td>â€¢ ë„¤íŠ¸ì›Œí¬ ì²˜ë¦¬ëŸ‰<br />â€¢ ì§€ì—°ì‹œê°„<br />â€¢ íŒ¨í‚· ì†ì‹¤ë¥ </td>
    </tr>
  </tbody>
</table>

<h3 id="ì„±ëŠ¥-íŠœë‹-êµ¬í˜„">ì„±ëŠ¥ íŠœë‹ êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">PerformanceOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">optimization_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_connector_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">connector_name</span><span class="p">,</span> <span class="n">current_metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ì„±ëŠ¥ ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># ì²˜ë¦¬ëŸ‰ ê¸°ë°˜ ë°°ì¹˜ í¬ê¸° ì¡°ì •
</span>        <span class="k">if</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">throughput</span><span class="sh">"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">batch_size</span><span class="sh">"</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8192</span><span class="p">)</span>
            <span class="n">optimizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">parameter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">current_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">batch_size</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">new_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">batch_size</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì²˜ë¦¬ëŸ‰ í–¥ìƒì„ ìœ„í•œ ë°°ì¹˜ í¬ê¸° ì¦ê°€</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="c1"># ì§€ì—°ì‹œê°„ ê¸°ë°˜ í´ë§ ê°„ê²© ì¡°ì •
</span>        <span class="k">if</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">latency</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
            <span class="n">poll_interval</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">poll_interval</span><span class="sh">"</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
            <span class="n">optimizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">parameter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">current_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">poll_interval</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">new_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">poll_interval</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì§€ì—°ì‹œê°„ ê°ì†Œë¥¼ ìœ„í•œ í´ë§ ê°„ê²© ë‹¨ì¶•</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="c1"># ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ê¸°ë°˜ í í¬ê¸° ì¡°ì •
</span>        <span class="k">if</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">memory_usage</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
            <span class="n">queue_size</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">queue_size</span><span class="sh">"</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1024</span><span class="p">)</span>
            <span class="n">optimizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">parameter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">max.queue.size</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">current_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">queue_size</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">new_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">queue_size</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥  ê°ì†Œë¥¼ ìœ„í•œ í í¬ê¸° ì¶•ì†Œ</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
    
    <span class="k">def</span> <span class="nf">optimize_kafka_cluster</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cluster_metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Kafka í´ëŸ¬ìŠ¤í„° ì„±ëŠ¥ ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="n">kafka_optimizations</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># ë¸Œë¡œì»¤ë³„ CPU ì‚¬ìš©ë¥  í™•ì¸
</span>        <span class="k">for</span> <span class="n">broker_id</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">cluster_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">brokers</span><span class="sh">"</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">cpu_usage</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">:</span>
                <span class="n">kafka_optimizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">broker_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">broker_id</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">CPU ì‚¬ìš©ë¥ ì´ ë†’ìŒ - íŒŒí‹°ì…˜ ì¬ë¶„ë°° ë˜ëŠ” ë¸Œë¡œì»¤ ì¶”ê°€ í•„ìš”</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">current_cpu</span><span class="sh">"</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">cpu_usage</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">recommended_action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">íŒŒí‹°ì…˜ ë¦¬ë°¸ëŸ°ì‹± ë˜ëŠ” ë¸Œë¡œì»¤ ìŠ¤ì¼€ì¼ë§</span><span class="sh">"</span>
                <span class="p">})</span>
            
            <span class="k">if</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">memory_usage</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
                <span class="n">kafka_optimizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">broker_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">broker_id</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ ì´ ë†’ìŒ - JVM í™ í¬ê¸° ì¡°ì • í•„ìš”</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">current_memory</span><span class="sh">"</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">memory_usage</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">recommended_action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">JVM í™ í¬ê¸° ì¦ê°€ ë˜ëŠ” ë¸Œë¡œì»¤ ì¶”ê°€</span><span class="sh">"</span>
                <span class="p">})</span>
        
        <span class="c1"># í† í”½ë³„ ì²˜ë¦¬ëŸ‰ ìµœì í™”
</span>        <span class="k">for</span> <span class="n">topic</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">cluster_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">topics</span><span class="sh">"</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">throughput</span><span class="sh">"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">10000</span><span class="p">:</span>
                <span class="n">kafka_optimizations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">topic</span><span class="sh">"</span><span class="p">:</span> <span class="n">topic</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì²˜ë¦¬ëŸ‰ì´ ë‚®ìŒ - íŒŒí‹°ì…˜ ìˆ˜ ì¦ê°€ í•„ìš”</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">current_partitions</span><span class="sh">"</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">partitions</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">recommended_partitions</span><span class="sh">"</span><span class="p">:</span> <span class="nf">min</span><span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">partitions</span><span class="sh">"</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
                <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">kafka_optimizations</span>
    
    <span class="k">def</span> <span class="nf">generate_performance_report</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">system_metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì„±ëŠ¥ ë¦¬í¬íŠ¸ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">summary</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">overall_health</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_overall_health</span><span class="p">(</span><span class="n">system_metrics</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">total_throughput</span><span class="sh">"</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="sh">"</span><span class="s">throughput</span><span class="sh">"</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">system_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">average_latency</span><span class="sh">"</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="sh">"</span><span class="s">latency</span><span class="sh">"</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">system_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">])</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">system_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">error_rate</span><span class="sh">"</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="sh">"</span><span class="s">error_rate</span><span class="sh">"</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">system_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">])</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">system_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">])</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">bottlenecks</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_identify_bottlenecks</span><span class="p">(</span><span class="n">system_metrics</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">recommendations</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_recommendations</span><span class="p">(</span><span class="n">system_metrics</span><span class="p">),</span>
            <span class="sh">"</span><span class="s">optimization_plan</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_create_optimization_plan</span><span class="p">(</span><span class="n">system_metrics</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">report</span>
    
    <span class="k">def</span> <span class="nf">_calculate_overall_health</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì „ì²´ ì‹œìŠ¤í…œ ê±´ê°•ë„ ê³„ì‚°</span><span class="sh">"""</span>
        
        <span class="n">health_score</span> <span class="o">=</span> <span class="mi">100</span>
        
        <span class="c1"># ì²˜ë¦¬ëŸ‰ ê¸°ì¤€ ê°ì 
</span>        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">connector</span><span class="p">[</span><span class="sh">"</span><span class="s">throughput</span><span class="sh">"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="p">:</span>
                <span class="n">health_score</span> <span class="o">-=</span> <span class="mi">10</span>
        
        <span class="c1"># ì§€ì—°ì‹œê°„ ê¸°ì¤€ ê°ì 
</span>        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">connector</span><span class="p">[</span><span class="sh">"</span><span class="s">latency</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5000</span><span class="p">:</span>
                <span class="n">health_score</span> <span class="o">-=</span> <span class="mi">15</span>
        
        <span class="c1"># ì˜¤ë¥˜ìœ¨ ê¸°ì¤€ ê°ì 
</span>        <span class="k">for</span> <span class="n">connector</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">connector</span><span class="p">[</span><span class="sh">"</span><span class="s">error_rate</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.01</span><span class="p">:</span>
                <span class="n">health_score</span> <span class="o">-=</span> <span class="mi">20</span>
        
        <span class="k">return</span> <span class="nf">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">health_score</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_identify_bottlenecks</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë³‘ëª© ì§€ì  ì‹ë³„</span><span class="sh">"""</span>
        
        <span class="n">bottlenecks</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ ë³‘ëª©
</span>        <span class="n">db_metrics</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database</span><span class="sh">"</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">if</span> <span class="n">db_metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">connection_pool_usage</span><span class="sh">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.9</span><span class="p">:</span>
            <span class="n">bottlenecks</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">database</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° í’€ ì‚¬ìš©ë¥ ì´ ë†’ìŒ</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">high</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">current_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">db_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">connection_pool_usage</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">})</span>
        
        <span class="c1"># Kafka ë³‘ëª©
</span>        <span class="n">kafka_metrics</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">kafka</span><span class="sh">"</span><span class="p">,</span> <span class="p">{})</span>
        <span class="k">for</span> <span class="n">topic</span><span class="p">,</span> <span class="n">topic_metrics</span> <span class="ow">in</span> <span class="n">kafka_metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">topics</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">topic_metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">consumer_lag</span><span class="sh">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">:</span>
                <span class="n">bottlenecks</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">kafka</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">í† í”½ </span><span class="si">{</span><span class="n">topic</span><span class="si">}</span><span class="s">ì˜ ì»¨ìŠˆë¨¸ ì§€ì—°ì´ ë†’ìŒ</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">medium</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">current_value</span><span class="sh">"</span><span class="p">:</span> <span class="n">topic_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">consumer_lag</span><span class="sh">"</span><span class="p">]</span>
                <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">bottlenecks</span>
</code></pre></div></div>

<h3 id="ìë™-ìŠ¤ì¼€ì¼ë§-êµ¬í˜„">ìë™ ìŠ¤ì¼€ì¼ë§ êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">AutoScaler</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">scaling_configs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">metrics_collector</span> <span class="o">=</span> <span class="nc">MetricsCollector</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_scaling</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scaling_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">auto_scaling_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">min_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">min_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">scale_up_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale_up_threshold</span><span class="sh">"</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">scale_down_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale_down_threshold</span><span class="sh">"</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">scale_up_cooldown</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale_up_cooldown</span><span class="sh">"</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">scale_down_cooldown</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale_down_cooldown</span><span class="sh">"</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">workers</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">min_workers</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">min_workers</span><span class="sh">"</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">max_workers</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_workers</span><span class="sh">"</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">cpu_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">cpu_threshold</span><span class="sh">"</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">memory_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">memory_threshold</span><span class="sh">"</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">auto_scaling_config</span>
    
    <span class="k">def</span> <span class="nf">evaluate_scaling_needs</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">connector_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤ì¼€ì¼ë§ í•„ìš”ì„± í‰ê°€</span><span class="sh">"""</span>
        
        <span class="n">current_metrics</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">metrics_collector</span><span class="p">.</span><span class="nf">get_connector_metrics</span><span class="p">(</span><span class="n">connector_name</span><span class="p">)</span>
        <span class="n">scaling_config</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">scaling_configs</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">connector_name</span><span class="p">,</span> <span class="p">{})</span>
        
        <span class="n">scaling_decision</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">connector</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_name</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">none</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sh">""</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">current_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">recommended_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span>
        <span class="p">}</span>
        
        <span class="c1"># CPU ì‚¬ìš©ë¥  ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§
</span>        <span class="n">cpu_usage</span> <span class="o">=</span> <span class="n">current_metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">cpu_usage</span><span class="sh">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cpu_usage</span> <span class="o">&gt;</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale_up_threshold</span><span class="sh">"</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="n">scaling_decision</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_up</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">CPU ì‚¬ìš©ë¥ ì´ </span><span class="si">{</span><span class="n">cpu_usage</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="o">%</span><span class="si">}</span><span class="s">ë¡œ ë†’ìŒ</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">recommended_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="nf">min</span><span class="p">(</span><span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
                <span class="p">})</span>
        
        <span class="k">elif</span> <span class="n">cpu_usage</span> <span class="o">&lt;</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale_down_threshold</span><span class="sh">"</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">min_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">scaling_decision</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                    <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_down</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">CPU ì‚¬ìš©ë¥ ì´ </span><span class="si">{</span><span class="n">cpu_usage</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="o">%</span><span class="si">}</span><span class="s">ë¡œ ë‚®ìŒ</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">recommended_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">min_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                <span class="p">})</span>
        
        <span class="c1"># ì²˜ë¦¬ëŸ‰ ê¸°ë°˜ ìŠ¤ì¼€ì¼ë§
</span>        <span class="n">throughput</span> <span class="o">=</span> <span class="n">current_metrics</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">throughput</span><span class="sh">"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">throughput</span> <span class="o">&gt;</span> <span class="mi">10000</span> <span class="ow">and</span> <span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
            <span class="n">scaling_decision</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_up</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">reason</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">ì²˜ë¦¬ëŸ‰ì´ </span><span class="si">{</span><span class="n">throughput</span><span class="si">}</span><span class="s">ë¡œ ë†’ìŒ</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">recommended_tasks</span><span class="sh">"</span><span class="p">:</span> <span class="nf">min</span><span class="p">(</span><span class="n">current_metrics</span><span class="p">[</span><span class="sh">"</span><span class="s">task_count</span><span class="sh">"</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scaling_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">scaling_decision</span>
    
    <span class="k">def</span> <span class="nf">execute_scaling</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">scaling_decision</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤ì¼€ì¼ë§ ì‹¤í–‰</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">scaling_decision</span><span class="p">[</span><span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">scale_up</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_scale_up_connector</span><span class="p">(</span>
                <span class="n">scaling_decision</span><span class="p">[</span><span class="sh">"</span><span class="s">connector</span><span class="sh">"</span><span class="p">],</span>
                <span class="n">scaling_decision</span><span class="p">[</span><span class="sh">"</span><span class="s">recommended_tasks</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">scaling_decision</span><span class="p">[</span><span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">]</span> <span class="o">==</span> <span class="sh">"</span><span class="s">scale_down</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">_scale_down_connector</span><span class="p">(</span>
                <span class="n">scaling_decision</span><span class="p">[</span><span class="sh">"</span><span class="s">connector</span><span class="sh">"</span><span class="p">],</span>
                <span class="n">scaling_decision</span><span class="p">[</span><span class="sh">"</span><span class="s">recommended_tasks</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">no_action_needed</span><span class="sh">"</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_scale_up_connector</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">connector_name</span><span class="p">,</span> <span class="n">new_task_count</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ìŠ¤ì¼€ì¼ ì—…</span><span class="sh">"""</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ì»¤ë„¥í„° ì„¤ì • ì—…ë°ì´íŠ¸
</span>            <span class="n">connector_config</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span><span class="p">.</span><span class="nf">get_connector_config</span><span class="p">(</span><span class="n">connector_name</span><span class="p">)</span>
            <span class="n">connector_config</span><span class="p">[</span><span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_task_count</span>
            
            <span class="c1"># ì»¤ë„¥í„° ì¬ì‹œì‘
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span><span class="p">.</span><span class="nf">update_connector</span><span class="p">(</span><span class="n">connector_name</span><span class="p">,</span> <span class="n">connector_config</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_up</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">old_task_count</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">new_task_count</span><span class="sh">"</span><span class="p">:</span> <span class="n">new_task_count</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">ì»¤ë„¥í„° </span><span class="si">{</span><span class="n">connector_name</span><span class="si">}</span><span class="s">ì´ </span><span class="si">{</span><span class="n">new_task_count</span><span class="si">}</span><span class="s">ê°œ íƒœìŠ¤í¬ë¡œ ìŠ¤ì¼€ì¼ ì—…ë¨</span><span class="sh">"</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_up</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">ì»¤ë„¥í„° </span><span class="si">{</span><span class="n">connector_name</span><span class="si">}</span><span class="s"> ìŠ¤ì¼€ì¼ ì—… ì‹¤íŒ¨</span><span class="sh">"</span>
            <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_scale_down_connector</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">connector_name</span><span class="p">,</span> <span class="n">new_task_count</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ë„¥í„° ìŠ¤ì¼€ì¼ ë‹¤ìš´</span><span class="sh">"""</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ì»¤ë„¥í„° ì„¤ì • ì—…ë°ì´íŠ¸
</span>            <span class="n">connector_config</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span><span class="p">.</span><span class="nf">get_connector_config</span><span class="p">(</span><span class="n">connector_name</span><span class="p">)</span>
            <span class="n">connector_config</span><span class="p">[</span><span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_task_count</span>
            
            <span class="c1"># ì»¤ë„¥í„° ì¬ì‹œì‘
</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">connector_manager</span><span class="p">.</span><span class="nf">update_connector</span><span class="p">(</span><span class="n">connector_name</span><span class="p">,</span> <span class="n">connector_config</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_down</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">old_task_count</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">new_task_count</span><span class="sh">"</span><span class="p">:</span> <span class="n">new_task_count</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">ì»¤ë„¥í„° </span><span class="si">{</span><span class="n">connector_name</span><span class="si">}</span><span class="s">ì´ </span><span class="si">{</span><span class="n">new_task_count</span><span class="si">}</span><span class="s">ê°œ íƒœìŠ¤í¬ë¡œ ìŠ¤ì¼€ì¼ ë‹¤ìš´ë¨</span><span class="sh">"</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">scale_down</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">ì»¤ë„¥í„° </span><span class="si">{</span><span class="n">connector_name</span><span class="si">}</span><span class="s"> ìŠ¤ì¼€ì¼ ë‹¤ìš´ ì‹¤íŒ¨</span><span class="sh">"</span>
            <span class="p">}</span>
</code></pre></div></div>

<h2 id="-ë°ì´í„°-ì¼ê´€ì„±-ë³´ì¥ê³¼-ê²€ì¦">ğŸ”’ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ê³¼ ê²€ì¦</h2>

<h3 id="ë°ì´í„°-ì¼ê´€ì„±-ì „ëµ">ë°ì´í„° ì¼ê´€ì„± ì „ëµ</h3>

<p>CDC íŒŒì´í”„ë¼ì¸ì—ì„œ ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ì¥í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.</p>

<h3 id="ì¼ê´€ì„±-ë³´ì¥-ë°©ë²•">ì¼ê´€ì„± ë³´ì¥ ë°©ë²•</h3>

<table>
  <thead>
    <tr>
      <th>ë°©ë²•</th>
      <th>ì„¤ëª…</th>
      <th>êµ¬í˜„ ë³µì¡ë„</th>
      <th>ì„±ëŠ¥ ì˜í–¥</th>
      <th>ì‚¬ìš© ì‚¬ë¡€</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Exactly-once Semantics</strong></td>
      <td>ê° ë©”ì‹œì§€ë¥¼ ì •í™•íˆ í•œ ë²ˆë§Œ ì²˜ë¦¬</td>
      <td>ë†’ìŒ</td>
      <td>ì¤‘ê°„</td>
      <td>ê¸ˆìœµ ê±°ë˜, ì£¼ë¬¸ ì²˜ë¦¬</td>
    </tr>
    <tr>
      <td><strong>At-least-once Semantics</strong></td>
      <td>ë©”ì‹œì§€ë¥¼ ìµœì†Œ í•œ ë²ˆì€ ì²˜ë¦¬</td>
      <td>ë‚®ìŒ</td>
      <td>ë‚®ìŒ</td>
      <td>ë¡œê·¸ ìˆ˜ì§‘, ë©”íŠ¸ë¦­ ìˆ˜ì§‘</td>
    </tr>
    <tr>
      <td><strong>At-most-once Semantics</strong></td>
      <td>ë©”ì‹œì§€ë¥¼ ìµœëŒ€ í•œ ë²ˆë§Œ ì²˜ë¦¬</td>
      <td>ì¤‘ê°„</td>
      <td>ë‚®ìŒ</td>
      <td>ì•Œë¦¼, ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°</td>
    </tr>
    <tr>
      <td><strong>Transactional Processing</strong></td>
      <td>íŠ¸ëœì­ì…˜ ë‹¨ìœ„ë¡œ ì¼ê´€ì„± ë³´ì¥</td>
      <td>ë†’ìŒ</td>
      <td>ë†’ìŒ</td>
      <td>ê³„ì • ì´ì²´, ì¬ê³  ê´€ë¦¬</td>
    </tr>
  </tbody>
</table>

<h2 id="ëª¨ë‹ˆí„°ë§ê³¼-ì¥ì• -ë³µêµ¬-ì „ëµ">ğŸ“Š ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµ</h2>

<h3 id="ì¢…í•©-ëª¨ë‹ˆí„°ë§-ì‹œìŠ¤í…œ">ì¢…í•© ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ</h3>

<p>CDC íŒŒì´í”„ë¼ì¸ì˜ ê±´ê°•í•œ ìš´ì˜ì„ ìœ„í•œ í¬ê´„ì ì¸ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.</p>

<h3 id="ëª¨ë‹ˆí„°ë§-ê³„ì¸µ">ëª¨ë‹ˆí„°ë§ ê³„ì¸µ</h3>

<table>
  <thead>
    <tr>
      <th>ê³„ì¸µ</th>
      <th>ëª¨ë‹ˆí„°ë§ ëŒ€ìƒ</th>
      <th>ì£¼ìš” ë©”íŠ¸ë¦­</th>
      <th>ì•Œë¦¼ ì„ê³„ê°’</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì¸í”„ë¼ ê³„ì¸µ</strong></td>
      <td>â€¢ Kubernetes í´ëŸ¬ìŠ¤í„°<br />â€¢ Kafka ë¸Œë¡œì»¤<br />â€¢ ë°ì´í„°ë² ì´ìŠ¤</td>
      <td>â€¢ CPU/ë©”ëª¨ë¦¬ ì‚¬ìš©ë¥ <br />â€¢ ë””ìŠ¤í¬ I/O<br />â€¢ ë„¤íŠ¸ì›Œí¬ ì²˜ë¦¬ëŸ‰</td>
      <td>â€¢ CPU &gt; 80%<br />â€¢ ë©”ëª¨ë¦¬ &gt; 90%<br />â€¢ ë””ìŠ¤í¬ &gt; 85%</td>
    </tr>
    <tr>
      <td><strong>ì• í”Œë¦¬ì¼€ì´ì…˜ ê³„ì¸µ</strong></td>
      <td>â€¢ Kafka Connect ì›Œì»¤<br />â€¢ ì»¤ë„¥í„°<br />â€¢ íƒœìŠ¤í¬</td>
      <td>â€¢ JVM ë©”ëª¨ë¦¬<br />â€¢ GC ì‹œê°„<br />â€¢ ìŠ¤ë ˆë“œ ìˆ˜</td>
      <td>â€¢ GC ì‹œê°„ &gt; 20%<br />â€¢ ìŠ¤ë ˆë“œ ìˆ˜ &gt; 1000<br />â€¢ í™ ì‚¬ìš©ë¥  &gt; 80%</td>
    </tr>
    <tr>
      <td><strong>ë°ì´í„° ê³„ì¸µ</strong></td>
      <td>â€¢ ë°ì´í„° ì²˜ë¦¬ëŸ‰<br />â€¢ ì§€ì—°ì‹œê°„<br />â€¢ ì˜¤ë¥˜ìœ¨</td>
      <td>â€¢ ë ˆì½”ë“œ/ì´ˆ<br />â€¢ P99 ì§€ì—°ì‹œê°„<br />â€¢ ì‹¤íŒ¨ìœ¨</td>
      <td>â€¢ ì²˜ë¦¬ëŸ‰ &lt; 1000/s<br />â€¢ ì§€ì—°ì‹œê°„ &gt; 5ì´ˆ<br />â€¢ ì˜¤ë¥˜ìœ¨ &gt; 1%</td>
    </tr>
    <tr>
      <td><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ê³„ì¸µ</strong></td>
      <td>â€¢ ë°ì´í„° í’ˆì§ˆ<br />â€¢ ì¼ê´€ì„±<br />â€¢ ì™„ì „ì„±</td>
      <td>â€¢ ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨<br />â€¢ ì²´í¬ì„¬ ë¶ˆì¼ì¹˜<br />â€¢ ëˆ„ë½ ë ˆì½”ë“œ</td>
      <td>â€¢ ê²€ì¦ ì‹¤íŒ¨ &gt; 0<br />â€¢ ì²´í¬ì„¬ ë¶ˆì¼ì¹˜ &gt; 0<br />â€¢ ëˆ„ë½ë¥  &gt; 0.1%</td>
    </tr>
  </tbody>
</table>

<h2 id="ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì—”í„°í”„ë¼ì´ì¦ˆ-cdc-ìš´ì˜-ì‹œìŠ¤í…œ">ğŸš€ ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì—”í„°í”„ë¼ì´ì¦ˆ CDC ìš´ì˜ ì‹œìŠ¤í…œ</h2>

<h3 id="í”„ë¡œì íŠ¸-ê°œìš”">í”„ë¡œì íŠ¸ ê°œìš”</h3>

<p>ëŒ€ê·œëª¨ ì „ììƒê±°ë˜ í”Œë«í¼ì„ ìœ„í•œ ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ CDC ìš´ì˜ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.</p>

<h3 id="ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜">ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h3>

<table>
  <thead>
    <tr>
      <th>êµ¬ì„± ìš”ì†Œ</th>
      <th>ê¸°ìˆ  ìŠ¤íƒ</th>
      <th>ìš©ëŸ‰</th>
      <th>ê³ ê°€ìš©ì„±</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Source Systems</strong></td>
      <td>â€¢ MySQL 8.0 (ì£¼ë¬¸)<br />â€¢ PostgreSQL 13 (ì‚¬ìš©ì)<br />â€¢ MongoDB 5.0 (ì œí’ˆ)</td>
      <td>â€¢ 100ë§Œ+ ë ˆì½”ë“œ/ì¼<br />â€¢ 50+ í…Œì´ë¸”<br />â€¢ 10+ ë°ì´í„°ë² ì´ìŠ¤</td>
      <td>â€¢ ì½ê¸° ì „ìš© ë³µì œë³¸<br />â€¢ ìë™ ì¥ì•  ë³µêµ¬</td>
    </tr>
    <tr>
      <td><strong>Kafka Cluster</strong></td>
      <td>â€¢ Apache Kafka 3.0<br />â€¢ Schema Registry<br />â€¢ Kafka Connect</td>
      <td>â€¢ 3 ë¸Œë¡œì»¤<br />â€¢ 100+ í† í”½<br />â€¢ 1000+ íŒŒí‹°ì…˜</td>
      <td>â€¢ 3ì¤‘ ë³µì œ<br />â€¢ ìë™ ë¦¬ë°¸ëŸ°ì‹±</td>
    </tr>
    <tr>
      <td><strong>Target Systems</strong></td>
      <td>â€¢ Elasticsearch 8.0<br />â€¢ Redis 7.0<br />â€¢ S3 Data Lake<br />â€¢ Snowflake</td>
      <td>â€¢ 3 ë…¸ë“œ ES í´ëŸ¬ìŠ¤í„°<br />â€¢ 6 ë…¸ë“œ Redis í´ëŸ¬ìŠ¤í„°<br />â€¢ ë¬´ì œí•œ S3 ì €ì¥ì†Œ</td>
      <td>â€¢ í´ëŸ¬ìŠ¤í„° ëª¨ë“œ<br />â€¢ ìë™ ë°±ì—…</td>
    </tr>
  </tbody>
</table>

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="ì´ë²ˆ-partì—ì„œ-í•™ìŠµí•œ-ë‚´ìš©">ì´ë²ˆ Partì—ì„œ í•™ìŠµí•œ ë‚´ìš©</h3>

<ol>
  <li><strong>Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜</strong>
    <ul>
      <li>ë¶„ì‚° ëª¨ë“œ êµ¬ì„±ê³¼ í´ëŸ¬ìŠ¤í„° ì„¤ê³„</li>
      <li>ì›Œì»¤ ë…¸ë“œ ê´€ë¦¬ì™€ í™•ì¥ì„± ì „ëµ</li>
      <li>ê³ ê°€ìš©ì„±ê³¼ ì¥ì•  ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜</li>
    </ul>
  </li>
  <li><strong>ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ</strong>
    <ul>
      <li>Source Connectorì™€ Sink Connector êµ¬í˜„</li>
      <li>ì»¤ìŠ¤í…€ Transform ê°œë°œ</li>
      <li>ì»¤ë„¥í„° í…ŒìŠ¤íŠ¸ì™€ ë°°í¬ ì „ëµ</li>
    </ul>
  </li>
  <li><strong>ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜</strong>
    <ul>
      <li>íŒŒì´í”„ë¼ì¸ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</li>
      <li>ë¶€í•˜ ë¶„ì‚°ê³¼ ì¥ì•  ê²©ë¦¬</li>
      <li>í™•ì¥ì„±ê³¼ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥</li>
    </ul>
  </li>
  <li><strong>ì„±ëŠ¥ ìµœì í™”ì™€ ë³‘ëª© í•´ê²°</strong>
    <ul>
      <li>ì„±ëŠ¥ ë³‘ëª© ì§€ì  ë¶„ì„</li>
      <li>ë™ì  ì„±ëŠ¥ íŠœë‹</li>
      <li>ìë™ ìŠ¤ì¼€ì¼ë§ êµ¬í˜„</li>
    </ul>
  </li>
  <li><strong>ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ê³¼ ê²€ì¦</strong>
    <ul>
      <li>ì¼ê´€ì„± ë³´ì¥ ë°©ë²•ë¡ </li>
      <li>ë°ì´í„° ê²€ì¦ ì‹œìŠ¤í…œ</li>
      <li>ë“œë¦¬í”„íŠ¸ ê°ì§€ì™€ ì´ìƒ íƒì§€</li>
    </ul>
  </li>
  <li><strong>ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµ</strong>
    <ul>
      <li>ì¢…í•© ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ</li>
      <li>ì¬í•´ ë³µêµ¬ ê³„íš</li>
      <li>ìë™ ì¥ì•  ì¡°ì¹˜</li>
    </ul>
  </li>
  <li><strong>ì‹¤ë¬´ í”„ë¡œì íŠ¸</strong>
    <ul>
      <li>ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ CDC ìš´ì˜ ì‹œìŠ¤í…œ</li>
      <li>ëŒ€ê·œëª¨ ì „ììƒê±°ë˜ í”Œë«í¼ ì ìš©</li>
      <li>ìš´ì˜ ìë™í™”ì™€ ìµœì í™”</li>
    </ul>
  </li>
</ol>

<h3 id="í•µì‹¬-ê¸°ìˆ -ìŠ¤íƒ">í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ</h3>

<table>
  <thead>
    <tr>
      <th>ê¸°ìˆ </th>
      <th>ì—­í• </th>
      <th>ì¤‘ìš”ë„</th>
      <th>í•™ìŠµ í¬ì¸íŠ¸</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Kafka Connect</strong></td>
      <td>ì»¤ë„¥í„° í”„ë ˆì„ì›Œí¬</td>
      <td>â­â­â­â­â­</td>
      <td>ë¶„ì‚° ì•„í‚¤í…ì²˜, í™•ì¥ì„±</td>
    </tr>
    <tr>
      <td><strong>Debezium</strong></td>
      <td>CDC í”Œë«í¼</td>
      <td>â­â­â­â­â­</td>
      <td>ê³ ê¸‰ ì„¤ì •, ì„±ëŠ¥ ìµœì í™”</td>
    </tr>
    <tr>
      <td><strong>ì»¤ìŠ¤í…€ ì»¤ë„¥í„°</strong></td>
      <td>íŠ¹í™”ëœ ë°ì´í„° ì²˜ë¦¬</td>
      <td>â­â­â­â­</td>
      <td>ê°œë°œ íŒ¨í„´, í…ŒìŠ¤íŠ¸ ì „ëµ</td>
    </tr>
    <tr>
      <td><strong>ëª¨ë‹ˆí„°ë§</strong></td>
      <td>ìš´ì˜ ê°€ì‹œì„±</td>
      <td>â­â­â­â­â­</td>
      <td>ë©”íŠ¸ë¦­ ìˆ˜ì§‘, ì•Œë¦¼ ì„¤ì •</td>
    </tr>
    <tr>
      <td><strong>ìë™í™”</strong></td>
      <td>ìš´ì˜ íš¨ìœ¨ì„±</td>
      <td>â­â­â­â­</td>
      <td>ìŠ¤ì¼€ì¼ë§, ë³µêµ¬ ìë™í™”</td>
    </tr>
  </tbody>
</table>

<h3 id="ë‹¤ìŒ-ë‹¨ê³„">ë‹¤ìŒ ë‹¨ê³„</h3>

<p>ì´ì œ CDC ì‹œë¦¬ì¦ˆì˜ í•µì‹¬ ë‚´ìš©ì„ ëª¨ë‘ í•™ìŠµí–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ë‹¨ê³„ë¡œëŠ”:</p>

<ol>
  <li><strong>ì‹¤ì œ í”„ë¡œì íŠ¸ ì ìš©</strong>: í•™ìŠµí•œ ë‚´ìš©ì„ ì‹¤ì œ í”„ë¡œì íŠ¸ì— ì ìš©</li>
  <li><strong>ê³ ê¸‰ ì£¼ì œ íƒêµ¬</strong>: ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬, ì´ë²¤íŠ¸ ì†Œì‹± ë“± ê³ ê¸‰ ì£¼ì œ</li>
  <li><strong>ë‹¤ë¥¸ ê¸°ìˆ  ìŠ¤íƒ</strong>: Apache Pulsar, Apache Flink ë“± ë‹¤ë¥¸ ìŠ¤íŠ¸ë¦¬ë° ê¸°ìˆ </li>
</ol>

<hr />

<p><strong>ì‹œë¦¬ì¦ˆ ì™„ë£Œ</strong>: <a href="/data-engineering/2025/09/19/change-data-capture-debezium-guide.html">Change Data Capture Complete Guide Series</a></p>

<hr />

<p><em>ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ì—¬ í˜„ëŒ€ì ì¸ ë°ì´í„° ì•„í‚¤í…ì²˜ì˜ í•µì‹¬ì„ ì™„ì„±í•˜ì„¸ìš”!</em> ğŸš€</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
          
          
      
      
        
        
        <a href="/data-engineering/2025/09/19/change-data-capture-debezium-guide.html" class="nav-link prev">
          â† ì´ì „: Part 1: Change Data Captureì™€ Debezium ì‹¤ì „ êµ¬í˜„ - ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ ì™„ì„±
        </a>
      
      
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="CDCì˜ í•µì‹¬ ê°œë…ë¶€í„° Debeziumì„ í™œìš©í•œ ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œ êµ¬ì¶•ê¹Œì§€, ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">



<title>Part 1: Change Data Captureì™€ Debezium ì‹¤ì „ êµ¬í˜„ - ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ ì™„ì„± - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 1: Change Data Captureì™€ Debezium ì‹¤ì „ êµ¬í˜„ - ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ ì™„ì„±">
<meta property="og:description" content="CDCì˜ í•µì‹¬ ê°œë…ë¶€í„° Debeziumì„ í™œìš©í•œ ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œ êµ¬ì¶•ê¹Œì§€, ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">
<meta property="og:url" content="https://data-droid.github.io/data-engineering/2025/09/19/change-data-capture-debezium-guide.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 1: Change Data Captureì™€ Debezium ì‹¤ì „ êµ¬í˜„ - ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ ì™„ì„±">
<meta name="twitter:description" content="CDCì˜ í•µì‹¬ ê°œë…ë¶€í„° Debeziumì„ í™œìš©í•œ ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œ êµ¬ì¶•ê¹Œì§€, ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-engineering/2025/09/19/change-data-capture-debezium-guide.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-19-change-data-capture-debezium-guide.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 19ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 1: Change Data Captureì™€ Debezium ì‹¤ì „ êµ¬í˜„ - ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ ì™„ì„±</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">Change-Data-Capture</span>
      
        <span class="tag">CDC</span>
      
        <span class="tag">Debezium</span>
      
        <span class="tag">Kafka</span>
      
        <span class="tag">ì‹¤ì‹œê°„ë™ê¸°í™”</span>
      
        <span class="tag">ì´ë²¤íŠ¸ë“œë¦¬ë¸</span>
      
        <span class="tag">ë°ì´í„°íŒŒì´í”„ë¼ì¸</span>
      
        <span class="tag">ìŠ¤í‚¤ë§ˆì§„í™”</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Change data capture complete guide ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 2</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 50ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ê³ ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-1-change-data-captureì™€-debezium-ì‹¤ì „-êµ¬í˜„---ì‹¤ì‹œê°„-ë°ì´í„°-ë™ê¸°í™”ì˜-ì™„ì„±">Part 1: Change Data Captureì™€ Debezium ì‹¤ì „ êµ¬í˜„ - ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ ì™„ì„±</h1>

<blockquote>
  <p>CDCì˜ í•µì‹¬ ê°œë…ë¶€í„° Debeziumì„ í™œìš©í•œ ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œ êµ¬ì¶•ê¹Œì§€, ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#change-data-capture-ê¸°ì´ˆ-ê°œë…">Change Data Capture ê¸°ì´ˆ ê°œë…</a></li>
  <li><a href="#debezium-ì•„í‚¤í…ì²˜ì™€-í•µì‹¬-ê¸°ëŠ¥">Debezium ì•„í‚¤í…ì²˜ì™€ í•µì‹¬ ê¸°ëŠ¥</a></li>
  <li><a href="#debezium-ì»¤ë„¥í„°-ì„¤ì •ê³¼-ìš´ì˜">Debezium ì»¤ë„¥í„° ì„¤ì •ê³¼ ìš´ì˜</a></li>
  <li><a href="#ìŠ¤í‚¤ë§ˆ-ì§„í™”ì™€-ìŠ¤í‚¤ë§ˆ-ë ˆì§€ìŠ¤íŠ¸ë¦¬">ìŠ¤í‚¤ë§ˆ ì§„í™”ì™€ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬</a></li>
  <li><a href="#ì‹¤ì‹œê°„-ë°ì´í„°-ë³€í™˜ê³¼-ë¼ìš°íŒ…">ì‹¤ì‹œê°„ ë°ì´í„° ë³€í™˜ê³¼ ë¼ìš°íŒ…</a></li>
  <li><a href="#ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì‹¤ì‹œê°„-ë°ì´í„°-ë™ê¸°í™”-ì‹œìŠ¤í…œ">ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œ</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<h2 id="change-data-capture-ê¸°ì´ˆ-ê°œë…">ğŸ”„ Change Data Capture ê¸°ì´ˆ ê°œë…</h2>

<h3 id="cdcë€-ë¬´ì—‡ì¸ê°€">CDCë€ ë¬´ì—‡ì¸ê°€?</h3>

<p>Change Data Capture(CDC)ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ê³  ìº¡ì²˜í•˜ì—¬ ë‹¤ë¥¸ ì‹œìŠ¤í…œìœ¼ë¡œ ì „íŒŒí•˜ëŠ” ê¸°ìˆ ì…ë‹ˆë‹¤. ì „í†µì ì¸ ë°°ì¹˜ ì²˜ë¦¬ ë°©ì‹ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³  ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•©ë‹ˆë‹¤.</p>

<h3 id="ì „í†µì ì¸-ë°°ì¹˜-ì²˜ë¦¬-vs-cdc">ì „í†µì ì¸ ë°°ì¹˜ ì²˜ë¦¬ vs CDC</h3>

<table>
  <thead>
    <tr>
      <th>íŠ¹ì„±</th>
      <th>ë°°ì¹˜ ì²˜ë¦¬</th>
      <th>CDC ë°©ì‹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì§€ì—°ì‹œê°„</strong></td>
      <td>ë†’ìŒ (ì‹œê°„/ì¼ ë‹¨ìœ„)</td>
      <td>ë‚®ìŒ (ì´ˆ/ë¶„ ë‹¨ìœ„)</td>
    </tr>
    <tr>
      <td><strong>ì²˜ë¦¬ëŸ‰</strong></td>
      <td>ë†’ìŒ (ëŒ€ìš©ëŸ‰ ì¼ê´„ ì²˜ë¦¬)</td>
      <td>ì¤‘ê°„ (ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¼)</td>
    </tr>
    <tr>
      <td><strong>ë³µì¡ì„±</strong></td>
      <td>ë‚®ìŒ</td>
      <td>ë†’ìŒ</td>
    </tr>
    <tr>
      <td><strong>ì¼ê´€ì„±</strong></td>
      <td>ìµœì¢… ì¼ê´€ì„±</td>
      <td>ê°•í•œ ì¼ê´€ì„± ê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>ë¦¬ì†ŒìŠ¤ ì‚¬ìš©</strong></td>
      <td>ì£¼ê¸°ì  ë†’ìŒ</td>
      <td>ì§€ì†ì  ì¤‘ê°„</td>
    </tr>
    <tr>
      <td><strong>ì‹¤ì‹œê°„ ì²˜ë¦¬</strong></td>
      <td>ë¶ˆê°€ëŠ¥</td>
      <td>ê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>ì£¼ìš” ì‚¬ìš© ì‚¬ë¡€</strong></td>
      <td>â€¢ ETL íŒŒì´í”„ë¼ì¸<br />â€¢ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ êµ¬ì¶•<br />â€¢ ì¼ì¼/ì£¼ê°„ ë¦¬í¬íŠ¸<br />â€¢ ëŒ€ìš©ëŸ‰ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜</td>
      <td>â€¢ ì‹¤ì‹œê°„ ë¶„ì„<br />â€¢ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜<br />â€¢ ë°ì´í„° ë ˆì´í¬ ì‹¤ì‹œê°„ ë™ê¸°í™”<br />â€¢ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ ë°ì´í„° ë™ê¸°í™”</td>
    </tr>
  </tbody>
</table>

<h3 id="cdc-ë„ì…-roi-í‰ê°€">CDC ë„ì… ROI í‰ê°€</h3>

<table>
  <thead>
    <tr>
      <th>í‰ê°€ ê¸°ì¤€</th>
      <th>ì ìˆ˜</th>
      <th>ì¡°ê±´</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë°ì´í„° ì‹ ì„ ë„</strong></td>
      <td>40ì </td>
      <td>ì‹¤ì‹œê°„/ë¶„ ë‹¨ìœ„</td>
      <td>ì¦‰ì‹œ ì²˜ë¦¬ í•„ìš”</td>
    </tr>
    <tr>
      <td><strong>ë°ì´í„° ì‹ ì„ ë„</strong></td>
      <td>20ì </td>
      <td>ì‹œê°„ ë‹¨ìœ„</td>
      <td>ë¹ ë¥¸ ì²˜ë¦¬ í•„ìš”</td>
    </tr>
    <tr>
      <td><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ì¤‘ìš”ë„</strong></td>
      <td>30ì </td>
      <td>3ê°œ ì´ìƒ í¬ë¦¬í‹°ì»¬ í”„ë¡œì„¸ìŠ¤</td>
      <td>í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ì˜í–¥</td>
    </tr>
    <tr>
      <td><strong>ì»´í”Œë¼ì´ì–¸ìŠ¤</strong></td>
      <td>20ì </td>
      <td>ê·œì œ ìš”êµ¬ì‚¬í•­ ìˆìŒ</td>
      <td>ê°ì‚¬ ì¶”ì  í•„ìš”</td>
    </tr>
    <tr>
      <td><strong>ë°ì´í„° ë³¼ë¥¨</strong></td>
      <td>10ì </td>
      <td>ì¼ì¼ 1TB ì´ìƒ</td>
      <td>ëŒ€ìš©ëŸ‰ ì²˜ë¦¬</td>
    </tr>
  </tbody>
</table>

<h4 id="roi-ê¶Œì¥ì‚¬í•­">ROI ê¶Œì¥ì‚¬í•­</h4>

<table>
  <thead>
    <tr>
      <th>ì´ì </th>
      <th>ê¶Œì¥ì‚¬í•­</th>
      <th>ì ìš© ì‹œë‚˜ë¦¬ì˜¤</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>70ì  ì´ìƒ</strong></td>
      <td>ê°•ë ¥ ì¶”ì²œ</td>
      <td>ì‹¤ì‹œê°„ ë¶„ì„, ê¸ˆìœµ ê±°ë˜, IoT ë°ì´í„°</td>
    </tr>
    <tr>
      <td><strong>40-69ì </strong></td>
      <td>ê³ ë ¤ ê¶Œì¥</td>
      <td>ì¤‘ê°„ ìˆ˜ì¤€ì˜ ì‹¤ì‹œê°„ ìš”êµ¬ì‚¬í•­</td>
    </tr>
    <tr>
      <td><strong>40ì  ë¯¸ë§Œ</strong></td>
      <td>ì‹ ì¤‘ ê²€í† </td>
      <td>ë°°ì¹˜ ì²˜ë¦¬ë¡œë„ ì¶©ë¶„í•œ ê²½ìš°</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">BatchProcessingVsCDC</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">calculate_roi_score</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">requirements</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">CDC ë„ì… ROI ì ìˆ˜ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_latency</span><span class="sh">"</span><span class="p">)</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">realtime</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">minutes</span><span class="sh">"</span><span class="p">]:</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="mi">40</span>
        <span class="k">elif</span> <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_latency</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">hourly</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="mi">20</span>
        
        <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">critical_processes</span><span class="sh">"</span><span class="p">,</span> <span class="p">[]))</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="mi">30</span>
        
        <span class="k">if</span> <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">compliance</span><span class="sh">"</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="mi">20</span>
        
        <span class="k">if</span> <span class="sh">"</span><span class="s">TB</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">daily_volume</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">):</span>
            <span class="n">score</span> <span class="o">+=</span> <span class="mi">10</span>
        
        <span class="k">return</span> <span class="n">score</span>
</code></pre></div></div>

<h3 id="ì£¼ìš”-cdc-ë„êµ¬-ë¹„êµ">ì£¼ìš” CDC ë„êµ¬ ë¹„êµ</h3>

<table>
  <thead>
    <tr>
      <th>ë„êµ¬</th>
      <th>íƒ€ì…</th>
      <th>ì§€ì› DB</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Debezium</strong></td>
      <td>Open Source</td>
      <td>MySQL, PostgreSQL, MongoDB, SQL Server, Oracle, DB2</td>
    </tr>
    <tr>
      <td><strong>Kafka Connect</strong></td>
      <td>Apache Kafka ìƒíƒœê³„</td>
      <td>JDBC í˜¸í™˜ ëª¨ë“  DB, Elasticsearch, HDFS, S3</td>
    </tr>
    <tr>
      <td><strong>Maxwell</strong></td>
      <td>Open Source</td>
      <td>MySQL</td>
    </tr>
    <tr>
      <td><strong>AWS DMS</strong></td>
      <td>Managed Service</td>
      <td>MySQL, PostgreSQL, Oracle, SQL Server, MongoDB</td>
    </tr>
  </tbody>
</table>

<h4 id="ì£¼ìš”-ì¥ì -ë¹„êµ">ì£¼ìš” ì¥ì  ë¹„êµ</h4>

<table>
  <thead>
    <tr>
      <th>ë„êµ¬</th>
      <th>ì£¼ìš” ì¥ì </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Debezium</strong></td>
      <td>â€¢ í’ë¶€í•œ DB ì§€ì›<br />â€¢ Kafka ìƒíƒœê³„ í†µí•©<br />â€¢ ìŠ¤í‚¤ë§ˆ ì§„í™” ì§€ì›<br />â€¢ í™•ì¥ì„±ê³¼ ì•ˆì •ì„±</td>
    </tr>
    <tr>
      <td><strong>Kafka Connect</strong></td>
      <td>â€¢ Kafka ë„¤ì´í‹°ë¸Œ í†µí•©<br />â€¢ í’ë¶€í•œ ì»¤ë„¥í„° ìƒíƒœê³„<br />â€¢ í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜</td>
    </tr>
    <tr>
      <td><strong>Maxwell</strong></td>
      <td>â€¢ ê°„ë‹¨í•œ ì„¤ì •<br />â€¢ MySQL íŠ¹í™” ìµœì í™”<br />â€¢ ê°€ë²¼ìš´ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©</td>
    </tr>
    <tr>
      <td><strong>AWS DMS</strong></td>
      <td>â€¢ ì™„ì „ ê´€ë¦¬í˜• ì„œë¹„ìŠ¤<br />â€¢ AWS ìƒíƒœê³„ í†µí•©<br />â€¢ ê³ ê°€ìš©ì„±<br />â€¢ ëª¨ë‹ˆí„°ë§ ë‚´ì¥</td>
    </tr>
  </tbody>
</table>

<h4 id="ì£¼ìš”-ë‹¨ì ê³¼-ì‚¬ìš©-ì‚¬ë¡€">ì£¼ìš” ë‹¨ì ê³¼ ì‚¬ìš© ì‚¬ë¡€</h4>

<table>
  <thead>
    <tr>
      <th>ë„êµ¬</th>
      <th>ì£¼ìš” ë‹¨ì </th>
      <th>ìµœì  ì‚¬ìš© ì‚¬ë¡€</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Debezium</strong></td>
      <td>â€¢ ì„¤ì • ë³µì¡ì„±<br />â€¢ Kafka ì˜ì¡´ì„±<br />â€¢ ìš´ì˜ ì˜¤ë²„í—¤ë“œ</td>
      <td>â€¢ ëŒ€ê·œëª¨ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°<br />â€¢ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜<br />â€¢ ë°ì´í„° ë ˆì´í¬ ì‹¤ì‹œê°„ ë™ê¸°í™”</td>
    </tr>
    <tr>
      <td><strong>Kafka Connect</strong></td>
      <td>â€¢ JDBC ê¸°ë°˜ ì§€ì—°ì‹œê°„<br />â€¢ ë³µì¡í•œ ì„¤ì •<br />â€¢ ëª¨ë‹ˆí„°ë§ ë³µì¡ì„±</td>
      <td>â€¢ Kafka ì¤‘ì‹¬ ì•„í‚¤í…ì²˜<br />â€¢ ë‹¤ì–‘í•œ ì‹œìŠ¤í…œ í†µí•©<br />â€¢ ê¸°ì¡´ ETL íŒŒì´í”„ë¼ì¸ í˜„ëŒ€í™”</td>
    </tr>
    <tr>
      <td><strong>Maxwell</strong></td>
      <td>â€¢ MySQLë§Œ ì§€ì›<br />â€¢ ì œí•œëœ í™•ì¥ì„±<br />â€¢ ì‘ì€ ì»¤ë®¤ë‹ˆí‹°</td>
      <td>â€¢ MySQL ì „ìš© í™˜ê²½<br />â€¢ ê°„ë‹¨í•œ CDC ìš”êµ¬ì‚¬í•­<br />â€¢ í”„ë¡œí† íƒ€ì… ê°œë°œ</td>
    </tr>
    <tr>
      <td><strong>AWS DMS</strong></td>
      <td>â€¢ AWS ë²¤ë” ë½ì¸<br />â€¢ ë¹„ìš©<br />â€¢ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì œí•œ</td>
      <td>â€¢ AWS ì¤‘ì‹¬ ì•„í‚¤í…ì²˜<br />â€¢ ê´€ë¦¬ ë¶€ë‹´ ìµœì†Œí™”<br />â€¢ ì—”í„°í”„ë¼ì´ì¦ˆ í™˜ê²½</td>
    </tr>
  </tbody>
</table>

<h3 id="cdc-ë„êµ¬-ì„ íƒ-ê¸°ì¤€">CDC ë„êµ¬ ì„ íƒ ê¸°ì¤€</h3>

<table>
  <thead>
    <tr>
      <th>ì¡°ê±´</th>
      <th>ê¶Œì¥ ë„êµ¬</th>
      <th>ì„ íƒ ì´ìœ </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>MySQL + ë‚®ì€ ë³µì¡ì„±</strong></td>
      <td>Maxwell</td>
      <td>ê°„ë‹¨í•œ ì„¤ì •, MySQL íŠ¹í™” ìµœì í™”</td>
    </tr>
    <tr>
      <td><strong>AWS ê´€ë¦¬í˜• ì„œë¹„ìŠ¤</strong></td>
      <td>AWS DMS</td>
      <td>ì™„ì „ ê´€ë¦¬í˜•, AWS ìƒíƒœê³„ í†µí•©</td>
    </tr>
    <tr>
      <td><strong>ëŒ€ê·œëª¨ + ê³ ë³µì¡ì„±</strong></td>
      <td>Debezium</td>
      <td>í’ë¶€í•œ ê¸°ëŠ¥, í™•ì¥ì„±, ìŠ¤í‚¤ë§ˆ ì§„í™”</td>
    </tr>
    <tr>
      <td><strong>ê¸°íƒ€ ê²½ìš°</strong></td>
      <td>Kafka Connect</td>
      <td>ë²”ìš©ì„±, ì»¤ë„¥í„° ìƒíƒœê³„</td>
    </tr>
  </tbody>
</table>

<h4 id="ì„ íƒ-ê¸°ì¤€ë³„-ê°€ì¤‘ì¹˜">ì„ íƒ ê¸°ì¤€ë³„ ê°€ì¤‘ì¹˜</h4>

<table>
  <thead>
    <tr>
      <th>ê¸°ì¤€</th>
      <th>ê°€ì¤‘ì¹˜</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë°ì´í„°ë² ì´ìŠ¤ íƒ€ì…</strong></td>
      <td>ë†’ìŒ</td>
      <td>ì§€ì› ë²”ìœ„ì™€ ìµœì í™” ìˆ˜ì¤€</td>
    </tr>
    <tr>
      <td><strong>ê·œëª¨</strong></td>
      <td>ë†’ìŒ</td>
      <td>ì²˜ë¦¬ëŸ‰ê³¼ í™•ì¥ì„± ìš”êµ¬ì‚¬í•­</td>
    </tr>
    <tr>
      <td><strong>ë³µì¡ì„±</strong></td>
      <td>ì¤‘ê°„</td>
      <td>ì„¤ì •ê³¼ ìš´ì˜ì˜ ë³µì¡ë„</td>
    </tr>
    <tr>
      <td><strong>ì˜ˆì‚°</strong></td>
      <td>ì¤‘ê°„</td>
      <td>ë¼ì´ì„ ìŠ¤ ë¹„ìš©ê³¼ ê´€ë¦¬ ë¹„ìš©</td>
    </tr>
    <tr>
      <td><strong>íŒ€ ì „ë¬¸ì„±</strong></td>
      <td>ë‚®ìŒ</td>
      <td>í•™ìŠµ ê³¡ì„ ê³¼ ìš´ì˜ ëŠ¥ë ¥</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CDCToolsComparison</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">select_optimal_tool</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">requirements</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìš”êµ¬ì‚¬í•­ì— ë”°ë¥¸ ìµœì  ë„êµ¬ ì„ íƒ</span><span class="sh">"""</span>
        <span class="nf">if </span><span class="p">(</span><span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">database</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">mysql</span><span class="sh">"</span> <span class="ow">and</span> 
            <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">complexity</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">low</span><span class="sh">"</span><span class="p">):</span>
            <span class="k">return</span> <span class="sh">"</span><span class="s">maxwell</span><span class="sh">"</span>
        <span class="k">elif</span> <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">budget</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">aws_managed</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="sh">"</span><span class="s">aws_dms</span><span class="sh">"</span>
        <span class="nf">elif </span><span class="p">(</span><span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">scale</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">large</span><span class="sh">"</span> <span class="ow">and</span> 
              <span class="n">requirements</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">complexity</span><span class="sh">"</span><span class="p">)</span> <span class="o">==</span> <span class="sh">"</span><span class="s">high</span><span class="sh">"</span><span class="p">):</span>
            <span class="k">return</span> <span class="sh">"</span><span class="s">debezium</span><span class="sh">"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sh">"</span><span class="s">kafka_connect</span><span class="sh">"</span>
</code></pre></div></div>

<h2 id="debezium-ì•„í‚¤í…ì²˜ì™€-í•µì‹¬-ê¸°ëŠ¥">ğŸ”§ Debezium ì•„í‚¤í…ì²˜ì™€ í•µì‹¬ ê¸°ëŠ¥</h2>

<h3 id="debezium-ì•„í‚¤í…ì²˜-ê°œìš”">Debezium ì•„í‚¤í…ì²˜ ê°œìš”</h3>

<p>Debeziumì€ Apache Kafka Connect í”„ë ˆì„ì›Œí¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ êµ¬ì¶•ëœ ì˜¤í”ˆì†ŒìŠ¤ CDC í”Œë«í¼ì…ë‹ˆë‹¤. ë‹¤ì–‘í•œ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ìº¡ì²˜í•˜ì—¬ Kafka í† í”½ìœ¼ë¡œ ì „ì†¡í•©ë‹ˆë‹¤.</p>

<h3 id="í•µì‹¬-ì»´í¬ë„ŒíŠ¸">í•µì‹¬ ì»´í¬ë„ŒíŠ¸</h3>

<p>Debeziumì˜ í•µì‹¬ ì»´í¬ë„ŒíŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:</p>

<ul>
  <li><strong>Debezium Connectors</strong>: ê° ë°ì´í„°ë² ì´ìŠ¤ë³„ë¡œ íŠ¹í™”ëœ ì»¤ë„¥í„°</li>
  <li><strong>Kafka Connect Framework</strong>: ì»¤ë„¥í„° ì‹¤í–‰ ë° ê´€ë¦¬ í”„ë ˆì„ì›Œí¬</li>
  <li><strong>Schema Registry</strong>: ìŠ¤í‚¤ë§ˆ ì§„í™” ë° í˜¸í™˜ì„± ê´€ë¦¬</li>
  <li><strong>Change Data Capture Engine</strong>: ë³€ê²½ì‚¬í•­ ê°ì§€ ë° ìº¡ì²˜ ì—”ì§„</li>
</ul>

<h3 id="ë°ì´í„°ë² ì´ìŠ¤ë³„-ë³€ê²½-ê°ì§€-ë©”ì»¤ë‹ˆì¦˜">ë°ì´í„°ë² ì´ìŠ¤ë³„ ë³€ê²½ ê°ì§€ ë©”ì»¤ë‹ˆì¦˜</h3>

<table>
  <thead>
    <tr>
      <th>ë°ì´í„°ë² ì´ìŠ¤</th>
      <th>ë³€ê²½ ê°ì§€ ë°©ì‹</th>
      <th>ì£¼ìš” ê¸°ëŠ¥</th>
      <th>ìŠ¤ëƒ…ìƒ· ëª¨ë“œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>MySQL</strong></td>
      <td>ë°”ì´ë„ˆë¦¬ ë¡œê·¸ (Binlog)</td>
      <td>â€¢ GTID ì§€ì›<br />â€¢ ê¸€ë¡œë²Œ íŠ¸ëœì­ì…˜ ì‹ë³„ì</td>
      <td>ì´ˆê¸° ìŠ¤ëƒ…ìƒ· + ì¦ë¶„ ë™ê¸°í™”</td>
    </tr>
    <tr>
      <td><strong>PostgreSQL</strong></td>
      <td>Write-Ahead Log (WAL)</td>
      <td>â€¢ ë…¼ë¦¬ì  ë³µì œ ìŠ¬ë¡¯<br />â€¢ ë„¤ì´í‹°ë¸Œ ë³µì œ í”„ë¡œí† ì½œ</td>
      <td>ì´ˆê¸° ìŠ¤ëƒ…ìƒ· + ìŠ¤íŠ¸ë¦¬ë°</td>
    </tr>
    <tr>
      <td><strong>MongoDB</strong></td>
      <td>Operations Log (Oplog)</td>
      <td>â€¢ Change Streams (3.6+)<br />â€¢ ì¬ì‹œì‘ ì§€ì  ì¶”ì </td>
      <td>ì´ˆê¸° ìŠ¤ëƒ…ìƒ· + Oplog ì¶”ì </td>
    </tr>
  </tbody>
</table>

<h3 id="kafka-connect-ì•„í‚¤í…ì²˜">Kafka Connect ì•„í‚¤í…ì²˜</h3>

<table>
  <thead>
    <tr>
      <th>ëª¨ë“œ</th>
      <th>ì„¤ëª…</th>
      <th>ì£¼ìš” íŠ¹ì§•</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Distributed Mode</strong></td>
      <td>ë¶„ì‚° ëª¨ë“œ</td>
      <td>â€¢ ê³ ê°€ìš©ì„± ë³´ì¥<br />â€¢ ìˆ˜í‰ í™•ì¥ ê°€ëŠ¥<br />â€¢ ì¥ì•  ë³µêµ¬ ìë™í™”</td>
    </tr>
    <tr>
      <td><strong>Standalone Mode</strong></td>
      <td>ë‹¨ì¼ ë…¸ë“œ ëª¨ë“œ</td>
      <td>â€¢ ê°œë°œ/í…ŒìŠ¤íŠ¸ í™˜ê²½<br />â€¢ ê°„ë‹¨í•œ ì„¤ì •<br />â€¢ ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰</td>
    </tr>
  </tbody>
</table>

<h3 id="kafka-topics-êµ¬ì¡°">Kafka Topics êµ¬ì¡°</h3>

<table>
  <thead>
    <tr>
      <th>í† í”½ íƒ€ì…</th>
      <th>ìš©ë„</th>
      <th>ì£¼ìš” ë‚´ìš©</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>change_events</strong></td>
      <td>ë°ì´í„°ë² ì´ìŠ¤ ë³€ê²½ ì´ë²¤íŠ¸</td>
      <td>ì‹¤ì œ ë°ì´í„° ë³€ê²½ì‚¬í•­</td>
    </tr>
    <tr>
      <td><strong>schema_changes</strong></td>
      <td>ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì´ë²¤íŠ¸</td>
      <td>í…Œì´ë¸”/ì»¬ëŸ¼ êµ¬ì¡° ë³€ê²½</td>
    </tr>
    <tr>
      <td><strong>heartbeat</strong></td>
      <td>ì—°ê²° ìƒíƒœ í™•ì¸</td>
      <td>ì»¤ë„¥í„° ìƒíƒœ ëª¨ë‹ˆí„°ë§</td>
    </tr>
    <tr>
      <td><strong>transaction_metadata</strong></td>
      <td>íŠ¸ëœì­ì…˜ ë©”íƒ€ë°ì´í„°</td>
      <td>íŠ¸ëœì­ì…˜ ê²½ê³„ ì •ë³´</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DebeziumArchitecture</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">create_debezium_configuration</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">database_type</span><span class="p">,</span> <span class="n">connection_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Debezium ì„¤ì • ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">base_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s">-connector</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">io.debezium.connector.</span><span class="si">{</span><span class="n">database_type</span><span class="p">.</span><span class="nf">title</span><span class="p">()</span><span class="si">}</span><span class="s">.MySqlConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">host</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">port</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">user</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">password</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.server.id</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">184054</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_name</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">schema.history.internal.kafka.bootstrap.servers</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">kafka:9092</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">schema.history.internal.kafka.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">schema-changes.</span><span class="si">{</span><span class="n">connection_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include.schema.changes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">initial</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">if</span> <span class="n">database_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">mysql</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">base_config</span><span class="p">[</span><span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">].</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.mysql.MySqlConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.server.id</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">184054</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">connection_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">databases</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">table.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">connection_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">binlog.buffer.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8192</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2048</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8192</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.locking.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">minimal</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="k">elif</span> <span class="n">database_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">postgresql</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">base_config</span><span class="p">[</span><span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">].</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.postgresql.PostgresConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.dbname</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">database</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.slot.name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">debezium_</span><span class="si">{</span><span class="n">connection_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">plugin.name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">pgoutput</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">publication.name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">debezium_publication_</span><span class="si">{</span><span class="n">connection_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">slot.drop.on.stop</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">publication.autocreate.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">filtered</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="k">elif</span> <span class="n">database_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">mongodb</span><span class="sh">"</span><span class="p">:</span>
            <span class="n">base_config</span><span class="p">[</span><span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">].</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.mongodb.MongoDbConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">mongodb.hosts</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">hosts</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">mongodb.name</span><span class="sh">"</span><span class="p">:</span> <span class="n">connection_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_name</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">collection.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">connection_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">collections</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">capture.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">change_streams_update_full</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">initial</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">base_config</span>
</code></pre></div></div>

<h3 id="ì´ë²¤íŠ¸-ìŠ¤íŠ¸ë¦¬ë°-íŒ¨í„´">ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° íŒ¨í„´</h3>

<table>
  <thead>
    <tr>
      <th>íŒ¨í„´</th>
      <th>ê°œë…</th>
      <th>ì£¼ìš” ì¥ì </th>
      <th>êµ¬í˜„ ë°©ì‹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Event Sourcing</strong></td>
      <td>ëª¨ë“  ìƒíƒœ ë³€ê²½ì„ ì´ë²¤íŠ¸ë¡œ ì €ì¥</td>
      <td>â€¢ ì™„ì „í•œ ë³€ê²½ ì´ë ¥ ì¶”ì <br />â€¢ ì‹œê°„ ì—¬í–‰ ê°€ëŠ¥<br />â€¢ ê°ì‚¬ ë¡œê·¸ ìë™ ìƒì„±<br />â€¢ ë¶„ì‚° ì‹œìŠ¤í…œ ê°„ ì¼ê´€ì„±</td>
      <td>â€¢ Kafka í† í”½ì„ ì´ë²¤íŠ¸ ìŠ¤í† ì–´ë¡œ í™œìš©<br />â€¢ ì£¼ê¸°ì  ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”<br />â€¢ ì½ê¸° ëª¨ë¸ ìƒì„±<br />â€¢ ì´ë²¤íŠ¸ ì¬ìƒìœ¼ë¡œ ìƒíƒœ ë³µì›</td>
    </tr>
    <tr>
      <td><strong>CQRS</strong></td>
      <td>ëª…ë ¹ê³¼ ì¡°íšŒì˜ ì±…ì„ ë¶„ë¦¬</td>
      <td>â€¢ ë…ë¦½ì  ìŠ¤ì¼€ì¼ë§<br />â€¢ ìµœì í™”ëœ ì½ê¸°/ì“°ê¸° ëª¨ë¸<br />â€¢ ë³µì¡ì„± ë¶„ë¦¬<br />â€¢ ì„±ëŠ¥ í–¥ìƒ</td>
      <td>â€¢ Debeziumìœ¼ë¡œ ëª…ë ¹ ì´ë²¤íŠ¸ ìº¡ì²˜<br />â€¢ ì½ê¸° ì „ìš© ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¶•<br />â€¢ ì´ë²¤íŠ¸ë¥¼ ì½ê¸° ëª¨ë¸ë¡œ ë³€í™˜<br />â€¢ ìµœì¢… ì¼ê´€ì„± ë³´ì¥</td>
    </tr>
    <tr>
      <td><strong>Saga</strong></td>
      <td>ë¶„ì‚° íŠ¸ëœì­ì…˜ ê´€ë¦¬</td>
      <td>â€¢ ë¶„ì‚° í™˜ê²½ì—ì„œ íŠ¸ëœì­ì…˜ ì²˜ë¦¬<br />â€¢ ì¥ì•  ë³µêµ¬ ê°€ëŠ¥<br />â€¢ í™•ì¥ì„± ë³´ì¥</td>
      <td>â€¢ ì´ë²¤íŠ¸ ê¸°ë°˜ ì¡°ìœ¨ (Choreography)<br />â€¢ ì¤‘ì•™ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° (Orchestration)<br />â€¢ ë³´ìƒ íŠ¸ëœì­ì…˜ ì²˜ë¦¬<br />â€¢ Saga ìƒíƒœ ê´€ë¦¬</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">EventStreamingPatterns</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">implement_event_sourcing_pattern</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Event Sourcing íŒ¨í„´ êµ¬í˜„ ì˜ˆì œ</span><span class="sh">"""</span>
        
        <span class="c1"># ì´ë²¤íŠ¸ ìŠ¤í† ì–´ ì„¤ì •
</span>        <span class="n">event_store_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">kafka_topics</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">order_events</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">orders.ecommerce.orders</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">customer_events</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">orders.ecommerce.customers</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">product_events</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">orders.ecommerce.products</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">event_serialization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Avro</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">snapshot_frequency</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">every_1000_events</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">retention_policy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7_days</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="c1"># ì´ë²¤íŠ¸ ì¬ìƒ ì˜ˆì œ
</span>        <span class="k">def</span> <span class="nf">replay_events_for_state</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">,</span> <span class="n">from_timestamp</span><span class="p">):</span>
            <span class="sh">"""</span><span class="s">íŠ¹ì • ì—”í‹°í‹°ì˜ ìƒíƒœë¥¼ ì´ë²¤íŠ¸ ì¬ìƒìœ¼ë¡œ ë³µì›</span><span class="sh">"""</span>
            <span class="n">events</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_events</span><span class="p">(</span><span class="n">entity_id</span><span class="p">,</span> <span class="n">from_timestamp</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">apply_event</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">event</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">state</span>
        
        <span class="k">return</span> <span class="n">event_store_config</span>
    
    <span class="k">def</span> <span class="nf">implement_cqrs_pattern</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">CQRS íŒ¨í„´ êµ¬í˜„ ì˜ˆì œ</span><span class="sh">"""</span>
        
        <span class="c1"># ëª…ë ¹ ì¸¡ (Command Side)
</span>        <span class="n">command_side_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">write_model</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">database</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">mysql_orders</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">tables</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">orders</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">order_items</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">for_writes</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">event_publishing</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">debezium_connector</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">mysql-orders-connector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">topics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">orders.ecommerce.orders</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1"># ì¡°íšŒ ì¸¡ (Query Side)
</span>        <span class="n">query_side_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">read_models</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">elasticsearch</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">indexes</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">orders_read_model</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">customers_read_model</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">for_reads</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">projections</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">order_summary</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">customer_profile</span><span class="sh">"</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="sh">"</span><span class="s">redis</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">caches</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">order_cache</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">customer_cache</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">ttl</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1_hour</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">command_side</span><span class="sh">"</span><span class="p">:</span> <span class="n">command_side_config</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">query_side</span><span class="sh">"</span><span class="p">:</span> <span class="n">query_side_config</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">implement_saga_pattern</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Saga íŒ¨í„´ êµ¬í˜„ ì˜ˆì œ</span><span class="sh">"""</span>
        
        <span class="c1"># Choreography íŒ¨í„´
</span>        <span class="n">choreography_saga</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">order_processing_saga</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">steps</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="sh">"</span><span class="s">service</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">order_service</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">create_order</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">compensation</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">cancel_order</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">event</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">OrderCreated</span><span class="sh">"</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="sh">"</span><span class="s">service</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">inventory_service</span><span class="sh">"</span><span class="p">,</span> 
                        <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">reserve_inventory</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">compensation</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">release_inventory</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">event</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">InventoryReserved</span><span class="sh">"</span>
                    <span class="p">},</span>
                    <span class="p">{</span>
                        <span class="sh">"</span><span class="s">service</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">payment_service</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">action</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">process_payment</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">compensation</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">refund_payment</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">event</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">PaymentProcessed</span><span class="sh">"</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="sh">"</span><span class="s">compensation_strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">reverse_order</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="c1"># Orchestration íŒ¨í„´
</span>        <span class="n">orchestration_saga</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">saga_orchestrator</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">state_machine</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">states</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">STARTED</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">INVENTORY_RESERVED</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">PAYMENT_PROCESSED</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">COMPLETED</span><span class="sh">"</span><span class="p">],</span>
                    <span class="sh">"</span><span class="s">transitions</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="sh">"</span><span class="s">STARTED</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">INVENTORY_RESERVED</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">INVENTORY_RESERVED</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">PAYMENT_PROCESSED</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">PAYMENT_PROCESSED</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">COMPLETED</span><span class="sh">"</span>
                    <span class="p">},</span>
                    <span class="sh">"</span><span class="s">compensation_states</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">INVENTORY_RELEASED</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">PAYMENT_REFUNDED</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CANCELLED</span><span class="sh">"</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">choreography</span><span class="sh">"</span><span class="p">:</span> <span class="n">choreography_saga</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">orchestration</span><span class="sh">"</span><span class="p">:</span> <span class="n">orchestration_saga</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="ï¸-debezium-ì»¤ë„¥í„°-ì„¤ì •ê³¼-ìš´ì˜">âš™ï¸ Debezium ì»¤ë„¥í„° ì„¤ì •ê³¼ ìš´ì˜</h2>

<h3 id="mysql-ì»¤ë„¥í„°-ì„¤ì •">MySQL ì»¤ë„¥í„° ì„¤ì •</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MySQLConnectorSetup</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config_templates</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_mysql_connector</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">environment_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">MySQL ì»¤ë„¥í„° ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="c1"># MySQL ì„œë²„ ì„¤ì •
</span>        <span class="n">mysql_server_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">binlog_format</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ROW</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">binlog_row_image</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">FULL</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">log_bin</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">mysql-bin</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">server_id</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_id</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">gtid_mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ON</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">enforce_gtid_consistency</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ON</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="c1"># Debezium MySQL ì»¤ë„¥í„° ì„¤ì •
</span>        <span class="n">connector_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">mysql-connector-</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.mysql.MySqlConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_host</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_port</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_user</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_password</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.server.id</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_id</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_name</span><span class="sh">"</span><span class="p">],</span>
                
                <span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ ë° í…Œì´ë¸” í•„í„°ë§
</span>                <span class="sh">"</span><span class="s">database.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_databases</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">table.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">database.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">excluded_databases</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">table.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">excluded_tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                
                <span class="c1"># ì„±ëŠ¥ ìµœì í™” ì„¤ì •
</span>                <span class="sh">"</span><span class="s">binlog.buffer.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">32768</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4096</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16384</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">500</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.locking.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">minimal</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.fetch.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2048</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ìŠ¤í‚¤ë§ˆ ë° ë©”íƒ€ë°ì´í„° ì„¤ì •
</span>                <span class="sh">"</span><span class="s">schema.history.internal.kafka.bootstrap.servers</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">kafka_bootstrap_servers</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">schema.history.internal.kafka.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">schema-changes.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include.schema.changes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">schema.name.adjustment.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">avro</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ìŠ¤ëƒ…ìƒ· ì„¤ì •
</span>                <span class="sh">"</span><span class="s">snapshot.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">initial</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.lock.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.delay.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># íŠ¸ëœì­ì…˜ ë©”íƒ€ë°ì´í„°
</span>                <span class="sh">"</span><span class="s">provide.transaction.metadata</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transaction.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">transactions.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># í•˜íŠ¸ë¹„íŠ¸ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">heartbeat.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">heartbeat.topics.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">heartbeats.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">mysql_server_config</span><span class="sh">"</span><span class="p">:</span> <span class="n">mysql_server_config</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">connector_config</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_config</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">setup_advanced_mysql_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">high_performance_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê³ ì„±ëŠ¥ MySQL ì»¤ë„¥í„° ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">advanced_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">mysql-high-perf-connector-</span><span class="si">{</span><span class="n">high_performance_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.mysql.MySqlConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_host</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_port</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_user</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mysql_password</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.server.id</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_id</span><span class="sh">"</span><span class="p">]),</span>
                <span class="sh">"</span><span class="s">topic.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_name</span><span class="sh">"</span><span class="p">],</span>
                
                <span class="c1"># ê³ ì„±ëŠ¥ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">binlog.buffer.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">65536</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8192</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">32768</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">100</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size.in.bytes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">104857600</span><span class="sh">"</span><span class="p">,</span>  <span class="c1"># 100MB
</span>                
                <span class="c1"># ë³‘ë ¬ ì²˜ë¦¬ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">tasks.max</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">high_performance_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">max_tasks</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span>
                <span class="sh">"</span><span class="s">database.connectionTimeZone</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">UTC</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ë©”ëª¨ë¦¬ ìµœì í™”
</span>                <span class="sh">"</span><span class="s">binlog.read.buffered.bytes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1048576</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">inconsistent.schema.handling.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">warn</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># í•„í„°ë§ ìµœì í™”
</span>                <span class="sh">"</span><span class="s">database.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">high_performance_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_databases</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">table.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">high_performance_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                
                <span class="c1"># ìŠ¤í‚¤ë§ˆ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">schema.history.internal.kafka.bootstrap.servers</span><span class="sh">"</span><span class="p">:</span> <span class="n">high_performance_config</span><span class="p">[</span><span class="sh">"</span><span class="s">kafka_bootstrap_servers</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">schema.history.internal.kafka.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">schema-changes.</span><span class="si">{</span><span class="n">high_performance_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include.schema.changes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># íŠ¸ëœì­ì…˜ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">provide.transaction.metadata</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transaction.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">transactions.</span><span class="si">{</span><span class="n">high_performance_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># í•˜íŠ¸ë¹„íŠ¸
</span>                <span class="sh">"</span><span class="s">heartbeat.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">heartbeat.topics.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">heartbeats.</span><span class="si">{</span><span class="n">high_performance_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">advanced_config</span>
</code></pre></div></div>

<h3 id="postgresql-ì»¤ë„¥í„°-ì„¤ì •">PostgreSQL ì»¤ë„¥í„° ì„¤ì •</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">PostgreSQLConnectorSetup</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config_templates</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_postgresql_connector</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">environment_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">PostgreSQL ì»¤ë„¥í„° ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="c1"># PostgreSQL ì„œë²„ ì„¤ì •
</span>        <span class="n">postgresql_server_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">wal_level</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">logical</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">max_wal_senders</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">max_replication_slots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">hot_standby</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">on</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="c1"># Debezium PostgreSQL ì»¤ë„¥í„° ì„¤ì •
</span>        <span class="n">connector_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">postgresql-connector-</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.postgresql.PostgresConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">database.hostname</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">postgres_host</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.port</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">postgres_port</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">postgres_user</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">postgres_password</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.dbname</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">database_name</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">database.server.name</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_name</span><span class="sh">"</span><span class="p">],</span>
                
                <span class="c1"># ë³µì œ ìŠ¬ë¡¯ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">database.slot.name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">debezium_</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">slot.drop.on.stop</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">slot.streaming.resume.lsn</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0/0</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># Publication ì„¤ì •
</span>                <span class="sh">"</span><span class="s">plugin.name</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">pgoutput</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">publication.name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">debezium_publication_</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">publication.autocreate.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">filtered</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ìŠ¤í‚¤ë§ˆ ë° í…Œì´ë¸” í•„í„°ë§
</span>                <span class="sh">"</span><span class="s">schema.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_schemas</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">table.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">schema.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">excluded_schemas</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">table.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">excluded_tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                
                <span class="c1"># ì„±ëŠ¥ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4096</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16384</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">500</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">status.update.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10000</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ìŠ¤í‚¤ë§ˆ íˆìŠ¤í† ë¦¬
</span>                <span class="sh">"</span><span class="s">schema.history.internal.kafka.bootstrap.servers</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">kafka_bootstrap_servers</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">schema.history.internal.kafka.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">schema-changes.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include.schema.changes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ìŠ¤ëƒ…ìƒ· ì„¤ì •
</span>                <span class="sh">"</span><span class="s">snapshot.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">initial</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.lock.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.delay.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.include.collection.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">snapshot_tables</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                
                <span class="c1"># íŠ¸ëœì­ì…˜ ë©”íƒ€ë°ì´í„°
</span>                <span class="sh">"</span><span class="s">provide.transaction.metadata</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transaction.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">transactions.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># í•˜íŠ¸ë¹„íŠ¸
</span>                <span class="sh">"</span><span class="s">heartbeat.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">heartbeat.topics.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">heartbeats.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ë°ì´í„° íƒ€ì… ë§¤í•‘
</span>                <span class="sh">"</span><span class="s">decimal.handling.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">precise</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">time.precision.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">adaptive</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">binary.handling.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">base64</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">postgresql_server_config</span><span class="sh">"</span><span class="p">:</span> <span class="n">postgresql_server_config</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">connector_config</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_config</span>
        <span class="p">}</span>
</code></pre></div></div>

<h3 id="mongodb-ì»¤ë„¥í„°-ì„¤ì •">MongoDB ì»¤ë„¥í„° ì„¤ì •</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MongoDBConnectorSetup</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config_templates</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_mongodb_connector</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">environment_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">MongoDB ì»¤ë„¥í„° ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="c1"># MongoDB ì„œë²„ ì„¤ì •
</span>        <span class="n">mongodb_server_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">replication</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">oplog_size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1GB</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">enable_majority_read_concern</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="c1"># Debezium MongoDB ì»¤ë„¥í„° ì„¤ì •
</span>        <span class="n">connector_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">name</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">mongodb-connector-</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">config</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">connector.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.connector.mongodb.MongoDbConnector</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">mongodb.hosts</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">mongodb_hosts</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">mongodb.name</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">server_name</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">mongodb.user</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">mongodb_user</span><span class="sh">"</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">mongodb.password</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">mongodb_password</span><span class="sh">"</span><span class="p">),</span>
                <span class="sh">"</span><span class="s">mongodb.ssl.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">ssl_enabled</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">),</span>
                
                <span class="c1"># ë°ì´í„°ë² ì´ìŠ¤ ë° ì»¬ë ‰ì…˜ í•„í„°ë§
</span>                <span class="sh">"</span><span class="s">database.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_databases</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">collection.include.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">included_collections</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">database.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">excluded_databases</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">collection.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">excluded_collections</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                
                <span class="c1"># ìº¡ì²˜ ëª¨ë“œ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">capture.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">change_streams_update_full</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">capture.scope</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">deployment</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ì„±ëŠ¥ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">max.batch.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2048</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8192</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">poll.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max.queue.size.in.bytes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">52428800</span><span class="sh">"</span><span class="p">,</span>  <span class="c1"># 50MB
</span>                
                <span class="c1"># ìŠ¤í‚¤ë§ˆ íˆìŠ¤í† ë¦¬
</span>                <span class="sh">"</span><span class="s">schema.history.internal.kafka.bootstrap.servers</span><span class="sh">"</span><span class="p">:</span> <span class="n">environment_config</span><span class="p">[</span><span class="sh">"</span><span class="s">kafka_bootstrap_servers</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">schema.history.internal.kafka.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">schema-changes.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include.schema.changes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># ìŠ¤ëƒ…ìƒ· ì„¤ì •
</span>                <span class="sh">"</span><span class="s">snapshot.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">initial</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">snapshot.delay.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># í•˜íŠ¸ë¹„íŠ¸
</span>                <span class="sh">"</span><span class="s">heartbeat.interval.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">heartbeat.topics.prefix</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">heartbeats.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># MongoDB íŠ¹í™” ì„¤ì •
</span>                <span class="sh">"</span><span class="s">connect.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">socket.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">server.selection.timeout.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30000</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">cursor.max.await.time.ms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000</span><span class="sh">"</span><span class="p">,</span>
                
                <span class="c1"># í•„ë“œ ì„¤ì •
</span>                <span class="sh">"</span><span class="s">field.renames</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">field_renames</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                <span class="sh">"</span><span class="s">field.exclude.list</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">environment_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">field_excludes</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
                
                <span class="c1"># íŠ¸ëœì­ì…˜ ë©”íƒ€ë°ì´í„°
</span>                <span class="sh">"</span><span class="s">provide.transaction.metadata</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">transaction.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">transactions.</span><span class="si">{</span><span class="n">environment_config</span><span class="p">[</span><span class="sh">'</span><span class="s">server_name</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">mongodb_server_config</span><span class="sh">"</span><span class="p">:</span> <span class="n">mongodb_server_config</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">connector_config</span><span class="sh">"</span><span class="p">:</span> <span class="n">connector_config</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="ìŠ¤í‚¤ë§ˆ-ì§„í™”ì™€-ìŠ¤í‚¤ë§ˆ-ë ˆì§€ìŠ¤íŠ¸ë¦¬">ğŸ“Š ìŠ¤í‚¤ë§ˆ ì§„í™”ì™€ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬</h2>

<h3 id="ìŠ¤í‚¤ë§ˆ-ì§„í™”-ê°œë…">ìŠ¤í‚¤ë§ˆ ì§„í™” ê°œë…</h3>

<p>ìŠ¤í‚¤ë§ˆ ì§„í™”ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆê°€ ì‹œê°„ì— ë”°ë¼ ë³€ê²½ë˜ë©´ì„œë„ ê¸°ì¡´ ë°ì´í„°ì™€ì˜ í˜¸í™˜ì„±ì„ ìœ ì§€í•˜ëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤. Debeziumì€ ìŠ¤í‚¤ë§ˆ ë³€ê²½ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ê³  Kafkaë¡œ ì „íŒŒí•©ë‹ˆë‹¤.</p>

<h4 id="ìŠ¤í‚¤ë§ˆ-ì§„í™”ì˜-ì¤‘ìš”ì„±">ìŠ¤í‚¤ë§ˆ ì§„í™”ì˜ ì¤‘ìš”ì„±</h4>

<ul>
  <li><strong>í•˜ìœ„ í˜¸í™˜ì„±</strong>: ê¸°ì¡´ ì†Œë¹„ìê°€ ìƒˆë¡œìš´ ìŠ¤í‚¤ë§ˆë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ</li>
  <li><strong>ìƒìœ„ í˜¸í™˜ì„±</strong>: ìƒˆë¡œìš´ ì†Œë¹„ìê°€ ê¸°ì¡´ ìŠ¤í‚¤ë§ˆë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆìŒ</li>
  <li><strong>ì ì§„ì  ë°°í¬</strong>: ì„œë¹„ìŠ¤ ì¤‘ë‹¨ ì—†ì´ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ê°€ëŠ¥</li>
  <li><strong>ë°ì´í„° ì¼ê´€ì„±</strong>: ë³€ê²½ ê³¼ì •ì—ì„œ ë°ì´í„° ì†ì‹¤ ë°©ì§€</li>
</ul>

<h3 id="ìŠ¤í‚¤ë§ˆ-ë ˆì§€ìŠ¤íŠ¸ë¦¬-í†µí•©">ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ í†µí•©</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SchemaRegistryIntegration</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">schema_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_confluent_schema_registry</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">registry_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Confluent Schema Registry ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">schema_registry_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">schema.registry.url</span><span class="sh">"</span><span class="p">:</span> <span class="n">registry_config</span><span class="p">[</span><span class="sh">"</span><span class="s">schema_registry_url</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">key.converter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.confluent.connect.avro.AvroConverter</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">key.converter.schema.registry.url</span><span class="sh">"</span><span class="p">:</span> <span class="n">registry_config</span><span class="p">[</span><span class="sh">"</span><span class="s">schema_registry_url</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">value.converter</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.confluent.connect.avro.AvroConverter</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">value.converter.schema.registry.url</span><span class="sh">"</span><span class="p">:</span> <span class="n">registry_config</span><span class="p">[</span><span class="sh">"</span><span class="s">schema_registry_url</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">value.converter.auto.register.schemas</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">value.converter.use.latest.version</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">unwrap</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.transforms.ExtractNewRecordState</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.drop.tombstones</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.delete.handling.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">drop</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.add.fields</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">op,ts_ms,source.ts_ms,source.db,source.table</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">schema_registry_config</span>
</code></pre></div></div>

<h3 id="ìŠ¤í‚¤ë§ˆ-ì§„í™”-ì‹œë‚˜ë¦¬ì˜¤">ìŠ¤í‚¤ë§ˆ ì§„í™” ì‹œë‚˜ë¦¬ì˜¤</h3>

<table>
  <thead>
    <tr>
      <th>ì‹œë‚˜ë¦¬ì˜¤</th>
      <th>ì„¤ëª…</th>
      <th>í˜¸í™˜ì„±</th>
      <th>ì²˜ë¦¬ ë°©ì‹</th>
      <th>ì˜ˆì‹œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì»¬ëŸ¼ ì¶”ê°€</strong></td>
      <td>ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€</td>
      <td>FORWARD</td>
      <td>ìƒˆë¡œìš´ ì»¬ëŸ¼ì€ null ë˜ëŠ” ê¸°ë³¸ê°’ìœ¼ë¡œ ì²˜ë¦¬</td>
      <td><code class="language-plaintext highlighter-rouge">ALTER TABLE users ADD COLUMN phone VARCHAR(20)</code></td>
    </tr>
    <tr>
      <td><strong>ì»¬ëŸ¼ ì‚­ì œ</strong></td>
      <td>ì»¬ëŸ¼ ì‚­ì œ</td>
      <td>BACKWARD</td>
      <td>ê¸°ì¡´ ë°ì´í„°ì—ì„œ í•´ë‹¹ ì»¬ëŸ¼ ì œê±°</td>
      <td><code class="language-plaintext highlighter-rouge">ALTER TABLE users DROP COLUMN old_field</code></td>
    </tr>
    <tr>
      <td><strong>ì»¬ëŸ¼ ì´ë¦„ ë³€ê²½</strong></td>
      <td>ì»¬ëŸ¼ ì´ë¦„ ë³€ê²½</td>
      <td>NONE</td>
      <td>ìƒˆë¡œìš´ ì»¬ëŸ¼ ì¶”ê°€ í›„ ê¸°ì¡´ ì»¬ëŸ¼ ì œê±°</td>
      <td><code class="language-plaintext highlighter-rouge">ALTER TABLE users RENAME COLUMN old_name TO new_name</code></td>
    </tr>
    <tr>
      <td><strong>ì»¬ëŸ¼ íƒ€ì… ë³€ê²½</strong></td>
      <td>ì»¬ëŸ¼ íƒ€ì… ë³€ê²½</td>
      <td>FORWARD_TRANSITIVE</td>
      <td>íƒ€ì… í˜¸í™˜ì„± í™•ì¸ í›„ ë³€í™˜</td>
      <td><code class="language-plaintext highlighter-rouge">ALTER TABLE users MODIFY COLUMN age INT</code></td>
    </tr>
    <tr>
      <td><strong>í…Œì´ë¸” ì¶”ê°€</strong></td>
      <td>ìƒˆë¡œìš´ í…Œì´ë¸” ì¶”ê°€</td>
      <td>FORWARD</td>
      <td>ìë™ìœ¼ë¡œ ìƒˆë¡œìš´ í† í”½ ìƒì„±</td>
      <td><code class="language-plaintext highlighter-rouge">CREATE TABLE new_table (...)</code></td>
    </tr>
    <tr>
      <td><strong>í…Œì´ë¸” ì‚­ì œ</strong></td>
      <td>í…Œì´ë¸” ì‚­ì œ</td>
      <td>BACKWARD</td>
      <td>ê¸°ì¡´ í† í”½ì€ ìœ ì§€í•˜ë˜ ìƒˆë¡œìš´ ì´ë²¤íŠ¸ ì¤‘ë‹¨</td>
      <td><code class="language-plaintext highlighter-rouge">DROP TABLE old_table</code></td>
    </tr>
  </tbody>
</table>

<h3 id="ìŠ¤í‚¤ë§ˆ-í˜¸í™˜ì„±-ì „ëµ">ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ì „ëµ</h3>

<table>
  <thead>
    <tr>
      <th>ì „ëµ</th>
      <th>ì„¤ëª…</th>
      <th>ì‚¬ìš© ì‚¬ë¡€</th>
      <th>í•„ë“œ ì¶”ê°€</th>
      <th>í•„ë“œ ì œê±°</th>
      <th>íƒ€ì… ë³€ê²½</th>
      <th>ì•ˆì „ì„±</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Backward Compatibility</strong></td>
      <td>ì´ì „ ë²„ì „ê³¼ í˜¸í™˜</td>
      <td>ì†Œë¹„ì ì—…ë°ì´íŠ¸ ì „ì— ìƒì‚°ì ì—…ë°ì´íŠ¸</td>
      <td>âœ… ì„ íƒì  í•„ë“œë§Œ</td>
      <td>âŒ ê¸ˆì§€</td>
      <td>âœ… í™•ì¥ ê°€ëŠ¥í•œ íƒ€ì…ë§Œ</td>
      <td>ë†’ìŒ</td>
    </tr>
    <tr>
      <td><strong>Forward Compatibility</strong></td>
      <td>ë¯¸ë˜ ë²„ì „ê³¼ í˜¸í™˜</td>
      <td>ìƒì‚°ì ì—…ë°ì´íŠ¸ ì „ì— ì†Œë¹„ì ì—…ë°ì´íŠ¸</td>
      <td>âŒ ê¸ˆì§€</td>
      <td>âœ… ì„ íƒì  í•„ë“œë§Œ</td>
      <td>âœ… ì¶•ì†Œ ê°€ëŠ¥í•œ íƒ€ì…ë§Œ</td>
      <td>ë†’ìŒ</td>
    </tr>
    <tr>
      <td><strong>Full Compatibility</strong></td>
      <td>ì–‘ë°©í–¥ í˜¸í™˜</td>
      <td>ê°€ì¥ ì•ˆì „í•œ ì „ëµ</td>
      <td>âœ… ì„ íƒì  í•„ë“œë§Œ</td>
      <td>âœ… ì„ íƒì  í•„ë“œë§Œ</td>
      <td>âœ… í˜¸í™˜ ê°€ëŠ¥í•œ íƒ€ì…ë§Œ</td>
      <td>ìµœê³ </td>
    </tr>
    <tr>
      <td><strong>No Compatibility</strong></td>
      <td>í˜¸í™˜ì„± ì—†ìŒ</td>
      <td>ê°œë°œ í™˜ê²½ ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜</td>
      <td>âœ… ëª¨ë“  ë³€ê²½ í—ˆìš©</td>
      <td>âœ… ëª¨ë“  ë³€ê²½ í—ˆìš©</td>
      <td>âœ… ëª¨ë“  ë³€ê²½ í—ˆìš©</td>
      <td>ë‚®ìŒ</td>
    </tr>
  </tbody>
</table>

<h3 id="schema-registry-í˜¸í™˜ì„±-ë ˆë²¨">Schema Registry í˜¸í™˜ì„± ë ˆë²¨</h3>

<table>
  <thead>
    <tr>
      <th>í˜¸í™˜ì„± ë ˆë²¨</th>
      <th>ì„¤ëª…</th>
      <th>ì‚¬ìš© ì‹œê¸°</th>
      <th>ì—…ë°ì´íŠ¸ ìˆœì„œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>BACKWARD</strong></td>
      <td>ì´ì „ ë²„ì „ê³¼ í˜¸í™˜</td>
      <td>ì†Œë¹„ì ì—…ë°ì´íŠ¸ ì „ì— ìƒì‚°ì ì—…ë°ì´íŠ¸</td>
      <td>ì†Œë¹„ì â†’ ìƒì‚°ì</td>
    </tr>
    <tr>
      <td><strong>FORWARD</strong></td>
      <td>ë¯¸ë˜ ë²„ì „ê³¼ í˜¸í™˜</td>
      <td>ìƒì‚°ì ì—…ë°ì´íŠ¸ ì „ì— ì†Œë¹„ì ì—…ë°ì´íŠ¸</td>
      <td>ìƒì‚°ì â†’ ì†Œë¹„ì</td>
    </tr>
    <tr>
      <td><strong>FULL</strong></td>
      <td>ì–‘ë°©í–¥ í˜¸í™˜</td>
      <td>ê°€ì¥ ì•ˆì „í•œ ì „ëµ</td>
      <td>ìˆœì„œ ë¬´ê´€</td>
    </tr>
    <tr>
      <td><strong>NONE</strong></td>
      <td>í˜¸í™˜ì„± ê²€ì‚¬ ì—†ìŒ</td>
      <td>ê°œë°œ í™˜ê²½ ë˜ëŠ” ë§ˆì´ê·¸ë ˆì´ì…˜</td>
      <td>ì œí•œ ì—†ìŒ</td>
    </tr>
  </tbody>
</table>

<h3 id="ìŠ¤í‚¤ë§ˆ-ê²€ì¦-ê·œì¹™">ìŠ¤í‚¤ë§ˆ ê²€ì¦ ê·œì¹™</h3>

<table>
  <thead>
    <tr>
      <th>ê·œì¹™</th>
      <th>ì„¤ëª…</th>
      <th>ì˜ˆì‹œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>í•„ë“œ ì¶”ê°€</strong></td>
      <td>ìƒˆ í•„ë“œëŠ” optionalì´ì–´ì•¼ í•¨</td>
      <td><code class="language-plaintext highlighter-rouge">"email": {"type": "string", "optional": true}</code></td>
    </tr>
    <tr>
      <td><strong>í•„ë“œ ì œê±°</strong></td>
      <td>ê¸°ì¡´ í•„ë“œ ì œê±° ì‹œ í˜¸í™˜ì„± í™•ì¸</td>
      <td>deprecated ë§ˆí‚¹ í›„ ë‹¨ê³„ì  ì œê±°</td>
    </tr>
    <tr>
      <td><strong>íƒ€ì… ë³€ê²½</strong></td>
      <td>íƒ€ì… ë³€ê²½ ì‹œ í˜¸í™˜ ê°€ëŠ¥í•œ íƒ€ì…ë§Œ í—ˆìš©</td>
      <td>int32 â†’ int64 (ê°€ëŠ¥), string â†’ int (ë¶ˆê°€ëŠ¥)</td>
    </tr>
    <tr>
      <td><strong>ê¸°ë³¸ê°’ ì„¤ì •</strong></td>
      <td>ìƒˆ í•„ë“œì— ì ì ˆí•œ ê¸°ë³¸ê°’ ì„¤ì •</td>
      <td><code class="language-plaintext highlighter-rouge">"default": null</code> ë˜ëŠ” ì ì ˆí•œ ê¸°ë³¸ê°’</td>
    </tr>
  </tbody>
</table>

<h3 id="ìŠ¤í‚¤ë§ˆ-ì§„í™”-ì „ëµ">ìŠ¤í‚¤ë§ˆ ì§„í™” ì „ëµ</h3>

<table>
  <thead>
    <tr>
      <th>ì „ëµ ìœ í˜•</th>
      <th>ì„¤ëª…</th>
      <th>ì˜ˆì‹œ</th>
      <th>ì²˜ë¦¬ ë°©ì‹</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Additive Changes</strong></td>
      <td>ì•ˆì „í•œ ë³€ê²½ (í˜¸í™˜ì„± ìœ ì§€)</td>
      <td>â€¢ ìƒˆë¡œìš´ optional í•„ë“œ ì¶”ê°€<br />â€¢ ìƒˆë¡œìš´ í…Œì´ë¸” ì¶”ê°€<br />â€¢ enum ê°’ ì¶”ê°€</td>
      <td>ì¦‰ì‹œ ì ìš© ê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>Breaking Changes</strong></td>
      <td>í˜¸í™˜ì„± íŒŒê´´ ë³€ê²½</td>
      <td>â€¢ í•„ìˆ˜ í•„ë“œ ì¶”ê°€<br />â€¢ í•„ë“œ íƒ€ì… ë³€ê²½<br />â€¢ í•„ë“œ ì‚­ì œ<br />â€¢ enum ê°’ ì œê±°</td>
      <td>ìƒˆë¡œìš´ ìŠ¤í‚¤ë§ˆ ë²„ì „ìœ¼ë¡œ ì²˜ë¦¬</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SchemaCompatibilityStrategies</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">implement_schema_compatibility_strategies</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ì „ëµ êµ¬í˜„</span><span class="sh">"""</span>
        
        <span class="c1"># Schema Registry ì„¤ì •
</span>        <span class="n">schema_registry_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">url</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">http://schema-registry:8081</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">compatibility_levels</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">BACKWARD</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì´ì „ ë²„ì „ê³¼ í˜¸í™˜ (ì†Œë¹„ì ë¨¼ì € ì—…ë°ì´íŠ¸)</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">FORWARD</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ë¯¸ë˜ ë²„ì „ê³¼ í˜¸í™˜ (ìƒì‚°ì ë¨¼ì € ì—…ë°ì´íŠ¸)</span><span class="sh">"</span><span class="p">,</span> 
                <span class="sh">"</span><span class="s">FULL</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì–‘ë°©í–¥ í˜¸í™˜ (ê°€ì¥ ì•ˆì „)</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">NONE</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">í˜¸í™˜ì„± ê²€ì‚¬ ì—†ìŒ (ê°œë°œ í™˜ê²½)</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">validation_rules</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">field_addition</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ìƒˆ í•„ë“œëŠ” optionalì´ì–´ì•¼ í•¨</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">field_removal</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ê¸°ì¡´ í•„ë“œ ì œê±° ì‹œ í˜¸í™˜ì„± í™•ì¸</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">type_changes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">íƒ€ì… ë³€ê²½ ì‹œ í˜¸í™˜ ê°€ëŠ¥í•œ íƒ€ì…ë§Œ í—ˆìš©</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">default_values</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ìƒˆ í•„ë“œì— ì ì ˆí•œ ê¸°ë³¸ê°’ ì„¤ì •</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">schema_registry_config</span>
    
    <span class="k">def</span> <span class="nf">validate_schema_compatibility</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">old_schema</span><span class="p">,</span> <span class="n">new_schema</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ê²€ì¦</span><span class="sh">"""</span>
        
        <span class="n">compatibility_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">is_compatible</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">compatibility_level</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">UNKNOWN</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">issues</span><span class="sh">"</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">"</span><span class="s">recommendations</span><span class="sh">"</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="c1"># í•„ë“œ ë³€ê²½ ê²€ì¦
</span>        <span class="n">old_fields</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">old_schema</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">keys</span><span class="p">())</span>
        <span class="n">new_fields</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">new_schema</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">keys</span><span class="p">())</span>
        
        <span class="c1"># ì¶”ê°€ëœ í•„ë“œ ê²€ì¦
</span>        <span class="n">added_fields</span> <span class="o">=</span> <span class="n">new_fields</span> <span class="o">-</span> <span class="n">old_fields</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">added_fields</span><span class="p">:</span>
            <span class="n">field_def</span> <span class="o">=</span> <span class="n">new_schema</span><span class="p">[</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">][</span><span class="n">field</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">field_def</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">optional</span><span class="sh">"</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">issues</span><span class="sh">"</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span>
                    <span class="sa">f</span><span class="sh">"</span><span class="s">ìƒˆ í•„ë“œ </span><span class="sh">'</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="sh">'</span><span class="s">ê°€ requiredì…ë‹ˆë‹¤. optionalë¡œ ë³€ê²½í•˜ì„¸ìš”.</span><span class="sh">"</span>
                <span class="p">)</span>
                <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">is_compatible</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c1"># ì œê±°ëœ í•„ë“œ ê²€ì¦
</span>        <span class="n">removed_fields</span> <span class="o">=</span> <span class="n">old_fields</span> <span class="o">-</span> <span class="n">new_fields</span>
        <span class="k">if</span> <span class="n">removed_fields</span><span class="p">:</span>
            <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">issues</span><span class="sh">"</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span>
                <span class="sa">f</span><span class="sh">"</span><span class="s">ì œê±°ëœ í•„ë“œ: </span><span class="si">{</span><span class="nf">list</span><span class="p">(</span><span class="n">removed_fields</span><span class="p">)</span><span class="si">}</span><span class="s">. ì´ëŠ” breaking changeì…ë‹ˆë‹¤.</span><span class="sh">"</span>
            <span class="p">)</span>
            <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">is_compatible</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c1"># íƒ€ì… ë³€ê²½ ê²€ì¦
</span>        <span class="n">common_fields</span> <span class="o">=</span> <span class="n">old_fields</span> <span class="o">&amp;</span> <span class="n">new_fields</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">common_fields</span><span class="p">:</span>
            <span class="n">old_type</span> <span class="o">=</span> <span class="n">old_schema</span><span class="p">[</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">][</span><span class="n">field</span><span class="p">].</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">new_type</span> <span class="o">=</span> <span class="n">new_schema</span><span class="p">[</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">][</span><span class="n">field</span><span class="p">].</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">old_type</span> <span class="o">!=</span> <span class="n">new_type</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="nf">_is_type_compatible</span><span class="p">(</span><span class="n">old_type</span><span class="p">,</span> <span class="n">new_type</span><span class="p">):</span>
                    <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">issues</span><span class="sh">"</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span>
                        <span class="sa">f</span><span class="sh">"</span><span class="s">í•„ë“œ </span><span class="sh">'</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="sh">'</span><span class="s"> íƒ€ì…ì´ </span><span class="si">{</span><span class="n">old_type</span><span class="si">}</span><span class="s">ì—ì„œ </span><span class="si">{</span><span class="n">new_type</span><span class="si">}</span><span class="s">ë¡œ ë³€ê²½ë¨</span><span class="sh">"</span>
                    <span class="p">)</span>
                    <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">is_compatible</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c1"># í˜¸í™˜ì„± ë ˆë²¨ ê²°ì •
</span>        <span class="k">if</span> <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">is_compatible</span><span class="sh">"</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">added_fields</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">removed_fields</span><span class="p">:</span>
                <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">compatibility_level</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">BACKWARD</span><span class="sh">"</span>
            <span class="k">elif</span> <span class="n">removed_fields</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">added_fields</span><span class="p">:</span>
                <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">compatibility_level</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">FORWARD</span><span class="sh">"</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">added_fields</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">removed_fields</span><span class="p">:</span>
                <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">compatibility_level</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">FULL</span><span class="sh">"</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">compatibility_level</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">NONE</span><span class="sh">"</span>
        
        <span class="c1"># ê¶Œì¥ì‚¬í•­ ìƒì„±
</span>        <span class="k">if</span> <span class="ow">not</span> <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">is_compatible</span><span class="sh">"</span><span class="p">]:</span>
            <span class="n">compatibility_results</span><span class="p">[</span><span class="sh">"</span><span class="s">recommendations</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">ìƒˆ í•„ë“œëŠ” optionalë¡œ ì„¤ì •í•˜ì„¸ìš”</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">í•„ë“œ ì œê±° ëŒ€ì‹  deprecated ë§ˆí‚¹ì„ ê³ ë ¤í•˜ì„¸ìš”</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">íƒ€ì… ë³€ê²½ ì‹œ í˜¸í™˜ ê°€ëŠ¥í•œ íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ì„¸ìš”</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">í•„ìš”ì‹œ ìƒˆë¡œìš´ ìŠ¤í‚¤ë§ˆ ë²„ì „ì„ ìƒì„±í•˜ì„¸ìš”</span><span class="sh">"</span>
            <span class="p">]</span>
        
        <span class="k">return</span> <span class="n">compatibility_results</span>
    
    <span class="k">def</span> <span class="nf">_is_type_compatible</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">old_type</span><span class="p">,</span> <span class="n">new_type</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒ€ì… í˜¸í™˜ì„± ê²€ì‚¬</span><span class="sh">"""</span>
        <span class="n">compatible_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">int32</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">int64</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">float</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">double</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">int64</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">float</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">double</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">float</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">double</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">string</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">bytes</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">bytes</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">string</span><span class="sh">"</span><span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">new_type</span> <span class="ow">in</span> <span class="n">compatible_types</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">old_type</span><span class="p">,</span> <span class="p">[])</span>
    
    <span class="k">def</span> <span class="nf">create_schema_evolution_plan</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">current_schema</span><span class="p">,</span> <span class="n">target_schema</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤í‚¤ë§ˆ ì§„í™” ê³„íš ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">evolution_plan</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">phases</span><span class="sh">"</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">"</span><span class="s">estimated_duration</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">unknown</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">risk_level</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">low</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="c1"># Phase 1: ì•ˆì „í•œ ë³€ê²½
</span>        <span class="n">safe_changes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">old_fields</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">current_schema</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">keys</span><span class="p">())</span>
        <span class="n">new_fields</span> <span class="o">=</span> <span class="nf">set</span><span class="p">(</span><span class="n">target_schema</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">,</span> <span class="p">{}).</span><span class="nf">keys</span><span class="p">())</span>
        
        <span class="n">added_fields</span> <span class="o">=</span> <span class="n">new_fields</span> <span class="o">-</span> <span class="n">old_fields</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">added_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">target_schema</span><span class="p">[</span><span class="sh">"</span><span class="s">fields</span><span class="sh">"</span><span class="p">][</span><span class="n">field</span><span class="p">].</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">optional</span><span class="sh">"</span><span class="p">,</span> <span class="bp">False</span><span class="p">):</span>
                <span class="n">safe_changes</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í•„ë“œ </span><span class="sh">'</span><span class="si">{</span><span class="n">field</span><span class="si">}</span><span class="sh">'</span><span class="s"> ì¶”ê°€ (optional)</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">safe_changes</span><span class="p">:</span>
            <span class="n">evolution_plan</span><span class="p">[</span><span class="sh">"</span><span class="s">phases</span><span class="sh">"</span><span class="p">].</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">phase</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">safe_changes</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì•ˆì „í•œ ë³€ê²½ (í˜¸í™˜ì„± ìœ ì§€)</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">changes</span><span class="sh">"</span><span class="p">:</span> <span class="n">safe_changes</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">duration</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1-2ì£¼</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="c1"># Phase 2: Breaking Changes (í•„ìš”ì‹œ)
</span>        <span class="n">breaking_changes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">removed_fields</span> <span class="o">=</span> <span class="n">old_fields</span> <span class="o">-</span> <span class="n">new_fields</span>
        <span class="k">if</span> <span class="n">removed_fields</span><span class="p">:</span>
            <span class="n">breaking_changes</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">í•„ë“œ ì œê±°: </span><span class="si">{</span><span class="nf">list</span><span class="p">(</span><span class="n">removed_fields</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">evolution_plan</span><span class="p">[</span><span class="sh">"</span><span class="s">risk_level</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">high</span><span class="sh">"</span>
        
        <span class="k">if</span> <span class="n">breaking_changes</span><span class="p">:</span>
            <span class="n">evolution_plan</span><span class="p">[</span><span class="sh">"</span><span class="s">phases</span><span class="sh">"</span><span class="p">].</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">phase</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">breaking_changes</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Breaking Changes (ìƒˆ ë²„ì „ í•„ìš”)</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">changes</span><span class="sh">"</span><span class="p">:</span> <span class="n">breaking_changes</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">duration</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2-4ì£¼</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">notes</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì†Œë¹„ì ì—…ë°ì´íŠ¸ í•„ìš”</span><span class="sh">"</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">evolution_plan</span>
</code></pre></div></div>

<h2 id="ì‹¤ì‹œê°„-ë°ì´í„°-ë³€í™˜ê³¼-ë¼ìš°íŒ…">ğŸ”„ ì‹¤ì‹œê°„ ë°ì´í„° ë³€í™˜ê³¼ ë¼ìš°íŒ…</h2>

<h3 id="ë°ì´í„°-ë³€í™˜-íŒŒì´í”„ë¼ì¸">ë°ì´í„° ë³€í™˜ íŒŒì´í”„ë¼ì¸</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DataTransformationPipeline</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">transformation_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_single_message_transform</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">transform_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Single Message Transform (SMT) ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">smt_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">transform_config</span><span class="p">[</span><span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">]),</span>
            
            <span class="c1"># ë ˆì½”ë“œ ì–¸ë˜í•‘
</span>            <span class="sh">"</span><span class="s">transforms.unwrap.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">io.debezium.transforms.ExtractNewRecordState</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.drop.tombstones</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.delete.handling.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">drop</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.add.fields</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">op,ts_ms,source.ts_ms,source.db,source.table</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.unwrap.add.headers</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">op,source.ts_ms</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># í•„ë“œ ì´ë¦„ ë³€í™˜
</span>            <span class="sh">"</span><span class="s">transforms.rename.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.ReplaceField$Value</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.rename.renames</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">,</span><span class="sh">"</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="n">transform_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">field_renames</span><span class="sh">"</span><span class="p">,</span> <span class="p">[])),</span>
            
            <span class="c1"># í† í”½ ë¼ìš°íŒ…
</span>            <span class="sh">"</span><span class="s">transforms.route.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.RegexRouter</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.route.regex</span><span class="sh">"</span><span class="p">:</span> <span class="n">transform_config</span><span class="p">[</span><span class="sh">"</span><span class="s">topic_regex</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">transforms.route.replacement</span><span class="sh">"</span><span class="p">:</span> <span class="n">transform_config</span><span class="p">[</span><span class="sh">"</span><span class="s">topic_replacement</span><span class="sh">"</span><span class="p">],</span>
            
            <span class="c1"># í•„í„°ë§
</span>            <span class="sh">"</span><span class="s">transforms.filter.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.Filter</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.filter.condition</span><span class="sh">"</span><span class="p">:</span> <span class="n">transform_config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">filter_condition</span><span class="sh">"</span><span class="p">,</span> <span class="sh">""</span><span class="p">),</span>
            
            <span class="c1"># í•„ë“œ ì¶”ê°€
</span>            <span class="sh">"</span><span class="s">transforms.addfield.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.InsertField$Value</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.addfield.static.field</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">processed_at</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.addfield.static.value</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">$(date:yyyy-MM-dd</span><span class="sh">'</span><span class="s">T</span><span class="sh">'</span><span class="s">HH:mm:ss</span><span class="sh">'</span><span class="s">Z</span><span class="sh">'</span><span class="s">)</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">smt_config</span>
    
    <span class="k">def</span> <span class="nf">implement_custom_transformation</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">custom_logic</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì»¤ìŠ¤í…€ ë³€í™˜ ë¡œì§ êµ¬í˜„</span><span class="sh">"""</span>
        
        <span class="n">custom_transform_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">transforms</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">custom</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.custom.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">com.company.debezium.CustomTransform</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">transforms.custom.config</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">business_rules</span><span class="sh">"</span><span class="p">:</span> <span class="n">custom_logic</span><span class="p">[</span><span class="sh">"</span><span class="s">business_rules</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">data_validation</span><span class="sh">"</span><span class="p">:</span> <span class="n">custom_logic</span><span class="p">[</span><span class="sh">"</span><span class="s">validation_rules</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">enrichment</span><span class="sh">"</span><span class="p">:</span> <span class="n">custom_logic</span><span class="p">[</span><span class="sh">"</span><span class="s">enrichment_config</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">masking</span><span class="sh">"</span><span class="p">:</span> <span class="n">custom_logic</span><span class="p">[</span><span class="sh">"</span><span class="s">masking_rules</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">custom_transform_config</span>
    
    <span class="k">def</span> <span class="nf">setup_topic_routing</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">routing_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í† í”½ ë¼ìš°íŒ… ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">routing_strategies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">database_based_routing</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ë°ì´í„°ë² ì´ìŠ¤ë³„ í† í”½ ë¶„ë¦¬</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">configuration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.route.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.RegexRouter</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.regex</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">([^.]+)</span><span class="se">\\</span><span class="s">.([^.]+)</span><span class="se">\\</span><span class="s">.([^.]+)</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.replacement</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">$1-$2-$3</span><span class="sh">"</span>
                <span class="p">},</span>
                <span class="sh">"</span><span class="s">result</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">server.database.table -&gt; server-database-table</span><span class="sh">"</span>
            <span class="p">},</span>
            
            <span class="sh">"</span><span class="s">table_based_routing</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">í…Œì´ë¸”ë³„ í† í”½ ë¶„ë¦¬</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">configuration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.route.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.kafka.connect.transforms.RegexRouter</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.regex</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">([^.]+)</span><span class="se">\\</span><span class="s">.([^.]+)</span><span class="se">\\</span><span class="s">.([^.]+)</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.replacement</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">$3</span><span class="sh">"</span>
                <span class="p">},</span>
                <span class="sh">"</span><span class="s">result</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">server.database.table -&gt; table</span><span class="sh">"</span>
            <span class="p">},</span>
            
            <span class="sh">"</span><span class="s">operation_based_routing</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì—°ì‚° íƒ€ì…ë³„ í† í”½ ë¶„ë¦¬</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">configuration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.route.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">com.company.debezium.OperationRouter</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.insert.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">inserts</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.update.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">updates</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.delete.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">deletes</span><span class="sh">"</span>
                <span class="p">},</span>
                <span class="sh">"</span><span class="s">result</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">INSERT -&gt; inserts, UPDATE -&gt; updates, DELETE -&gt; deletes</span><span class="sh">"</span>
            <span class="p">},</span>
            
            <span class="sh">"</span><span class="s">conditional_routing</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì¡°ê±´ë¶€ í† í”½ ë¼ìš°íŒ…</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">configuration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.route.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">com.company.debezium.ConditionalRouter</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.route.conditions</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="sh">"</span><span class="s">high_priority</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">priority == </span><span class="sh">'</span><span class="s">HIGH</span><span class="sh">'"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">low_priority</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">priority == </span><span class="sh">'</span><span class="s">LOW</span><span class="sh">'"</span>
                    <span class="p">},</span>
                    <span class="sh">"</span><span class="s">transforms.route.default.topic</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">normal</span><span class="sh">"</span>
                <span class="p">},</span>
                <span class="sh">"</span><span class="s">result</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì¡°ê±´ì— ë”°ë¥¸ ë™ì  í† í”½ ë¼ìš°íŒ…</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">routing_strategies</span><span class="p">[</span><span class="n">routing_config</span><span class="p">[</span><span class="sh">"</span><span class="s">strategy</span><span class="sh">"</span><span class="p">]]</span>
    
    <span class="k">def</span> <span class="nf">implement_data_enrichment</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">enrichment_config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°ì´í„° í’ë¶€í™” êµ¬í˜„</span><span class="sh">"""</span>
        
        <span class="n">enrichment_pipeline</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">lookup_enrichment</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤ ì¡°íšŒ</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">implementation</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.enrich.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">com.company.debezium.LookupTransform</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.enrich.lookup.source</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">redis</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.enrich.lookup.key.field</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">user_id</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.enrich.lookup.value.fields</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">user_name,user_email,user_role</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            
            <span class="sh">"</span><span class="s">calculation_enrichment</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ê³„ì‚°ëœ í•„ë“œ ì¶”ê°€</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">implementation</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.calc.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">com.company.debezium.CalculationTransform</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.calc.formulas</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                        <span class="sh">"</span><span class="s">total_amount</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">price * quantity</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">discount_amount</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">total_amount * discount_rate</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">final_amount</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">total_amount - discount_amount</span><span class="sh">"</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
            
            <span class="sh">"</span><span class="s">geolocation_enrichment</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">description</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ì§€ë¦¬ì  ì •ë³´ í’ë¶€í™”</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">implementation</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">transforms.geo.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">com.company.debezium.GeolocationTransform</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.geo.latitude.field</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">lat</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.geo.longitude.field</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">lng</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">transforms.geo.output.fields</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">country,region,city,timezone</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">enrichment_pipeline</span>
</code></pre></div></div>

<h2 id="ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì‹¤ì‹œê°„-ë°ì´í„°-ë™ê¸°í™”-ì‹œìŠ¤í…œ">ğŸš€ ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œ</h2>

<h3 id="í”„ë¡œì íŠ¸-ê°œìš”">í”„ë¡œì íŠ¸ ê°œìš”</h3>

<p>ëŒ€ê·œëª¨ ì´ì»¤ë¨¸ìŠ¤ í”Œë«í¼ì„ ìœ„í•œ ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤. MySQL ì£¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ìº¡ì²˜í•˜ì—¬ Elasticsearch ê²€ìƒ‰ ì—”ì§„, Redis ìºì‹œ, ê·¸ë¦¬ê³  ë°ì´í„° ë ˆì´í¬ë¡œ ë™ê¸°í™”í•©ë‹ˆë‹¤.</p>

<h4 id="í”„ë¡œì íŠ¸-ëª©í‘œ">í”„ë¡œì íŠ¸ ëª©í‘œ</h4>

<ul>
  <li><strong>ì‹¤ì‹œê°„ ê²€ìƒ‰</strong>: ì£¼ë¬¸ ë°ì´í„° ë³€ê²½ì‚¬í•­ì„ ì¦‰ì‹œ Elasticsearchì— ë°˜ì˜</li>
  <li><strong>ìºì‹œ ë™ê¸°í™”</strong>: Redis ìºì‹œì˜ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ë¡œ ì‘ë‹µ ì†ë„ í–¥ìƒ</li>
  <li><strong>ë°ì´í„° ë ˆì´í¬</strong>: ë¶„ì„ìš© ë°ì´í„°ë¥¼ Parquet í˜•íƒœë¡œ ì €ì¥</li>
  <li><strong>ëª¨ë‹ˆí„°ë§</strong>: ì „ì²´ íŒŒì´í”„ë¼ì¸ì˜ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼</li>
</ul>

<h4 id="ê¸°ìˆ ì -ë„ì „ê³¼ì œ">ê¸°ìˆ ì  ë„ì „ê³¼ì œ</h4>

<ul>
  <li><strong>ëŒ€ìš©ëŸ‰ ì²˜ë¦¬</strong>: ì¼ì¼ 100ë§Œ ê±´ ì´ìƒì˜ ì£¼ë¬¸ ì²˜ë¦¬</li>
  <li><strong>ë‚®ì€ ì§€ì—°ì‹œê°„</strong>: 5ì´ˆ ì´ë‚´ì˜ ë°ì´í„° ë™ê¸°í™”</li>
  <li><strong>ê³ ê°€ìš©ì„±</strong>: 99.9% ì´ìƒì˜ ì‹œìŠ¤í…œ ê°€ìš©ì„±</li>
  <li><strong>ë°ì´í„° ì¼ê´€ì„±</strong>: ëª¨ë“  ì‹œìŠ¤í…œ ê°„ì˜ ë°ì´í„° ì¼ê´€ì„± ë³´ì¥</li>
</ul>

<h3 id="1-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜">1. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h3>

<h4 id="ì†ŒìŠ¤-ë°ì´í„°ë² ì´ìŠ¤">ì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤</h4>

<table>
  <thead>
    <tr>
      <th>ë°ì´í„°ë² ì´ìŠ¤</th>
      <th>ìš©ë„</th>
      <th>í…Œì´ë¸”</th>
      <th>ì¼ì¼ ë³¼ë¥¨</th>
      <th>ì§€ì—°ì‹œê°„ ìš”êµ¬ì‚¬í•­</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>MySQL Orders</strong></td>
      <td>ì£¼ë¬¸ ë°ì´í„° ì €ì¥</td>
      <td>orders, order_items, customers, products</td>
      <td>1M íŠ¸ëœì­ì…˜</td>
      <td>&lt; 5ì´ˆ</td>
    </tr>
    <tr>
      <td><strong>MySQL Inventory</strong></td>
      <td>ì¬ê³  ë°ì´í„° ì €ì¥</td>
      <td>inventory, warehouses, stock_movements</td>
      <td>500K ì—…ë°ì´íŠ¸</td>
      <td>&lt; 1ì´ˆ</td>
    </tr>
  </tbody>
</table>

<h4 id="kafka-í´ëŸ¬ìŠ¤í„°-êµ¬ì„±">Kafka í´ëŸ¬ìŠ¤í„° êµ¬ì„±</h4>

<table>
  <thead>
    <tr>
      <th>êµ¬ì„± ìš”ì†Œ</th>
      <th>ì„¤ì •ê°’</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë¸Œë¡œì»¤ ìˆ˜</strong></td>
      <td>3ê°œ</td>
      <td>ê³ ê°€ìš©ì„± ë³´ì¥</td>
    </tr>
    <tr>
      <td><strong>íŒŒí‹°ì…˜ ìˆ˜</strong></td>
      <td>12ê°œ</td>
      <td>ë³‘ë ¬ ì²˜ë¦¬ ì„±ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>ë°ì´í„° ë³´ê´€</strong></td>
      <td>7ì¼</td>
      <td>ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ë³´ê´€</td>
    </tr>
    <tr>
      <td><strong>í† í”½</strong></td>
      <td>4ê°œ</td>
      <td>ì£¼ë¬¸, ì•„ì´í…œ, ê³ ê°, ì¬ê³  ì´ë²¤íŠ¸</td>
    </tr>
  </tbody>
</table>

<h4 id="ëŒ€ìƒ-ì‹œìŠ¤í…œ">ëŒ€ìƒ ì‹œìŠ¤í…œ</h4>

<table>
  <thead>
    <tr>
      <th>ì‹œìŠ¤í…œ</th>
      <th>ìš©ë„</th>
      <th>ì¸ë±ìŠ¤/ë°ì´í„° íƒ€ì…</th>
      <th>ì—…ë°ì´íŠ¸ ë¹ˆë„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Elasticsearch</strong></td>
      <td>ì‹¤ì‹œê°„ ê²€ìƒ‰ ë° ë¶„ì„</td>
      <td>orders, customers, products</td>
      <td>ì‹¤ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>Redis</strong></td>
      <td>ìºì‹œ ë° ì„¸ì…˜ ì €ì¥</td>
      <td>customer_sessions, product_cache</td>
      <td>ì‹¤ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>Data Lake</strong></td>
      <td>ë°ì´í„° ë¶„ì„ ë° ML</td>
      <td>Parquet í˜•ì‹</td>
      <td>ì‹œê°„ë³„ ë°°ì¹˜</td>
    </tr>
  </tbody>
</table>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RealTimeDataSyncSystem</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">components</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data_flows</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">design_system_architecture</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì„¤ê³„</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">source_databases</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">mysql_orders</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">mysql_inventory</span><span class="sh">"</span><span class="p">],</span>
            <span class="sh">"</span><span class="s">kafka_cluster</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span><span class="sh">"</span><span class="s">brokers</span><span class="sh">"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="sh">"</span><span class="s">partitions</span><span class="sh">"</span><span class="p">:</span> <span class="mi">12</span><span class="p">},</span>
            <span class="sh">"</span><span class="s">target_systems</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">elasticsearch</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">redis</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">data_lake</span><span class="sh">"</span><span class="p">]</span>
        <span class="p">}</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def implement_order_sync_pipeline(self):
    """ì£¼ë¬¸ ë™ê¸°í™” íŒŒì´í”„ë¼ì¸ êµ¬í˜„"""
    
    # MySQL ì£¼ë¬¸ ë°ì´í„°ë² ì´ìŠ¤ ì»¤ë„¥í„°
    orders_connector_config = {
        "name": "mysql-orders-connector",
        "config": {
            "connector.class": "io.debezium.connector.mysql.MySqlConnector",
            "database.hostname": "mysql-orders-cluster",
            "database.port": "3306",
            "database.user": "debezium_user",
            "database.password": "secure_password",
            "database.server.id": "184054",
            "topic.prefix": "orders.ecommerce",
            
            # í…Œì´ë¸” í•„í„°ë§
            "table.include.list": "ecommerce.orders,ecommerce.order_items,ecommerce.customers",
            "database.include.list": "ecommerce",
            
            # ì„±ëŠ¥ ìµœì í™”
            "binlog.buffer.size": "32768",
            "max.batch.size": "4096",
            "max.queue.size": "16384",
            "poll.interval.ms": "100",
            
            # ìŠ¤í‚¤ë§ˆ ì„¤ì •
            "schema.history.internal.kafka.bootstrap.servers": "kafka:9092",
            "schema.history.internal.kafka.topic": "schema-changes.orders.ecommerce",
            "include.schema.changes": "true",
            
            # ë°ì´í„° ë³€í™˜
            "transforms": "unwrap,route,addTimestamp",
            "transforms.unwrap.type": "io.debezium.transforms.ExtractNewRecordState",
            "transforms.unwrap.drop.tombstones": "false",
            "transforms.unwrap.delete.handling.mode": "drop",
            "transforms.unwrap.add.fields": "op,ts_ms,source.ts_ms",
            
            # í† í”½ ë¼ìš°íŒ…
            "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
            "transforms.route.regex": "orders\\.ecommerce\\.([^.]+)",
            "transforms.route.replacement": "orders.$1",
            
            # íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€
            "transforms.addTimestamp.type": "org.apache.kafka.connect.transforms.InsertField$Value",
            "transforms.addTimestamp.static.field": "processed_at",
            "transforms.addTimestamp.static.value": "$(date:yyyy-MM-dd'T'HH:mm:ss'Z')",
            
            # íŠ¸ëœì­ì…˜ ë©”íƒ€ë°ì´í„°
            "provide.transaction.metadata": "true",
            "transaction.topic": "transactions.orders.ecommerce"
        }
    }
    
    return orders_connector_config

def implement_elasticsearch_sink(self):
    """Elasticsearch ì‹±í¬ êµ¬í˜„"""
    
    elasticsearch_sink_config = {
        "name": "elasticsearch-orders-sink",
        "config": {
            "connector.class": "io.confluent.connect.elasticsearch.ElasticsearchSinkConnector",
            "topics": "orders.orders,orders.order_items,orders.customers",
            "connection.url": "http://elasticsearch-cluster:9200",
            
            # ì¸ë±ìŠ¤ ì„¤ì •
            "type.name": "_doc",
            "key.ignore": "false",
            "schema.ignore": "true",
            
            # ì„±ëŠ¥ ì„¤ì •
            "batch.size": "1000",
            "max.in.flight.requests": "5",
            "flush.timeout.ms": "30000",
            "max.retries": "3",
            "retry.backoff.ms": "1000",
            
            # ì¸ë±ìŠ¤ ë§¤í•‘
            "transforms": "route,addTimestamp",
            "transforms.route.type": "org.apache.kafka.connect.transforms.RegexRouter",
            "transforms.route.regex": "orders\\.([^.]+)",
            "transforms.route.replacement": "$1-index",
            
            # íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€
            "transforms.addTimestamp.type": "org.apache.kafka.connect.transforms.InsertField$Value",
            "transforms.addTimestamp.static.field": "indexed_at",
            "transforms.addTimestamp.static.value": "$(date:yyyy-MM-dd'T'HH:mm:ss'Z')",
            
            # ì—ëŸ¬ ì²˜ë¦¬
            "errors.tolerance": "all",
            "errors.log.enable": "true",
            "errors.log.include.messages": "true"
        }
    }
    
    return elasticsearch_sink_config

def implement_redis_sink(self):
    """Redis ì‹±í¬ êµ¬í˜„"""
    
    redis_sink_config = {
        "name": "redis-cache-sink",
        "config": {
            "connector.class": "com.company.connect.redis.RedisSinkConnector",
            "topics": "orders.customers,orders.products",
            "redis.hosts": "redis-cluster:6379",
            "redis.password": "redis_password",
            
            # ë°ì´í„° ë§¤í•‘
            "key.converter": "org.apache.kafka.connect.storage.StringConverter",
            "value.converter": "org.apache.kafka.connect.json.JsonConverter",
            "value.converter.schemas.enable": "false",
            
            # ìºì‹œ ì „ëµ
            "cache.strategy": "write_through",
            "cache.ttl": "3600",  # 1 hour
            "cache.key.field": "id",
            "cache.prefix": "cache:",
            
            # ì„±ëŠ¥ ì„¤ì •
            "batch.size": "500",
            "flush.timeout.ms": "10000",
            "max.retries": "3",
            
            # ë°ì´í„° ë³€í™˜
            "transforms": "extractKey,addMetadata",
            "transforms.extractKey.type": "org.apache.kafka.connect.transforms.ExtractField$Key",
            "transforms.extractKey.field": "id",
            
            "transforms.addMetadata.type": "org.apache.kafka.connect.transforms.InsertField$Value",
            "transforms.addMetadata.static.field": "cached_at",
            "transforms.addMetadata.static.value": "$(date:yyyy-MM-dd'T'HH:mm:ss'Z')"
        }
    }
    
    return redis_sink_config

def implement_data_lake_sink(self):
    """ë°ì´í„° ë ˆì´í¬ ì‹±í¬ êµ¬í˜„"""
    
    data_lake_sink_config = {
        "name": "s3-data-lake-sink",
        "config": {
            "connector.class": "io.confluent.connect.s3.S3SinkConnector",
            "topics": "orders.orders,orders.order_items,orders.customers",
            "s3.bucket.name": "ecommerce-data-lake",
            "s3.region": "us-west-2",
            "s3.part.size": "5242880",  # 5MB
            "flush.size": "10000",
            "rotate.interval.ms": "3600000",  # 1 hour
            
            # íŒŒì¼ í¬ë§·
            "format.class": "io.confluent.connect.s3.format.parquet.ParquetFormat",
            "parquet.compression.codec": "snappy",
            
            # íŒŒí‹°ì…”ë‹
            "partitioner.class": "io.confluent.connect.storage.partitioner.TimeBasedPartitioner",
            "partition.duration.ms": "3600000",  # 1 hour
            "path.format": "YYYY/MM/dd/HH",
            "locale": "en_US",
            "timezone": "UTC",
            
            # ìŠ¤í‚¤ë§ˆ ì§„í™”
            "schema.compatibility": "BACKWARD",
            "value.converter": "io.confluent.connect.avro.AvroConverter",
            "value.converter.schema.registry.url": "http://schema-registry:8081",
            
            # ì—ëŸ¬ ì²˜ë¦¬
            "errors.tolerance": "all",
            "errors.log.enable": "true"
        }
    }
    
    return data_lake_sink_config

def setup_monitoring_and_alerting(self):
    """ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼ ì„¤ì •"""
    
    monitoring_config = {
        "kafka_connect_metrics": {
            "connector_status": "RUNNING, PAUSED, FAILED",
            "task_status": "RUNNING, FAILED, UNASSIGNED",
            "throughput_metrics": "records_per_second, bytes_per_second",
            "latency_metrics": "offset_lag, consumer_lag"
        },
        
        "debezium_metrics": {
            "binlog_position": "MySQL binlog position tracking",
            "snapshot_progress": "Initial snapshot progress",
            "transaction_metrics": "Transaction processing metrics",
            "error_metrics": "Error counts and types"
        },
        
        "alerting_rules": {
            "connector_failure": {
                "condition": "connector_status == 'FAILED'",
                "severity": "critical",
                "notification": ["slack", "email", "pagerduty"]
            },
            
            "high_latency": {
                "condition": "offset_lag &gt; 10000",
                "severity": "warning",
                "notification": ["slack", "email"]
            },
            
            "low_throughput": {
                "condition": "records_per_second &lt; 100",
                "severity": "warning",
                "notification": ["slack"]
            },
            
            "snapshot_stalled": {
                "condition": "snapshot_progress_stalled &gt; 10min",
                "severity": "warning",
                "notification": ["slack", "email"]
            }
        },
        
        "dashboard_metrics": {
            "system_overview": [
                "Total connectors running",
                "Total records processed",
                "Average processing latency",
                "Error rate percentage"
            ],
            
            "per_connector_metrics": [
                "Records per second",
                "Bytes per second",
                "Offset lag",
                "Last processed timestamp"
            ],
            
            "target_system_health": [
                "Elasticsearch indexing rate",
                "Redis cache hit rate",
                "S3 upload success rate"
            ]
        }
    }
    
    return monitoring_config ```
</code></pre></div></div>

<h3 id="2-ì‹œìŠ¤í…œ-ë°°í¬-ë°-ì‹¤í–‰">2. ì‹œìŠ¤í…œ ë°°í¬ ë° ì‹¤í–‰</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">deploy_realtime_sync_system</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">ì‹¤ì‹œê°„ ë™ê¸°í™” ì‹œìŠ¤í…œ ë°°í¬</span><span class="sh">"""</span>
    <span class="n">sync_system</span> <span class="o">=</span> <span class="nc">RealTimeDataSyncSystem</span><span class="p">()</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ğŸš€ Starting Real-time Data Sync System Deployment...</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 1. ì•„í‚¤í…ì²˜ ì„¤ê³„
</span>    <span class="n">architecture</span> <span class="o">=</span> <span class="n">sync_system</span><span class="p">.</span><span class="nf">design_system_architecture</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… System architecture designed</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 2. ì»¤ë„¥í„° ì„¤ì •
</span>    <span class="n">orders_connector</span> <span class="o">=</span> <span class="n">sync_system</span><span class="p">.</span><span class="nf">implement_order_sync_pipeline</span><span class="p">()</span>
    <span class="n">elasticsearch_sink</span> <span class="o">=</span> <span class="n">sync_system</span><span class="p">.</span><span class="nf">implement_elasticsearch_sink</span><span class="p">()</span>
    <span class="n">redis_sink</span> <span class="o">=</span> <span class="n">sync_system</span><span class="p">.</span><span class="nf">implement_redis_sink</span><span class="p">()</span>
    <span class="n">data_lake_sink</span> <span class="o">=</span> <span class="n">sync_system</span><span class="p">.</span><span class="nf">implement_data_lake_sink</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… Connector configurations created</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 3. ëª¨ë‹ˆí„°ë§ ì„¤ì •
</span>    <span class="n">monitoring</span> <span class="o">=</span> <span class="n">sync_system</span><span class="p">.</span><span class="nf">setup_monitoring_and_alerting</span><span class="p">()</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… Monitoring and alerting configured</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 4. ë°°í¬ ê²€ì¦
</span>    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… System deployment completed successfully!</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="p">{</span>
        <span class="sh">"</span><span class="s">architecture</span><span class="sh">"</span><span class="p">:</span> <span class="n">architecture</span><span class="p">,</span>
        <span class="sh">"</span><span class="s">connectors</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">orders_source</span><span class="sh">"</span><span class="p">:</span> <span class="n">orders_connector</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">elasticsearch_sink</span><span class="sh">"</span><span class="p">:</span> <span class="n">elasticsearch_sink</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">redis_sink</span><span class="sh">"</span><span class="p">:</span> <span class="n">redis_sink</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">data_lake_sink</span><span class="sh">"</span><span class="p">:</span> <span class="n">data_lake_sink</span>
        <span class="p">},</span>
        <span class="sh">"</span><span class="s">monitoring</span><span class="sh">"</span><span class="p">:</span> <span class="n">monitoring</span>
    <span class="p">}</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">system</span> <span class="o">=</span> <span class="nf">deploy_realtime_sync_system</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="ì´ë²ˆ-íŒŒíŠ¸ì—ì„œ-í•™ìŠµí•œ-ë‚´ìš©">ì´ë²ˆ íŒŒíŠ¸ì—ì„œ í•™ìŠµí•œ ë‚´ìš©</h3>

<ol>
  <li><strong>Change Data Capture ê¸°ì´ˆ ê°œë…</strong>
    <ul>
      <li>CDCì˜ ê°œë…ê³¼ í•„ìš”ì„±</li>
      <li>ë°°ì¹˜ ì²˜ë¦¬ vs CDC ë°©ì‹ ë¹„êµ</li>
      <li>ì£¼ìš” CDC ë„êµ¬ë“¤ ë¹„êµ (Debezium, Kafka Connect, Maxwell, AWS DMS)</li>
      <li>CDC ë„ì… ROI ê³„ì‚°</li>
    </ul>
  </li>
  <li><strong>Debezium ì•„í‚¤í…ì²˜ì™€ í•µì‹¬ ê¸°ëŠ¥</strong>
    <ul>
      <li>Debezium ì•„í‚¤í…ì²˜ ì´í•´</li>
      <li>ë°ì´í„°ë² ì´ìŠ¤ë³„ ë³€ê²½ ê°ì§€ ë©”ì»¤ë‹ˆì¦˜</li>
      <li>ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° íŒ¨í„´ (ì´ë²¤íŠ¸ ì†Œì‹±, CQRS, Saga)</li>
    </ul>
  </li>
  <li><strong>Debezium ì»¤ë„¥í„° ì„¤ì •ê³¼ ìš´ì˜</strong>
    <ul>
      <li>MySQL ì»¤ë„¥í„° ê³ ê¸‰ ì„¤ì •</li>
      <li>PostgreSQL ì»¤ë„¥í„° ì„¤ì •</li>
      <li>MongoDB ì»¤ë„¥í„° ì„¤ì •</li>
      <li>ì„±ëŠ¥ ìµœì í™” ì „ëµ</li>
    </ul>
  </li>
  <li><strong>ìŠ¤í‚¤ë§ˆ ì§„í™”ì™€ ìŠ¤í‚¤ë§ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬</strong>
    <ul>
      <li>ìŠ¤í‚¤ë§ˆ ì§„í™” ê°œë…ê³¼ ì‹œë‚˜ë¦¬ì˜¤</li>
      <li>Confluent Schema Registry í†µí•©</li>
      <li>ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ì „ëµ</li>
    </ul>
  </li>
  <li><strong>ì‹¤ì‹œê°„ ë°ì´í„° ë³€í™˜ê³¼ ë¼ìš°íŒ…</strong>
    <ul>
      <li>Single Message Transform (SMT) í™œìš©</li>
      <li>ì»¤ìŠ¤í…€ ë³€í™˜ ë¡œì§ êµ¬í˜„</li>
      <li>í† í”½ ë¼ìš°íŒ… ì „ëµ</li>
      <li>ë°ì´í„° í’ë¶€í™” êµ¬í˜„</li>
    </ul>
  </li>
  <li><strong>ì‹¤ë¬´ í”„ë¡œì íŠ¸</strong>
    <ul>
      <li>ëŒ€ê·œëª¨ ì´ì»¤ë¨¸ìŠ¤ í”Œë«í¼ ì‹¤ì‹œê°„ ë™ê¸°í™” ì‹œìŠ¤í…œ</li>
      <li>MySQL â†’ Elasticsearch/Redis/Data Lake íŒŒì´í”„ë¼ì¸</li>
      <li>ëª¨ë‹ˆí„°ë§ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œ</li>
    </ul>
  </li>
</ol>

<h3 id="í•µì‹¬-ê¸°ìˆ -ìŠ¤íƒ">í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ</h3>

<table>
  <thead>
    <tr>
      <th>ê¸°ìˆ </th>
      <th>ìš©ë„</th>
      <th>ì¤‘ìš”ë„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Debezium</strong></td>
      <td>CDC í”Œë«í¼</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>Apache Kafka</strong></td>
      <td>ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>Kafka Connect</strong></td>
      <td>ì»¤ë„¥í„° í”„ë ˆì„ì›Œí¬</td>
      <td>â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>Schema Registry</strong></td>
      <td>ìŠ¤í‚¤ë§ˆ ê´€ë¦¬</td>
      <td>â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>Elasticsearch</strong></td>
      <td>ê²€ìƒ‰ ì—”ì§„</td>
      <td>â­â­â­â­</td>
    </tr>
  </tbody>
</table>

<h3 id="ë‹¤ìŒ-íŒŒíŠ¸-ì˜ˆê³ ">ë‹¤ìŒ íŒŒíŠ¸ ì˜ˆê³ </h3>

<p><strong>Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜</strong>ì—ì„œëŠ”:</p>
<ul>
  <li>Kafka Connect ê³ ê¸‰ ì•„í‚¤í…ì²˜ì™€ í™•ì¥ì„±</li>
  <li>ì»¤ìŠ¤í…€ ì»¤ë„¥í„° ê°œë°œ</li>
  <li>ëŒ€ê·œëª¨ CDC íŒŒì´í”„ë¼ì¸ ìš´ì˜ ì „ëµ</li>
  <li>ì„±ëŠ¥ ìµœì í™”ì™€ ë³‘ëª© í•´ê²°</li>
  <li>ë°ì´í„° ì¼ê´€ì„± ë³´ì¥ê³¼ ê²€ì¦</li>
  <li>ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµ</li>
  <li>ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ CDC ìš´ì˜ ì‹œìŠ¤í…œ êµ¬ì¶•</li>
</ul>

<hr />

<p><strong>ì‹œë¦¬ì¦ˆ ì§„í–‰</strong>: <a href="/data-engineering/2025/09/19/change-data-capture-debezium-guide.html">Change Data Capture ì™„ì „ ì •ë³µ ì‹œë¦¬ì¦ˆ</a></p>

<hr />

<p><em>ì‹¤ì‹œê°„ ë°ì´í„° ë™ê¸°í™”ì˜ í˜ìœ¼ë¡œ í˜„ëŒ€ì ì¸ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ ì•„í‚¤í…ì²˜ë¥¼ êµ¬ì¶•í•˜ì„¸ìš”!</em> ğŸš€</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
          
          
      
      
      
      
        
        
        <a href="/data-engineering/2025/09/20/kafka-connect-production-cdc-operations.html" class="nav-link next">
          ë‹¤ìŒ: Part 2: Kafka Connectì™€ í”„ë¡œë•ì…˜ CDC ìš´ì˜ - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ â†’
        </a>
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="Apache Flinkë¥¼ Kubernetesì—ì„œ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•˜ê³ , ì„±ëŠ¥ì„ ìµœì í™”í•˜ë©°, ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµì„ êµ¬í˜„í•˜ëŠ” ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">



<title>Part 4: Apache Flink í”„ë¡œë•ì…˜ ë°°í¬ì™€ ì„±ëŠ¥ ìµœì í™” - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ìš´ì˜ì˜ ì™„ì„± - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 4: Apache Flink í”„ë¡œë•ì…˜ ë°°í¬ì™€ ì„±ëŠ¥ ìµœì í™” - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ìš´ì˜ì˜ ì™„ì„±">
<meta property="og:description" content="Apache Flinkë¥¼ Kubernetesì—ì„œ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•˜ê³ , ì„±ëŠ¥ì„ ìµœì í™”í•˜ë©°, ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµì„ êµ¬í˜„í•˜ëŠ” ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">
<meta property="og:url" content="http://localhost:4000/data-engineering/2025/09/18/apache-flink-production-deployment.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 4: Apache Flink í”„ë¡œë•ì…˜ ë°°í¬ì™€ ì„±ëŠ¥ ìµœì í™” - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ìš´ì˜ì˜ ì™„ì„±">
<meta name="twitter:description" content="Apache Flinkë¥¼ Kubernetesì—ì„œ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•˜ê³ , ì„±ëŠ¥ì„ ìµœì í™”í•˜ë©°, ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµì„ êµ¬í˜„í•˜ëŠ” ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-engineering/2025/09/18/apache-flink-production-deployment.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-18-apache-flink-production-deployment.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 18ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 4: Apache Flink í”„ë¡œë•ì…˜ ë°°í¬ì™€ ì„±ëŠ¥ ìµœì í™” - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ìš´ì˜ì˜ ì™„ì„±</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">Apache-Flink</span>
      
        <span class="tag">Kubernetes</span>
      
        <span class="tag">í”„ë¡œë•ì…˜ë°°í¬</span>
      
        <span class="tag">ì„±ëŠ¥ìµœì í™”</span>
      
        <span class="tag">ëª¨ë‹ˆí„°ë§</span>
      
        <span class="tag">ì¥ì• ë³µêµ¬</span>
      
        <span class="tag">DevOps</span>
      
        <span class="tag">CI/CD</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Apache flink complete guide ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 5</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 50ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ê³ ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-4-apache-flink-í”„ë¡œë•ì…˜-ë°°í¬ì™€-ì„±ëŠ¥-ìµœì í™”---ì—”í„°í”„ë¼ì´ì¦ˆê¸‰-ìš´ì˜ì˜-ì™„ì„±">Part 4: Apache Flink í”„ë¡œë•ì…˜ ë°°í¬ì™€ ì„±ëŠ¥ ìµœì í™” - ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ìš´ì˜ì˜ ì™„ì„±</h1>

<blockquote>
  <p>Apache Flinkë¥¼ Kubernetesì—ì„œ í”„ë¡œë•ì…˜ í™˜ê²½ì— ë°°í¬í•˜ê³ , ì„±ëŠ¥ì„ ìµœì í™”í•˜ë©°, ëª¨ë‹ˆí„°ë§ê³¼ ì¥ì•  ë³µêµ¬ ì „ëµì„ êµ¬í˜„í•˜ëŠ” ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="-ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#kubernetesë¥¼-í™œìš©í•œ-flink-í´ëŸ¬ìŠ¤í„°-ë°°í¬">Kubernetesë¥¼ í™œìš©í•œ Flink í´ëŸ¬ìŠ¤í„° ë°°í¬</a></li>
  <li><a href="#ì„±ëŠ¥-íŠœë‹ê³¼-ìµœì í™”">ì„±ëŠ¥ íŠœë‹ê³¼ ìµœì í™”</a></li>
  <li><a href="#ëª¨ë‹ˆí„°ë§ê³¼-ì•Œë¦¼-ì‹œìŠ¤í…œ">ëª¨ë‹ˆí„°ë§ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œ</a></li>
  <li><a href="#ì¥ì• -ë³µêµ¬ì™€-ìš´ì˜-ì „ëµ">ì¥ì•  ë³µêµ¬ì™€ ìš´ì˜ ì „ëµ</a></li>
  <li><a href="#ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì—”í„°í”„ë¼ì´ì¦ˆê¸‰-flink-í”Œë«í¼">ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ Flink í”Œë«í¼</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<h2 id="-kubernetesë¥¼-í™œìš©í•œ-flink-í´ëŸ¬ìŠ¤í„°-ë°°í¬">ğŸš€ Kubernetesë¥¼ í™œìš©í•œ Flink í´ëŸ¬ìŠ¤í„° ë°°í¬</h2>

<h3 id="flink-on-kubernetes-ì•„í‚¤í…ì²˜">Flink on Kubernetes ì•„í‚¤í…ì²˜</h3>

<p>Kubernetesì—ì„œ Flinkë¥¼ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ ì´ì ì„ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
<ul>
  <li><strong>ìë™ ìŠ¤ì¼€ì¼ë§</strong>: ì›Œí¬ë¡œë“œì— ë”°ë¼ ìë™ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ ì¡°ì •</li>
  <li><strong>ê³ ê°€ìš©ì„±</strong>: Pod ì¥ì•  ì‹œ ìë™ ë³µêµ¬</li>
  <li><strong>ë¦¬ì†ŒìŠ¤ ê´€ë¦¬</strong>: íš¨ìœ¨ì ì¸ ë©”ëª¨ë¦¬ì™€ CPU ì‚¬ìš©</li>
  <li><strong>ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬</strong>: ë‚´ì¥ëœ ë„¤íŠ¸ì›Œí‚¹ê³¼ ë¡œë“œ ë°¸ëŸ°ì‹±</li>
</ul>

<h3 id="1-flink-operator-ì„¤ì¹˜">1. Flink Operator ì„¤ì¹˜</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-operator-install.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Namespace</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">flink-operator</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">serviceAccountName</span><span class="pi">:</span> <span class="s">flink-operator</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">apache/flink-kubernetes-operator:1.7.0</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span>
        <span class="na">env</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">OPERATOR_NAME</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">flink-operator"</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">WATCH_NAMESPACE</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">256Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">100m"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">512Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ServiceAccount</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">rules</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">apps"</span><span class="pi">]</span>
  <span class="na">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">deployments"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">statefulsets"</span><span class="pi">]</span>
  <span class="na">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">get"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">list"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">watch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">create"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">update"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">patch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">delete"</span><span class="pi">]</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">]</span>
  <span class="na">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">pods"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">services"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">configmaps"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">secrets"</span><span class="pi">]</span>
  <span class="na">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">get"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">list"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">watch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">create"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">update"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">patch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">delete"</span><span class="pi">]</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRoleBinding</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">roleRef</span><span class="pi">:</span>
  <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">subjects</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">kind</span><span class="pi">:</span> <span class="s">ServiceAccount</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-operator</span>
</code></pre></div></div>

<h3 id="2-flink-application-ë°°í¬">2. Flink Application ë°°í¬</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-application.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">flink.apache.org/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">FlinkDeployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">real-time-analytics</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">flink:1.18-scala_2.12-java11</span>
  <span class="na">flinkVersion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1.18"</span>
  <span class="na">flinkConfiguration</span><span class="pi">:</span>
    <span class="na">taskmanager.numberOfTaskSlots</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4"</span>
    <span class="na">parallelism.default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4"</span>
    <span class="na">state.backend</span><span class="pi">:</span> <span class="s2">"</span><span class="s">rocksdb"</span>
    <span class="na">state.checkpoints.dir</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-checkpoints/checkpoints"</span>
    <span class="na">state.savepoints.dir</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-savepoints/savepoints"</span>
    <span class="na">execution.checkpointing.interval</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">execution.checkpointing.mode</span><span class="pi">:</span> <span class="s2">"</span><span class="s">EXACTLY_ONCE"</span>
    <span class="na">execution.checkpointing.timeout</span><span class="pi">:</span> <span class="s2">"</span><span class="s">600s"</span>
    <span class="na">execution.checkpointing.min-pause</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">execution.checkpointing.max-concurrent-checkpoints</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
    <span class="na">restart-strategy</span><span class="pi">:</span> <span class="s2">"</span><span class="s">fixed-delay"</span>
    <span class="na">restart-strategy.fixed-delay.attempts</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3"</span>
    <span class="na">restart-strategy.fixed-delay.delay</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10s"</span>
    <span class="na">high-availability</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kubernetes"</span>
    <span class="na">high-availability.storageDir</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-ha/ha"</span>
  <span class="na">serviceAccount</span><span class="pi">:</span> <span class="s">flink-service-account</span>
  <span class="na">jobManager</span><span class="pi">:</span>
    <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">resource</span><span class="pi">:</span>
      <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2048m"</span>
      <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000m"</span>
    <span class="na">podTemplate</span><span class="pi">:</span>
      <span class="na">spec</span><span class="pi">:</span>
        <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-main-container</span>
          <span class="na">env</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">JAVA_OPTS</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">-Xmx1536m"</span>
          <span class="na">resources</span><span class="pi">:</span>
            <span class="na">requests</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2048m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000m"</span>
            <span class="na">limits</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2048m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000m"</span>
  <span class="na">taskManager</span><span class="pi">:</span>
    <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
    <span class="na">resource</span><span class="pi">:</span>
      <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4096m"</span>
      <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
    <span class="na">podTemplate</span><span class="pi">:</span>
      <span class="na">spec</span><span class="pi">:</span>
        <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-main-container</span>
          <span class="na">env</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">JAVA_OPTS</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">-Xmx3072m"</span>
          <span class="na">resources</span><span class="pi">:</span>
            <span class="na">requests</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4096m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
            <span class="na">limits</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4096m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
  <span class="na">job</span><span class="pi">:</span>
    <span class="na">jarURI</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-jobs/real-time-analytics.jar"</span>
    <span class="na">parallelism</span><span class="pi">:</span> <span class="m">8</span>
    <span class="na">upgradeMode</span><span class="pi">:</span> <span class="s2">"</span><span class="s">stateless"</span>
    <span class="na">allowNonRestoredState</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div>

<h3 id="3-ê³ ê°€ìš©ì„±-ì„¤ì •">3. ê³ ê°€ìš©ì„± ì„¤ì •</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-ha-config.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-ha-config</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-production</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">flink-conf.yaml</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s"># ê³ ê°€ìš©ì„± ì„¤ì •</span>
    <span class="s">high-availability: kubernetes</span>
    <span class="s">high-availability.cluster-id: flink-cluster</span>
    <span class="s">high-availability.storageDir: s3://flink-ha/ha</span>
    
    <span class="s"># ZooKeeper ì„¤ì • (ì„ íƒì‚¬í•­)</span>
    <span class="s"># high-availability.zookeeper.quorum: zookeeper-service:2181</span>
    <span class="s"># high-availability.zookeeper.path.root: /flink</span>
    
    <span class="s"># Kubernetes ë¦¬ë” ì„ íƒê¸°</span>
    <span class="s">kubernetes.operator.leader.election.lease-duration: 15s</span>
    <span class="s">kubernetes.operator.leader.election.renew-deadline: 10s</span>
    <span class="s">kubernetes.operator.leader.election.retry-period: 2s</span>
    
    <span class="s"># ì²´í¬í¬ì¸íŠ¸ ì„¤ì •</span>
    <span class="s">state.backend: rocksdb</span>
    <span class="s">state.backend.incremental: true</span>
    <span class="s">state.checkpoints.dir: s3://flink-checkpoints/checkpoints</span>
    <span class="s">state.savepoints.dir: s3://flink-savepoints/savepoints</span>
    <span class="s">execution.checkpointing.interval: 60s</span>
    <span class="s">execution.checkpointing.mode: EXACTLY_ONCE</span>
    <span class="s">execution.checkpointing.timeout: 600s</span>
    <span class="s">execution.checkpointing.min-pause: 60s</span>
    <span class="s">execution.checkpointing.max-concurrent-checkpoints: 1</span>
    
    <span class="s"># ì¬ì‹œì‘ ì „ëµ</span>
    <span class="s">restart-strategy: fixed-delay</span>
    <span class="s">restart-strategy.fixed-delay.attempts: 3</span>
    <span class="s">restart-strategy.fixed-delay.delay: 10s</span>
    
    <span class="s"># ë©”íŠ¸ë¦­ ì„¤ì •</span>
    <span class="s">metrics.reporter.prom.class: org.apache.flink.metrics.prometheus.PrometheusReporter</span>
    <span class="s">metrics.reporter.prom.port: 9249</span>
    <span class="s">metrics.system-resource: true</span>
    <span class="s">metrics.system-resource-probing-interval: 5000</span>
</code></pre></div></div>

<h3 id="4-ìë™-ìŠ¤ì¼€ì¼ë§-ì„¤ì •">4. ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-autoscaling.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">flink.apache.org/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">FlinkDeployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">auto-scaling-flink-app</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">flinkConfiguration</span><span class="pi">:</span>
    <span class="c1"># ìë™ ìŠ¤ì¼€ì¼ë§ í™œì„±í™”</span>
    <span class="na">kubernetes.operator.auto-scaling.enabled</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.window</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.delay</span><span class="pi">:</span> <span class="s2">"</span><span class="s">30s"</span>
    <span class="na">kubernetes.operator.auto-scaling.scale-up.grace-period</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">kubernetes.operator.auto-scaling.scale-down.grace-period</span><span class="pi">:</span> <span class="s2">"</span><span class="s">300s"</span>
    
    <span class="c1"># ìŠ¤ì¼€ì¼ë§ ì„ê³„ê°’</span>
    <span class="na">kubernetes.operator.auto-scaling.target.utilization</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.8"</span>
    <span class="na">kubernetes.operator.auto-scaling.min.replicas</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2"</span>
    <span class="na">kubernetes.operator.auto-scaling.max.replicas</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10"</span>
    
    <span class="c1"># ìŠ¤ì¼€ì¼ë§ ë©”íŠ¸ë¦­</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.jvm.cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.jvm.memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.operator.num-records-in</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.operator.num-records-out</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
  <span class="na">taskManager</span><span class="pi">:</span>
    <span class="na">replicas</span><span class="pi">:</span> <span class="m">2</span>
    <span class="c1"># HPA ì„¤ì •</span>
    <span class="na">horizontalPodAutoscaler</span><span class="pi">:</span>
      <span class="na">minReplicas</span><span class="pi">:</span> <span class="m">2</span>
      <span class="na">maxReplicas</span><span class="pi">:</span> <span class="m">10</span>
      <span class="na">metrics</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Resource</span>
        <span class="na">resource</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">cpu</span>
          <span class="na">target</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">Utilization</span>
            <span class="na">averageUtilization</span><span class="pi">:</span> <span class="m">80</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Resource</span>
        <span class="na">resource</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">memory</span>
          <span class="na">target</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">Utilization</span>
            <span class="na">averageUtilization</span><span class="pi">:</span> <span class="m">80</span>
      <span class="na">behavior</span><span class="pi">:</span>
        <span class="na">scaleDown</span><span class="pi">:</span>
          <span class="na">stabilizationWindowSeconds</span><span class="pi">:</span> <span class="m">300</span>
          <span class="na">policies</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Percent</span>
            <span class="na">value</span><span class="pi">:</span> <span class="m">10</span>
            <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">60</span>
        <span class="na">scaleUp</span><span class="pi">:</span>
          <span class="na">stabilizationWindowSeconds</span><span class="pi">:</span> <span class="m">60</span>
          <span class="na">policies</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Percent</span>
            <span class="na">value</span><span class="pi">:</span> <span class="m">100</span>
            <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">60</span>
</code></pre></div></div>

<h2 id="-ì„±ëŠ¥-íŠœë‹ê³¼-ìµœì í™”">âš¡ ì„±ëŠ¥ íŠœë‹ê³¼ ìµœì í™”</h2>

<h3 id="1-ë©”ëª¨ë¦¬-ìµœì í™”">1. ë©”ëª¨ë¦¬ ìµœì í™”</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlinkMemoryOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">memory_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">generate_optimized_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">workload_type</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì›Œí¬ë¡œë“œ íƒ€ì…ì— ë”°ë¥¸ ë©”ëª¨ë¦¬ ì„¤ì • ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">streaming</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_streaming_memory_config</span><span class="p">(</span><span class="n">data_volume</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">batch</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_batch_memory_config</span><span class="p">(</span><span class="n">data_volume</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">machine_learning</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_ml_memory_config</span><span class="p">(</span><span class="n">data_volume</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_default_memory_config</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_streaming_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤íŠ¸ë¦¬ë° ì›Œí¬ë¡œë“œìš© ë©”ëª¨ë¦¬ ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">low</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># &lt; 1GB/min
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">medium</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># 1-10GB/min
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># &gt; 10GB/min
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
            <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_batch_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°°ì¹˜ ì›Œí¬ë¡œë“œìš© ë©”ëª¨ë¦¬ ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">small</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># &lt; 100GB
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">large</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># 100GB - 1TB
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># &gt; 1TB
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
            <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_ml_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¨¸ì‹ ëŸ¬ë‹ ì›Œí¬ë¡œë“œìš© ë©”ëª¨ë¦¬ ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">12g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">6g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.15</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_default_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê¸°ë³¸ ë©”ëª¨ë¦¬ ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
        <span class="p">}</span>
</code></pre></div></div>

<h3 id="2-ë„¤íŠ¸ì›Œí¬-ìµœì í™”">2. ë„¤íŠ¸ì›Œí¬ ìµœì í™”</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">NetworkOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">network_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_network_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="n">data_throughput</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># ë„¤íŠ¸ì›Œí¬ ë²„í¼ ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.min</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">128mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1gb</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ë„¤íŠ¸ì›Œí¬ ìŠ¤ë ˆë“œ ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.netty.num-arenas</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">cluster_size</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.server.numThreads</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.numThreads</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì—°ê²° ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.netty.server.backlog</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.connectTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ë²„í¼ ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.memory.buffers-per-channel</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.floating-buffers-per-gate</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="c1"># ë°ì´í„° ì²˜ë¦¬ëŸ‰ì— ë”°ë¥¸ ì¶”ê°€ ìµœì í™”
</span>        <span class="k">if</span> <span class="n">data_throughput</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>  <span class="c1"># MB/s
</span>            <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.3</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2gb</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.buffers-per-channel</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.floating-buffers-per-gate</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16</span><span class="sh">"</span><span class="p">,</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">config</span>
    
    <span class="k">def</span> <span class="nf">optimize_shuffle_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_size</span><span class="p">,</span> <span class="n">parallelism</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Shuffle ì„±ëŠ¥ ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="c1"># ë°ì´í„° í¬ê¸°ì— ë”°ë¥¸ íŒŒí‹°ì…˜ ìˆ˜ ì¡°ì •
</span>        <span class="n">optimal_partitions</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">data_size</span> <span class="o">//</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
        
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">parallelism</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">parallelism</span><span class="p">),</span>
            
            <span class="c1"># Shuffle ìµœì í™”
</span>            <span class="sh">"</span><span class="s">taskmanager.memory.segment-size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">32kb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.sort-shuffle.min-parallelism</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.sort-shuffle.min-buffers</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">64</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì••ì¶• ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.compression.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.compression.codec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">lz4</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">config</span>
</code></pre></div></div>

<h3 id="3-ìƒíƒœ-ë°±ì—”ë“œ-ìµœì í™”">3. ìƒíƒœ ë°±ì—”ë“œ ìµœì í™”</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StateBackendOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rocksdb_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_rocksdb_backend</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">,</span> <span class="n">access_pattern</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">RocksDB ë°±ì—”ë“œ ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">access_pattern</span> <span class="o">==</span> <span class="sh">"</span><span class="s">read_heavy</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_read_optimized_config</span><span class="p">(</span><span class="n">state_size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">access_pattern</span> <span class="o">==</span> <span class="sh">"</span><span class="s">write_heavy</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_write_optimized_config</span><span class="p">(</span><span class="n">state_size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">access_pattern</span> <span class="o">==</span> <span class="sh">"</span><span class="s">mixed</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_balanced_config</span><span class="p">(</span><span class="n">state_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_default_config</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_read_optimized_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì½ê¸° ìµœì í™” ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">block_cache_size</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">512</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>  <span class="c1"># 512MB max
</span>        
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># ë¸”ë¡ ìºì‹œ ìµœì í™”
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">block_cache_size</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size-per-column-family</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">block_cache_size</span> <span class="o">//</span> <span class="mi">4</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ë¸”ë¡ í¬ê¸° ìµœì í™”
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.blocksize</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16kb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.bloom-filter-bits-per-key</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì••ì¶• ì„¤ì •
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-slowdown-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">20</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-stop-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">36</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì½ê¸° ìµœì í™”
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.readoptions.async-io</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.readoptions.cache-index-and-filter-blocks</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_write_optimized_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì“°ê¸° ìµœì í™” ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">write_buffer_size</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>  <span class="c1"># 128MB max
</span>        
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># ì“°ê¸° ë²„í¼ ìµœì í™”
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.write-buffer-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">write_buffer_size</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.max-write-buffer-number</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.min-write-buffer-number-to-merge</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># WAL ì„¤ì •
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.wal.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.wal.sync</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì••ì¶• ì„¤ì •
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-slowdown-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-stop-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">12</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì“°ê¸° ìµœì í™”
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.writeoptions.sync</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.writeoptions.disable-wal</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_balanced_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê· í˜• ì¡íŒ ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># ë¸”ë¡ ìºì‹œ
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì“°ê¸° ë²„í¼
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.write-buffer-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.max-write-buffer-number</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì••ì¶• ì„¤ì •
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-slowdown-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">20</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-stop-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">36</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì¼ë°˜ ì„¤ì •
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.blocksize</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16kb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.wal.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="-ëª¨ë‹ˆí„°ë§ê³¼-ì•Œë¦¼-ì‹œìŠ¤í…œ">ğŸ“Š ëª¨ë‹ˆí„°ë§ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œ</h2>

<h3 id="1-prometheus-ë©”íŠ¸ë¦­-ì„¤ì •">1. Prometheus ë©”íŠ¸ë¦­ ì„¤ì •</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># prometheus-config.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">prometheus-config</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">monitoring</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">prometheus.yml</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">global:</span>
      <span class="s">scrape_interval: 15s</span>
      <span class="s">evaluation_interval: 15s</span>
    
    <span class="s">rule_files:</span>
      <span class="s">- "flink_rules.yml"</span>
    
    <span class="s">alerting:</span>
      <span class="s">alertmanagers:</span>
        <span class="s">- static_configs:</span>
            <span class="s">- targets:</span>
              <span class="s">- alertmanager:9093</span>
    
    <span class="s">scrape_configs:</span>
      <span class="s">- job_name: 'flink-jobmanager'</span>
        <span class="s">static_configs:</span>
          <span class="s">- targets: ['flink-jobmanager:9249']</span>
        <span class="s">scrape_interval: 10s</span>
        <span class="s">metrics_path: /metrics</span>
    <span class="no">    </span>
      <span class="s">- job_name: 'flink-taskmanager'</span>
        <span class="s">kubernetes_sd_configs:</span>
          <span class="s">- role: pod</span>
            <span class="s">namespaces:</span>
              <span class="s">names:</span>
                <span class="s">- flink-production</span>
        <span class="s">relabel_configs:</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_label_app]</span>
            <span class="s">action: keep</span>
            <span class="s">regex: flink-taskmanager</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_container_port_name]</span>
            <span class="s">action: keep</span>
            <span class="s">regex: metrics</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_name]</span>
            <span class="s">target_label: instance</span>
        <span class="s">scrape_interval: 10s</span>
        <span class="s">metrics_path: /metrics</span>
    <span class="no">    </span>
      <span class="s">- job_name: 'kubernetes-pods'</span>
        <span class="s">kubernetes_sd_configs:</span>
          <span class="s">- role: pod</span>
        <span class="s">relabel_configs:</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]</span>
            <span class="s">action: keep</span>
            <span class="s">regex: true</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]</span>
            <span class="s">action: replace</span>
            <span class="s">target_label: __metrics_path__</span>
            <span class="s">regex: (.+)</span>
</code></pre></div></div>

<h3 id="2-grafana-ëŒ€ì‹œë³´ë“œ-ì„¤ì •">2. Grafana ëŒ€ì‹œë³´ë“œ ì„¤ì •</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"dashboard"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apache Flink Production Dashboard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"panels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Job Status"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stat"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_jobmanager_numRunningJobs"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"fieldConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"defaults"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thresholds"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"thresholds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"steps"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"green"</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Records Processed Per Second"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sum(rate(flink_taskmanager_job_task_operator_numRecordsInPerSecond[5m])) by (job_name)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Records/sec"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Checkpoint Duration"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_jobmanager_job_lastCheckpointDuration"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Duration (ms)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Memory Usage"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_taskmanager_Status_JVM_Memory_Heap_Used"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_taskmanager_Status_JVM_Memory_Heap_Max"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"B"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Memory (bytes)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Backpressure"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_taskmanager_job_task_backPressuredTimeMsPerSecond"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Backpressure (ms/sec)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="3-ì•Œë¦¼-ê·œì¹™-ì„¤ì •">3. ì•Œë¦¼ ê·œì¹™ ì„¤ì •</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-alert-rules.yml</span>
<span class="na">groups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-alerts</span>
    <span class="na">rules</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">FlinkJobFailed</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">flink_jobmanager_job_status == </span><span class="m">0</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">1m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">critical</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Flink</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">failed"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Flink</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">failed</span><span class="nv"> </span><span class="s">state</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">more</span><span class="nv"> </span><span class="s">than</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">minute"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighCheckpointDuration</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">flink_jobmanager_job_lastCheckpointDuration &gt; </span><span class="m">60000</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">checkpoint</span><span class="nv"> </span><span class="s">duration</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Checkpoint</span><span class="nv"> </span><span class="s">duration</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">threshold"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighBackpressure</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">flink_taskmanager_job_task_backPressuredTimeMsPerSecond &gt; </span><span class="m">1000</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">2m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">backpressure</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Task</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">experiencing</span><span class="nv"> </span><span class="s">high</span><span class="nv"> </span><span class="s">backpressure"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighMemoryUsage</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">(flink_taskmanager_Status_JVM_Memory_Heap_Used / flink_taskmanager_Status_JVM_Memory_Heap_Max) &gt; </span><span class="m">0.9</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">memory</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">TaskManager</span><span class="nv"> </span><span class="s">memory</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">threshold"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">LowThroughput</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">rate(flink_taskmanager_job_task_operator_numRecordsInPerSecond[5m]) &lt; </span><span class="m">100</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">10m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Low</span><span class="nv"> </span><span class="s">throughput</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Job</span><span class="nv"> </span><span class="s">throughput</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">below</span><span class="nv"> </span><span class="s">normal</span><span class="nv"> </span><span class="s">threshold"</span>
</code></pre></div></div>

<h2 id="-ì¥ì• -ë³µêµ¬ì™€-ìš´ì˜-ì „ëµ">ğŸ”§ ì¥ì•  ë³µêµ¬ì™€ ìš´ì˜ ì „ëµ</h2>

<h3 id="1-ìë™-ì¥ì• -ë³µêµ¬-ì‹œìŠ¤í…œ">1. ìë™ ì¥ì•  ë³µêµ¬ ì‹œìŠ¤í…œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlinkDisasterRecovery</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">kubernetes_client</span><span class="p">,</span> <span class="n">flink_client</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span> <span class="o">=</span> <span class="n">kubernetes_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span> <span class="o">=</span> <span class="n">flink_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">recovery_strategies</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_disaster_recovery</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¬í•´ ë³µêµ¬ ì‹œìŠ¤í…œ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="c1"># 1. ì²´í¬í¬ì¸íŠ¸ ëª¨ë‹ˆí„°ë§
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_checkpoint_monitoring</span><span class="p">()</span>
        
        <span class="c1"># 2. ìë™ ì¬ì‹œì‘ ì„¤ì •
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_restart</span><span class="p">()</span>
        
        <span class="c1"># 3. ë°±ì—… ë° ë³µì› ì‹œìŠ¤í…œ
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_backup_system</span><span class="p">()</span>
        
        <span class="c1"># 4. ì¥ì•  ì „íŒŒ ë°©ì§€
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_circuit_breaker</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_checkpoint_monitoring</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì²´í¬í¬ì¸íŠ¸ ëª¨ë‹ˆí„°ë§ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">checkpoint_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">EXACTLY_ONCE</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">600s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.min-pause</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.max-concurrent-checkpoints</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.unaligned</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.alignment-timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0s</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì²´í¬í¬ì¸íŠ¸ ì €ì¥ì†Œ
</span>            <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rocksdb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.checkpoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-checkpoints/checkpoints</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.savepoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-savepoints/savepoints</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ê³ ê°€ìš©ì„±
</span>            <span class="sh">"</span><span class="s">high-availability</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">kubernetes</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">high-availability.storageDir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-ha/ha</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">high-availability.cluster-id</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">flink-cluster</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">checkpoint_config</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_restart</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™ ì¬ì‹œì‘ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">restart_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">exponential-delay</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.initial-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.max-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2min</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.backoff-multiplier</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2.0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.reset-backoff-threshold</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10min</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.jitter-factor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">restart_config</span>
    
    <span class="k">def</span> <span class="nf">setup_backup_system</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°±ì—… ì‹œìŠ¤í…œ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">backup_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># ìë™ ì„¸ì´ë¸Œí¬ì¸íŠ¸
</span>            <span class="sh">"</span><span class="s">execution.savepoint.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.savepoint.trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">periodic</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ë°±ì—… ì €ì¥ì†Œ
</span>            <span class="sh">"</span><span class="s">state.backend.incremental</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.checkpoint.transfer.thread.num</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì••ì¶• ì„¤ì •
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compression.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">LZ4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level.max-size-level-base</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256mb</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">backup_config</span>
    
    <span class="k">def</span> <span class="nf">setup_circuit_breaker</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì„œí‚· ë¸Œë ˆì´ì»¤ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">circuit_breaker_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># ë„¤íŠ¸ì›Œí¬ íƒ€ì„ì•„ì›ƒ
</span>            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.connectTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.requestTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ì¬ì‹œë„ ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.retries</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.retry-delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># ë°±í”„ë ˆì…” ì„¤ì •
</span>            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1gb</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">circuit_breaker_config</span>
    
    <span class="k">def</span> <span class="nf">execute_disaster_recovery</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">failure_type</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¬í•´ ë³µêµ¬ ì‹¤í–‰</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">job_failure</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">cluster_failure</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_cluster_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">data_corruption</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_data_corruption</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_unknown_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‘ì—… ì‹¤íŒ¨ì—ì„œ ë³µêµ¬</span><span class="sh">"""</span>
        <span class="n">recovery_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">1. ì‹¤íŒ¨í•œ ì‘ì—… ì¤‘ì§€</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">2. ìµœì‹  ì²´í¬í¬ì¸íŠ¸ í™•ì¸</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">3. ìƒíƒœ ë°±ì—”ë“œ ê²€ì¦</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">4. ì‘ì—… ì¬ì‹œì‘</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">5. ë³µêµ¬ ìƒíƒœ ëª¨ë‹ˆí„°ë§</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="c1"># ì‹¤ì œ ë³µêµ¬ ë¡œì§ êµ¬í˜„
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. ì‘ì—… ì¤‘ì§€
</span>            <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">cancel_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            
            <span class="c1"># 2. ìµœì‹  ì²´í¬í¬ì¸íŠ¸ í™•ì¸
</span>            <span class="n">latest_checkpoint</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_latest_checkpoint</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            
            <span class="c1"># 3. ìƒíƒœ ê²€ì¦
</span>            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">validate_checkpoint</span><span class="p">(</span><span class="n">latest_checkpoint</span><span class="p">):</span>
                <span class="c1"># 4. ì‘ì—… ì¬ì‹œì‘
</span>                <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">restart_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">latest_checkpoint</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Job recovered successfully</span><span class="sh">"</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 5. ì„¸ì´ë¸Œí¬ì¸íŠ¸ì—ì„œ ë³µêµ¬ ì‹œë„
</span>                <span class="n">latest_savepoint</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_latest_savepoint</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">latest_savepoint</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">restart_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">latest_savepoint</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Job recovered from savepoint</span><span class="sh">"</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">failed</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">No valid checkpoint or savepoint found</span><span class="sh">"</span><span class="p">}</span>
                    
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Recovery failed: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">recover_from_cluster_failure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í´ëŸ¬ìŠ¤í„° ì‹¤íŒ¨ì—ì„œ ë³µêµ¬</span><span class="sh">"""</span>
        <span class="n">recovery_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">2. Kubernetes ë¦¬ì†ŒìŠ¤ ì¬ì‹œì‘</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">3. Flink í´ëŸ¬ìŠ¤í„° ì¬ë°°í¬</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">4. ì‘ì—… ë³µêµ¬</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">5. ì „ì²´ ì‹œìŠ¤í…œ ê²€ì¦</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸
</span>            <span class="n">cluster_status</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_cluster_status</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">cluster_status</span><span class="p">[</span><span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 2. í´ëŸ¬ìŠ¤í„° ì¬ì‹œì‘
</span>                <span class="n">self</span><span class="p">.</span><span class="nf">restart_flink_cluster</span><span class="p">()</span>
                
                <span class="c1"># 3. ì‘ì—… ë³µêµ¬
</span>                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Cluster recovery failed: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_latest_checkpoint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìµœì‹  ì²´í¬í¬ì¸íŠ¸ ì¡°íšŒ</span><span class="sh">"""</span>
        <span class="n">checkpoints</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">list_checkpoints</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checkpoints</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">max</span><span class="p">(</span><span class="n">checkpoints</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">get_latest_savepoint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìµœì‹  ì„¸ì´ë¸Œí¬ì¸íŠ¸ ì¡°íšŒ</span><span class="sh">"""</span>
        <span class="n">savepoints</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">list_savepoints</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">savepoints</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">max</span><span class="p">(</span><span class="n">savepoints</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">validate_checkpoint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì²´í¬í¬ì¸íŠ¸ ìœ íš¨ì„± ê²€ì¦</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checkpoint</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        
        <span class="c1"># ì²´í¬í¬ì¸íŠ¸ íŒŒì¼ ì¡´ì¬ í™•ì¸
</span>        <span class="c1"># ì²´í¬í¬ì¸íŠ¸ ë©”íƒ€ë°ì´í„° ê²€ì¦
</span>        <span class="c1"># ì²´í¬í¬ì¸íŠ¸ ë¬´ê²°ì„± ê²€ì‚¬
</span>        
        <span class="k">return</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">check_cluster_status</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Kubernetes í´ëŸ¬ìŠ¤í„° ìƒíƒœ í™•ì¸
</span>            <span class="n">pods</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span><span class="p">.</span><span class="nf">list_pods_for_all_namespaces</span><span class="p">(</span>
                <span class="n">label_selector</span><span class="o">=</span><span class="sh">"</span><span class="s">app=flink</span><span class="sh">"</span>
            <span class="p">)</span>
            
            <span class="n">healthy_pods</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">total_pods</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">pods</span><span class="p">.</span><span class="n">items</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pods</span><span class="p">.</span><span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pod</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">phase</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Running</span><span class="sh">"</span><span class="p">:</span>
                    <span class="n">healthy_pods</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="n">health_ratio</span> <span class="o">=</span> <span class="n">healthy_pods</span> <span class="o">/</span> <span class="n">total_pods</span> <span class="k">if</span> <span class="n">total_pods</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span><span class="p">:</span> <span class="n">health_ratio</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">health_ratio</span><span class="sh">"</span><span class="p">:</span> <span class="n">health_ratio</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">total_pods</span><span class="sh">"</span><span class="p">:</span> <span class="n">total_pods</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">healthy_pods</span><span class="sh">"</span><span class="p">:</span> <span class="n">healthy_pods</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
    
    <span class="k">def</span> <span class="nf">restart_flink_cluster</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Flink í´ëŸ¬ìŠ¤í„° ì¬ì‹œì‘</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># JobManager ì¬ì‹œì‘
</span>            <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span><span class="p">.</span><span class="nf">delete_namespaced_deployment</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-jobmanager</span><span class="sh">"</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-production</span><span class="sh">"</span>
            <span class="p">)</span>
            
            <span class="c1"># TaskManager ì¬ì‹œì‘
</span>            <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span><span class="p">.</span><span class="nf">delete_namespaced_deployment</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-taskmanager</span><span class="sh">"</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-production</span><span class="sh">"</span>
            <span class="p">)</span>
            
            <span class="c1"># ì¬ì‹œì‘ ëŒ€ê¸°
</span>            <span class="kn">import</span> <span class="n">time</span>
            <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Cluster restarted successfully</span><span class="sh">"</span><span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Cluster restart failed: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="2-ìš´ì˜-ìë™í™”-ì‹œìŠ¤í…œ">2. ìš´ì˜ ìë™í™” ì‹œìŠ¤í…œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlinkOperationsAutomation</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">operation_templates</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">monitoring_thresholds</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_operational_automation</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìš´ì˜ ìë™í™” ì‹œìŠ¤í…œ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="c1"># 1. ìë™ ìŠ¤ì¼€ì¼ë§
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_scaling</span><span class="p">()</span>
        
        <span class="c1"># 2. ìë™ ë°±ì—…
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_backup</span><span class="p">()</span>
        
        <span class="c1"># 3. ìë™ ì—…ë°ì´íŠ¸
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_update</span><span class="p">()</span>
        
        <span class="c1"># 4. ìë™ ëª¨ë‹ˆí„°ë§
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_monitoring</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_scaling</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">scaling_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.metrics.window</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.metrics.delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.scale-up.grace-period</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.scale-down.grace-period</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.target.utilization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.8</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.min.replicas</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.max.replicas</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">scaling_config</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_backup</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™ ë°±ì—… ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">backup_schedule</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">checkpoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">savepoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">24h</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">retention_policy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7d</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">backup_storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-backups/</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">compression</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">encryption</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">aes256</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">backup_schedule</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_update</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™ ì—…ë°ì´íŠ¸ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">update_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">update_strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rolling</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">update_window</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">02:00-06:00</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">health_check_timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">rollback_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10%</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">canary_percentage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10%</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">update_config</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_monitoring</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™ ëª¨ë‹ˆí„°ë§ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">monitoring_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">metrics_collection_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">alert_evaluation_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">retention_period</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30d</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">anomaly_detection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">performance_baseline</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">auto</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">monitoring_config</span>

<span class="k">class</span> <span class="nc">FlinkPerformanceOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">optimization_rules</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_workload</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">workload_type</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì›Œí¬ë¡œë“œ íƒ€ì…ì— ë”°ë¥¸ ì„±ëŠ¥ ìµœì í™”</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">low_latency</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_low_latency</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">high_throughput</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_high_throughput</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">memory_intensive</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_memory_intensive</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_balanced</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_low_latency</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì €ì§€ì—° ìµœì í™”</span><span class="sh">"""</span>
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">execution.buffer-timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1ms</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.min</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">64mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.server.backlog</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.connectTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">5</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_high_throughput</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê³ ì²˜ë¦¬ëŸ‰ ìµœì í™”</span><span class="sh">"""</span>
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">execution.buffer-timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">100ms</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">600s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.min</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2gb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.buffers-per-channel</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.floating-buffers-per-gate</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_memory_intensive</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë©”ëª¨ë¦¬ ì§‘ì•½ì  ìµœì í™”</span><span class="sh">"""</span>
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2gb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.write-buffer-size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.max-write-buffer-number</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
</code></pre></div></div>

<h2 id="-ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì—”í„°í”„ë¼ì´ì¦ˆê¸‰-flink-í”Œë«í¼">ğŸš€ ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ Flink í”Œë«í¼</h2>

<h3 id="í”„ë¡œì íŠ¸-ê°œìš”">í”„ë¡œì íŠ¸ ê°œìš”</h3>

<p>ëŒ€ê·œëª¨ ì—”í„°í”„ë¼ì´ì¦ˆ í™˜ê²½ì—ì„œ Apache Flinkë¥¼ ìš´ì˜í•˜ê¸° ìœ„í•œ ì™„ì „í•œ í”Œë«í¼ì„ êµ¬ì¶•í•©ë‹ˆë‹¤. ì´ í”Œë«í¼ì€ ìë™í™”, ëª¨ë‹ˆí„°ë§, ì¥ì•  ë³µêµ¬, ì„±ëŠ¥ ìµœì í™”ë¥¼ ëª¨ë‘ í¬í•¨í•©ë‹ˆë‹¤.</p>

<h3 id="1-í”Œë«í¼-ì•„í‚¤í…ì²˜">1. í”Œë«í¼ ì•„í‚¤í…ì²˜</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">EnterpriseFlinkPlatform</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">components</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">deployment</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkDeploymentManager</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">monitoring</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkMonitoringSystem</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">automation</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkOperationsAutomation</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">recovery</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkDisasterRecovery</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkPerformanceOptimizer</span><span class="p">()</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">deploy_enterprise_platform</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì—”í„°í”„ë¼ì´ì¦ˆ í”Œë«í¼ ë°°í¬</span><span class="sh">"""</span>
        
        <span class="n">deployment_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">1. ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° RBAC ì„¤ì •</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">2. Flink Operator ì„¤ì¹˜</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">3. ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ ë°°í¬</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">4. Flink í´ëŸ¬ìŠ¤í„° ë°°í¬</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">5. ìë™í™” ê·œì¹™ ì„¤ì •</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">6. ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì„±</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">7. ë°±ì—… ì‹œìŠ¤í…œ ì„¤ì •</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment_steps</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Executing: </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">execute_deployment_step</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">execute_deployment_step</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°°í¬ ë‹¨ê³„ ì‹¤í–‰</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="sh">"</span><span class="s">ë„¤ì„ìŠ¤í˜ì´ìŠ¤</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">create_namespaces_and_rbac</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">Operator</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">install_flink_operator</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">ëª¨ë‹ˆí„°ë§</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_monitoring_stack</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">í´ëŸ¬ìŠ¤í„°</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_flink_cluster</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">ìë™í™”</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">setup_automation_rules</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">ì•Œë¦¼</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">configure_alerting</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">ë°±ì—…</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">setup_backup_system</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">create_namespaces_and_rbac</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ë° RBAC ìƒì„±</span><span class="sh">"""</span>
        <span class="n">namespaces</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">flink-production</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">flink-staging</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">monitoring</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">logging</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">namespace</span> <span class="ow">in</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">create_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">create_rbac_for_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">install_flink_operator</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Flink Operator ì„¤ì¹˜</span><span class="sh">"""</span>
        <span class="n">operator_manifest</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
        apiVersion: v1
        kind: Namespace
        metadata:
          name: flink-operator
        ---
        apiVersion: apps/v1
        kind: Deployment
        metadata:
          name: flink-operator
          namespace: flink-operator
        spec:
          replicas: 1
          selector:
            matchLabels:
              app: flink-operator
          template:
            metadata:
              labels:
                app: flink-operator
            spec:
              serviceAccountName: flink-operator
              containers:
              - name: flink-operator
                image: apache/flink-kubernetes-operator:1.7.0
                ports:
                - containerPort: 8080
                env:
                - name: OPERATOR_NAME
                  value: </span><span class="sh">"</span><span class="s">flink-operator</span><span class="sh">"</span><span class="s">
                - name: WATCH_NAMESPACE
                  value: </span><span class="sh">""</span><span class="s">
                resources:
                  requests:
                    memory: </span><span class="sh">"</span><span class="s">256Mi</span><span class="sh">"</span><span class="s">
                    cpu: </span><span class="sh">"</span><span class="s">100m</span><span class="sh">"</span><span class="s">
                  limits:
                    memory: </span><span class="sh">"</span><span class="s">512Mi</span><span class="sh">"</span><span class="s">
                    cpu: </span><span class="sh">"</span><span class="s">500m</span><span class="sh">"</span><span class="s">
        </span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">apply_manifest</span><span class="p">(</span><span class="n">operator_manifest</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">deploy_monitoring_stack</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëª¨ë‹ˆí„°ë§ ìŠ¤íƒ ë°°í¬</span><span class="sh">"""</span>
        <span class="n">monitoring_components</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">prometheus</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">grafana</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">alertmanager</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">jaeger</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">elasticsearch</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kibana</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">monitoring_components</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_monitoring_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">deploy_flink_cluster</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Flink í´ëŸ¬ìŠ¤í„° ë°°í¬</span><span class="sh">"""</span>
        <span class="n">cluster_configs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">production</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_production_cluster_config</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">staging</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_staging_cluster_config</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">development</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_development_cluster_config</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">env</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">cluster_configs</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_cluster_for_environment</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_production_cluster_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í”„ë¡œë•ì…˜ í´ëŸ¬ìŠ¤í„° ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">flinkConfiguration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rocksdb</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.checkpoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://prod-flink-checkpoints/checkpoints</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.savepoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://prod-flink-savepoints/savepoints</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">EXACTLY_ONCE</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">high-availability</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">kubernetes</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">high-availability.storageDir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://prod-flink-ha/ha</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">exponential-delay</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.initial-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.max-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2min</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">metrics.reporter.prom.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.flink.metrics.prometheus.PrometheusReporter</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">metrics.reporter.prom.port</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">9249</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">jobManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">taskManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_staging_cluster_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤í…Œì´ì§• í´ëŸ¬ìŠ¤í„° ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">flinkConfiguration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rocksdb</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.checkpoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://staging-flink-checkpoints/checkpoints</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">120s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AT_LEAST_ONCE</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">fixed-delay</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.attempts</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">jobManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">taskManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_development_cluster_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê°œë°œ í´ëŸ¬ìŠ¤í„° ì„¤ì •</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">flinkConfiguration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AT_LEAST_ONCE</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">fixed-delay</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.attempts</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">5s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">jobManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">500m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">taskManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">setup_automation_rules</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™í™” ê·œì¹™ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">automation_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">auto_scaling</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">min_replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max_replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">target_cpu</span><span class="sh">"</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">target_memory</span><span class="sh">"</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">scale_up_cooldown</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">scale_down_cooldown</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">auto_backup</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">checkpoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">savepoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">24h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention_days</span><span class="sh">"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">backup_storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-backups/</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">auto_update</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>  <span class="c1"># í”„ë¡œë•ì…˜ì—ì„œëŠ” ìˆ˜ë™ ìŠ¹ì¸ í•„ìš”
</span>                <span class="sh">"</span><span class="s">update_window</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">02:00-06:00</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">canary_percentage</span><span class="sh">"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">health_check_timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">auto_recovery</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max_restart_attempts</span><span class="sh">"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart_delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">escalation_timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">rule_type</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">automation_rules</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">configure_automation_rule</span><span class="p">(</span><span class="n">rule_type</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">configure_alerting</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì„±</span><span class="sh">"""</span>
        <span class="n">alert_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">FlinkJobFailed</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">ClusterDown</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">DataLoss</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">CheckpointFailure</span><span class="sh">"</span>
            <span class="p">],</span>
            <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">HighCheckpointDuration</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">HighBackpressure</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">HighMemoryUsage</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">LowThroughput</span><span class="sh">"</span>
            <span class="p">],</span>
            <span class="sh">"</span><span class="s">info</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">JobStarted</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">JobCompleted</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">ScalingEvent</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">BackupCompleted</span><span class="sh">"</span>
            <span class="p">]</span>
        <span class="p">}</span>
        
        <span class="n">notification_channels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">email</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">recipients</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">admin@company.com</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">oncall@company.com</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">slack</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">webhook_url</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://hooks.slack.com/services/...</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">channels</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">#flink-alerts</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">#data-team</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">pagerduty</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">integration_key</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">integration_key_here</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">configure_alert_rules</span><span class="p">(</span><span class="n">alert_rules</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">configure_notification_channels</span><span class="p">(</span><span class="n">notification_channels</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">setup_backup_system</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°±ì—… ì‹œìŠ¤í…œ ì„¤ì •</span><span class="sh">"""</span>
        <span class="n">backup_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">checkpoints</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-checkpoints/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">compression</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">savepoints</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">24h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-savepoints/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">compression</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">configurations</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">90d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-configs/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">flink-conf.yaml</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">log4j.properties</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">state_backend</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-state/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">encryption</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">aes256</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">configure_backup_system</span><span class="p">(</span><span class="n">backup_config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">create_comprehensive_dashboard</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¢…í•© ëŒ€ì‹œë³´ë“œ ìƒì„±</span><span class="sh">"""</span>
        <span class="n">dashboard_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Enterprise Flink Platform Dashboard</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">panels</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Cluster Overview</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">stat</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_numRunningJobs</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_numCompletedJobs</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_numFailedJobs</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Performance Metrics</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">timeseries</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_operator_numRecordsInPerSecond</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_operator_numRecordsOutPerSecond</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_operator_latency</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Resource Usage</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">timeseries</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_Status_JVM_Memory_Heap_Used</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_Status_JVM_CPU_Load</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_Status_JVM_Threads_Count</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Checkpoint Health</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">timeseries</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_job_lastCheckpointDuration</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_job_lastCheckpointSize</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_job_lastCheckpointAlignmentBuffered</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Backpressure</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">heatmap</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_backPressuredTimeMsPerSecond</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">dashboard_config</span>

<span class="c1"># í”Œë«í¼ ì‹¤í–‰ ì˜ˆì œ
</span><span class="k">def</span> <span class="nf">deploy_enterprise_flink_platform</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">ì—”í„°í”„ë¼ì´ì¦ˆ Flink í”Œë«í¼ ë°°í¬</span><span class="sh">"""</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="nc">EnterpriseFlinkPlatform</span><span class="p">()</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">ğŸš€ Starting Enterprise Flink Platform Deployment...</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 1. í”Œë«í¼ ë°°í¬
</span>    <span class="n">platform</span><span class="p">.</span><span class="nf">deploy_enterprise_platform</span><span class="p">()</span>
    
    <span class="c1"># 2. ëŒ€ì‹œë³´ë“œ ìƒì„±
</span>    <span class="n">dashboard</span> <span class="o">=</span> <span class="n">platform</span><span class="p">.</span><span class="nf">create_comprehensive_dashboard</span><span class="p">()</span>
    
    <span class="c1"># 3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰
</span>    <span class="n">platform</span><span class="p">.</span><span class="nf">run_integration_tests</span><span class="p">()</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">âœ… Enterprise Flink Platform deployed successfully!</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">platform</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="nf">deploy_enterprise_flink_platform</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="-í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="ì´ë²ˆ-íŒŒíŠ¸ì—ì„œ-í•™ìŠµí•œ-ë‚´ìš©">ì´ë²ˆ íŒŒíŠ¸ì—ì„œ í•™ìŠµí•œ ë‚´ìš©</h3>

<ol>
  <li><strong>Kubernetesë¥¼ í™œìš©í•œ Flink í´ëŸ¬ìŠ¤í„° ë°°í¬</strong>
    <ul>
      <li>Flink Operator ì„¤ì¹˜ì™€ ì„¤ì •</li>
      <li>ê³ ê°€ìš©ì„± í´ëŸ¬ìŠ¤í„° êµ¬ì„±</li>
      <li>ìë™ ìŠ¤ì¼€ì¼ë§ ì„¤ì •</li>
      <li>í™˜ê²½ë³„ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬</li>
    </ul>
  </li>
  <li><strong>ì„±ëŠ¥ íŠœë‹ê³¼ ìµœì í™”</strong>
    <ul>
      <li>ë©”ëª¨ë¦¬ ìµœì í™” ì „ëµ</li>
      <li>ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ ìµœì í™”</li>
      <li>ìƒíƒœ ë°±ì—”ë“œ ìµœì í™”</li>
      <li>ì›Œí¬ë¡œë“œë³„ ì„±ëŠ¥ íŠœë‹</li>
    </ul>
  </li>
  <li><strong>ëª¨ë‹ˆí„°ë§ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œ</strong>
    <ul>
      <li>Prometheus ë©”íŠ¸ë¦­ ìˆ˜ì§‘</li>
      <li>Grafana ëŒ€ì‹œë³´ë“œ êµ¬ì„±</li>
      <li>ì•Œë¦¼ ê·œì¹™ ì„¤ì •</li>
      <li>ì¢…í•© ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ</li>
    </ul>
  </li>
  <li><strong>ì¥ì•  ë³µêµ¬ì™€ ìš´ì˜ ì „ëµ</strong>
    <ul>
      <li>ìë™ ì¥ì•  ë³µêµ¬ ì‹œìŠ¤í…œ</li>
      <li>ìš´ì˜ ìë™í™”</li>
      <li>ë°±ì—… ë° ë³µì› ì „ëµ</li>
      <li>ì„œí‚· ë¸Œë ˆì´ì»¤ íŒ¨í„´</li>
    </ul>
  </li>
  <li><strong>ì‹¤ë¬´ í”„ë¡œì íŠ¸</strong>
    <ul>
      <li>ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ Flink í”Œë«í¼</li>
      <li>ì™„ì „ ìë™í™”ëœ ìš´ì˜ í™˜ê²½</li>
      <li>ë‹¤ì¤‘ í™˜ê²½ ê´€ë¦¬</li>
      <li>ì¢…í•© ëŒ€ì‹œë³´ë“œ ì‹œìŠ¤í…œ</li>
    </ul>
  </li>
</ol>

<h3 id="í•µì‹¬-ê¸°ìˆ -ìŠ¤íƒ">í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ</h3>

<table>
  <thead>
    <tr>
      <th>ê¸°ìˆ </th>
      <th>ìš©ë„</th>
      <th>ì¤‘ìš”ë„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Kubernetes</strong></td>
      <td>ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>Flink Operator</strong></td>
      <td>Kubernetes ë„¤ì´í‹°ë¸Œ ê´€ë¦¬</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>Prometheus/Grafana</strong></td>
      <td>ëª¨ë‹ˆí„°ë§ê³¼ ì‹œê°í™”</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>ìë™í™” ì‹œìŠ¤í…œ</strong></td>
      <td>ìš´ì˜ íš¨ìœ¨ì„±</td>
      <td>â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>ì¥ì•  ë³µêµ¬</strong></td>
      <td>ì‹œìŠ¤í…œ ì•ˆì •ì„±</td>
      <td>â­â­â­â­</td>
    </tr>
  </tbody>
</table>

<h3 id="apache-flink-ì‹œë¦¬ì¦ˆ-ì™„ì„±">Apache Flink ì‹œë¦¬ì¦ˆ ì™„ì„±!</h3>

<p>ì¶•í•˜í•©ë‹ˆë‹¤! Apache Flink ì™„ì „ ì •ë³µ ì‹œë¦¬ì¦ˆë¥¼ ëª¨ë‘ ì™„ì£¼í•˜ì…¨ìŠµë‹ˆë‹¤! ğŸ‰</p>

<h4 id="ì‹œë¦¬ì¦ˆ-ì „ì²´-ìš”ì•½"><strong>ì‹œë¦¬ì¦ˆ ì „ì²´ ìš”ì•½:</strong></h4>

<ul>
  <li>âœ… <strong>Part 1</strong>: Apache Flink ê¸°ì´ˆì™€ í•µì‹¬ ê°œë…</li>
  <li>âœ… <strong>Part 2</strong>: ê³ ê¸‰ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì™€ ìƒíƒœ ê´€ë¦¬</li>
  <li>âœ… <strong>Part 3</strong>: ì‹¤ì‹œê°„ ë¶„ì„ê³¼ CEP</li>
  <li>âœ… <strong>Part 4</strong>: í”„ë¡œë•ì…˜ ë°°í¬ì™€ ì„±ëŠ¥ ìµœì í™”</li>
</ul>

<h4 id="ìŠµë“í•œ-í•µì‹¬-ì—­ëŸ‰"><strong>ìŠµë“í•œ í•µì‹¬ ì—­ëŸ‰:</strong></h4>

<ol>
  <li><strong>ê¸°ìˆ ì  ì—­ëŸ‰</strong>
    <ul>
      <li>Apache Flinkì˜ í•µì‹¬ ì•„í‚¤í…ì²˜ ì´í•´</li>
      <li>DataStream APIë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ì²˜ë¦¬ êµ¬í˜„</li>
      <li>ìƒíƒœ ê´€ë¦¬ì™€ ì²´í¬í¬ì¸íŒ… í™œìš©</li>
      <li>ë³µì¡í•œ ì´ë²¤íŠ¸ ì²˜ë¦¬ (CEP) êµ¬í˜„</li>
      <li>í”„ë¡œë•ì…˜ í™˜ê²½ ë°°í¬ì™€ ìš´ì˜</li>
    </ul>
  </li>
  <li><strong>ì‹¤ë¬´ ì—­ëŸ‰</strong>
    <ul>
      <li>ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸ êµ¬ì¶•</li>
      <li>ë§ˆì´í¬ë¡œì´ˆ ë‹¨ìœ„ ì§€ì—°ì‹œê°„ ë‹¬ì„±</li>
      <li>ì¥ì•  ë³µêµ¬ì™€ ìš´ì˜ ìë™í™”</li>
      <li>ì„±ëŠ¥ ìµœì í™”ì™€ ëª¨ë‹ˆí„°ë§</li>
    </ul>
  </li>
  <li><strong>ì—”í„°í”„ë¼ì´ì¦ˆ ì—­ëŸ‰</strong>
    <ul>
      <li>Kubernetes ê¸°ë°˜ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬</li>
      <li>ìë™í™”ëœ ìš´ì˜ ì‹œìŠ¤í…œ êµ¬ì¶•</li>
      <li>ì¢…í•© ëª¨ë‹ˆí„°ë§ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œ</li>
      <li>ì¥ì•  ë³µêµ¬ì™€ ë°±ì—… ì „ëµ</li>
    </ul>
  </li>
</ol>

<p>ì´ì œ Apache Flinkë¥¼ í™œìš©í•˜ì—¬ ì—”í„°í”„ë¼ì´ì¦ˆê¸‰ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì§€ì‹ê³¼ ê²½í—˜ì„ ê°–ì¶”ì…¨ìŠµë‹ˆë‹¤! ğŸš€</p>

<hr />

<p><strong>ì‹œë¦¬ì¦ˆ ì™„ì„±</strong>: <a href="/data-engineering/2025/09/14/apache-flink-series-overview.html">Apache Flink ì™„ì „ ì •ë³µ ì‹œë¦¬ì¦ˆ</a></p>

<hr />

<p><em>Apache Flinkì˜ ì„¸ê³„ì—ì„œ ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ í˜ì„ ê²½í—˜í•˜ì„¸ìš”!</em> ğŸ¯</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
      
        
      
        
          
          
      
      
        
        
        <a href="/data-engineering/2025/09/17/apache-flink-real-time-analytics.html" class="nav-link prev">
          â† ì´ì „: Part 3: Apache Flink ì‹¤ì‹œê°„ ë¶„ì„ê³¼ CEP - ë³µì¡í•œ ì´ë²¤íŠ¸ ì²˜ë¦¬ì˜ ì™„ì„±
        </a>
      
      
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

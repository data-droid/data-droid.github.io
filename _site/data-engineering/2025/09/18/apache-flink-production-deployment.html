<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="Apache Flink를 Kubernetes에서 프로덕션 환경에 배포하고, 성능을 최적화하며, 모니터링과 장애 복구 전략을 구현하는 완전한 가이드입니다.">



<title>Part 4: Apache Flink 프로덕션 배포와 성능 최적화 - 엔터프라이즈급 운영의 완성 - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 4: Apache Flink 프로덕션 배포와 성능 최적화 - 엔터프라이즈급 운영의 완성">
<meta property="og:description" content="Apache Flink를 Kubernetes에서 프로덕션 환경에 배포하고, 성능을 최적화하며, 모니터링과 장애 복구 전략을 구현하는 완전한 가이드입니다.">
<meta property="og:url" content="http://localhost:4000/data-engineering/2025/09/18/apache-flink-production-deployment.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 4: Apache Flink 프로덕션 배포와 성능 최적화 - 엔터프라이즈급 운영의 완성">
<meta name="twitter:description" content="Apache Flink를 Kubernetes에서 프로덕션 환경에 배포하고, 성능을 최적화하며, 모니터링과 장애 복구 전략을 구현하는 완전한 가이드입니다.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="메뉴 열기/닫기">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">홈</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">카테고리</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">데이터 엔지니어링</a></li>
              <li><a href="/categories/bi-engineering/">BI 엔지니어링</a></li>
              <li><a href="/categories/infrastructure-tools/">인프라 & 도구</a></li>
              <li><a href="/categories/data-quality/">데이터 품질</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">블로그</a></li>
        <li><a href="/about/">소개</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- 포스트용 언어 전환 -->
        
          <a href="/data-engineering/2025/09/18/apache-flink-production-deployment.html" class="lang-btn active">한국어</a>
          
          <a href="/en_posts/2025-09-18-apache-flink-production-deployment.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data engineering</span>
      <span class="post-date">2025년 09월 18일</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 4: Apache Flink 프로덕션 배포와 성능 최적화 - 엔터프라이즈급 운영의 완성</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">Apache-Flink</span>
      
        <span class="tag">Kubernetes</span>
      
        <span class="tag">프로덕션배포</span>
      
        <span class="tag">성능최적화</span>
      
        <span class="tag">모니터링</span>
      
        <span class="tag">장애복구</span>
      
        <span class="tag">DevOps</span>
      
        <span class="tag">CI/CD</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">📚 Apache flink complete guide 시리즈</span>
      <span class="series-order">Part 5</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">⏱️ 50분</span>
      
      
        <span class="difficulty">📊 고급</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-4-apache-flink-프로덕션-배포와-성능-최적화---엔터프라이즈급-운영의-완성">Part 4: Apache Flink 프로덕션 배포와 성능 최적화 - 엔터프라이즈급 운영의 완성</h1>

<blockquote>
  <p>Apache Flink를 Kubernetes에서 프로덕션 환경에 배포하고, 성능을 최적화하며, 모니터링과 장애 복구 전략을 구현하는 완전한 가이드입니다.</p>
</blockquote>

<h2 id="-목차">📋 목차</h2>

<ol>
  <li><a href="#kubernetes를-활용한-flink-클러스터-배포">Kubernetes를 활용한 Flink 클러스터 배포</a></li>
  <li><a href="#성능-튜닝과-최적화">성능 튜닝과 최적화</a></li>
  <li><a href="#모니터링과-알림-시스템">모니터링과 알림 시스템</a></li>
  <li><a href="#장애-복구와-운영-전략">장애 복구와 운영 전략</a></li>
  <li><a href="#실무-프로젝트-엔터프라이즈급-flink-플랫폼">실무 프로젝트: 엔터프라이즈급 Flink 플랫폼</a></li>
  <li><a href="#학습-요약">학습 요약</a></li>
</ol>

<h2 id="-kubernetes를-활용한-flink-클러스터-배포">🚀 Kubernetes를 활용한 Flink 클러스터 배포</h2>

<h3 id="flink-on-kubernetes-아키텍처">Flink on Kubernetes 아키텍처</h3>

<p>Kubernetes에서 Flink를 실행하면 다음과 같은 이점을 얻을 수 있습니다:</p>
<ul>
  <li><strong>자동 스케일링</strong>: 워크로드에 따라 자동으로 리소스 조정</li>
  <li><strong>고가용성</strong>: Pod 장애 시 자동 복구</li>
  <li><strong>리소스 관리</strong>: 효율적인 메모리와 CPU 사용</li>
  <li><strong>서비스 디스커버리</strong>: 내장된 네트워킹과 로드 밸런싱</li>
</ul>

<h3 id="1-flink-operator-설치">1. Flink Operator 설치</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-operator-install.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Namespace</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">apps/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Deployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">selector</span><span class="pi">:</span>
    <span class="na">matchLabels</span><span class="pi">:</span>
      <span class="na">app</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">metadata</span><span class="pi">:</span>
      <span class="na">labels</span><span class="pi">:</span>
        <span class="na">app</span><span class="pi">:</span> <span class="s">flink-operator</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">serviceAccountName</span><span class="pi">:</span> <span class="s">flink-operator</span>
      <span class="na">containers</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
        <span class="na">image</span><span class="pi">:</span> <span class="s">apache/flink-kubernetes-operator:1.7.0</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span>
        <span class="na">env</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">OPERATOR_NAME</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">flink-operator"</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">WATCH_NAMESPACE</span>
          <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">"</span>
        <span class="na">resources</span><span class="pi">:</span>
          <span class="na">requests</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">256Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">100m"</span>
          <span class="na">limits</span><span class="pi">:</span>
            <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">512Mi"</span>
            <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">500m"</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ServiceAccount</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">rules</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">apps"</span><span class="pi">]</span>
  <span class="na">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">deployments"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">statefulsets"</span><span class="pi">]</span>
  <span class="na">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">get"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">list"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">watch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">create"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">update"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">patch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">delete"</span><span class="pi">]</span>
<span class="pi">-</span> <span class="na">apiGroups</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">"</span><span class="pi">]</span>
  <span class="na">resources</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">pods"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">services"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">configmaps"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">secrets"</span><span class="pi">]</span>
  <span class="na">verbs</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">get"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">list"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">watch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">create"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">update"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">patch"</span><span class="pi">,</span> <span class="s2">"</span><span class="s">delete"</span><span class="pi">]</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRoleBinding</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">roleRef</span><span class="pi">:</span>
  <span class="na">apiGroup</span><span class="pi">:</span> <span class="s">rbac.authorization.k8s.io</span>
  <span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterRole</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
<span class="na">subjects</span><span class="pi">:</span>
<span class="pi">-</span> <span class="na">kind</span><span class="pi">:</span> <span class="s">ServiceAccount</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-operator</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-operator</span>
</code></pre></div></div>

<h3 id="2-flink-application-배포">2. Flink Application 배포</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-application.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">flink.apache.org/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">FlinkDeployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">real-time-analytics</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">image</span><span class="pi">:</span> <span class="s">flink:1.18-scala_2.12-java11</span>
  <span class="na">flinkVersion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1.18"</span>
  <span class="na">flinkConfiguration</span><span class="pi">:</span>
    <span class="na">taskmanager.numberOfTaskSlots</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4"</span>
    <span class="na">parallelism.default</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4"</span>
    <span class="na">state.backend</span><span class="pi">:</span> <span class="s2">"</span><span class="s">rocksdb"</span>
    <span class="na">state.checkpoints.dir</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-checkpoints/checkpoints"</span>
    <span class="na">state.savepoints.dir</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-savepoints/savepoints"</span>
    <span class="na">execution.checkpointing.interval</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">execution.checkpointing.mode</span><span class="pi">:</span> <span class="s2">"</span><span class="s">EXACTLY_ONCE"</span>
    <span class="na">execution.checkpointing.timeout</span><span class="pi">:</span> <span class="s2">"</span><span class="s">600s"</span>
    <span class="na">execution.checkpointing.min-pause</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">execution.checkpointing.max-concurrent-checkpoints</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
    <span class="na">restart-strategy</span><span class="pi">:</span> <span class="s2">"</span><span class="s">fixed-delay"</span>
    <span class="na">restart-strategy.fixed-delay.attempts</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3"</span>
    <span class="na">restart-strategy.fixed-delay.delay</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10s"</span>
    <span class="na">high-availability</span><span class="pi">:</span> <span class="s2">"</span><span class="s">kubernetes"</span>
    <span class="na">high-availability.storageDir</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-ha/ha"</span>
  <span class="na">serviceAccount</span><span class="pi">:</span> <span class="s">flink-service-account</span>
  <span class="na">jobManager</span><span class="pi">:</span>
    <span class="na">replicas</span><span class="pi">:</span> <span class="m">1</span>
    <span class="na">resource</span><span class="pi">:</span>
      <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2048m"</span>
      <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000m"</span>
    <span class="na">podTemplate</span><span class="pi">:</span>
      <span class="na">spec</span><span class="pi">:</span>
        <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-main-container</span>
          <span class="na">env</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">JAVA_OPTS</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">-Xmx1536m"</span>
          <span class="na">resources</span><span class="pi">:</span>
            <span class="na">requests</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2048m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000m"</span>
            <span class="na">limits</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2048m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1000m"</span>
  <span class="na">taskManager</span><span class="pi">:</span>
    <span class="na">replicas</span><span class="pi">:</span> <span class="m">3</span>
    <span class="na">resource</span><span class="pi">:</span>
      <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4096m"</span>
      <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
    <span class="na">podTemplate</span><span class="pi">:</span>
      <span class="na">spec</span><span class="pi">:</span>
        <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-main-container</span>
          <span class="na">env</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">JAVA_OPTS</span>
            <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">-Xmx3072m"</span>
          <span class="na">resources</span><span class="pi">:</span>
            <span class="na">requests</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4096m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
            <span class="na">limits</span><span class="pi">:</span>
              <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">4096m"</span>
              <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2000m"</span>
  <span class="na">job</span><span class="pi">:</span>
    <span class="na">jarURI</span><span class="pi">:</span> <span class="s2">"</span><span class="s">s3://flink-jobs/real-time-analytics.jar"</span>
    <span class="na">parallelism</span><span class="pi">:</span> <span class="m">8</span>
    <span class="na">upgradeMode</span><span class="pi">:</span> <span class="s2">"</span><span class="s">stateless"</span>
    <span class="na">allowNonRestoredState</span><span class="pi">:</span> <span class="kc">false</span>
</code></pre></div></div>

<h3 id="3-고가용성-설정">3. 고가용성 설정</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-ha-config.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">flink-ha-config</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-production</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">flink-conf.yaml</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s"># 고가용성 설정</span>
    <span class="s">high-availability: kubernetes</span>
    <span class="s">high-availability.cluster-id: flink-cluster</span>
    <span class="s">high-availability.storageDir: s3://flink-ha/ha</span>
    
    <span class="s"># ZooKeeper 설정 (선택사항)</span>
    <span class="s"># high-availability.zookeeper.quorum: zookeeper-service:2181</span>
    <span class="s"># high-availability.zookeeper.path.root: /flink</span>
    
    <span class="s"># Kubernetes 리더 선택기</span>
    <span class="s">kubernetes.operator.leader.election.lease-duration: 15s</span>
    <span class="s">kubernetes.operator.leader.election.renew-deadline: 10s</span>
    <span class="s">kubernetes.operator.leader.election.retry-period: 2s</span>
    
    <span class="s"># 체크포인트 설정</span>
    <span class="s">state.backend: rocksdb</span>
    <span class="s">state.backend.incremental: true</span>
    <span class="s">state.checkpoints.dir: s3://flink-checkpoints/checkpoints</span>
    <span class="s">state.savepoints.dir: s3://flink-savepoints/savepoints</span>
    <span class="s">execution.checkpointing.interval: 60s</span>
    <span class="s">execution.checkpointing.mode: EXACTLY_ONCE</span>
    <span class="s">execution.checkpointing.timeout: 600s</span>
    <span class="s">execution.checkpointing.min-pause: 60s</span>
    <span class="s">execution.checkpointing.max-concurrent-checkpoints: 1</span>
    
    <span class="s"># 재시작 전략</span>
    <span class="s">restart-strategy: fixed-delay</span>
    <span class="s">restart-strategy.fixed-delay.attempts: 3</span>
    <span class="s">restart-strategy.fixed-delay.delay: 10s</span>
    
    <span class="s"># 메트릭 설정</span>
    <span class="s">metrics.reporter.prom.class: org.apache.flink.metrics.prometheus.PrometheusReporter</span>
    <span class="s">metrics.reporter.prom.port: 9249</span>
    <span class="s">metrics.system-resource: true</span>
    <span class="s">metrics.system-resource-probing-interval: 5000</span>
</code></pre></div></div>

<h3 id="4-자동-스케일링-설정">4. 자동 스케일링 설정</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-autoscaling.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">flink.apache.org/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">FlinkDeployment</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">auto-scaling-flink-app</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">flink-production</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">flinkConfiguration</span><span class="pi">:</span>
    <span class="c1"># 자동 스케일링 활성화</span>
    <span class="na">kubernetes.operator.auto-scaling.enabled</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.window</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.delay</span><span class="pi">:</span> <span class="s2">"</span><span class="s">30s"</span>
    <span class="na">kubernetes.operator.auto-scaling.scale-up.grace-period</span><span class="pi">:</span> <span class="s2">"</span><span class="s">60s"</span>
    <span class="na">kubernetes.operator.auto-scaling.scale-down.grace-period</span><span class="pi">:</span> <span class="s2">"</span><span class="s">300s"</span>
    
    <span class="c1"># 스케일링 임계값</span>
    <span class="na">kubernetes.operator.auto-scaling.target.utilization</span><span class="pi">:</span> <span class="s2">"</span><span class="s">0.8"</span>
    <span class="na">kubernetes.operator.auto-scaling.min.replicas</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2"</span>
    <span class="na">kubernetes.operator.auto-scaling.max.replicas</span><span class="pi">:</span> <span class="s2">"</span><span class="s">10"</span>
    
    <span class="c1"># 스케일링 메트릭</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.jvm.cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.jvm.memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.operator.num-records-in</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
    <span class="na">kubernetes.operator.auto-scaling.metrics.operator.num-records-out</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
  <span class="na">taskManager</span><span class="pi">:</span>
    <span class="na">replicas</span><span class="pi">:</span> <span class="m">2</span>
    <span class="c1"># HPA 설정</span>
    <span class="na">horizontalPodAutoscaler</span><span class="pi">:</span>
      <span class="na">minReplicas</span><span class="pi">:</span> <span class="m">2</span>
      <span class="na">maxReplicas</span><span class="pi">:</span> <span class="m">10</span>
      <span class="na">metrics</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Resource</span>
        <span class="na">resource</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">cpu</span>
          <span class="na">target</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">Utilization</span>
            <span class="na">averageUtilization</span><span class="pi">:</span> <span class="m">80</span>
      <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Resource</span>
        <span class="na">resource</span><span class="pi">:</span>
          <span class="na">name</span><span class="pi">:</span> <span class="s">memory</span>
          <span class="na">target</span><span class="pi">:</span>
            <span class="na">type</span><span class="pi">:</span> <span class="s">Utilization</span>
            <span class="na">averageUtilization</span><span class="pi">:</span> <span class="m">80</span>
      <span class="na">behavior</span><span class="pi">:</span>
        <span class="na">scaleDown</span><span class="pi">:</span>
          <span class="na">stabilizationWindowSeconds</span><span class="pi">:</span> <span class="m">300</span>
          <span class="na">policies</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Percent</span>
            <span class="na">value</span><span class="pi">:</span> <span class="m">10</span>
            <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">60</span>
        <span class="na">scaleUp</span><span class="pi">:</span>
          <span class="na">stabilizationWindowSeconds</span><span class="pi">:</span> <span class="m">60</span>
          <span class="na">policies</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">type</span><span class="pi">:</span> <span class="s">Percent</span>
            <span class="na">value</span><span class="pi">:</span> <span class="m">100</span>
            <span class="na">periodSeconds</span><span class="pi">:</span> <span class="m">60</span>
</code></pre></div></div>

<h2 id="-성능-튜닝과-최적화">⚡ 성능 튜닝과 최적화</h2>

<h3 id="1-메모리-최적화">1. 메모리 최적화</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlinkMemoryOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">memory_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">generate_optimized_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">workload_type</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">워크로드 타입에 따른 메모리 설정 최적화</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">streaming</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_streaming_memory_config</span><span class="p">(</span><span class="n">data_volume</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">batch</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_batch_memory_config</span><span class="p">(</span><span class="n">data_volume</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">machine_learning</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_ml_memory_config</span><span class="p">(</span><span class="n">data_volume</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_default_memory_config</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_streaming_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">스트리밍 워크로드용 메모리 설정</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">low</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># &lt; 1GB/min
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">medium</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># 1-10GB/min
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># &gt; 10GB/min
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
            <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_batch_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">배치 워크로드용 메모리 설정</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">small</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># &lt; 100GB
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">elif</span> <span class="n">data_volume</span> <span class="o">==</span> <span class="sh">"</span><span class="s">large</span><span class="sh">"</span><span class="p">:</span>  <span class="c1"># 100GB - 1TB
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># &gt; 1TB
</span>            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
            <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_ml_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_volume</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">머신러닝 워크로드용 메모리 설정</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">12g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">6g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.15</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_default_memory_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">기본 메모리 설정</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-metaspace.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512m</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.jvm-overhead.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.network.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span>
        <span class="p">}</span>
</code></pre></div></div>

<h3 id="2-네트워크-최적화">2. 네트워크 최적화</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">NetworkOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">network_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_network_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cluster_size</span><span class="p">,</span> <span class="n">data_throughput</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">네트워크 성능 최적화</span><span class="sh">"""</span>
        
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># 네트워크 버퍼 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.min</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">128mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1gb</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 네트워크 스레드 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.netty.num-arenas</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">cluster_size</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.server.numThreads</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.numThreads</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 연결 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.netty.server.backlog</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.connectTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 버퍼 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.memory.buffers-per-channel</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.floating-buffers-per-gate</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="c1"># 데이터 처리량에 따른 추가 최적화
</span>        <span class="k">if</span> <span class="n">data_throughput</span> <span class="o">&gt;</span> <span class="mi">1000</span><span class="p">:</span>  <span class="c1"># MB/s
</span>            <span class="n">config</span><span class="p">.</span><span class="nf">update</span><span class="p">({</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.3</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2gb</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.buffers-per-channel</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">taskmanager.network.memory.floating-buffers-per-gate</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16</span><span class="sh">"</span><span class="p">,</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">config</span>
    
    <span class="k">def</span> <span class="nf">optimize_shuffle_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_size</span><span class="p">,</span> <span class="n">parallelism</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Shuffle 성능 최적화</span><span class="sh">"""</span>
        
        <span class="c1"># 데이터 크기에 따른 파티션 수 조정
</span>        <span class="n">optimal_partitions</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="nf">max</span><span class="p">(</span><span class="n">data_size</span> <span class="o">//</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1000</span><span class="p">)</span>
        
        <span class="n">config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="nf">min</span><span class="p">(</span><span class="n">parallelism</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span>
            <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">parallelism</span><span class="p">),</span>
            
            <span class="c1"># Shuffle 최적화
</span>            <span class="sh">"</span><span class="s">taskmanager.memory.segment-size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">32kb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.sort-shuffle.min-parallelism</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.sort-shuffle.min-buffers</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">64</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 압축 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.compression.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.compression.codec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">lz4</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">config</span>
</code></pre></div></div>

<h3 id="3-상태-백엔드-최적화">3. 상태 백엔드 최적화</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StateBackendOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">rocksdb_configs</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_rocksdb_backend</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">,</span> <span class="n">access_pattern</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">RocksDB 백엔드 최적화</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">access_pattern</span> <span class="o">==</span> <span class="sh">"</span><span class="s">read_heavy</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_read_optimized_config</span><span class="p">(</span><span class="n">state_size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">access_pattern</span> <span class="o">==</span> <span class="sh">"</span><span class="s">write_heavy</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_write_optimized_config</span><span class="p">(</span><span class="n">state_size</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">access_pattern</span> <span class="o">==</span> <span class="sh">"</span><span class="s">mixed</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_balanced_config</span><span class="p">(</span><span class="n">state_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_default_config</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">get_read_optimized_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">읽기 최적화 설정</span><span class="sh">"""</span>
        <span class="n">block_cache_size</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">512</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>  <span class="c1"># 512MB max
</span>        
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># 블록 캐시 최적화
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">block_cache_size</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size-per-column-family</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">block_cache_size</span> <span class="o">//</span> <span class="mi">4</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 블록 크기 최적화
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.blocksize</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16kb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.bloom-filter-bits-per-key</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 압축 설정
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-slowdown-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">20</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-stop-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">36</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 읽기 최적화
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.readoptions.async-io</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.readoptions.cache-index-and-filter-blocks</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_write_optimized_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">쓰기 최적화 설정</span><span class="sh">"""</span>
        <span class="n">write_buffer_size</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span>  <span class="c1"># 128MB max
</span>        
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># 쓰기 버퍼 최적화
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.write-buffer-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">write_buffer_size</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.max-write-buffer-number</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.min-write-buffer-number-to-merge</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># WAL 설정
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.wal.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.wal.sync</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 압축 설정
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-slowdown-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-stop-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">12</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 쓰기 최적화
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.writeoptions.sync</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.writeoptions.disable-wal</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">false</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_balanced_config</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">state_size</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">균형 잡힌 설정</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="c1"># 블록 캐시
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">256</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 쓰기 버퍼
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.write-buffer-size</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="nf">min</span><span class="p">(</span><span class="n">state_size</span> <span class="o">//</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">64</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)</span><span class="si">}</span><span class="s">b</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.max-write-buffer-number</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 압축 설정
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-slowdown-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">20</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-stop-writes-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">36</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 일반 설정
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.blocksize</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16kb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.wal.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="-모니터링과-알림-시스템">📊 모니터링과 알림 시스템</h2>

<h3 id="1-prometheus-메트릭-설정">1. Prometheus 메트릭 설정</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># prometheus-config.yaml</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ConfigMap</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">prometheus-config</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">monitoring</span>
<span class="na">data</span><span class="pi">:</span>
  <span class="na">prometheus.yml</span><span class="pi">:</span> <span class="pi">|</span>
    <span class="s">global:</span>
      <span class="s">scrape_interval: 15s</span>
      <span class="s">evaluation_interval: 15s</span>
    
    <span class="s">rule_files:</span>
      <span class="s">- "flink_rules.yml"</span>
    
    <span class="s">alerting:</span>
      <span class="s">alertmanagers:</span>
        <span class="s">- static_configs:</span>
            <span class="s">- targets:</span>
              <span class="s">- alertmanager:9093</span>
    
    <span class="s">scrape_configs:</span>
      <span class="s">- job_name: 'flink-jobmanager'</span>
        <span class="s">static_configs:</span>
          <span class="s">- targets: ['flink-jobmanager:9249']</span>
        <span class="s">scrape_interval: 10s</span>
        <span class="s">metrics_path: /metrics</span>
    <span class="no">    </span>
      <span class="s">- job_name: 'flink-taskmanager'</span>
        <span class="s">kubernetes_sd_configs:</span>
          <span class="s">- role: pod</span>
            <span class="s">namespaces:</span>
              <span class="s">names:</span>
                <span class="s">- flink-production</span>
        <span class="s">relabel_configs:</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_label_app]</span>
            <span class="s">action: keep</span>
            <span class="s">regex: flink-taskmanager</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_container_port_name]</span>
            <span class="s">action: keep</span>
            <span class="s">regex: metrics</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_name]</span>
            <span class="s">target_label: instance</span>
        <span class="s">scrape_interval: 10s</span>
        <span class="s">metrics_path: /metrics</span>
    <span class="no">    </span>
      <span class="s">- job_name: 'kubernetes-pods'</span>
        <span class="s">kubernetes_sd_configs:</span>
          <span class="s">- role: pod</span>
        <span class="s">relabel_configs:</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_scrape]</span>
            <span class="s">action: keep</span>
            <span class="s">regex: true</span>
          <span class="s">- source_labels: [__meta_kubernetes_pod_annotation_prometheus_io_path]</span>
            <span class="s">action: replace</span>
            <span class="s">target_label: __metrics_path__</span>
            <span class="s">regex: (.+)</span>
</code></pre></div></div>

<h3 id="2-grafana-대시보드-설정">2. Grafana 대시보드 설정</h3>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"dashboard"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Apache Flink Production Dashboard"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"panels"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Job Status"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"stat"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_jobmanager_numRunningJobs"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"fieldConfig"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="nl">"defaults"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"mode"</span><span class="p">:</span><span class="w"> </span><span class="s2">"thresholds"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"thresholds"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="nl">"steps"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="p">{</span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"green"</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"yellow"</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">},</span><span class="w">
                </span><span class="p">{</span><span class="nl">"color"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">}</span><span class="w">
              </span><span class="p">]</span><span class="w">
            </span><span class="p">}</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Records Processed Per Second"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sum(rate(flink_taskmanager_job_task_operator_numRecordsInPerSecond[5m])) by (job_name)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Records/sec"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Checkpoint Duration"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_jobmanager_job_lastCheckpointDuration"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Duration (ms)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Memory Usage"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_taskmanager_Status_JVM_Memory_Heap_Used"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_taskmanager_Status_JVM_Memory_Heap_Max"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"B"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Memory (bytes)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="p">{</span><span class="w">
        </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
        </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Backpressure"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"timeseries"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"targets"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"expr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"flink_taskmanager_job_task_backPressuredTimeMsPerSecond"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"refId"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A"</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"yAxes"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="nl">"label"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Backpressure (ms/sec)"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
          </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="3-알림-규칙-설정">3. 알림 규칙 설정</h3>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># flink-alert-rules.yml</span>
<span class="na">groups</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">flink-alerts</span>
    <span class="na">rules</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">FlinkJobFailed</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">flink_jobmanager_job_status == </span><span class="m">0</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">1m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">critical</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Flink</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">failed"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Flink</span><span class="nv"> </span><span class="s">job</span><span class="nv"> </span><span class="s">has</span><span class="nv"> </span><span class="s">been</span><span class="nv"> </span><span class="s">in</span><span class="nv"> </span><span class="s">failed</span><span class="nv"> </span><span class="s">state</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">more</span><span class="nv"> </span><span class="s">than</span><span class="nv"> </span><span class="s">1</span><span class="nv"> </span><span class="s">minute"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighCheckpointDuration</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">flink_jobmanager_job_lastCheckpointDuration &gt; </span><span class="m">60000</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">checkpoint</span><span class="nv"> </span><span class="s">duration</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Checkpoint</span><span class="nv"> </span><span class="s">duration</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">threshold"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighBackpressure</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">flink_taskmanager_job_task_backPressuredTimeMsPerSecond &gt; </span><span class="m">1000</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">2m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">backpressure</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Task</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">experiencing</span><span class="nv"> </span><span class="s">high</span><span class="nv"> </span><span class="s">backpressure"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">HighMemoryUsage</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">(flink_taskmanager_Status_JVM_Memory_Heap_Used / flink_taskmanager_Status_JVM_Memory_Heap_Max) &gt; </span><span class="m">0.9</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">5m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">High</span><span class="nv"> </span><span class="s">memory</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">TaskManager</span><span class="nv"> </span><span class="s">memory</span><span class="nv"> </span><span class="s">usage</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">above</span><span class="nv"> </span><span class="s">threshold"</span>
      
      <span class="pi">-</span> <span class="na">alert</span><span class="pi">:</span> <span class="s">LowThroughput</span>
        <span class="na">expr</span><span class="pi">:</span> <span class="s">rate(flink_taskmanager_job_task_operator_numRecordsInPerSecond[5m]) &lt; </span><span class="m">100</span>
        <span class="na">for</span><span class="pi">:</span> <span class="s">10m</span>
        <span class="na">labels</span><span class="pi">:</span>
          <span class="na">severity</span><span class="pi">:</span> <span class="s">warning</span>
        <span class="na">annotations</span><span class="pi">:</span>
          <span class="na">summary</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Low</span><span class="nv"> </span><span class="s">throughput</span><span class="nv"> </span><span class="s">detected"</span>
          <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Job</span><span class="nv"> </span><span class="s">throughput</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">below</span><span class="nv"> </span><span class="s">normal</span><span class="nv"> </span><span class="s">threshold"</span>
</code></pre></div></div>

<h2 id="-장애-복구와-운영-전략">🔧 장애 복구와 운영 전략</h2>

<h3 id="1-자동-장애-복구-시스템">1. 자동 장애 복구 시스템</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlinkDisasterRecovery</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">kubernetes_client</span><span class="p">,</span> <span class="n">flink_client</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span> <span class="o">=</span> <span class="n">kubernetes_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span> <span class="o">=</span> <span class="n">flink_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">recovery_strategies</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_disaster_recovery</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">재해 복구 시스템 설정</span><span class="sh">"""</span>
        
        <span class="c1"># 1. 체크포인트 모니터링
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_checkpoint_monitoring</span><span class="p">()</span>
        
        <span class="c1"># 2. 자동 재시작 설정
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_restart</span><span class="p">()</span>
        
        <span class="c1"># 3. 백업 및 복원 시스템
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_backup_system</span><span class="p">()</span>
        
        <span class="c1"># 4. 장애 전파 방지
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_circuit_breaker</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_checkpoint_monitoring</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">체크포인트 모니터링 설정</span><span class="sh">"""</span>
        <span class="n">checkpoint_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">EXACTLY_ONCE</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">600s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.min-pause</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.max-concurrent-checkpoints</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.unaligned</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.alignment-timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0s</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 체크포인트 저장소
</span>            <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rocksdb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.checkpoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-checkpoints/checkpoints</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.savepoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-savepoints/savepoints</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 고가용성
</span>            <span class="sh">"</span><span class="s">high-availability</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">kubernetes</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">high-availability.storageDir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-ha/ha</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">high-availability.cluster-id</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">flink-cluster</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">checkpoint_config</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_restart</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">자동 재시작 설정</span><span class="sh">"""</span>
        <span class="n">restart_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">exponential-delay</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.initial-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.max-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2min</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.backoff-multiplier</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2.0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.reset-backoff-threshold</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10min</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.jitter-factor</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">restart_config</span>
    
    <span class="k">def</span> <span class="nf">setup_backup_system</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">백업 시스템 설정</span><span class="sh">"""</span>
        <span class="n">backup_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># 자동 세이브포인트
</span>            <span class="sh">"</span><span class="s">execution.savepoint.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.savepoint.trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">periodic</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 백업 저장소
</span>            <span class="sh">"</span><span class="s">state.backend.incremental</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.checkpoint.transfer.thread.num</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 압축 설정
</span>            <span class="sh">"</span><span class="s">state.backend.rocksdb.compression.type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">LZ4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level.max-size-level-base</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256mb</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">backup_config</span>
    
    <span class="k">def</span> <span class="nf">setup_circuit_breaker</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">서킷 브레이커 설정</span><span class="sh">"""</span>
        <span class="n">circuit_breaker_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># 네트워크 타임아웃
</span>            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.connectTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.requestTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 재시도 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.retries</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.retry-delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            
            <span class="c1"># 백프레셔 설정
</span>            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1gb</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">circuit_breaker_config</span>
    
    <span class="k">def</span> <span class="nf">execute_disaster_recovery</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">failure_type</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">재해 복구 실행</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">job_failure</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">cluster_failure</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_cluster_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">failure_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">data_corruption</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_data_corruption</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_unknown_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">작업 실패에서 복구</span><span class="sh">"""</span>
        <span class="n">recovery_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">1. 실패한 작업 중지</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">2. 최신 체크포인트 확인</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">3. 상태 백엔드 검증</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">4. 작업 재시작</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">5. 복구 상태 모니터링</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="c1"># 실제 복구 로직 구현
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. 작업 중지
</span>            <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">cancel_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            
            <span class="c1"># 2. 최신 체크포인트 확인
</span>            <span class="n">latest_checkpoint</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_latest_checkpoint</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            
            <span class="c1"># 3. 상태 검증
</span>            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">validate_checkpoint</span><span class="p">(</span><span class="n">latest_checkpoint</span><span class="p">):</span>
                <span class="c1"># 4. 작업 재시작
</span>                <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">restart_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">latest_checkpoint</span><span class="p">)</span>
                <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Job recovered successfully</span><span class="sh">"</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 5. 세이브포인트에서 복구 시도
</span>                <span class="n">latest_savepoint</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_latest_savepoint</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">latest_savepoint</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">restart_job</span><span class="p">(</span><span class="n">job_name</span><span class="p">,</span> <span class="n">latest_savepoint</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Job recovered from savepoint</span><span class="sh">"</span><span class="p">}</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">failed</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">No valid checkpoint or savepoint found</span><span class="sh">"</span><span class="p">}</span>
                    
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Recovery failed: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">recover_from_cluster_failure</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">클러스터 실패에서 복구</span><span class="sh">"""</span>
        <span class="n">recovery_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">1. 클러스터 상태 확인</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">2. Kubernetes 리소스 재시작</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">3. Flink 클러스터 재배포</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">4. 작업 복구</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">5. 전체 시스템 검증</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># 1. 클러스터 상태 확인
</span>            <span class="n">cluster_status</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">check_cluster_status</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">cluster_status</span><span class="p">[</span><span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># 2. 클러스터 재시작
</span>                <span class="n">self</span><span class="p">.</span><span class="nf">restart_flink_cluster</span><span class="p">()</span>
                
                <span class="c1"># 3. 작업 복구
</span>                <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">recover_from_job_failure</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
                
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Cluster recovery failed: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_latest_checkpoint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">최신 체크포인트 조회</span><span class="sh">"""</span>
        <span class="n">checkpoints</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">list_checkpoints</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">checkpoints</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">max</span><span class="p">(</span><span class="n">checkpoints</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">get_latest_savepoint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">최신 세이브포인트 조회</span><span class="sh">"""</span>
        <span class="n">savepoints</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">flink_client</span><span class="p">.</span><span class="nf">list_savepoints</span><span class="p">(</span><span class="n">job_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">savepoints</span><span class="p">:</span>
            <span class="k">return</span> <span class="nf">max</span><span class="p">(</span><span class="n">savepoints</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">])</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">validate_checkpoint</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">체크포인트 유효성 검증</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">checkpoint</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>
        
        <span class="c1"># 체크포인트 파일 존재 확인
</span>        <span class="c1"># 체크포인트 메타데이터 검증
</span>        <span class="c1"># 체크포인트 무결성 검사
</span>        
        <span class="k">return</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">check_cluster_status</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">클러스터 상태 확인</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Kubernetes 클러스터 상태 확인
</span>            <span class="n">pods</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span><span class="p">.</span><span class="nf">list_pods_for_all_namespaces</span><span class="p">(</span>
                <span class="n">label_selector</span><span class="o">=</span><span class="sh">"</span><span class="s">app=flink</span><span class="sh">"</span>
            <span class="p">)</span>
            
            <span class="n">healthy_pods</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">total_pods</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">pods</span><span class="p">.</span><span class="n">items</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">pod</span> <span class="ow">in</span> <span class="n">pods</span><span class="p">.</span><span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">pod</span><span class="p">.</span><span class="n">status</span><span class="p">.</span><span class="n">phase</span> <span class="o">==</span> <span class="sh">"</span><span class="s">Running</span><span class="sh">"</span><span class="p">:</span>
                    <span class="n">healthy_pods</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="n">health_ratio</span> <span class="o">=</span> <span class="n">healthy_pods</span> <span class="o">/</span> <span class="n">total_pods</span> <span class="k">if</span> <span class="n">total_pods</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span><span class="p">:</span> <span class="n">health_ratio</span> <span class="o">&gt;</span> <span class="mf">0.8</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">health_ratio</span><span class="sh">"</span><span class="p">:</span> <span class="n">health_ratio</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">total_pods</span><span class="sh">"</span><span class="p">:</span> <span class="n">total_pods</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">healthy_pods</span><span class="sh">"</span><span class="p">:</span> <span class="n">healthy_pods</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">healthy</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)}</span>
    
    <span class="k">def</span> <span class="nf">restart_flink_cluster</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Flink 클러스터 재시작</span><span class="sh">"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># JobManager 재시작
</span>            <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span><span class="p">.</span><span class="nf">delete_namespaced_deployment</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-jobmanager</span><span class="sh">"</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-production</span><span class="sh">"</span>
            <span class="p">)</span>
            
            <span class="c1"># TaskManager 재시작
</span>            <span class="n">self</span><span class="p">.</span><span class="n">k8s_client</span><span class="p">.</span><span class="nf">delete_namespaced_deployment</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-taskmanager</span><span class="sh">"</span><span class="p">,</span>
                <span class="n">namespace</span><span class="o">=</span><span class="sh">"</span><span class="s">flink-production</span><span class="sh">"</span>
            <span class="p">)</span>
            
            <span class="c1"># 재시작 대기
</span>            <span class="kn">import</span> <span class="n">time</span>
            <span class="n">time</span><span class="p">.</span><span class="nf">sleep</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
            
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">success</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Cluster restarted successfully</span><span class="sh">"</span><span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">"</span><span class="s">status</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">error</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">message</span><span class="sh">"</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">Cluster restart failed: </span><span class="si">{</span><span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">}</span>
</code></pre></div></div>

<h3 id="2-운영-자동화-시스템">2. 운영 자동화 시스템</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">FlinkOperationsAutomation</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">operation_templates</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">monitoring_thresholds</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_operational_automation</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">운영 자동화 시스템 설정</span><span class="sh">"""</span>
        
        <span class="c1"># 1. 자동 스케일링
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_scaling</span><span class="p">()</span>
        
        <span class="c1"># 2. 자동 백업
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_backup</span><span class="p">()</span>
        
        <span class="c1"># 3. 자동 업데이트
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_update</span><span class="p">()</span>
        
        <span class="c1"># 4. 자동 모니터링
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">setup_auto_monitoring</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_scaling</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">자동 스케일링 설정</span><span class="sh">"""</span>
        <span class="n">scaling_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.enabled</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">true</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.metrics.window</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.metrics.delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.scale-up.grace-period</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.scale-down.grace-period</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.target.utilization</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.8</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.min.replicas</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kubernetes.operator.auto-scaling.max.replicas</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">scaling_config</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_backup</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">자동 백업 설정</span><span class="sh">"""</span>
        <span class="n">backup_schedule</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">checkpoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">savepoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">24h</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">retention_policy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7d</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">backup_storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-backups/</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">compression</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">encryption</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">aes256</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">backup_schedule</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_update</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">자동 업데이트 설정</span><span class="sh">"""</span>
        <span class="n">update_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">update_strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rolling</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">update_window</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">02:00-06:00</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">health_check_timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">rollback_threshold</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10%</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">canary_percentage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10%</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">update_config</span>
    
    <span class="k">def</span> <span class="nf">setup_auto_monitoring</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">자동 모니터링 설정</span><span class="sh">"""</span>
        <span class="n">monitoring_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">metrics_collection_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">alert_evaluation_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">retention_period</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30d</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">anomaly_detection</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">performance_baseline</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">auto</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">monitoring_config</span>

<span class="k">class</span> <span class="nc">FlinkPerformanceOptimizer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">optimization_rules</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_workload</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">workload_type</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">워크로드 타입에 따른 성능 최적화</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">low_latency</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_low_latency</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">high_throughput</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_high_throughput</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">workload_type</span> <span class="o">==</span> <span class="sh">"</span><span class="s">memory_intensive</span><span class="sh">"</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_memory_intensive</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">optimize_for_balanced</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_low_latency</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">저지연 최적화</span><span class="sh">"""</span>
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">execution.buffer-timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1ms</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.1</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.min</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">64mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.server.backlog</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.netty.client.connectTimeoutSec</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">5</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_high_throughput</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">고처리량 최적화</span><span class="sh">"""</span>
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">execution.buffer-timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">100ms</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">execution.checkpointing.timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">600s</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.fraction</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">0.3</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.min</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">512mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.max</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2gb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.buffers-per-channel</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.network.memory.floating-buffers-per-gate</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
    
    <span class="k">def</span> <span class="nf">optimize_for_memory_intensive</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">metrics</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">메모리 집약적 최적화</span><span class="sh">"""</span>
        <span class="n">optimizations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.managed.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">taskmanager.memory.process.size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.block.cache-size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2gb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.write-buffer-size</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">256mb</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.max-write-buffer-number</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">state.backend.rocksdb.compaction.level0-file-num-compaction-trigger</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">optimizations</span>
</code></pre></div></div>

<h2 id="-실무-프로젝트-엔터프라이즈급-flink-플랫폼">🚀 실무 프로젝트: 엔터프라이즈급 Flink 플랫폼</h2>

<h3 id="프로젝트-개요">프로젝트 개요</h3>

<p>대규모 엔터프라이즈 환경에서 Apache Flink를 운영하기 위한 완전한 플랫폼을 구축합니다. 이 플랫폼은 자동화, 모니터링, 장애 복구, 성능 최적화를 모두 포함합니다.</p>

<h3 id="1-플랫폼-아키텍처">1. 플랫폼 아키텍처</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">EnterpriseFlinkPlatform</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">components</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">deployment</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkDeploymentManager</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">monitoring</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkMonitoringSystem</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">automation</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkOperationsAutomation</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">recovery</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkDisasterRecovery</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">optimization</span><span class="sh">"</span><span class="p">:</span> <span class="nc">FlinkPerformanceOptimizer</span><span class="p">()</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">deploy_enterprise_platform</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">엔터프라이즈 플랫폼 배포</span><span class="sh">"""</span>
        
        <span class="n">deployment_steps</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">1. 네임스페이스 및 RBAC 설정</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">2. Flink Operator 설치</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">3. 모니터링 스택 배포</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">4. Flink 클러스터 배포</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">5. 자동화 규칙 설정</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">6. 알림 시스템 구성</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">7. 백업 시스템 설정</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">deployment_steps</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Executing: </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">execute_deployment_step</span><span class="p">(</span><span class="n">step</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">execute_deployment_step</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">배포 단계 실행</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="sh">"</span><span class="s">네임스페이스</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">create_namespaces_and_rbac</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">Operator</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">install_flink_operator</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">모니터링</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_monitoring_stack</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">클러스터</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_flink_cluster</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">자동화</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">setup_automation_rules</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">알림</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">configure_alerting</span><span class="p">()</span>
        <span class="k">elif</span> <span class="sh">"</span><span class="s">백업</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">step</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">setup_backup_system</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">create_namespaces_and_rbac</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">네임스페이스 및 RBAC 생성</span><span class="sh">"""</span>
        <span class="n">namespaces</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">flink-production</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">flink-staging</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">monitoring</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">logging</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">namespace</span> <span class="ow">in</span> <span class="n">namespaces</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">create_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">create_rbac_for_namespace</span><span class="p">(</span><span class="n">namespace</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">install_flink_operator</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Flink Operator 설치</span><span class="sh">"""</span>
        <span class="n">operator_manifest</span> <span class="o">=</span> <span class="sh">"""</span><span class="s">
        apiVersion: v1
        kind: Namespace
        metadata:
          name: flink-operator
        ---
        apiVersion: apps/v1
        kind: Deployment
        metadata:
          name: flink-operator
          namespace: flink-operator
        spec:
          replicas: 1
          selector:
            matchLabels:
              app: flink-operator
          template:
            metadata:
              labels:
                app: flink-operator
            spec:
              serviceAccountName: flink-operator
              containers:
              - name: flink-operator
                image: apache/flink-kubernetes-operator:1.7.0
                ports:
                - containerPort: 8080
                env:
                - name: OPERATOR_NAME
                  value: </span><span class="sh">"</span><span class="s">flink-operator</span><span class="sh">"</span><span class="s">
                - name: WATCH_NAMESPACE
                  value: </span><span class="sh">""</span><span class="s">
                resources:
                  requests:
                    memory: </span><span class="sh">"</span><span class="s">256Mi</span><span class="sh">"</span><span class="s">
                    cpu: </span><span class="sh">"</span><span class="s">100m</span><span class="sh">"</span><span class="s">
                  limits:
                    memory: </span><span class="sh">"</span><span class="s">512Mi</span><span class="sh">"</span><span class="s">
                    cpu: </span><span class="sh">"</span><span class="s">500m</span><span class="sh">"</span><span class="s">
        </span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">apply_manifest</span><span class="p">(</span><span class="n">operator_manifest</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">deploy_monitoring_stack</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">모니터링 스택 배포</span><span class="sh">"""</span>
        <span class="n">monitoring_components</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sh">"</span><span class="s">prometheus</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">grafana</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">alertmanager</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">jaeger</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">elasticsearch</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">kibana</span><span class="sh">"</span>
        <span class="p">]</span>
        
        <span class="k">for</span> <span class="n">component</span> <span class="ow">in</span> <span class="n">monitoring_components</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_monitoring_component</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">deploy_flink_cluster</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Flink 클러스터 배포</span><span class="sh">"""</span>
        <span class="n">cluster_configs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">production</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_production_cluster_config</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">staging</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_staging_cluster_config</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">development</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_development_cluster_config</span><span class="p">()</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">env</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">cluster_configs</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">deploy_cluster_for_environment</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_production_cluster_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">프로덕션 클러스터 설정</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">flinkConfiguration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">16</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rocksdb</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.checkpoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://prod-flink-checkpoints/checkpoints</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.savepoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://prod-flink-savepoints/savepoints</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">EXACTLY_ONCE</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">high-availability</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">kubernetes</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">high-availability.storageDir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://prod-flink-ha/ha</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">exponential-delay</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.initial-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.exponential-delay.max-backoff</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2min</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">metrics.reporter.prom.class</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">org.apache.flink.metrics.prometheus.PrometheusReporter</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">metrics.reporter.prom.port</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">9249</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">jobManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">taskManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_staging_cluster_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">스테이징 클러스터 설정</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">flinkConfiguration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">8</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">rocksdb</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.checkpoints.dir</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://staging-flink-checkpoints/checkpoints</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">120s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AT_LEAST_ONCE</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">fixed-delay</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.attempts</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">3</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">jobManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">taskManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">4g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_development_cluster_config</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">개발 클러스터 설정</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">flinkConfiguration</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">taskmanager.numberOfTaskSlots</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">parallelism.default</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">state.backend</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">execution.checkpointing.mode</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AT_LEAST_ONCE</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">fixed-delay</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.attempts</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart-strategy.fixed-delay.delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">5s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">jobManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">500m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">taskManager</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">resource</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">memory</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">2g</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">cpu</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1000m</span><span class="sh">"</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">setup_automation_rules</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">자동화 규칙 설정</span><span class="sh">"""</span>
        <span class="n">automation_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">auto_scaling</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">min_replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max_replicas</span><span class="sh">"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">target_cpu</span><span class="sh">"</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">target_memory</span><span class="sh">"</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">scale_up_cooldown</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">60s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">scale_down_cooldown</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">auto_backup</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">checkpoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">savepoint_interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">24h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention_days</span><span class="sh">"</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">backup_storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-backups/</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">auto_update</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span>  <span class="c1"># 프로덕션에서는 수동 승인 필요
</span>                <span class="sh">"</span><span class="s">update_window</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">02:00-06:00</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">canary_percentage</span><span class="sh">"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">health_check_timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">auto_recovery</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">max_restart_attempts</span><span class="sh">"</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">restart_delay</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">10s</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">escalation_timeout</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">300s</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">rule_type</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">automation_rules</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">configure_automation_rule</span><span class="p">(</span><span class="n">rule_type</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">configure_alerting</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">알림 시스템 구성</span><span class="sh">"""</span>
        <span class="n">alert_rules</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">FlinkJobFailed</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">ClusterDown</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">DataLoss</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">CheckpointFailure</span><span class="sh">"</span>
            <span class="p">],</span>
            <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">HighCheckpointDuration</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">HighBackpressure</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">HighMemoryUsage</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">LowThroughput</span><span class="sh">"</span>
            <span class="p">],</span>
            <span class="sh">"</span><span class="s">info</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="sh">"</span><span class="s">JobStarted</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">JobCompleted</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">ScalingEvent</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">BackupCompleted</span><span class="sh">"</span>
            <span class="p">]</span>
        <span class="p">}</span>
        
        <span class="n">notification_channels</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">email</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">recipients</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">admin@company.com</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">oncall@company.com</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">slack</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">webhook_url</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">https://hooks.slack.com/services/...</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">channels</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">#flink-alerts</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">#data-team</span><span class="sh">"</span><span class="p">],</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">warning</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">pagerduty</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">integration_key</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">integration_key_here</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">critical</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">configure_alert_rules</span><span class="p">(</span><span class="n">alert_rules</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">configure_notification_channels</span><span class="p">(</span><span class="n">notification_channels</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">setup_backup_system</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">백업 시스템 설정</span><span class="sh">"""</span>
        <span class="n">backup_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">checkpoints</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-checkpoints/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">compression</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">savepoints</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">24h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">30d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-savepoints/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">compression</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">gzip</span><span class="sh">"</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">configurations</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">90d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-configs/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">include</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span><span class="sh">"</span><span class="s">flink-conf.yaml</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">log4j.properties</span><span class="sh">"</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">"</span><span class="s">state_backend</span><span class="sh">"</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">"</span><span class="s">enabled</span><span class="sh">"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">interval</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">1h</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">retention</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">7d</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">storage</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">s3://flink-state/</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">encryption</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">aes256</span><span class="sh">"</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="nf">configure_backup_system</span><span class="p">(</span><span class="n">backup_config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">create_comprehensive_dashboard</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">종합 대시보드 생성</span><span class="sh">"""</span>
        <span class="n">dashboard_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Enterprise Flink Platform Dashboard</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">panels</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Cluster Overview</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">stat</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_numRunningJobs</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_numCompletedJobs</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_numFailedJobs</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Performance Metrics</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">timeseries</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_operator_numRecordsInPerSecond</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_operator_numRecordsOutPerSecond</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_operator_latency</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Resource Usage</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">timeseries</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_Status_JVM_Memory_Heap_Used</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_Status_JVM_CPU_Load</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_Status_JVM_Threads_Count</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Checkpoint Health</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">timeseries</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_job_lastCheckpointDuration</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_job_lastCheckpointSize</span><span class="sh">"</span><span class="p">,</span>
                        <span class="sh">"</span><span class="s">flink_jobmanager_job_lastCheckpointAlignmentBuffered</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">},</span>
                <span class="p">{</span>
                    <span class="sh">"</span><span class="s">title</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Backpressure</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">heatmap</span><span class="sh">"</span><span class="p">,</span>
                    <span class="sh">"</span><span class="s">metrics</span><span class="sh">"</span><span class="p">:</span> <span class="p">[</span>
                        <span class="sh">"</span><span class="s">flink_taskmanager_job_task_backPressuredTimeMsPerSecond</span><span class="sh">"</span>
                    <span class="p">]</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">dashboard_config</span>

<span class="c1"># 플랫폼 실행 예제
</span><span class="k">def</span> <span class="nf">deploy_enterprise_flink_platform</span><span class="p">():</span>
    <span class="sh">"""</span><span class="s">엔터프라이즈 Flink 플랫폼 배포</span><span class="sh">"""</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="nc">EnterpriseFlinkPlatform</span><span class="p">()</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">🚀 Starting Enterprise Flink Platform Deployment...</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="c1"># 1. 플랫폼 배포
</span>    <span class="n">platform</span><span class="p">.</span><span class="nf">deploy_enterprise_platform</span><span class="p">()</span>
    
    <span class="c1"># 2. 대시보드 생성
</span>    <span class="n">dashboard</span> <span class="o">=</span> <span class="n">platform</span><span class="p">.</span><span class="nf">create_comprehensive_dashboard</span><span class="p">()</span>
    
    <span class="c1"># 3. 테스트 실행
</span>    <span class="n">platform</span><span class="p">.</span><span class="nf">run_integration_tests</span><span class="p">()</span>
    
    <span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">✅ Enterprise Flink Platform deployed successfully!</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">platform</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">platform</span> <span class="o">=</span> <span class="nf">deploy_enterprise_flink_platform</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="-학습-요약">📚 학습 요약</h2>

<h3 id="이번-파트에서-학습한-내용">이번 파트에서 학습한 내용</h3>

<ol>
  <li><strong>Kubernetes를 활용한 Flink 클러스터 배포</strong>
    <ul>
      <li>Flink Operator 설치와 설정</li>
      <li>고가용성 클러스터 구성</li>
      <li>자동 스케일링 설정</li>
      <li>환경별 클러스터 관리</li>
    </ul>
  </li>
  <li><strong>성능 튜닝과 최적화</strong>
    <ul>
      <li>메모리 최적화 전략</li>
      <li>네트워크 성능 최적화</li>
      <li>상태 백엔드 최적화</li>
      <li>워크로드별 성능 튜닝</li>
    </ul>
  </li>
  <li><strong>모니터링과 알림 시스템</strong>
    <ul>
      <li>Prometheus 메트릭 수집</li>
      <li>Grafana 대시보드 구성</li>
      <li>알림 규칙 설정</li>
      <li>종합 모니터링 시스템</li>
    </ul>
  </li>
  <li><strong>장애 복구와 운영 전략</strong>
    <ul>
      <li>자동 장애 복구 시스템</li>
      <li>운영 자동화</li>
      <li>백업 및 복원 전략</li>
      <li>서킷 브레이커 패턴</li>
    </ul>
  </li>
  <li><strong>실무 프로젝트</strong>
    <ul>
      <li>엔터프라이즈급 Flink 플랫폼</li>
      <li>완전 자동화된 운영 환경</li>
      <li>다중 환경 관리</li>
      <li>종합 대시보드 시스템</li>
    </ul>
  </li>
</ol>

<h3 id="핵심-기술-스택">핵심 기술 스택</h3>

<table>
  <thead>
    <tr>
      <th>기술</th>
      <th>용도</th>
      <th>중요도</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Kubernetes</strong></td>
      <td>컨테이너 오케스트레이션</td>
      <td>⭐⭐⭐⭐⭐</td>
    </tr>
    <tr>
      <td><strong>Flink Operator</strong></td>
      <td>Kubernetes 네이티브 관리</td>
      <td>⭐⭐⭐⭐⭐</td>
    </tr>
    <tr>
      <td><strong>Prometheus/Grafana</strong></td>
      <td>모니터링과 시각화</td>
      <td>⭐⭐⭐⭐⭐</td>
    </tr>
    <tr>
      <td><strong>자동화 시스템</strong></td>
      <td>운영 효율성</td>
      <td>⭐⭐⭐⭐</td>
    </tr>
    <tr>
      <td><strong>장애 복구</strong></td>
      <td>시스템 안정성</td>
      <td>⭐⭐⭐⭐</td>
    </tr>
  </tbody>
</table>

<h3 id="apache-flink-시리즈-완성">Apache Flink 시리즈 완성!</h3>

<p>축하합니다! Apache Flink 완전 정복 시리즈를 모두 완주하셨습니다! 🎉</p>

<h4 id="시리즈-전체-요약"><strong>시리즈 전체 요약:</strong></h4>

<ul>
  <li>✅ <strong>Part 1</strong>: Apache Flink 기초와 핵심 개념</li>
  <li>✅ <strong>Part 2</strong>: 고급 스트리밍 처리와 상태 관리</li>
  <li>✅ <strong>Part 3</strong>: 실시간 분석과 CEP</li>
  <li>✅ <strong>Part 4</strong>: 프로덕션 배포와 성능 최적화</li>
</ul>

<h4 id="습득한-핵심-역량"><strong>습득한 핵심 역량:</strong></h4>

<ol>
  <li><strong>기술적 역량</strong>
    <ul>
      <li>Apache Flink의 핵심 아키텍처 이해</li>
      <li>DataStream API를 활용한 실시간 처리 구현</li>
      <li>상태 관리와 체크포인팅 활용</li>
      <li>복잡한 이벤트 처리 (CEP) 구현</li>
      <li>프로덕션 환경 배포와 운영</li>
    </ul>
  </li>
  <li><strong>실무 역량</strong>
    <ul>
      <li>실시간 데이터 파이프라인 구축</li>
      <li>마이크로초 단위 지연시간 달성</li>
      <li>장애 복구와 운영 자동화</li>
      <li>성능 최적화와 모니터링</li>
    </ul>
  </li>
  <li><strong>엔터프라이즈 역량</strong>
    <ul>
      <li>Kubernetes 기반 클러스터 관리</li>
      <li>자동화된 운영 시스템 구축</li>
      <li>종합 모니터링과 알림 시스템</li>
      <li>장애 복구와 백업 전략</li>
    </ul>
  </li>
</ol>

<p>이제 Apache Flink를 활용하여 엔터프라이즈급 실시간 스트리밍 처리 시스템을 구축할 수 있는 모든 지식과 경험을 갖추셨습니다! 🚀</p>

<hr />

<p><strong>시리즈 완성</strong>: <a href="/data-engineering/2025/09/14/apache-flink-series-overview.html">Apache Flink 완전 정복 시리즈</a></p>

<hr />

<p><em>Apache Flink의 세계에서 진정한 스트리밍 처리의 힘을 경험하세요!</em> 🎯</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
      
        
      
        
          
          
      
      
        
        
        <a href="/data-engineering/2025/09/17/apache-flink-real-time-analytics.html" class="nav-link prev">
          ← 이전: Part 3: Apache Flink 실시간 분석과 CEP - 복잡한 이벤트 처리의 완성
        </a>
      
      
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-engineering/" class="btn btn-secondary">
        📚 시리즈 전체 보기
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>데이터 엔지니어가 다루는 기술 블로그</p>
      </div>
      
      <div class="footer-section">
        <h4>카테고리</h4>
        <ul>
          <li><a href="/categories/data-engineering/">데이터 엔지니어링</a></li>
          <li><a href="/categories/bi-engineering/">BI 엔지니어링</a></li>
          <li><a href="/categories/infrastructure-tools/">인프라 & 도구</a></li>
          <li><a href="/categories/data-quality/">데이터 품질</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>링크</h4>
        <ul>
          <li><a href="/">홈</a></li>
          <li><a href="/blog/">블로그</a></li>
          <li><a href="/about/">소개</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>소셜</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. 모든 권리 보유</p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="Apache Flinkì˜ ê¸°ë³¸ êµ¬ì¡°ì™€ í•µì‹¬ ê°œë…ì¸ DataStream API, ìƒíƒœ ê´€ë¦¬, ì‹œê°„ ì²˜ë¦¬ ë“±ì„ í•™ìŠµí•˜ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.">



<title>Part 1: Apache Flink ê¸°ì´ˆì™€ í•µì‹¬ ê°œë… - ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ ì‹œì‘ - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 1: Apache Flink ê¸°ì´ˆì™€ í•µì‹¬ ê°œë… - ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ ì‹œì‘">
<meta property="og:description" content="Apache Flinkì˜ ê¸°ë³¸ êµ¬ì¡°ì™€ í•µì‹¬ ê°œë…ì¸ DataStream API, ìƒíƒœ ê´€ë¦¬, ì‹œê°„ ì²˜ë¦¬ ë“±ì„ í•™ìŠµí•˜ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.">
<meta property="og:url" content="http://localhost:4000/data-engineering/2025/09/15/apache-flink-basics.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 1: Apache Flink ê¸°ì´ˆì™€ í•µì‹¬ ê°œë… - ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ ì‹œì‘">
<meta name="twitter:description" content="Apache Flinkì˜ ê¸°ë³¸ êµ¬ì¡°ì™€ í•µì‹¬ ê°œë…ì¸ DataStream API, ìƒíƒœ ê´€ë¦¬, ì‹œê°„ ì²˜ë¦¬ ë“±ì„ í•™ìŠµí•˜ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-engineering/2025/09/15/apache-flink-basics.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-15-apache-flink-basics.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 15ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 1: Apache Flink ê¸°ì´ˆì™€ í•µì‹¬ ê°œë… - ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ ì‹œì‘</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">Apache-Flink</span>
      
        <span class="tag">DataStream-API</span>
      
        <span class="tag">ìƒíƒœê´€ë¦¬</span>
      
        <span class="tag">ì‹œê°„ì²˜ë¦¬</span>
      
        <span class="tag">ìŠ¤íŠ¸ë¦¬ë°ì²˜ë¦¬</span>
      
        <span class="tag">Python</span>
      
        <span class="tag">PyFlink</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Apache flink complete guide ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 2</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 35ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ì¤‘ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-1-apache-flink-ê¸°ì´ˆì™€-í•µì‹¬-ê°œë…---ì§„ì •í•œ-ìŠ¤íŠ¸ë¦¬ë°-ì²˜ë¦¬ì˜-ì‹œì‘">Part 1: Apache Flink ê¸°ì´ˆì™€ í•µì‹¬ ê°œë… - ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ ì‹œì‘</h1>

<blockquote>
  <p>Apache Flinkì˜ ê¸°ë³¸ êµ¬ì¡°ì™€ í•µì‹¬ ê°œë…ì¸ DataStream API, ìƒíƒœ ê´€ë¦¬, ì‹œê°„ ì²˜ë¦¬ ë“±ì„ í•™ìŠµí•˜ê³  ì‹¤ìŠµí•´ë´…ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#apache-flinkë€-ë¬´ì—‡ì¸ê°€">Apache Flinkë€ ë¬´ì—‡ì¸ê°€?</a></li>
  <li><a href="#flink-ì•„í‚¤í…ì²˜ì™€-í•µì‹¬-ê°œë…">Flink ì•„í‚¤í…ì²˜ì™€ í•µì‹¬ ê°œë…</a></li>
  <li><a href="#datastream-api-ê¸°ì´ˆ">DataStream API ê¸°ì´ˆ</a></li>
  <li><a href="#ì‹œê°„-ì²˜ë¦¬ì™€-ì›Œí„°ë§ˆí‚¹">ì‹œê°„ ì²˜ë¦¬ì™€ ì›Œí„°ë§ˆí‚¹</a></li>
  <li><a href="#ìƒíƒœ-ê´€ë¦¬-ê¸°ì´ˆ">ìƒíƒœ ê´€ë¦¬ ê¸°ì´ˆ</a></li>
  <li><a href="#ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì‹¤ì‹œê°„-ë¡œê·¸-ë¶„ì„">ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì‹¤ì‹œê°„ ë¡œê·¸ ë¶„ì„</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<h2 id="apache-flinkë€-ë¬´ì—‡ì¸ê°€">ğŸš€ Apache Flinkë€ ë¬´ì—‡ì¸ê°€?</h2>

<h3 id="flinkì˜-íƒ„ìƒ-ë°°ê²½">Flinkì˜ íƒ„ìƒ ë°°ê²½</h3>

<p>Apache FlinkëŠ” 2009ë…„ ë…ì¼ì˜ TU Berlinì—ì„œ ì‹œì‘ëœ <strong>Stratosphere í”„ë¡œì íŠ¸</strong>ì—ì„œ ì¶œë°œí–ˆìŠµë‹ˆë‹¤. 2014ë…„ Apache Software Foundationì˜ Top-level í”„ë¡œì íŠ¸ê°€ ë˜ì—ˆìœ¼ë©°, <strong>ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬</strong>ë¥¼ ëª©í‘œë¡œ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<h4 id="í•µì‹¬-ì„¤ê³„-ì² í•™"><strong>í•µì‹¬ ì„¤ê³„ ì² í•™</strong></h4>

<ol>
  <li><strong>True Streaming</strong>: ë§ˆì´í¬ë¡œë°°ì¹˜ê°€ ì•„ë‹Œ ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬</li>
  <li><strong>Low Latency</strong>: ë°€ë¦¬ì´ˆ ë‹¨ìœ„ì˜ ì§€ì—°ì‹œê°„ ë‹¬ì„±</li>
  <li><strong>High Throughput</strong>: ë†’ì€ ì²˜ë¦¬ëŸ‰ ìœ ì§€</li>
  <li><strong>Exactly-Once</strong>: ì •í™•íˆ í•œ ë²ˆ ì²˜ë¦¬ ë³´ì¥</li>
  <li><strong>Fault Tolerance</strong>: ê°•ë ¥í•œ ì¥ì•  ë³µêµ¬ ëŠ¥ë ¥</li>
</ol>

<h3 id="sparkì™€ì˜-ê·¼ë³¸ì -ì°¨ì´ì ">Sparkì™€ì˜ ê·¼ë³¸ì  ì°¨ì´ì </h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Spark: ë§ˆì´í¬ë¡œë°°ì¹˜ ë°©ì‹
</span><span class="kn">from</span> <span class="n">pyspark.sql</span> <span class="kn">import</span> <span class="n">SparkSession</span>
<span class="kn">from</span> <span class="n">pyspark.streaming</span> <span class="kn">import</span> <span class="n">StreamingContext</span>

<span class="n">spark</span> <span class="o">=</span> <span class="n">SparkSession</span><span class="p">.</span><span class="n">builder</span><span class="p">.</span><span class="nf">appName</span><span class="p">(</span><span class="sh">"</span><span class="s">SparkStreaming</span><span class="sh">"</span><span class="p">).</span><span class="nf">getOrCreate</span><span class="p">()</span>
<span class="n">ssc</span> <span class="o">=</span> <span class="nc">StreamingContext</span><span class="p">(</span><span class="n">spark</span><span class="p">.</span><span class="n">sparkContext</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>  <span class="c1"># 5ì´ˆ ë°°ì¹˜ ê°„ê²©
</span>
<span class="c1"># Flink: ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹
</span><span class="kn">from</span> <span class="n">pyflink.datastream</span> <span class="kn">import</span> <span class="n">StreamExecutionEnvironment</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="nf">get_execution_environment</span><span class="p">()</span>
<span class="c1"># ë°°ì¹˜ ê°„ê²© ì—†ìŒ - ì´ë²¤íŠ¸ ë„ì°© ì¦‰ì‹œ ì²˜ë¦¬
</span></code></pre></div></div>

<h2 id="flink-ì•„í‚¤í…ì²˜ì™€-í•µì‹¬-ê°œë…">ğŸ— ï¸ Flink ì•„í‚¤í…ì²˜ì™€ í•µì‹¬ ê°œë…</h2>

<h3 id="í´ëŸ¬ìŠ¤í„°-ì•„í‚¤í…ì²˜">í´ëŸ¬ìŠ¤í„° ì•„í‚¤í…ì²˜</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flink Cluster                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  JobManager (Master)                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   Dispatcher    â”‚  â”‚  ResourceManagerâ”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   JobMaster     â”‚  â”‚  CheckpointCoordâ”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TaskManager (Worker)                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚     Task 1      â”‚  â”‚     Task 2      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚     Task 3      â”‚  â”‚     Task 4      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div></div>

<h3 id="í•µì‹¬-ì»´í¬ë„ŒíŠ¸">í•µì‹¬ ì»´í¬ë„ŒíŠ¸</h3>

<h4 id="1-jobmanager"><strong>1. JobManager</strong></h4>
<ul>
  <li><strong>ì—­í• </strong>: ì‘ì—… ìŠ¤ì¼€ì¤„ë§ê³¼ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬</li>
  <li><strong>êµ¬ì„±ìš”ì†Œ</strong>:
    <ul>
      <li>Dispatcher: ì‘ì—… ì œì¶œ ì¸í„°í˜ì´ìŠ¤</li>
      <li>ResourceManager: ë¦¬ì†ŒìŠ¤ í• ë‹¹ ê´€ë¦¬</li>
      <li>JobMaster: ê°œë³„ ì‘ì—… ê´€ë¦¬</li>
      <li>CheckpointCoordinator: ì²´í¬í¬ì¸íŠ¸ ì¡°ì •</li>
    </ul>
  </li>
</ul>

<h4 id="2-taskmanager"><strong>2. TaskManager</strong></h4>
<ul>
  <li><strong>ì—­í• </strong>: ì‹¤ì œ ë°ì´í„° ì²˜ë¦¬ ì‹¤í–‰</li>
  <li><strong>íŠ¹ì§•</strong>:
    <ul>
      <li>Task Slotì„ í†µí•œ ë³‘ë ¬ ì²˜ë¦¬</li>
      <li>ìƒíƒœ ì €ì¥ì†Œ ì œê³µ</li>
      <li>ë„¤íŠ¸ì›Œí¬ í†µì‹  ë‹´ë‹¹</li>
    </ul>
  </li>
</ul>

<h3 id="flink-í”„ë¡œê·¸ë¨-êµ¬ì¡°">Flink í”„ë¡œê·¸ë¨ êµ¬ì¡°</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream</span> <span class="kn">import</span> <span class="n">StreamExecutionEnvironment</span>
<span class="kn">from</span> <span class="n">pyflink.table</span> <span class="kn">import</span> <span class="n">StreamTableEnvironment</span>

<span class="c1"># 1. ì‹¤í–‰ í™˜ê²½ ìƒì„±
</span><span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="nf">get_execution_environment</span><span class="p">()</span>

<span class="c1"># 2. ë°ì´í„° ì†ŒìŠ¤ ìƒì„±
</span><span class="n">data_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="c1"># 3. ë³€í™˜ ì—°ì‚° ì ìš©
</span><span class="n">result_stream</span> <span class="o">=</span> <span class="n">data_stream</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># 4. ë°ì´í„° ì‹±í¬ ì§€ì •
</span><span class="n">result_stream</span><span class="p">.</span><span class="nf">print</span><span class="p">()</span>

<span class="c1"># 5. í”„ë¡œê·¸ë¨ ì‹¤í–‰
</span><span class="n">env</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">Basic Flink Program</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="datastream-api-ê¸°ì´ˆ">ğŸ“Š DataStream API ê¸°ì´ˆ</h2>

<h3 id="ê¸°ë³¸-ë°ì´í„°-íƒ€ì…">ê¸°ë³¸ ë°ì´í„° íƒ€ì…</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common.typeinfo</span> <span class="kn">import</span> <span class="n">Types</span>
<span class="kn">from</span> <span class="n">pyflink.datastream</span> <span class="kn">import</span> <span class="n">StreamExecutionEnvironment</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="nf">get_execution_environment</span><span class="p">()</span>

<span class="c1"># ê¸°ë³¸ ë°ì´í„° íƒ€ì…ë“¤
</span><span class="n">basic_types</span> <span class="o">=</span> <span class="p">[</span>
    <span class="sh">"</span><span class="s">Hello</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">World</span><span class="sh">"</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mf">45.67</span><span class="p">,</span> <span class="bp">True</span>
<span class="p">]</span>

<span class="n">data_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">(</span><span class="n">basic_types</span><span class="p">)</span>

<span class="c1"># íƒ€ì… ì •ë³´ ëª…ì‹œì  ì§€ì •
</span><span class="n">typed_stream</span> <span class="o">=</span> <span class="n">data_stream</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="nf">upper</span><span class="p">(),</span>
    <span class="n">output_type</span><span class="o">=</span><span class="n">Types</span><span class="p">.</span><span class="nc">STRING</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></div>

<h3 id="í•µì‹¬-ë³€í™˜-ì—°ì‚°">í•µì‹¬ ë³€í™˜ ì—°ì‚°</h3>

<h4 id="1-map-ì—°ì‚°"><strong>1. Map ì—°ì‚°</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ë‹¨ì¼ ìš”ì†Œ ë³€í™˜
</span><span class="k">def</span> <span class="nf">multiply_by_two</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>

<span class="n">data_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">data_stream</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="n">multiply_by_two</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="2-filter-ì—°ì‚°"><strong>2. Filter ì—°ì‚°</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì¡°ê±´ì— ë”°ë¥¸ í•„í„°ë§
</span><span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">even_numbers</span> <span class="o">=</span> <span class="n">numbers</span><span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="n">is_even</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="3-flatmap-ì—°ì‚°"><strong>3. FlatMap ì—°ì‚°</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 1:N ë³€í™˜
</span><span class="k">def</span> <span class="nf">split_words</span><span class="p">(</span><span class="n">sentence</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sentence</span><span class="p">.</span><span class="nf">split</span><span class="p">()</span>

<span class="n">text_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span>
    <span class="sh">"</span><span class="s">Hello World</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Apache Flink</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Stream Processing</span><span class="sh">"</span>
<span class="p">])</span>

<span class="n">words</span> <span class="o">=</span> <span class="n">text_stream</span><span class="p">.</span><span class="nf">flat_map</span><span class="p">(</span><span class="n">split_words</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="4-keyby-ì—°ì‚°"><strong>4. KeyBy ì—°ì‚°</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common.typeinfo</span> <span class="kn">import</span> <span class="n">Types</span>

<span class="c1"># í‚¤ë³„ ê·¸ë£¹í™”
</span><span class="k">class</span> <span class="nc">LogEntry</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">action</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">user_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">action</span> <span class="o">=</span> <span class="n">action</span>
        <span class="n">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>

<span class="c1"># ìƒ˜í”Œ ë¡œê·¸ ë°ì´í„°
</span><span class="n">log_entries</span> <span class="o">=</span> <span class="p">[</span>
    <span class="nc">LogEntry</span><span class="p">(</span><span class="sh">"</span><span class="s">user1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">login</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2025-01-01 10:00:00</span><span class="sh">"</span><span class="p">),</span>
    <span class="nc">LogEntry</span><span class="p">(</span><span class="sh">"</span><span class="s">user2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">view</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2025-01-01 10:01:00</span><span class="sh">"</span><span class="p">),</span>
    <span class="nc">LogEntry</span><span class="p">(</span><span class="sh">"</span><span class="s">user1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">logout</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">2025-01-01 10:02:00</span><span class="sh">"</span><span class="p">)</span>
<span class="p">]</span>

<span class="n">log_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">(</span><span class="n">log_entries</span><span class="p">)</span>
<span class="n">keyed_stream</span> <span class="o">=</span> <span class="n">log_stream</span><span class="p">.</span><span class="nf">key_by</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="n">log</span><span class="p">.</span><span class="n">user_id</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="ìœˆë„ìš°-ì—°ì‚°">ìœˆë„ìš° ì—°ì‚°</h3>

<h4 id="1-tumbling-window"><strong>1. Tumbling Window</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream.window</span> <span class="kn">import</span> <span class="n">TumblingProcessingTimeWindows</span>
<span class="kn">from</span> <span class="n">pyflink.common.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="c1"># ê³ ì • í¬ê¸° ìœˆë„ìš°
</span><span class="n">windowed_stream</span> <span class="o">=</span> <span class="n">keyed_stream</span><span class="p">.</span><span class="nf">window</span><span class="p">(</span>
    <span class="n">TumblingProcessingTimeWindows</span><span class="p">.</span><span class="nf">of</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="p">).</span><span class="nf">sum</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># ê° ìœˆë„ìš°ì—ì„œì˜ ì´ë²¤íŠ¸ ìˆ˜ ê³„ì‚°
</span></code></pre></div></div>

<h4 id="2-sliding-window"><strong>2. Sliding Window</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream.window</span> <span class="kn">import</span> <span class="n">SlidingProcessingTimeWindows</span>

<span class="c1"># ìŠ¬ë¼ì´ë”© ìœˆë„ìš° (10ì´ˆ í¬ê¸°, 5ì´ˆ ìŠ¬ë¼ì´ë“œ)
</span><span class="n">sliding_window</span> <span class="o">=</span> <span class="n">keyed_stream</span><span class="p">.</span><span class="nf">window</span><span class="p">(</span>
    <span class="n">SlidingProcessingTimeWindows</span><span class="p">.</span><span class="nf">of</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="p">).</span><span class="nf">sum</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="3-session-window"><strong>3. Session Window</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream.window</span> <span class="kn">import</span> <span class="n">ProcessingTimeSessionWindows</span>

<span class="c1"># ì„¸ì…˜ ìœˆë„ìš° (5ì´ˆ ë¹„í™œì„± ì‹œê°„)
</span><span class="n">session_window</span> <span class="o">=</span> <span class="n">keyed_stream</span><span class="p">.</span><span class="nf">window</span><span class="p">(</span>
    <span class="n">ProcessingTimeSessionWindows</span><span class="p">.</span><span class="nf">with_gap</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="p">).</span><span class="nf">sum</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="-ì‹œê°„-ì²˜ë¦¬ì™€-ì›Œí„°ë§ˆí‚¹">â° ì‹œê°„ ì²˜ë¦¬ì™€ ì›Œí„°ë§ˆí‚¹</h2>

<h3 id="ì‹œê°„ì˜-ì¢…ë¥˜">ì‹œê°„ì˜ ì¢…ë¥˜</h3>

<h4 id="1-event-time"><strong>1. Event Time</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">from</span> <span class="n">pyflink.datastream</span> <span class="kn">import</span> <span class="n">StreamExecutionEnvironment</span>
<span class="kn">from</span> <span class="n">pyflink.common.typeinfo</span> <span class="kn">import</span> <span class="n">Types</span>

<span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="nf">get_execution_environment</span><span class="p">()</span>

<span class="c1"># ì´ë²¤íŠ¸ ì‹œê°„ ê¸°ë°˜ ì²˜ë¦¬ ì„¤ì •
</span><span class="n">env</span><span class="p">.</span><span class="nf">set_stream_time_characteristic</span><span class="p">(</span><span class="n">TimeCharacteristic</span><span class="p">.</span><span class="n">EventTime</span><span class="p">)</span>

<span class="c1"># íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì›Œí„°ë§ˆí¬ ì„¤ì •
</span><span class="k">class</span> <span class="nc">TimestampedEvent</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>

<span class="c1"># ì›Œí„°ë§ˆí¬ ìƒì„±ì ì •ì˜
</span><span class="k">class</span> <span class="nc">TimestampExtractor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">extract_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">previous_timestamp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">element</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># ë°€ë¦¬ì´ˆë¡œ ë³€í™˜
</span>
<span class="n">events</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span>
    <span class="nc">TimestampedEvent</span><span class="p">(</span><span class="sh">"</span><span class="s">event1</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1640995200</span><span class="p">),</span>  <span class="c1"># 2022-01-01 00:00:00
</span>    <span class="nc">TimestampedEvent</span><span class="p">(</span><span class="sh">"</span><span class="s">event2</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1640995260</span><span class="p">),</span>  <span class="c1"># 2022-01-01 00:01:00
</span>    <span class="nc">TimestampedEvent</span><span class="p">(</span><span class="sh">"</span><span class="s">event3</span><span class="sh">"</span><span class="p">,</span> <span class="mi">1640995320</span><span class="p">),</span>  <span class="c1"># 2022-01-01 00:02:00
</span><span class="p">])</span>

<span class="c1"># ì›Œí„°ë§ˆí¬ í• ë‹¹
</span><span class="n">watermarked_stream</span> <span class="o">=</span> <span class="n">events</span><span class="p">.</span><span class="nf">assign_timestamps_and_watermarks</span><span class="p">(</span>
    <span class="nc">TimestampExtractor</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></div>

<h4 id="2-processing-time"><strong>2. Processing Time</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ì²˜ë¦¬ ì‹œê°„ ê¸°ë°˜ ì²˜ë¦¬ ì„¤ì •
</span><span class="n">env</span><span class="p">.</span><span class="nf">set_stream_time_characteristic</span><span class="p">(</span><span class="n">TimeCharacteristic</span><span class="p">.</span><span class="n">ProcessingTime</span><span class="p">)</span>

<span class="c1"># ì²˜ë¦¬ ì‹œê°„ì€ ìë™ìœ¼ë¡œ í• ë‹¹ë¨
</span><span class="n">processing_time_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>

<h4 id="3-ingestion-time"><strong>3. Ingestion Time</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># ìˆ˜ì§‘ ì‹œê°„ ê¸°ë°˜ ì²˜ë¦¬ ì„¤ì •
</span><span class="n">env</span><span class="p">.</span><span class="nf">set_stream_time_characteristic</span><span class="p">(</span><span class="n">TimeCharacteristic</span><span class="p">.</span><span class="n">IngestionTime</span><span class="p">)</span>

<span class="c1"># ìˆ˜ì§‘ ì‹œê°„ì€ ë°ì´í„°ê°€ Flinkì— ë„ì°©í•  ë•Œ í• ë‹¹ë¨
</span><span class="n">ingestion_time_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</code></pre></div></div>

<h3 id="ì›Œí„°ë§ˆí‚¹-ì „ëµ">ì›Œí„°ë§ˆí‚¹ ì „ëµ</h3>

<h4 id="1-ascending-timestamps"><strong>1. Ascending Timestamps</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream.functions</span> <span class="kn">import</span> <span class="n">AscendingTimestampExtractor</span>

<span class="k">class</span> <span class="nc">AscendingWatermarkExtractor</span><span class="p">(</span><span class="n">AscendingTimestampExtractor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">extract_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">previous_timestamp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">element</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">ascending_watermark</span> <span class="o">=</span> <span class="n">events</span><span class="p">.</span><span class="nf">assign_timestamps_and_watermarks</span><span class="p">(</span>
    <span class="nc">AscendingWatermarkExtractor</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></div>

<h4 id="2-bounded-out-of-orderness"><strong>2. Bounded Out-of-Orderness</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream.functions</span> <span class="kn">import</span> <span class="n">BoundedOutOfOrdernessTimestampExtractor</span>
<span class="kn">from</span> <span class="n">pyflink.common.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="k">class</span> <span class="nc">BoundedWatermarkExtractor</span><span class="p">(</span><span class="n">BoundedOutOfOrdernessTimestampExtractor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># 10ì´ˆ ì§€ì—° í—ˆìš©
</span>    
    <span class="k">def</span> <span class="nf">extract_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">previous_timestamp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">element</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">bounded_watermark</span> <span class="o">=</span> <span class="n">events</span><span class="p">.</span><span class="nf">assign_timestamps_and_watermarks</span><span class="p">(</span>
    <span class="nc">BoundedWatermarkExtractor</span><span class="p">()</span>
<span class="p">)</span>
</code></pre></div></div>

<h2 id="ï¸-ìƒíƒœ-ê´€ë¦¬-ê¸°ì´ˆ">ğŸ—ƒï¸ ìƒíƒœ ê´€ë¦¬ ê¸°ì´ˆ</h2>

<h3 id="ìƒíƒœì˜-ì¢…ë¥˜">ìƒíƒœì˜ ì¢…ë¥˜</h3>

<h4 id="1-valuestate"><strong>1. ValueState</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common.state</span> <span class="kn">import</span> <span class="n">ValueStateDescriptor</span>
<span class="kn">from</span> <span class="n">pyflink.common.typeinfo</span> <span class="kn">import</span> <span class="n">Types</span>
<span class="kn">from</span> <span class="n">pyflink.datastream</span> <span class="kn">import</span> <span class="n">KeyedProcessFunction</span>

<span class="k">class</span> <span class="nc">CounterFunction</span><span class="p">(</span><span class="n">KeyedProcessFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">count_state</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">runtime_context</span><span class="p">):</span>
        <span class="c1"># ValueState ì´ˆê¸°í™”
</span>        <span class="n">self</span><span class="p">.</span><span class="n">count_state</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_state</span><span class="p">(</span>
            <span class="nc">ValueStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">count</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">INT</span><span class="p">())</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_element</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="c1"># í˜„ì¬ ìƒíƒœ ê°’ ê°€ì ¸ì˜¤ê¸°
</span>        <span class="n">current_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">count_state</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">0</span>
        
        <span class="c1"># ìƒíƒœ ì—…ë°ì´íŠ¸
</span>        <span class="n">new_count</span> <span class="o">=</span> <span class="n">current_count</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">self</span><span class="p">.</span><span class="n">count_state</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">new_count</span><span class="p">)</span>
        
        <span class="c1"># ê²°ê³¼ ì¶œë ¥
</span>        <span class="n">ctx</span><span class="p">.</span><span class="nf">collect</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Key: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">, Count: </span><span class="si">{</span><span class="n">new_count</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì œ
</span><span class="n">counter_stream</span> <span class="o">=</span> <span class="n">keyed_stream</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="nc">CounterFunction</span><span class="p">())</span>
</code></pre></div></div>

<h4 id="2-liststate"><strong>2. ListState</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common.state</span> <span class="kn">import</span> <span class="n">ListStateDescriptor</span>

<span class="k">class</span> <span class="nc">ListCollector</span><span class="p">(</span><span class="n">KeyedProcessFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">list_state</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">runtime_context</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">list_state</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_list_state</span><span class="p">(</span>
            <span class="nc">ListStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">items</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">STRING</span><span class="p">())</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_element</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="c1"># ë¦¬ìŠ¤íŠ¸ì— ê°’ ì¶”ê°€
</span>        <span class="n">self</span><span class="p">.</span><span class="n">list_state</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        
        <span class="c1"># ë¦¬ìŠ¤íŠ¸ ë‚´ìš© ìˆ˜ì§‘
</span>        <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">list_state</span><span class="p">.</span><span class="nf">get</span><span class="p">():</span>
            <span class="n">items</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        
        <span class="n">ctx</span><span class="p">.</span><span class="nf">collect</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Collected items: </span><span class="si">{</span><span class="n">items</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">list_stream</span> <span class="o">=</span> <span class="n">keyed_stream</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="nc">ListCollector</span><span class="p">())</span>
</code></pre></div></div>

<h4 id="3-mapstate"><strong>3. MapState</strong></h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common.state</span> <span class="kn">import</span> <span class="n">MapStateDescriptor</span>

<span class="k">class</span> <span class="nc">MapAggregator</span><span class="p">(</span><span class="n">KeyedProcessFunction</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">map_state</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">runtime_context</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">map_state</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_map_state</span><span class="p">(</span>
            <span class="nc">MapStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">counts</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">STRING</span><span class="p">(),</span> <span class="n">Types</span><span class="p">.</span><span class="nc">INT</span><span class="p">())</span>
        <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_element</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
        <span class="c1"># ë§µì—ì„œ í˜„ì¬ ì¹´ìš´íŠ¸ ê°€ì ¸ì˜¤ê¸°
</span>        <span class="n">current_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">map_state</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
        
        <span class="c1"># ì¹´ìš´íŠ¸ ì¦ê°€
</span>        <span class="n">self</span><span class="p">.</span><span class="n">map_state</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">current_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># ê²°ê³¼ ì¶œë ¥
</span>        <span class="n">ctx</span><span class="p">.</span><span class="nf">collect</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Value: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s">, Count: </span><span class="si">{</span><span class="n">current_count</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="n">map_stream</span> <span class="o">=</span> <span class="n">keyed_stream</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="nc">MapAggregator</span><span class="p">())</span>
</code></pre></div></div>

<h3 id="ì²´í¬í¬ì¸íŒ…">ì²´í¬í¬ì¸íŒ…</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.common</span> <span class="kn">import</span> <span class="n">Configuration</span>
<span class="kn">from</span> <span class="n">pyflink.common.checkpointing</span> <span class="kn">import</span> <span class="n">CheckpointingMode</span>

<span class="c1"># ì²´í¬í¬ì¸íŒ… ì„¤ì •
</span><span class="n">env</span><span class="p">.</span><span class="nf">get_checkpoint_config</span><span class="p">().</span><span class="nf">enable_checkpointing</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>  <span class="c1"># 1ì´ˆë§ˆë‹¤ ì²´í¬í¬ì¸íŠ¸
</span><span class="n">env</span><span class="p">.</span><span class="nf">get_checkpoint_config</span><span class="p">().</span><span class="nf">set_checkpointing_mode</span><span class="p">(</span><span class="n">CheckpointingMode</span><span class="p">.</span><span class="n">EXACTLY_ONCE</span><span class="p">)</span>

<span class="c1"># ì²´í¬í¬ì¸íŠ¸ ë””ë ‰í† ë¦¬ ì„¤ì •
</span><span class="n">env</span><span class="p">.</span><span class="nf">get_checkpoint_config</span><span class="p">().</span><span class="nf">set_checkpoint_storage_dir</span><span class="p">(</span><span class="sh">"</span><span class="s">file:///tmp/flink-checkpoints</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ìµœëŒ€ ë™ì‹œ ì²´í¬í¬ì¸íŠ¸ ìˆ˜
</span><span class="n">env</span><span class="p">.</span><span class="nf">get_checkpoint_config</span><span class="p">().</span><span class="nf">set_max_concurrent_checkpoints</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># ìµœì†Œ ì²´í¬í¬ì¸íŠ¸ ê°„ê²©
</span><span class="n">env</span><span class="p">.</span><span class="nf">get_checkpoint_config</span><span class="p">().</span><span class="nf">set_min_pause_between_checkpoints</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì‹¤ì‹œê°„-ë¡œê·¸-ë¶„ì„">ğŸš€ ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì‹¤ì‹œê°„ ë¡œê·¸ ë¶„ì„</h2>

<h3 id="í”„ë¡œì íŠ¸-ê°œìš”">í”„ë¡œì íŠ¸ ê°œìš”</h3>

<p>ì‹¤ì‹œê°„ ë¡œê·¸ ë¶„ì„ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ì—¬ ë‹¤ìŒ ê¸°ëŠ¥ë“¤ì„ êµ¬í˜„í•©ë‹ˆë‹¤:</p>
<ul>
  <li>ì‹¤ì‹œê°„ ë¡œê·¸ ìˆ˜ì§‘</li>
  <li>ì‚¬ìš©ìë³„ í™œë™ ë¶„ì„</li>
  <li>ì´ìƒ íŒ¨í„´ íƒì§€</li>
  <li>ì‹¤ì‹œê°„ ì•Œë¦¼</li>
</ul>

<h3 id="1-ë¡œê·¸-ë°ì´í„°-ëª¨ë¸ë§">1. ë¡œê·¸ ë°ì´í„° ëª¨ë¸ë§</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">from</span> <span class="n">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="kn">import</span> <span class="n">json</span>

<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">LogEvent</span><span class="p">:</span>
    <span class="n">user_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">session_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">action</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">ip_address</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">user_agent</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="nf">dumps</span><span class="p">({</span>
            <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">session_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">session_id</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">action</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">action</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">timestamp</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">ip_address</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">ip_address</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">user_agent</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">user_agent</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">metadata</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">metadata</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="p">})</span>
    
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">json_str</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">json_str</span><span class="p">)</span>
        <span class="k">return</span> <span class="nf">cls</span><span class="p">(</span><span class="o">**</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="2-ì‹¤ì‹œê°„-ë¡œê·¸-ë¶„ì„-ì‹œìŠ¤í…œ">2. ì‹¤ì‹œê°„ ë¡œê·¸ ë¶„ì„ ì‹œìŠ¤í…œ</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pyflink.datastream</span> <span class="kn">import</span> <span class="n">StreamExecutionEnvironment</span>
<span class="kn">from</span> <span class="n">pyflink.common.typeinfo</span> <span class="kn">import</span> <span class="n">Types</span>
<span class="kn">from</span> <span class="n">pyflink.common.state</span> <span class="kn">import</span> <span class="n">ValueStateDescriptor</span><span class="p">,</span> <span class="n">ListStateDescriptor</span>
<span class="kn">from</span> <span class="n">pyflink.common.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">from</span> <span class="n">pyflink.datastream.functions</span> <span class="kn">import</span> <span class="n">KeyedProcessFunction</span>
<span class="kn">from</span> <span class="n">pyflink.datastream.window</span> <span class="kn">import</span> <span class="n">TumblingEventTimeWindows</span>
<span class="kn">from</span> <span class="n">pyflink.datastream.connectors</span> <span class="kn">import</span> <span class="n">FlinkKafkaConsumer</span>
<span class="kn">from</span> <span class="n">pyflink.common.serialization</span> <span class="kn">import</span> <span class="n">SimpleStringSchema</span>
<span class="kn">from</span> <span class="n">pyflink.common.typeinfo</span> <span class="kn">import</span> <span class="n">Types</span>

<span class="k">class</span> <span class="nc">LogAnalyzer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="nf">get_execution_environment</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">setup_environment</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_environment</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="c1"># ì²´í¬í¬ì¸íŒ… í™œì„±í™”
</span>        <span class="n">self</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="nf">get_checkpoint_config</span><span class="p">().</span><span class="nf">enable_checkpointing</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
        
        <span class="c1"># ì´ë²¤íŠ¸ ì‹œê°„ ì„¤ì •
</span>        <span class="n">self</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="nf">set_stream_time_characteristic</span><span class="p">(</span><span class="n">TimeCharacteristic</span><span class="p">.</span><span class="n">EventTime</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">create_kafka_source</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">topic</span><span class="p">,</span> <span class="n">bootstrap_servers</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">Kafka ì†ŒìŠ¤ ìƒì„±</span><span class="sh">"""</span>
        <span class="n">kafka_properties</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">bootstrap.servers</span><span class="sh">'</span><span class="p">:</span> <span class="n">bootstrap_servers</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">group.id</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">log-analyzer-group</span><span class="sh">'</span>
        <span class="p">}</span>
        
        <span class="n">kafka_source</span> <span class="o">=</span> <span class="nc">FlinkKafkaConsumer</span><span class="p">(</span>
            <span class="n">topic</span><span class="p">,</span>
            <span class="nc">SimpleStringSchema</span><span class="p">(),</span>
            <span class="n">kafka_properties</span>
        <span class="p">)</span>
        
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="nf">add_source</span><span class="p">(</span><span class="n">kafka_source</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">parse_log_events</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">log_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¡œê·¸ ì´ë²¤íŠ¸ íŒŒì‹±</span><span class="sh">"""</span>
        <span class="k">def</span> <span class="nf">parse_log</span><span class="p">(</span><span class="n">log_str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">LogEvent</span><span class="p">.</span><span class="nf">from_json</span><span class="p">(</span><span class="n">log_str</span><span class="p">)</span>
            <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Failed to parse log: </span><span class="si">{</span><span class="n">log_str</span><span class="si">}</span><span class="s">, Error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
                <span class="k">return</span> <span class="bp">None</span>
        
        <span class="k">return</span> <span class="n">log_stream</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="n">parse_log</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="n">Types</span><span class="p">.</span><span class="nc">PICKLED_BYTE_ARRAY</span><span class="p">())</span> \
                        <span class="p">.</span><span class="nf">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">detect_anomalies</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">log_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì´ìƒ íŒ¨í„´ íƒì§€</span><span class="sh">"""</span>
        <span class="k">class</span> <span class="nc">AnomalyDetector</span><span class="p">(</span><span class="n">KeyedProcessFunction</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
                <span class="n">self</span><span class="p">.</span><span class="n">failed_login_count</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">self</span><span class="p">.</span><span class="n">last_login_time</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">self</span><span class="p">.</span><span class="n">suspicious_actions</span> <span class="o">=</span> <span class="bp">None</span>
            
            <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">runtime_context</span><span class="p">):</span>
                <span class="n">self</span><span class="p">.</span><span class="n">failed_login_count</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_state</span><span class="p">(</span>
                    <span class="nc">ValueStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">failed_logins</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">INT</span><span class="p">())</span>
                <span class="p">)</span>
                <span class="n">self</span><span class="p">.</span><span class="n">last_login_time</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_state</span><span class="p">(</span>
                    <span class="nc">ValueStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">last_login</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">LONG</span><span class="p">())</span>
                <span class="p">)</span>
                <span class="n">self</span><span class="p">.</span><span class="n">suspicious_actions</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_list_state</span><span class="p">(</span>
                    <span class="nc">ListStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">suspicious</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">STRING</span><span class="p">())</span>
                <span class="p">)</span>
            
            <span class="k">def</span> <span class="nf">process_element</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">log_event</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">log_event</span><span class="p">.</span><span class="n">timestamp</span>
                
                <span class="c1"># ì‹¤íŒ¨í•œ ë¡œê·¸ì¸ ì‹œë„ ì¶”ì 
</span>                <span class="k">if</span> <span class="n">log_event</span><span class="p">.</span><span class="n">action</span> <span class="o">==</span> <span class="sh">"</span><span class="s">login_failed</span><span class="sh">"</span><span class="p">:</span>
                    <span class="n">current_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">failed_login_count</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">0</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">failed_login_count</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">current_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                    
                    <span class="c1"># 5ë¶„ ë‚´ 5íšŒ ì´ìƒ ì‹¤íŒ¨ ì‹œ ì•Œë¦¼
</span>                    <span class="k">if</span> <span class="n">current_count</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">:</span>  <span class="c1"># 0ë¶€í„° ì‹œì‘í•˜ë¯€ë¡œ 4ë©´ 5ë²ˆì§¸
</span>                        <span class="n">ctx</span><span class="p">.</span><span class="nf">collect</span><span class="p">({</span>
                            <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">security_alert</span><span class="sh">'</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">log_event</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Multiple failed login attempts: </span><span class="si">{</span><span class="n">current_count</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">current_time</span>
                        <span class="p">})</span>
                        <span class="n">self</span><span class="p">.</span><span class="n">failed_login_count</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
                
                <span class="c1"># ì„±ê³µí•œ ë¡œê·¸ì¸ ì‹œ ì‹¤íŒ¨ ì¹´ìš´íŠ¸ ì´ˆê¸°í™”
</span>                <span class="k">elif</span> <span class="n">log_event</span><span class="p">.</span><span class="n">action</span> <span class="o">==</span> <span class="sh">"</span><span class="s">login_success</span><span class="sh">"</span><span class="p">:</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">failed_login_count</span><span class="p">.</span><span class="nf">clear</span><span class="p">()</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">last_login_time</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>
                
                <span class="c1"># ë¹„ì •ìƒì ì¸ ì‹œê°„ëŒ€ í™œë™ ê°ì§€
</span>                <span class="k">elif</span> <span class="n">log_event</span><span class="p">.</span><span class="n">action</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">view</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">purchase</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">download</span><span class="sh">"</span><span class="p">]:</span>
                    <span class="n">last_login</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">last_login_time</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">last_login</span> <span class="ow">and</span> <span class="p">(</span><span class="n">current_time</span> <span class="o">-</span> <span class="n">last_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">86400</span><span class="p">:</span>  <span class="c1"># 24ì‹œê°„
</span>                        <span class="n">ctx</span><span class="p">.</span><span class="nf">collect</span><span class="p">({</span>
                            <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">anomaly_alert</span><span class="sh">'</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">log_event</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Activity after long inactivity: </span><span class="si">{</span><span class="n">log_event</span><span class="p">.</span><span class="n">action</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">current_time</span>
                        <span class="p">})</span>
        
        <span class="c1"># ì‚¬ìš©ìë³„ë¡œ í‚¤ ì§€ì •í•˜ê³  ì´ìƒ íƒì§€
</span>        <span class="k">return</span> <span class="n">log_stream</span><span class="p">.</span><span class="nf">key_by</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="n">log</span><span class="p">.</span><span class="n">user_id</span><span class="p">)</span> \
                        <span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="nc">AnomalyDetector</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="nf">calculate_user_metrics</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">log_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‚¬ìš©ìë³„ ë©”íŠ¸ë¦­ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="k">class</span> <span class="nc">UserMetricsCalculator</span><span class="p">(</span><span class="n">KeyedProcessFunction</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
                <span class="n">self</span><span class="p">.</span><span class="n">action_counts</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">self</span><span class="p">.</span><span class="n">session_duration</span> <span class="o">=</span> <span class="bp">None</span>
                <span class="n">self</span><span class="p">.</span><span class="n">last_action_time</span> <span class="o">=</span> <span class="bp">None</span>
            
            <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">runtime_context</span><span class="p">):</span>
                <span class="n">self</span><span class="p">.</span><span class="n">action_counts</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_map_state</span><span class="p">(</span>
                    <span class="nc">MapStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">action_counts</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">STRING</span><span class="p">(),</span> <span class="n">Types</span><span class="p">.</span><span class="nc">INT</span><span class="p">())</span>
                <span class="p">)</span>
                <span class="n">self</span><span class="p">.</span><span class="n">session_duration</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_state</span><span class="p">(</span>
                    <span class="nc">ValueStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">session_duration</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">LONG</span><span class="p">())</span>
                <span class="p">)</span>
                <span class="n">self</span><span class="p">.</span><span class="n">last_action_time</span> <span class="o">=</span> <span class="n">runtime_context</span><span class="p">.</span><span class="nf">get_state</span><span class="p">(</span>
                    <span class="nc">ValueStateDescriptor</span><span class="p">(</span><span class="sh">"</span><span class="s">last_action_time</span><span class="sh">"</span><span class="p">,</span> <span class="n">Types</span><span class="p">.</span><span class="nc">LONG</span><span class="p">())</span>
                <span class="p">)</span>
            
            <span class="k">def</span> <span class="nf">process_element</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">log_event</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
                <span class="n">current_time</span> <span class="o">=</span> <span class="n">log_event</span><span class="p">.</span><span class="n">timestamp</span>
                
                <span class="c1"># ì•¡ì…˜ë³„ ì¹´ìš´íŠ¸ ì—…ë°ì´íŠ¸
</span>                <span class="n">current_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">action_counts</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">log_event</span><span class="p">.</span><span class="n">action</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span>
                <span class="n">self</span><span class="p">.</span><span class="n">action_counts</span><span class="p">.</span><span class="nf">put</span><span class="p">(</span><span class="n">log_event</span><span class="p">.</span><span class="n">action</span><span class="p">,</span> <span class="n">current_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                
                <span class="c1"># ì„¸ì…˜ ì§€ì† ì‹œê°„ ê³„ì‚°
</span>                <span class="n">last_time</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">last_action_time</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">last_time</span><span class="p">:</span>
                    <span class="n">duration</span> <span class="o">=</span> <span class="n">current_time</span> <span class="o">-</span> <span class="n">last_time</span>
                    <span class="n">current_duration</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">session_duration</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">0</span>
                    <span class="n">self</span><span class="p">.</span><span class="n">session_duration</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">current_duration</span> <span class="o">+</span> <span class="n">duration</span><span class="p">)</span>
                
                <span class="n">self</span><span class="p">.</span><span class="n">last_action_time</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">current_time</span><span class="p">)</span>
                
                <span class="c1"># 1ë¶„ë§ˆë‹¤ ë©”íŠ¸ë¦­ ì¶œë ¥
</span>                <span class="k">if</span> <span class="n">current_time</span> <span class="o">%</span> <span class="mi">60</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">log_event</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">current_time</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">session_duration</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">session_duration</span><span class="p">.</span><span class="nf">value</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
                        <span class="sh">'</span><span class="s">action_counts</span><span class="sh">'</span><span class="p">:</span> <span class="nf">dict</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">action_counts</span><span class="p">.</span><span class="nf">items</span><span class="p">())</span>
                    <span class="p">}</span>
                    <span class="n">ctx</span><span class="p">.</span><span class="nf">collect</span><span class="p">(</span><span class="n">metrics</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">log_stream</span><span class="p">.</span><span class="nf">key_by</span><span class="p">(</span><span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="n">log</span><span class="p">.</span><span class="n">user_id</span><span class="p">)</span> \
                        <span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="nc">UserMetricsCalculator</span><span class="p">())</span>
    
    <span class="k">def</span> <span class="nf">run_analysis</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ íŒŒì´í”„ë¼ì¸ ì‹¤í–‰</span><span class="sh">"""</span>
        <span class="c1"># Kafkaì—ì„œ ë¡œê·¸ ì½ê¸°
</span>        <span class="n">log_stream</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">create_kafka_source</span><span class="p">(</span><span class="sh">"</span><span class="s">user-logs</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">localhost:9092</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># ë¡œê·¸ íŒŒì‹±
</span>        <span class="n">parsed_logs</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">parse_log_events</span><span class="p">(</span><span class="n">log_stream</span><span class="p">)</span>
        
        <span class="c1"># íƒ€ì„ìŠ¤íƒ¬í”„ì™€ ì›Œí„°ë§ˆí¬ í• ë‹¹
</span>        <span class="n">watermarked_logs</span> <span class="o">=</span> <span class="n">parsed_logs</span><span class="p">.</span><span class="nf">assign_timestamps_and_watermarks</span><span class="p">(</span>
            <span class="nc">TimestampExtractor</span><span class="p">()</span>
        <span class="p">)</span>
        
        <span class="c1"># ì´ìƒ íƒì§€
</span>        <span class="n">anomalies</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">detect_anomalies</span><span class="p">(</span><span class="n">watermarked_logs</span><span class="p">)</span>
        
        <span class="c1"># ì‚¬ìš©ì ë©”íŠ¸ë¦­ ê³„ì‚°
</span>        <span class="n">metrics</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">calculate_user_metrics</span><span class="p">(</span><span class="n">watermarked_logs</span><span class="p">)</span>
        
        <span class="c1"># ê²°ê³¼ ì¶œë ¥
</span>        <span class="n">anomalies</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">Security Alerts</span><span class="sh">"</span><span class="p">)</span>
        <span class="n">metrics</span><span class="p">.</span><span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">User Metrics</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="c1"># ì‹¤í–‰
</span>        <span class="n">self</span><span class="p">.</span><span class="n">env</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">Real-time Log Analysis</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ì›Œí„°ë§ˆí¬ ì¶”ì¶œê¸°
</span><span class="k">class</span> <span class="nc">TimestampExtractor</span><span class="p">(</span><span class="n">BoundedOutOfOrdernessTimestampExtractor</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">().</span><span class="nf">__init__</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>  <span class="c1"># 10ì´ˆ ì§€ì—° í—ˆìš©
</span>    
    <span class="k">def</span> <span class="nf">extract_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">previous_timestamp</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">element</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">analyzer</span> <span class="o">=</span> <span class="nc">LogAnalyzer</span><span class="p">()</span>
    <span class="n">analyzer</span><span class="p">.</span><span class="nf">run_analysis</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="3-ì‹¤í–‰-ë°-í…ŒìŠ¤íŠ¸">3. ì‹¤í–‰ ë° í…ŒìŠ¤íŠ¸</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±ê¸°
</span><span class="k">class</span> <span class="nc">LogGenerator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="n">random</span>
        <span class="kn">import</span> <span class="n">time</span>
        <span class="n">self</span><span class="p">.</span><span class="n">users</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">user1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">user2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">user3</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">user4</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">user5</span><span class="sh">"</span><span class="p">]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">login</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">logout</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">view</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">purchase</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">download</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">login_failed</span><span class="sh">"</span><span class="p">]</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ip_addresses</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">192.168.1.1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">192.168.1.2</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">10.0.0.1</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">10.0.0.2</span><span class="sh">"</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">generate_log</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="kn">import</span> <span class="n">random</span>
        <span class="kn">import</span> <span class="n">time</span>
        
        <span class="k">return</span> <span class="nc">LogEvent</span><span class="p">(</span>
            <span class="n">user_id</span><span class="o">=</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">users</span><span class="p">),</span>
            <span class="n">session_id</span><span class="o">=</span><span class="sa">f</span><span class="sh">"</span><span class="s">session_</span><span class="si">{</span><span class="n">random</span><span class="p">.</span><span class="nf">randint</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">9999</span><span class="p">)</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">action</span><span class="o">=</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">actions</span><span class="p">),</span>
            <span class="n">timestamp</span><span class="o">=</span><span class="nf">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()),</span>
            <span class="n">ip_address</span><span class="o">=</span><span class="n">random</span><span class="p">.</span><span class="nf">choice</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">ip_addresses</span><span class="p">),</span>
            <span class="n">user_agent</span><span class="o">=</span><span class="sh">"</span><span class="s">Mozilla/5.0 (Test Browser)</span><span class="sh">"</span>
        <span class="p">).</span><span class="nf">to_json</span><span class="p">()</span>

<span class="c1"># í…ŒìŠ¤íŠ¸ ì‹¤í–‰
</span><span class="k">def</span> <span class="nf">test_log_analysis</span><span class="p">():</span>
    <span class="n">env</span> <span class="o">=</span> <span class="n">StreamExecutionEnvironment</span><span class="p">.</span><span class="nf">get_execution_environment</span><span class="p">()</span>
    
    <span class="c1"># í…ŒìŠ¤íŠ¸ ë°ì´í„° ìƒì„±
</span>    <span class="n">generator</span> <span class="o">=</span> <span class="nc">LogGenerator</span><span class="p">()</span>
    <span class="n">test_logs</span> <span class="o">=</span> <span class="p">[</span><span class="n">generator</span><span class="p">.</span><span class="nf">generate_log</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
    
    <span class="n">log_stream</span> <span class="o">=</span> <span class="n">env</span><span class="p">.</span><span class="nf">from_collection</span><span class="p">(</span><span class="n">test_logs</span><span class="p">)</span>
    
    <span class="c1"># ë¡œê·¸ íŒŒì‹±
</span>    <span class="n">parsed_logs</span> <span class="o">=</span> <span class="n">log_stream</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">LogEvent</span><span class="p">.</span><span class="nf">from_json</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
        <span class="n">output_type</span><span class="o">=</span><span class="n">Types</span><span class="p">.</span><span class="nc">PICKLED_BYTE_ARRAY</span><span class="p">()</span>
    <span class="p">).</span><span class="nf">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">)</span>
    
    <span class="c1"># ê°„ë‹¨í•œ í†µê³„ ê³„ì‚°
</span>    <span class="n">user_actions</span> <span class="o">=</span> <span class="n">parsed_logs</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">log</span><span class="p">:</span> <span class="p">(</span><span class="n">log</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span> <span class="n">log</span><span class="p">.</span><span class="n">action</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="p">).</span><span class="nf">key_by</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> \
     <span class="p">.</span><span class="nf">window</span><span class="p">(</span><span class="n">TumblingProcessingTimeWindows</span><span class="p">.</span><span class="nf">of</span><span class="p">(</span><span class="n">Time</span><span class="p">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span> \
     <span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    
    <span class="n">user_actions</span><span class="p">.</span><span class="nf">print</span><span class="p">()</span>
    
    <span class="n">env</span><span class="p">.</span><span class="nf">execute</span><span class="p">(</span><span class="sh">"</span><span class="s">Log Analysis Test</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># í…ŒìŠ¤íŠ¸ ì‹¤í–‰
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">test_log_analysis</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="ì´ë²ˆ-íŒŒíŠ¸ì—ì„œ-í•™ìŠµí•œ-ë‚´ìš©">ì´ë²ˆ íŒŒíŠ¸ì—ì„œ í•™ìŠµí•œ ë‚´ìš©</h3>

<ol>
  <li><strong>Apache Flink ì†Œê°œ</strong>
    <ul>
      <li>Flinkì˜ íƒ„ìƒ ë°°ê²½ê³¼ ì„¤ê³„ ì² í•™</li>
      <li>Sparkì™€ì˜ ê·¼ë³¸ì  ì°¨ì´ì </li>
      <li>ì§„ì •í•œ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì˜ ê°œë…</li>
    </ul>
  </li>
  <li><strong>Flink ì•„í‚¤í…ì²˜</strong>
    <ul>
      <li>JobManagerì™€ TaskManagerì˜ ì—­í• </li>
      <li>í´ëŸ¬ìŠ¤í„° êµ¬ì„±ê³¼ ë¦¬ì†ŒìŠ¤ ê´€ë¦¬</li>
      <li>í”„ë¡œê·¸ë¨ ì‹¤í–‰ êµ¬ì¡°</li>
    </ul>
  </li>
  <li><strong>DataStream API</strong>
    <ul>
      <li>ê¸°ë³¸ ë°ì´í„° íƒ€ì…ê³¼ ë³€í™˜ ì—°ì‚°</li>
      <li>Map, Filter, FlatMap, KeyBy ì—°ì‚°</li>
      <li>ìœˆë„ìš° ì—°ì‚° (Tumbling, Sliding, Session)</li>
    </ul>
  </li>
  <li><strong>ì‹œê°„ ì²˜ë¦¬</strong>
    <ul>
      <li>Event Time, Processing Time, Ingestion Time</li>
      <li>ì›Œí„°ë§ˆí‚¹ ì „ëµê³¼ ì§€ì—° ë°ì´í„° ì²˜ë¦¬</li>
      <li>íƒ€ì„ìŠ¤íƒ¬í”„ í• ë‹¹ ë°©ë²•</li>
    </ul>
  </li>
  <li><strong>ìƒíƒœ ê´€ë¦¬</strong>
    <ul>
      <li>ValueState, ListState, MapState</li>
      <li>ì²´í¬í¬ì¸íŒ…ê³¼ ì¥ì•  ë³µêµ¬</li>
      <li>ìƒíƒœ ê¸°ë°˜ ì²˜ë¦¬ ë¡œì§</li>
    </ul>
  </li>
  <li><strong>ì‹¤ë¬´ í”„ë¡œì íŠ¸</strong>
    <ul>
      <li>ì‹¤ì‹œê°„ ë¡œê·¸ ë¶„ì„ ì‹œìŠ¤í…œ</li>
      <li>ì´ìƒ íŒ¨í„´ íƒì§€</li>
      <li>ì‚¬ìš©ì ë©”íŠ¸ë¦­ ê³„ì‚°</li>
    </ul>
  </li>
</ol>

<h3 id="í•µì‹¬-ê¸°ìˆ -ìŠ¤íƒ">í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ</h3>

<table>
  <thead>
    <tr>
      <th>ê¸°ìˆ </th>
      <th>ìš©ë„</th>
      <th>ì¤‘ìš”ë„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>DataStream API</strong></td>
      <td>ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ì²˜ë¦¬</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>ìƒíƒœ ê´€ë¦¬</strong></td>
      <td>ìƒíƒœ ê¸°ë°˜ ì²˜ë¦¬</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>ì‹œê°„ ì²˜ë¦¬</strong></td>
      <td>ì´ë²¤íŠ¸ ì‹œê°„ ê¸°ë°˜ ë¶„ì„</td>
      <td>â­â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>ìœˆë„ìš° ì—°ì‚°</strong></td>
      <td>ì‹œê°„ ê¸°ë°˜ ì§‘ê³„</td>
      <td>â­â­â­â­</td>
    </tr>
    <tr>
      <td><strong>ì²´í¬í¬ì¸íŒ…</strong></td>
      <td>ì¥ì•  ë³µêµ¬</td>
      <td>â­â­â­â­</td>
    </tr>
  </tbody>
</table>

<h3 id="ë‹¤ìŒ-íŒŒíŠ¸-ë¯¸ë¦¬ë³´ê¸°">ë‹¤ìŒ íŒŒíŠ¸ ë¯¸ë¦¬ë³´ê¸°</h3>

<p><strong>Part 2: ê³ ê¸‰ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì™€ ìƒíƒœ ê´€ë¦¬</strong>ì—ì„œëŠ” ë‹¤ìŒ ë‚´ìš©ì„ ë‹¤ë£¹ë‹ˆë‹¤:</p>
<ul>
  <li>ê³ ê¸‰ ìƒíƒœ ê´€ë¦¬ íŒ¨í„´</li>
  <li>ì²´í¬í¬ì¸íŒ…ê³¼ ì„¸ì´ë¸Œí¬ì¸íŠ¸ ì‹¬í™”</li>
  <li>ë³µì¡í•œ ì‹œê°„ ì²˜ë¦¬ ì „ëµ</li>
  <li>ì„±ëŠ¥ ìµœì í™” ê¸°ë²•</li>
</ul>

<hr />

<p><strong>ë‹¤ìŒ íŒŒíŠ¸</strong>: <a href="/data-engineering/2025/09/16/apache-flink-advanced-streaming.html">Part 2: ê³ ê¸‰ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì™€ ìƒíƒœ ê´€ë¦¬</a></p>

<hr />

<p><em>ì´ì œ Flinkì˜ ê¸°ì´ˆë¥¼ ë§ˆìŠ¤í„°í–ˆìŠµë‹ˆë‹¤! ë‹¤ìŒ íŒŒíŠ¸ì—ì„œëŠ” ë” ê³ ê¸‰ ê¸°ëŠ¥ë“¤ì„ ë‹¤ë¤„ë³´ê² ìŠµë‹ˆë‹¤.</em> ğŸš€</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
          
          
      
      
      
      
        
        
        <a href="/data-engineering/2025/09/16/apache-flink-advanced-streaming.html" class="nav-link next">
          ë‹¤ìŒ: Part 2: Apache Flink ê³ ê¸‰ ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ì™€ ìƒíƒœ ê´€ë¦¬ - í”„ë¡œë•ì…˜ê¸‰ ì‹¤ì‹œê°„ ì‹œìŠ¤í…œ â†’
        </a>
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸">



<title>Part 3: HyperLogLogì™€ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ - í˜„ëŒ€ì  BI ë¶„ì„ì˜ ì™„ì„± - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 3: HyperLogLogì™€ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ - í˜„ëŒ€ì  BI ë¶„ì„ì˜ ì™„ì„±">
<meta property="og:description" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸">
<meta property="og:url" content="http://localhost:4000/bi-engineering/2025/09/25/hyperloglog-advanced-probabilistic-algorithms.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 3: HyperLogLogì™€ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ - í˜„ëŒ€ì  BI ë¶„ì„ì˜ ì™„ì„±">
<meta name="twitter:description" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/bi-engineering/2025/09/25/hyperloglog-advanced-probabilistic-algorithms.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-25-hyperloglog-advanced-probabilistic-algorithms.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Bi engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 25ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 3: HyperLogLogì™€ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ - í˜„ëŒ€ì  BI ë¶„ì„ì˜ ì™„ì„±</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">HyperLogLog</span>
      
        <span class="tag">í™•ë¥ ì ì•Œê³ ë¦¬ì¦˜</span>
      
        <span class="tag">ê³ ê¸‰ë¶„ì„</span>
      
        <span class="tag">BIì‹œìŠ¤í…œ</span>
      
        <span class="tag">ìŠ¤íŠ¸ë¦¬ë°ë¶„ì„</span>
      
        <span class="tag">ì‹¤ì‹œê°„ì²˜ë¦¬</span>
      
        <span class="tag">ë¹…ë°ì´í„°</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Modern bi engineering ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 4</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 50ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ê³ ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-3-hyperloglogì™€-ê³ ê¸‰-í™•ë¥ ì -ì•Œê³ ë¦¬ì¦˜---í˜„ëŒ€ì -bi-ë¶„ì„ì˜-ì™„ì„±">Part 3: HyperLogLogì™€ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ - í˜„ëŒ€ì  BI ë¶„ì„ì˜ ì™„ì„±</h1>

<blockquote>
  <p>HyperLogLogì™€ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ” ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ë“¤ë¶€í„° ìŠ¤íŠ¸ë¦¬ë° ë¶„ì„, ì‹¤ì‹œê°„ ì²˜ë¦¬, ê·¸ë¦¬ê³  í˜„ëŒ€ì  BI ì‹œìŠ¤í…œì˜ ì™„ì„±ê¹Œì§€ ëª¨ë“  ê²ƒì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#ê³ ê¸‰-í™•ë¥ ì -ì•Œê³ ë¦¬ì¦˜-ê°œìš”">ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ ê°œìš”</a></li>
  <li><a href="#count-min-sketchì™€-í•¨ê»˜í•˜ëŠ”-ë¶„ì„">Count-Min Sketchì™€ í•¨ê»˜í•˜ëŠ” ë¶„ì„</a></li>
  <li><a href="#bloom-filterì™€-ì¤‘ë³µ-ì œê±°">Bloom Filterì™€ ì¤‘ë³µ ì œê±°</a></li>
  <li><a href="#ìŠ¤íŠ¸ë¦¬ë°-ë¶„ì„ê³¼-ì‹¤ì‹œê°„-ì²˜ë¦¬">ìŠ¤íŠ¸ë¦¬ë° ë¶„ì„ê³¼ ì‹¤ì‹œê°„ ì²˜ë¦¬</a></li>
  <li><a href="#ê³ ê¸‰-bi-ë¶„ì„-ê¸°ë²•">ê³ ê¸‰ BI ë¶„ì„ ê¸°ë²•</a></li>
  <li><a href="#ì‹¤ë¬´-í”„ë¡œì íŠ¸-í†µí•©-ë¶„ì„-í”Œë«í¼">ì‹¤ë¬´ í”„ë¡œì íŠ¸: í†µí•© ë¶„ì„ í”Œë«í¼</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<hr />

<h2 id="ê³ ê¸‰-í™•ë¥ ì -ì•Œê³ ë¦¬ì¦˜-ê°œìš”">ğŸ¯ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ ê°œìš”</h2>

<h3 id="í™•ë¥ ì -ì•Œê³ ë¦¬ì¦˜ì˜-ì¢…ë¥˜ì™€-íŠ¹ì§•">í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ì˜ ì¢…ë¥˜ì™€ íŠ¹ì§•</h3>

<table>
  <thead>
    <tr>
      <th>ì•Œê³ ë¦¬ì¦˜</th>
      <th>ì£¼ìš” ìš©ë„</th>
      <th>ë©”ëª¨ë¦¬ ë³µì¡ë„</th>
      <th>ì •í™•ë„</th>
      <th>íŠ¹ì§•</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</td>
      <td>O(log log n)</td>
      <td>Â±1.04/âˆšm</td>
      <td>ê³ ìœ ê°’ ê°œìˆ˜ ì¶”ì •</td>
    </tr>
    <tr>
      <td><strong>Count-Min Sketch</strong></td>
      <td>ë¹ˆë„ ì¶”ì •</td>
      <td>O(dÃ—w)</td>
      <td>Â±ÎµN</td>
      <td>ìš”ì†Œë³„ ë¹ˆë„ ê³„ì‚°</td>
    </tr>
    <tr>
      <td><strong>Bloom Filter</strong></td>
      <td>ë©¤ë²„ì‹­ í…ŒìŠ¤íŠ¸</td>
      <td>O(m)</td>
      <td>0% False Negative</td>
      <td>ì¤‘ë³µ ì œê±°, ì¡´ì¬ í™•ì¸</td>
    </tr>
    <tr>
      <td><strong>MinHash</strong></td>
      <td>ìœ ì‚¬ë„ ì¶”ì •</td>
      <td>O(k)</td>
      <td>Â±1/âˆšk</td>
      <td>ì§‘í•© ìœ ì‚¬ë„ ê³„ì‚°</td>
    </tr>
    <tr>
      <td><strong>T-Digest</strong></td>
      <td>ë¶„ìœ„ìˆ˜ ì¶”ì •</td>
      <td>O(Î´)</td>
      <td>Â±Îµ</td>
      <td>ë¶„í¬ í†µê³„ëŸ‰ ì¶”ì •</td>
    </tr>
  </tbody>
</table>

<h3 id="ì•Œê³ ë¦¬ì¦˜-ì¡°í•©-ì „ëµ">ì•Œê³ ë¦¬ì¦˜ ì¡°í•© ì „ëµ</h3>

<table>
  <thead>
    <tr>
      <th>ì¡°í•©</th>
      <th>ëª©ì </th>
      <th>ì‚¬ìš© ì‚¬ë¡€</th>
      <th>ì„±ëŠ¥ ì´ì </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>HLL + Count-Min</strong></td>
      <td>ì¹´ë””ë„ë¦¬í‹° + ë¹ˆë„</td>
      <td>ì‹¤ì‹œê°„ íŠ¸ë Œë“œ ë¶„ì„</td>
      <td>ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±</td>
    </tr>
    <tr>
      <td><strong>HLL + Bloom Filter</strong></td>
      <td>ì¤‘ë³µ ì œê±° + ì¹´ìš´íŒ…</td>
      <td>ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ì²˜ë¦¬</td>
      <td>ì²˜ë¦¬ ì†ë„ í–¥ìƒ</td>
    </tr>
    <tr>
      <td><strong>HLL + MinHash</strong></td>
      <td>ìœ ì‚¬ë„ + ì¹´ìš´íŒ…</td>
      <td>ì‚¬ìš©ì ì„¸ê·¸ë¨¼íŠ¸ ë¶„ì„</td>
      <td>ì •í™•ë„ í–¥ìƒ</td>
    </tr>
    <tr>
      <td><strong>Count-Min + Bloom</strong></td>
      <td>ë¹ˆë„ + ì¤‘ë³µ ì œê±°</td>
      <td>ë¡œê·¸ ë¶„ì„ ì‹œìŠ¤í…œ</td>
      <td>ì €ì¥ ê³µê°„ ì ˆì•½</td>
    </tr>
  </tbody>
</table>

<h3 id="ì‹¤ë¬´-ì ìš©-ì‹œë‚˜ë¦¬ì˜¤">ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">ProbabilisticAnalyticsEngine</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hll_registry</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">count_min_sketches</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">bloom_filters</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">min_hash_registry</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_analytics_pipeline</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ íŒŒì´í”„ë¼ì¸ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">pipeline_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">user_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">:</span> <span class="mi">16384</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.01</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">content_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">500000</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.005</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">real_time_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">100000</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.02</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">pipeline_config</span>
    
    <span class="k">def</span> <span class="nf">initialize_structures</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í™•ë¥ ì  êµ¬ì¡° ì´ˆê¸°í™”</span><span class="sh">"""</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">hll_registry</span><span class="p">[</span><span class="n">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">self</span><span class="p">.</span><span class="n">count_min_sketches</span><span class="p">[</span><span class="n">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="nc">CountMinSketch</span><span class="p">(</span>
            <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">],</span> 
            <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">bloom_filters</span><span class="p">[</span><span class="n">namespace</span><span class="p">]</span> <span class="o">=</span> <span class="nc">BloomFilter</span><span class="p">(</span>
            <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">],</span> 
            <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">bloom_error_rate</span><span class="sh">'</span><span class="p">]</span>
        <span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">hll_registry</span><span class="p">[</span><span class="n">namespace</span><span class="p">],</span>
            <span class="sh">'</span><span class="s">count_min</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">count_min_sketches</span><span class="p">[</span><span class="n">namespace</span><span class="p">],</span>
            <span class="sh">'</span><span class="s">bloom</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">bloom_filters</span><span class="p">[</span><span class="n">namespace</span><span class="p">]</span>
        <span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="count-min-sketchì™€-í•¨ê»˜í•˜ëŠ”-ë¶„ì„">ğŸ”¢ Count-Min Sketchì™€ í•¨ê»˜í•˜ëŠ” ë¶„ì„</h2>

<h3 id="count-min-sketch-ê°œìš”">Count-Min Sketch ê°œìš”</h3>

<p>Count-Min SketchëŠ” ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„°ì—ì„œ ìš”ì†Œì˜ ë¹ˆë„ë¥¼ ì¶”ì •í•˜ëŠ” í™•ë¥ ì  ìë£Œêµ¬ì¡°ì…ë‹ˆë‹¤.</p>

<h4 id="ê¸°ë³¸-êµ¬ì¡°ì™€-ì›ë¦¬">ê¸°ë³¸ êµ¬ì¡°ì™€ ì›ë¦¬</h4>

<table>
  <thead>
    <tr>
      <th>êµ¬ì„±ìš”ì†Œ</th>
      <th>ì„¤ëª…</th>
      <th>í¬ê¸°</th>
      <th>ì—­í• </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>í•´ì‹œ í•¨ìˆ˜</strong></td>
      <td>dê°œì˜ ë…ë¦½ì  í•´ì‹œ í•¨ìˆ˜</td>
      <td>dê°œ</td>
      <td>ìš”ì†Œë¥¼ wê°œ ë²„í‚·ì— ë§¤í•‘</td>
    </tr>
    <tr>
      <td><strong>ë²„í‚· ë°°ì—´</strong></td>
      <td>dÃ—w í¬ê¸°ì˜ 2ì°¨ì› ë°°ì—´</td>
      <td>dÃ—w</td>
      <td>ë¹ˆë„ ì¹´ìš´í„° ì €ì¥</td>
    </tr>
    <tr>
      <td><strong>ê¹Šì´(d)</strong></td>
      <td>í•´ì‹œ í•¨ìˆ˜ ê°œìˆ˜</td>
      <td>4-8ê°œ</td>
      <td>ì •í™•ë„ ì¡°ì ˆ</td>
    </tr>
    <tr>
      <td><strong>ë„ˆë¹„(w)</strong></td>
      <td>ê° í•´ì‹œ í•¨ìˆ˜ì˜ ë²„í‚· ìˆ˜</td>
      <td>2^k</td>
      <td>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¡°ì ˆ</td>
    </tr>
  </tbody>
</table>

<h3 id="count-min-sketch-êµ¬í˜„">Count-Min Sketch êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">class</span> <span class="nc">CountMinSketch</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">16384</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">depth</span>
        <span class="n">self</span><span class="p">.</span><span class="n">width</span> <span class="o">=</span> <span class="n">width</span>
        <span class="n">self</span><span class="p">.</span><span class="n">sketch</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">depth</span><span class="p">,</span> <span class="n">width</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">uint32</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hash_functions</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_hash_functions</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_generate_hash_functions</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í•´ì‹œ í•¨ìˆ˜ ìƒì„±</span><span class="sh">"""</span>
        <span class="n">hash_funcs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">depth</span><span class="p">):</span>
            <span class="c1"># ê°„ë‹¨í•œ í•´ì‹œ í•¨ìˆ˜ ìƒì„± (ì‹¤ì œë¡œëŠ” ë” ì •êµí•œ ë°©ë²• ì‚¬ìš©)
</span>            <span class="k">def</span> <span class="nf">hash_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="sh">"</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">width</span>
            <span class="n">hash_funcs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">hash_func</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hash_funcs</span>
    
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìš”ì†Œ ì¶”ê°€</span><span class="sh">"""</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">hash_func</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">hash_functions</span><span class="p">):</span>
            <span class="n">bucket</span> <span class="o">=</span> <span class="nf">hash_func</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">sketch</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">bucket</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
    
    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¹ˆë„ ì¶”ì •</span><span class="sh">"""</span>
        <span class="n">estimates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">hash_func</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">hash_functions</span><span class="p">):</span>
            <span class="n">bucket</span> <span class="o">=</span> <span class="nf">hash_func</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="n">estimates</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">sketch</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">bucket</span><span class="p">])</span>
        <span class="k">return</span> <span class="nf">min</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span>  <span class="c1"># ìµœì†Œê°’ ë°˜í™˜ (ê³¼ëŒ€ì¶”ì • ë°©ì§€)
</span>    
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other_sketch</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë‹¤ë¥¸ ìŠ¤ì¼€ì¹˜ì™€ ë³‘í•©</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">depth</span> <span class="o">!=</span> <span class="n">other_sketch</span><span class="p">.</span><span class="n">depth</span> <span class="ow">or</span> <span class="n">self</span><span class="p">.</span><span class="n">width</span> <span class="o">!=</span> <span class="n">other_sketch</span><span class="p">.</span><span class="n">width</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">ìŠ¤ì¼€ì¹˜ í¬ê¸°ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">sketch</span> <span class="o">+=</span> <span class="n">other_sketch</span><span class="p">.</span><span class="n">sketch</span>
        <span class="k">return</span> <span class="n">self</span>
</code></pre></div></div>

<h3 id="hyperloglogì™€-count-min-sketch-ì¡°í•©">HyperLogLogì™€ Count-Min Sketch ì¡°í•©</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HLLCountMinAnalyzer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hll_precision</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">cm_depth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cm_width</span><span class="o">=</span><span class="mi">16384</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">hll_precision</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">count_min</span> <span class="o">=</span> <span class="nc">CountMinSketch</span><span class="p">(</span><span class="n">cm_depth</span><span class="p">,</span> <span class="n">cm_width</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">unique_elements</span> <span class="o">=</span> <span class="nf">set</span><span class="p">()</span>  <span class="c1"># ì •í™•í•œ ì¶”ì ìš© (ì„ íƒì )
</span>    
    <span class="k">def</span> <span class="nf">process_stream</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤íŠ¸ë¦¼ ë°ì´í„° ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">unique_count</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">frequency_estimates</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">top_elements</span><span class="sh">'</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">'</span><span class="s">statistics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
            <span class="c1"># HyperLogLogì— ì¶”ê°€ (ê³ ìœ ê°’ ê°œìˆ˜ ì¶”ì •)
</span>            <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            
            <span class="c1"># Count-Min Sketchì— ì¶”ê°€ (ë¹ˆë„ ì¶”ì •)
</span>            <span class="n">self</span><span class="p">.</span><span class="n">count_min</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            
            <span class="c1"># ì •í™•í•œ ì¶”ì  (ì„ íƒì )
</span>            <span class="n">self</span><span class="p">.</span><span class="n">unique_elements</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        
        <span class="c1"># ê²°ê³¼ ê³„ì‚°
</span>        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">exact_unique_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">unique_elements</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">exact_unique_count</span><span class="sh">'</span><span class="p">])</span> <span class="o">/</span> <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">exact_unique_count</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">results</span>
    
    <span class="k">def</span> <span class="nf">get_frequency_analysis</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¹ˆë„ ë¶„ì„</span><span class="sh">"""</span>
        
        <span class="n">frequency_analysis</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="n">estimated_freq</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">count_min</span><span class="p">.</span><span class="nf">estimate</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="n">frequency_analysis</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">estimated_frequency</span><span class="sh">'</span><span class="p">:</span> <span class="n">estimated_freq</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">confidence_interval</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_confidence_interval</span><span class="p">(</span><span class="n">estimated_freq</span><span class="p">)</span>
            <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">frequency_analysis</span>
    
    <span class="k">def</span> <span class="nf">_calculate_confidence_interval</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">estimate</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹ ë¢°êµ¬ê°„ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="c1"># Count-Min Sketchì˜ í‘œì¤€ ì˜¤ì°¨ ê·¼ì‚¬
</span>        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">estimate</span> <span class="o">*</span> <span class="mf">0.1</span>  <span class="c1"># ê°„ë‹¨í•œ ê·¼ì‚¬
</span>        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">lower_bound</span><span class="sh">'</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">estimate</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">standard_error</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">upper_bound</span><span class="sh">'</span><span class="p">:</span> <span class="n">estimate</span> <span class="o">+</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">standard_error</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">confidence_level</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.95</span>
        <span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="bloom-filterì™€-ì¤‘ë³µ-ì œê±°">ğŸŒ¸ Bloom Filterì™€ ì¤‘ë³µ ì œê±°</h2>

<h3 id="bloom-filter-ê°œìš”">Bloom Filter ê°œìš”</h3>

<p>Bloom FilterëŠ” ìš”ì†Œì˜ ë©¤ë²„ì‹­ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ” í™•ë¥ ì  ìë£Œêµ¬ì¡°ë¡œ, ì¤‘ë³µ ì œê±°ì™€ ì¡´ì¬ í™•ì¸ì— ìµœì í™”ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</p>

<h4 id="bloom-filter-êµ¬ì¡°">Bloom Filter êµ¬ì¡°</h4>

<table>
  <thead>
    <tr>
      <th>êµ¬ì„±ìš”ì†Œ</th>
      <th>ì„¤ëª…</th>
      <th>í¬ê¸°</th>
      <th>ì—­í• </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë¹„íŠ¸ ë°°ì—´</strong></td>
      <td>mê°œì˜ ë¹„íŠ¸ë¡œ êµ¬ì„±ëœ ë°°ì—´</td>
      <td>m bits</td>
      <td>ìš”ì†Œ ì¡´ì¬ ì •ë³´ ì €ì¥</td>
    </tr>
    <tr>
      <td><strong>í•´ì‹œ í•¨ìˆ˜</strong></td>
      <td>kê°œì˜ ë…ë¦½ì  í•´ì‹œ í•¨ìˆ˜</td>
      <td>kê°œ</td>
      <td>ìš”ì†Œë¥¼ ë¹„íŠ¸ ìœ„ì¹˜ì— ë§¤í•‘</td>
    </tr>
    <tr>
      <td><strong>ìš©ëŸ‰(n)</strong></td>
      <td>ì˜ˆìƒ ìš”ì†Œ ê°œìˆ˜</td>
      <td>ì‚¬ìš©ì ì •ì˜</td>
      <td>False Positive í™•ë¥  ì¡°ì ˆ</td>
    </tr>
    <tr>
      <td><strong>ì˜¤ì°¨ìœ¨(p)</strong></td>
      <td>False Positive í™•ë¥ </td>
      <td>ì‚¬ìš©ì ì •ì˜</td>
      <td>ì •í™•ë„ vs ë©”ëª¨ë¦¬ íŠ¸ë ˆì´ë“œì˜¤í”„</td>
    </tr>
  </tbody>
</table>

<h3 id="bloom-filter-êµ¬í˜„">Bloom Filter êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">math</span>

<span class="k">class</span> <span class="nc">BloomFilter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">error_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">capacity</span> <span class="o">=</span> <span class="n">capacity</span>
        <span class="n">self</span><span class="p">.</span><span class="n">error_rate</span> <span class="o">=</span> <span class="n">error_rate</span>
        
        <span class="c1"># ìµœì  íŒŒë¼ë¯¸í„° ê³„ì‚°
</span>        <span class="n">self</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_size</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">error_rate</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hash_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_hash_count</span><span class="p">(</span><span class="n">capacity</span><span class="p">,</span> <span class="n">error_rate</span><span class="p">)</span>
        
        <span class="c1"># ë¹„íŠ¸ ë°°ì—´ ì´ˆê¸°í™”
</span>        <span class="n">self</span><span class="p">.</span><span class="n">bit_array</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">size</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hash_functions</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_hash_functions</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">_calculate_size</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¹„íŠ¸ ë°°ì—´ í¬ê¸° ê³„ì‚°</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">p</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">_calculate_hash_count</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í•´ì‹œ í•¨ìˆ˜ ê°œìˆ˜ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="nf">int</span><span class="p">((</span><span class="n">self</span><span class="p">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">_generate_hash_functions</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í•´ì‹œ í•¨ìˆ˜ ìƒì„±</span><span class="sh">"""</span>
        <span class="n">hash_funcs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">hash_count</span><span class="p">):</span>
            <span class="k">def</span> <span class="nf">hash_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">i</span><span class="p">):</span>
                <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="n">hashlib</span><span class="p">.</span><span class="nf">sha256</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">seed</span><span class="si">}</span><span class="sh">"</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">hexdigest</span><span class="p">(),</span> <span class="mi">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">self</span><span class="p">.</span><span class="n">size</span>
            <span class="n">hash_funcs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">hash_func</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hash_funcs</span>
    
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìš”ì†Œ ì¶”ê°€</span><span class="sh">"""</span>
        <span class="k">for</span> <span class="n">hash_func</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">hash_functions</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nf">hash_func</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">bit_array</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë©¤ë²„ì‹­ í…ŒìŠ¤íŠ¸</span><span class="sh">"""</span>
        <span class="k">for</span> <span class="n">hash_func</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">hash_functions</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nf">hash_func</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">self</span><span class="p">.</span><span class="n">bit_array</span><span class="p">[</span><span class="n">index</span><span class="p">]:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">return</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">false_positive_rate</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í˜„ì¬ False Positive í™•ë¥  ê³„ì‚°</span><span class="sh">"""</span>
        <span class="c1"># ì‹¤ì œ êµ¬í˜„ì—ì„œëŠ” ë” ì •êµí•œ ê³„ì‚° í•„ìš”
</span>        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">error_rate</span>
</code></pre></div></div>

<h3 id="hyperloglogì™€-bloom-filter-ì¡°í•©">HyperLogLogì™€ Bloom Filter ì¡°í•©</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HLLBloomDeduplicator</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hll_precision</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">bloom_capacity</span><span class="o">=</span><span class="mi">1000000</span><span class="p">,</span> <span class="n">bloom_error_rate</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">hll_precision</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span> <span class="o">=</span> <span class="nc">BloomFilter</span><span class="p">(</span><span class="n">bloom_capacity</span><span class="p">,</span> <span class="n">bloom_error_rate</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">processed_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">self</span><span class="p">.</span><span class="n">duplicate_count</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">process_with_deduplication</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¤‘ë³µ ì œê±°ì™€ í•¨ê»˜ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">total_processed</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">unique_processed</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">duplicates_skipped</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">estimated_unique_count</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">deduplication_rate</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.0</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
            <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">total_processed</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            
            <span class="c1"># Bloom Filterë¡œ ì¤‘ë³µ í™•ì¸
</span>            <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span><span class="p">.</span><span class="nf">contains</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
                <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">duplicates_skipped</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">self</span><span class="p">.</span><span class="n">duplicate_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">continue</span>
            
            <span class="c1"># ìƒˆë¡œìš´ ìš”ì†Œ ì²˜ë¦¬
</span>            <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
            <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_processed</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="c1"># ê²°ê³¼ ê³„ì‚°
</span>        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">estimated_unique_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">()</span>
        <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">deduplication_rate</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">duplicates_skipped</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">results</span><span class="p">[</span><span class="sh">'</span><span class="s">total_processed</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">results</span>
    
    <span class="k">def</span> <span class="nf">get_deduplication_stats</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¤‘ë³µ ì œê±° í†µê³„</span><span class="sh">"""</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">bloom_filter_size</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span><span class="p">.</span><span class="n">size</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">bloom_filter_hash_count</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span><span class="p">.</span><span class="n">hash_count</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">false_positive_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span><span class="p">.</span><span class="nf">false_positive_rate</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">memory_usage_bytes</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">bloom_filter</span><span class="p">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">8</span><span class="p">,</span>  <span class="c1"># ë¹„íŠ¸ë¥¼ ë°”ì´íŠ¸ë¡œ ë³€í™˜
</span>            <span class="sh">'</span><span class="s">estimated_unique_elements</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">duplicate_ratio</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">duplicate_count</span> <span class="o">/</span> <span class="nf">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">processed_count</span><span class="p">)</span>
        <span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="ìŠ¤íŠ¸ë¦¬ë°-ë¶„ì„ê³¼-ì‹¤ì‹œê°„-ì²˜ë¦¬">âš¡ ìŠ¤íŠ¸ë¦¬ë° ë¶„ì„ê³¼ ì‹¤ì‹œê°„ ì²˜ë¦¬</h2>

<h3 id="ìŠ¤íŠ¸ë¦¬ë°-ë¶„ì„-ì•„í‚¤í…ì²˜">ìŠ¤íŠ¸ë¦¬ë° ë¶„ì„ ì•„í‚¤í…ì²˜</h3>

<table>
  <thead>
    <tr>
      <th>êµ¬ì„±ìš”ì†Œ</th>
      <th>ê¸°ìˆ  ìŠ¤íƒ</th>
      <th>ì—­í• </th>
      <th>í™•ì¥ì„±</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ìŠ¤íŠ¸ë¦¼ ìˆ˜ì§‘</strong></td>
      <td>Apache Kafka, AWS Kinesis</td>
      <td>ë°ì´í„° ìˆ˜ì§‘ ë° ë²„í¼ë§</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬</strong></td>
      <td>Apache Flink, Apache Storm</td>
      <td>ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>í™•ë¥ ì  êµ¬ì¡°</strong></td>
      <td>HyperLogLog, Count-Min, Bloom</td>
      <td>ë©”ëª¨ë¦¬ íš¨ìœ¨ì  ë¶„ì„</td>
      <td>ë©”ëª¨ë¦¬ ìµœì í™”</td>
    </tr>
    <tr>
      <td><strong>ê²°ê³¼ ì €ì¥</strong></td>
      <td>Redis, Apache Cassandra</td>
      <td>ì‹¤ì‹œê°„ ê²°ê³¼ ì €ì¥</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>ì‹œê°í™”</strong></td>
      <td>Grafana, Apache Superset</td>
      <td>ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
  </tbody>
</table>

<h3 id="ì‹¤ì‹œê°„-ë¶„ì„-íŒŒì´í”„ë¼ì¸">ì‹¤ì‹œê°„ ë¶„ì„ íŒŒì´í”„ë¼ì¸</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StreamingAnalyticsPipeline</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="n">self</span><span class="p">.</span><span class="n">analyzers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">window_size</span><span class="sh">'</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>  <span class="c1"># 60ì´ˆ ìœˆë„ìš°
</span>        <span class="n">self</span><span class="p">.</span><span class="n">slide_size</span> <span class="o">=</span> <span class="n">config</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">slide_size</span><span class="sh">'</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>    <span class="c1"># 10ì´ˆ ìŠ¬ë¼ì´ë“œ
</span>    
    <span class="k">def</span> <span class="nf">setup_analyzers</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ê¸° ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">analyzer_configs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">user_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">:</span> <span class="mi">16384</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1000000</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">content_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">:</span> <span class="mi">8192</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">500000</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">geographic_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4096</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">100000</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">analyzer_configs</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">analyzers</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="nc">HLLCountMinAnalyzer</span><span class="p">(</span>
                <span class="n">hll_precision</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">],</span>
                <span class="n">cm_depth</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">],</span>
                <span class="n">cm_width</span><span class="o">=</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">count_min_width</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_streaming_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">window_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">current_window</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">data_point</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
            <span class="n">current_window</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">data_point</span><span class="p">)</span>
            
            <span class="c1"># ìœˆë„ìš°ê°€ ê°€ë“ ì°¼ì„ ë•Œ ì²˜ë¦¬
</span>            <span class="k">if</span> <span class="nf">len</span><span class="p">(</span><span class="n">current_window</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">self</span><span class="p">.</span><span class="n">window_size</span><span class="p">:</span>
                <span class="n">window_result</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_process_window</span><span class="p">(</span><span class="n">current_window</span><span class="p">)</span>
                <span class="n">window_results</span><span class="p">[</span><span class="n">data_point</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">window_result</span>
                
                <span class="c1"># ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ì—…ë°ì´íŠ¸
</span>                <span class="n">current_window</span> <span class="o">=</span> <span class="n">current_window</span><span class="p">[</span><span class="n">self</span><span class="p">.</span><span class="n">slide_size</span><span class="p">:]</span>
        
        <span class="k">return</span> <span class="n">window_results</span>
    
    <span class="k">def</span> <span class="nf">_process_window</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">window_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìœˆë„ìš° ë°ì´í„° ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">window_result</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">window_data</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">],</span>
            <span class="sh">'</span><span class="s">window_size</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">window_data</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">analyzer_name</span><span class="p">,</span> <span class="n">analyzer</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">analyzers</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="c1"># ë¶„ì„ê¸°ë³„ ë°ì´í„° í•„í„°ë§
</span>            <span class="n">filtered_data</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_filter_data_for_analyzer</span><span class="p">(</span><span class="n">window_data</span><span class="p">,</span> <span class="n">analyzer_name</span><span class="p">)</span>
            
            <span class="c1"># ë¶„ì„ ì‹¤í–‰
</span>            <span class="n">analysis_result</span> <span class="o">=</span> <span class="n">analyzer</span><span class="p">.</span><span class="nf">process_stream</span><span class="p">(</span><span class="n">filtered_data</span><span class="p">)</span>
            <span class="n">window_result</span><span class="p">[</span><span class="sh">'</span><span class="s">analytics</span><span class="sh">'</span><span class="p">][</span><span class="n">analyzer_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">analysis_result</span>
        
        <span class="k">return</span> <span class="n">window_result</span>
    
    <span class="k">def</span> <span class="nf">_filter_data_for_analyzer</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">analyzer_name</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ê¸°ë³„ ë°ì´í„° í•„í„°ë§</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">analyzer_name</span> <span class="o">==</span> <span class="sh">'</span><span class="s">user_analytics</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">analyzer_name</span> <span class="o">==</span> <span class="sh">'</span><span class="s">content_analytics</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">content_id</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="sh">'</span><span class="s">content_id</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">analyzer_name</span> <span class="o">==</span> <span class="sh">'</span><span class="s">geographic_analytics</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">location</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span> <span class="k">if</span> <span class="sh">'</span><span class="s">location</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">data</span>
</code></pre></div></div>

<hr />

<h2 id="ê³ ê¸‰-bi-ë¶„ì„-ê¸°ë²•">ğŸ“Š ê³ ê¸‰ BI ë¶„ì„ ê¸°ë²•</h2>

<h3 id="ë‹¤ì°¨ì›-ë¶„ì„-ì „ëµ">ë‹¤ì°¨ì› ë¶„ì„ ì „ëµ</h3>

<table>
  <thead>
    <tr>
      <th>ë¶„ì„ ì°¨ì›</th>
      <th>í™•ë¥ ì  êµ¬ì¡°</th>
      <th>ë©”íŠ¸ë¦­</th>
      <th>í™œìš© ì‚¬ë¡€</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì‹œê°„ ì°¨ì›</strong></td>
      <td>HLL + Count-Min</td>
      <td>ì‹œê°„ë³„ ê³ ìœ  ì‚¬ìš©ì, ë¹ˆë„</td>
      <td>íŠ¸ë Œë“œ ë¶„ì„</td>
    </tr>
    <tr>
      <td><strong>ì§€ì—­ ì°¨ì›</strong></td>
      <td>HLL + Bloom</td>
      <td>ì§€ì—­ë³„ ê³ ìœ  ì‚¬ìš©ì, ì¤‘ë³µ ì œê±°</td>
      <td>ì§€ë¦¬ì  ë¶„ì„</td>
    </tr>
    <tr>
      <td><strong>ë””ë°”ì´ìŠ¤ ì°¨ì›</strong></td>
      <td>HLL + MinHash</td>
      <td>ë””ë°”ì´ìŠ¤ë³„ ì‚¬ìš©ì, ìœ ì‚¬ë„</td>
      <td>í¬ë¡œìŠ¤ ë””ë°”ì´ìŠ¤ ë¶„ì„</td>
    </tr>
    <tr>
      <td><strong>ì½˜í…ì¸  ì°¨ì›</strong></td>
      <td>Count-Min + Bloom</td>
      <td>ì½˜í…ì¸ ë³„ ì¡°íšŒìˆ˜, ì¤‘ë³µ ì œê±°</td>
      <td>ì½˜í…ì¸  ì„±ê³¼ ë¶„ì„</td>
    </tr>
    <tr>
      <td><strong>ì‚¬ìš©ì ì„¸ê·¸ë¨¼íŠ¸</strong></td>
      <td>HLL + Count-Min + Bloom</td>
      <td>ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³ ìœ  ì‚¬ìš©ì, ë¹ˆë„</td>
      <td>íƒ€ê²ŸíŒ… ë¶„ì„</td>
    </tr>
  </tbody>
</table>

<h3 id="ê³ ê¸‰-ë¶„ì„-ì—”ì§„">ê³ ê¸‰ ë¶„ì„ ì—”ì§„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">AdvancedBIAnalyticsEngine</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">dimensional_analyzers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cross_dimensional_analyzers</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">temporal_analyzers</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_dimensional_analysis</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë‹¤ì°¨ì› ë¶„ì„ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">dimensions</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">granularity</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">hour</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">day</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">week</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">month</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">geography</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">granularity</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">region</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">city</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">device</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">granularity</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">browser</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">content</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">granularity</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">author</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">dim_name</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">dimensions</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">dimensional_analyzers</span><span class="p">[</span><span class="n">dim_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            
            <span class="k">for</span> <span class="n">granularity</span> <span class="ow">in</span> <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">granularity</span><span class="sh">'</span><span class="p">]:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">dimensional_analyzers</span><span class="p">[</span><span class="n">dim_name</span><span class="p">][</span><span class="n">granularity</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">]),</span>
                    <span class="sh">'</span><span class="s">count_min</span><span class="sh">'</span><span class="p">:</span> <span class="nc">CountMinSketch</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">],</span> <span class="mi">8192</span><span class="p">),</span>
                    <span class="sh">'</span><span class="s">bloom</span><span class="sh">'</span><span class="p">:</span> <span class="nc">BloomFilter</span><span class="p">(</span><span class="mi">100000</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
                <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">analyze_cross_dimensional</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">êµì°¨ ì°¨ì› ë¶„ì„</span><span class="sh">"""</span>
        
        <span class="n">cross_analysis</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="c1"># ì‹œê°„ Ã— ì§€ì—­ ë¶„ì„
</span>        <span class="n">time_geo_analysis</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_time_geography</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cross_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">time_geography</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">time_geo_analysis</span>
        
        <span class="c1"># ë””ë°”ì´ìŠ¤ Ã— ì½˜í…ì¸  ë¶„ì„
</span>        <span class="n">device_content_analysis</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_device_content</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cross_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">device_content</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">device_content_analysis</span>
        
        <span class="c1"># ì‚¬ìš©ì Ã— ì‹œê°„ ë¶„ì„
</span>        <span class="n">user_time_analysis</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_user_time</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cross_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">user_time</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">user_time_analysis</span>
        
        <span class="k">return</span> <span class="n">cross_analysis</span>
    
    <span class="k">def</span> <span class="nf">_analyze_time_geography</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹œê°„ Ã— ì§€ì—­ ë¶„ì„</span><span class="sh">"""</span>
        
        <span class="n">time_geo_results</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">time_key</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">].</span><span class="nf">strftime</span><span class="p">(</span><span class="sh">'</span><span class="s">%Y-%m-%d-%H</span><span class="sh">'</span><span class="p">)</span>
            <span class="n">geo_key</span> <span class="o">=</span> <span class="n">item</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">country</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">unknown</span><span class="sh">'</span><span class="p">)</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">]</span>
            
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">time_key</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">geo_key</span><span class="si">}</span><span class="sh">"</span>
            
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">time_geo_results</span><span class="p">:</span>
                <span class="n">time_geo_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                    <span class="sh">'</span><span class="s">count_min</span><span class="sh">'</span><span class="p">:</span> <span class="nc">CountMinSketch</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4096</span><span class="p">)</span>
                <span class="p">}</span>
            
            <span class="n">time_geo_results</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
            <span class="n">time_geo_results</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="sh">'</span><span class="s">count_min</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        
        <span class="c1"># ê²°ê³¼ ì§‘ê³„
</span>        <span class="n">aggregated_results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">analyzers</span> <span class="ow">in</span> <span class="n">time_geo_results</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">time_part</span><span class="p">,</span> <span class="n">geo_part</span> <span class="o">=</span> <span class="n">key</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="sh">'</span><span class="s">_</span><span class="sh">'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">aggregated_results</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">:</span> <span class="n">time_part</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">geography</span><span class="sh">'</span><span class="p">:</span> <span class="n">geo_part</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">unique_users</span><span class="sh">'</span><span class="p">:</span> <span class="n">analyzers</span><span class="p">[</span><span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">(),</span>
                <span class="sh">'</span><span class="s">total_events</span><span class="sh">'</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">analyzers</span><span class="p">[</span><span class="sh">'</span><span class="s">count_min</span><span class="sh">'</span><span class="p">].</span><span class="n">sketch</span><span class="p">.</span><span class="nf">flatten</span><span class="p">())</span>
            <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">aggregated_results</span>
    
    <span class="k">def</span> <span class="nf">generate_insights</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">analysis_results</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¸ì‚¬ì´íŠ¸ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">insights</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">trend_analysis</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_trends</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">anomaly_detection</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_detect_anomalies</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">segmentation_insights</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_segmentation</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">performance_metrics</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_performance_metrics</span><span class="p">(</span><span class="n">analysis_results</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">insights</span>
    
    <span class="k">def</span> <span class="nf">_analyze_trends</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íŠ¸ë Œë“œ ë¶„ì„</span><span class="sh">"""</span>
        
        <span class="n">trends</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">user_growth</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_growth_rate</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="sh">'</span><span class="s">unique_users</span><span class="sh">'</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">engagement_trends</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_engagement_trends</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">geographic_expansion</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_geographic_expansion</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">trends</span>
    
    <span class="k">def</span> <span class="nf">_detect_anomalies</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">results</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì´ìƒ íƒì§€</span><span class="sh">"""</span>
        
        <span class="n">anomalies</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">spike_detection</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_detect_spikes</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">drop_detection</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_detect_drops</span><span class="p">(</span><span class="n">results</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">pattern_anomalies</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_detect_pattern_anomalies</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">anomalies</span>
</code></pre></div></div>

<hr />

<h2 id="ì‹¤ë¬´-í”„ë¡œì íŠ¸-í†µí•©-ë¶„ì„-í”Œë«í¼">ğŸš€ ì‹¤ë¬´ í”„ë¡œì íŠ¸: í†µí•© ë¶„ì„ í”Œë«í¼</h2>

<h3 id="í”„ë¡œì íŠ¸-ê°œìš”">í”„ë¡œì íŠ¸ ê°œìš”</h3>

<p>ëŒ€ê·œëª¨ ì „ììƒê±°ë˜ í”Œë«í¼ì„ ìœ„í•œ í†µí•© ë¶„ì„ í”Œë«í¼ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.</p>

<h4 id="ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜">ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h4>

<table>
  <thead>
    <tr>
      <th>ê³„ì¸µ</th>
      <th>êµ¬ì„±ìš”ì†Œ</th>
      <th>ê¸°ìˆ  ìŠ¤íƒ</th>
      <th>í™•ì¥ì„±</th>
      <th>ì—­í• </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë°ì´í„° ìˆ˜ì§‘</strong></td>
      <td>ìŠ¤íŠ¸ë¦¼ ìˆ˜ì§‘ê¸°</td>
      <td>Apache Kafka, AWS Kinesis</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
      <td>ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘</td>
    </tr>
    <tr>
      <td><strong>ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬</strong></td>
      <td>ì‹¤ì‹œê°„ ì²˜ë¦¬ ì—”ì§„</td>
      <td>Apache Flink, Apache Storm</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
      <td>ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬</td>
    </tr>
    <tr>
      <td><strong>í™•ë¥ ì  ë¶„ì„</strong></td>
      <td>ë¶„ì„ ì—”ì§„</td>
      <td>HyperLogLog, Count-Min, Bloom</td>
      <td>ë©”ëª¨ë¦¬ ìµœì í™”</td>
      <td>íš¨ìœ¨ì  ë¶„ì„</td>
    </tr>
    <tr>
      <td><strong>ê²°ê³¼ ì €ì¥</strong></td>
      <td>ì €ì¥ì†Œ</td>
      <td>Redis, Apache Cassandra</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
      <td>ì‹¤ì‹œê°„ ê²°ê³¼ ì €ì¥</td>
    </tr>
    <tr>
      <td><strong>API ì„œë¹„ìŠ¤</strong></td>
      <td>REST API</td>
      <td>FastAPI, Node.js</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
      <td>ë¶„ì„ ê²°ê³¼ ì œê³µ</td>
    </tr>
    <tr>
      <td><strong>ì‹œê°í™”</strong></td>
      <td>ëŒ€ì‹œë³´ë“œ</td>
      <td>React, D3.js, Grafana</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
      <td>ì‹¤ì‹œê°„ ì‹œê°í™”</td>
    </tr>
  </tbody>
</table>

<h3 id="í†µí•©-ë¶„ì„-í”Œë«í¼-êµ¬í˜„">í†µí•© ë¶„ì„ í”Œë«í¼ êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">IntegratedAnalyticsPlatform</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="n">self</span><span class="p">.</span><span class="n">stream_processors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">analytics_engines</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">storage_backends</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">api_services</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">setup_platform</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í”Œë«í¼ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">platform_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">streaming</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">kafka_brokers</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">localhost:9092</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">topics</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">user_events</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">content_events</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">transaction_events</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">consumer_groups</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">analytics_consumers</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">real_time</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1000000</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">batch</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">hll_precision</span><span class="sh">'</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">count_min_depth</span><span class="sh">'</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">bloom_capacity</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10000000</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">storage</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">redis</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">host</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">localhost</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">port</span><span class="sh">'</span><span class="p">:</span> <span class="mi">6379</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">db</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">cassandra</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">hosts</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">localhost</span><span class="sh">'</span><span class="p">],</span>
                    <span class="sh">'</span><span class="s">keyspace</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">analytics</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">platform_config</span>
    
    <span class="k">def</span> <span class="nf">initialize_analytics_engines</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ ì—”ì§„ ì´ˆê¸°í™”</span><span class="sh">"""</span>
        
        <span class="n">engines</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">user_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">real_time</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">unique_users</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user_frequency</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user_segments</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">dimensions</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">geography</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">device</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">content_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">real_time</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">unique_content</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">content_views</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">content_engagement</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">dimensions</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">author</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">transaction_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">batch</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">unique_transactions</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">transaction_amounts</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">conversion_rates</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">dimensions</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">time</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">geography</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">payment_method</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">engine_name</span><span class="p">,</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">engines</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">self</span><span class="p">.</span><span class="n">analytics_engines</span><span class="p">[</span><span class="n">engine_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_create_analytics_engine</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_create_analytics_engine</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ ì—”ì§„ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">real_time</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="nc">RealTimeAnalyticsEngine</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">batch</span><span class="sh">'</span><span class="p">:</span>
            <span class="k">return</span> <span class="nc">BatchAnalyticsEngine</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">ì§€ì›í•˜ì§€ ì•ŠëŠ” ì—”ì§„ íƒ€ì…: </span><span class="si">{</span><span class="n">config</span><span class="p">[</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">process_streaming_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìŠ¤íŠ¸ë¦¬ë° ë°ì´í„° ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">processing_results</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">processed_count</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">analytics_results</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">errors</span><span class="sh">'</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">'</span><span class="s">performance_metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">data_point</span> <span class="ow">in</span> <span class="n">data_stream</span><span class="p">:</span>
                <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">processed_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                
                <span class="c1"># ê° ë¶„ì„ ì—”ì§„ì— ë°ì´í„° ì „ë‹¬
</span>                <span class="k">for</span> <span class="n">engine_name</span><span class="p">,</span> <span class="n">engine</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">analytics_engines</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">result</span> <span class="o">=</span> <span class="n">engine</span><span class="p">.</span><span class="nf">process</span><span class="p">(</span><span class="n">data_point</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">engine_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">analytics_results</span><span class="sh">'</span><span class="p">]:</span>
                            <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">analytics_results</span><span class="sh">'</span><span class="p">][</span><span class="n">engine_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">analytics_results</span><span class="sh">'</span><span class="p">][</span><span class="n">engine_name</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">errors</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">({</span>
                            <span class="sh">'</span><span class="s">engine</span><span class="sh">'</span><span class="p">:</span> <span class="n">engine_name</span><span class="p">,</span>
                            <span class="sh">'</span><span class="s">error</span><span class="sh">'</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
                        <span class="p">})</span>
            
            <span class="c1"># ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê³„ì‚°
</span>            <span class="n">processing_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
            <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">performance_metrics</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">total_processing_time</span><span class="sh">'</span><span class="p">:</span> <span class="n">processing_time</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">throughput</span><span class="sh">'</span><span class="p">:</span> <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">processed_count</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">processing_time</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">errors</span><span class="sh">'</span><span class="p">])</span> <span class="o">/</span> <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">processed_count</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">processing_results</span><span class="p">[</span><span class="sh">'</span><span class="s">errors</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">system_error</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">error</span><span class="sh">'</span><span class="p">:</span> <span class="nf">str</span><span class="p">(</span><span class="n">e</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">time</span><span class="p">.</span><span class="nf">time</span><span class="p">()</span>
            <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">processing_results</span>
    
    <span class="k">def</span> <span class="nf">generate_analytics_report</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">time_range</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ ë¦¬í¬íŠ¸ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">time_range</span><span class="sh">'</span><span class="p">:</span> <span class="n">time_range</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">summary</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">detailed_analysis</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">insights</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">recommendations</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="c1"># ê° ë¶„ì„ ì—”ì§„ì—ì„œ ë°ì´í„° ìˆ˜ì§‘
</span>        <span class="k">for</span> <span class="n">engine_name</span><span class="p">,</span> <span class="n">engine</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">analytics_engines</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">engine_data</span> <span class="o">=</span> <span class="n">engine</span><span class="p">.</span><span class="nf">get_analytics</span><span class="p">(</span><span class="n">time_range</span><span class="p">)</span>
            <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">detailed_analysis</span><span class="sh">'</span><span class="p">][</span><span class="n">engine_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">engine_data</span>
        
        <span class="c1"># ì¢…í•© ë¶„ì„ ìˆ˜í–‰
</span>        <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">summary</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_summary</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">detailed_analysis</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">insights</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_insights</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">detailed_analysis</span><span class="sh">'</span><span class="p">])</span>
        <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">recommendations</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_recommendations</span><span class="p">(</span><span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">insights</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="n">report</span>
    
    <span class="k">def</span> <span class="nf">_generate_summary</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">detailed_analysis</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìš”ì•½ ì •ë³´ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">summary</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">total_unique_users</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">total_events</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">top_metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">growth_rates</span><span class="sh">'</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">engine_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">detailed_analysis</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="sh">'</span><span class="s">unique_users</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">summary</span><span class="p">[</span><span class="sh">'</span><span class="s">total_unique_users</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">unique_users</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">if</span> <span class="sh">'</span><span class="s">total_events</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">summary</span><span class="p">[</span><span class="sh">'</span><span class="s">total_events</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">data</span><span class="p">[</span><span class="sh">'</span><span class="s">total_events</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="k">return</span> <span class="n">summary</span>
    
    <span class="k">def</span> <span class="nf">_generate_insights</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">detailed_analysis</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¸ì‚¬ì´íŠ¸ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">insights</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">user_behavior</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_user_behavior</span><span class="p">(</span><span class="n">detailed_analysis</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">content_performance</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_content_performance</span><span class="p">(</span><span class="n">detailed_analysis</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">business_metrics</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_analyze_business_metrics</span><span class="p">(</span><span class="n">detailed_analysis</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">insights</span>
    
    <span class="k">def</span> <span class="nf">_generate_recommendations</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">insights</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê¶Œì¥ì‚¬í•­ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># ì‚¬ìš©ì í–‰ë™ ê¸°ë°˜ ê¶Œì¥ì‚¬í•­
</span>        <span class="k">if</span> <span class="n">insights</span><span class="p">[</span><span class="sh">'</span><span class="s">user_behavior</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">engagement_trend</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">declining</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">recommendations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">user_engagement</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">priority</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">high</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">recommendation</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">ì‚¬ìš©ì ì°¸ì—¬ë„ í–¥ìƒì„ ìœ„í•œ ì½˜í…ì¸  ì „ëµ ìˆ˜ë¦½ í•„ìš”</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">action_items</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span>
                    <span class="sh">'</span><span class="s">ê°œì¸í™”ëœ ì½˜í…ì¸  ì¶”ì²œ ì‹œìŠ¤í…œ ë„ì…</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">ì‚¬ìš©ì ì„¸ê·¸ë¨¼íŠ¸ë³„ ë§ì¶¤í˜• ë§ˆì¼€íŒ… ìº í˜ì¸ ì‹¤í–‰</span><span class="sh">'</span>
                <span class="p">]</span>
            <span class="p">})</span>
        
        <span class="c1"># ì½˜í…ì¸  ì„±ê³¼ ê¸°ë°˜ ê¶Œì¥ì‚¬í•­
</span>        <span class="k">if</span> <span class="n">insights</span><span class="p">[</span><span class="sh">'</span><span class="s">content_performance</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">top_performing_category</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">recommendations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">category</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">content_strategy</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">priority</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">medium</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">recommendation</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">insights</span><span class="p">[</span><span class="sh">'</span><span class="s">content_performance</span><span class="sh">'</span><span class="p">][</span><span class="sh">'</span><span class="s">top_performing_category</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> ì¹´í…Œê³ ë¦¬ ì½˜í…ì¸  í™•ëŒ€</span><span class="sh">'</span><span class="s">,
                </span><span class="sh">'</span><span class="s">action_items</span><span class="sh">'</span><span class="s">: [
                    </span><span class="sh">'</span><span class="s">ì„±ê³¼ê°€ ì¢‹ì€ ì½˜í…ì¸  ìœ í˜• ë¶„ì„</span><span class="sh">'</span><span class="s">,
                    </span><span class="sh">'</span><span class="s">ìœ ì‚¬í•œ ì½˜í…ì¸  ì œì‘ ê³„íš ìˆ˜ë¦½</span><span class="sh">'</span><span class="s">
                ]
            })
        
        return recommendations
</span></code></pre></div></div>

<hr />

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="í•µì‹¬-ê°œë…-ì •ë¦¬">í•µì‹¬ ê°œë… ì •ë¦¬</h3>

<ol>
  <li><strong>ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜</strong>
    <ul>
      <li>Count-Min Sketch: ë¹ˆë„ ì¶”ì •</li>
      <li>Bloom Filter: ì¤‘ë³µ ì œê±° ë° ë©¤ë²„ì‹­ í…ŒìŠ¤íŠ¸</li>
      <li>MinHash: ì§‘í•© ìœ ì‚¬ë„ ê³„ì‚°</li>
      <li>T-Digest: ë¶„ìœ„ìˆ˜ ì¶”ì •</li>
    </ul>
  </li>
  <li><strong>ì•Œê³ ë¦¬ì¦˜ ì¡°í•© ì „ëµ</strong>
    <ul>
      <li>HyperLogLog + Count-Min: ì¹´ë””ë„ë¦¬í‹° + ë¹ˆë„ ë¶„ì„</li>
      <li>HyperLogLog + Bloom Filter: ì¤‘ë³µ ì œê±° + ì¹´ìš´íŒ…</li>
      <li>ë‹¤ì¤‘ ì•Œê³ ë¦¬ì¦˜ ì¡°í•©ìœ¼ë¡œ ì •í™•ë„ì™€ íš¨ìœ¨ì„± ê· í˜•</li>
    </ul>
  </li>
  <li><strong>ìŠ¤íŠ¸ë¦¬ë° ë¶„ì„ê³¼ ì‹¤ì‹œê°„ ì²˜ë¦¬</strong>
    <ul>
      <li>ìŠ¬ë¼ì´ë”© ìœˆë„ìš° ê¸°ë°˜ ì‹¤ì‹œê°„ ë¶„ì„</li>
      <li>ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬</li>
      <li>í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ ì„¤ê³„</li>
    </ul>
  </li>
  <li><strong>ê³ ê¸‰ BI ë¶„ì„ ê¸°ë²•</strong>
    <ul>
      <li>ë‹¤ì°¨ì› ë¶„ì„ ì „ëµ</li>
      <li>êµì°¨ ì°¨ì› ë¶„ì„</li>
      <li>íŠ¸ë Œë“œ ë¶„ì„ê³¼ ì´ìƒ íƒì§€</li>
    </ul>
  </li>
  <li><strong>í†µí•© ë¶„ì„ í”Œë«í¼</strong>
    <ul>
      <li>ì‹¤ì‹œê°„ + ë°°ì¹˜ ì²˜ë¦¬ í•˜ì´ë¸Œë¦¬ë“œ</li>
      <li>í™•ì¥ ê°€ëŠ¥í•œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜</li>
      <li>ìë™í™”ëœ ì¸ì‚¬ì´íŠ¸ ìƒì„±</li>
    </ul>
  </li>
</ol>

<h3 id="ì‹¤ë¬´-ì ìš©-ê°€ì´ë“œ">ì‹¤ë¬´ ì ìš© ê°€ì´ë“œ</h3>

<ol>
  <li><strong>ì‹œìŠ¤í…œ ì„¤ê³„ ì‹œ ê³ ë ¤ì‚¬í•­</strong>
    <ul>
      <li>ë°ì´í„° ë³¼ë¥¨ê³¼ ì •í™•ë„ ìš”êµ¬ì‚¬í•­ ë¶„ì„</li>
      <li>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ê³¼ ì²˜ë¦¬ ì„±ëŠ¥ì˜ ê· í˜•</li>
      <li>í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± ê³ ë ¤</li>
    </ul>
  </li>
  <li><strong>ì•Œê³ ë¦¬ì¦˜ ì„ íƒ ê¸°ì¤€</strong>
    <ul>
      <li>ì¹´ë””ë„ë¦¬í‹° ì¶”ì •: HyperLogLog</li>
      <li>ë¹ˆë„ ë¶„ì„: Count-Min Sketch</li>
      <li>ì¤‘ë³µ ì œê±°: Bloom Filter</li>
      <li>ìœ ì‚¬ë„ ë¶„ì„: MinHash</li>
    </ul>
  </li>
  <li><strong>ì„±ëŠ¥ ìµœì í™” ì „ëµ</strong>
    <ul>
      <li>ì ì ˆí•œ ì •ë°€ë„ ì„¤ì •</li>
      <li>ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ êµ¬ì¡° ì„ íƒ</li>
      <li>ë³‘ë ¬ ì²˜ë¦¬ ë° ìºì‹± í™œìš©</li>
    </ul>
  </li>
</ol>

<h3 id="ë‹¤ìŒ-ë‹¨ê³„">ë‹¤ìŒ ë‹¨ê³„</h3>

<p>Modern BI Engineering ì‹œë¦¬ì¦ˆë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. HyperLogLogì™€ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•œ í˜„ëŒ€ì  BI ì‹œìŠ¤í…œ êµ¬ì¶•ì˜ ëª¨ë“  ì¸¡ë©´ì„ ë‹¤ë¤˜ìŠµë‹ˆë‹¤.</p>

<p><strong>ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸:</strong></p>
<ul>
  <li>âœ… HyperLogLogì˜ ì›ë¦¬ì™€ ì‹¤ë¬´ ì ìš©</li>
  <li>âœ… ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ì˜ ì¡°í•© í™œìš©</li>
  <li>âœ… ìŠ¤íŠ¸ë¦¬ë° ë¶„ì„ê³¼ ì‹¤ì‹œê°„ ì²˜ë¦¬ ì‹œìŠ¤í…œ</li>
  <li>âœ… ë‹¤ì°¨ì› ë¶„ì„ê³¼ ê³ ê¸‰ BI ê¸°ë²•</li>
  <li>âœ… í†µí•© ë¶„ì„ í”Œë«í¼ êµ¬ì¶•</li>
</ul>

<p><strong>ì¶”ì²œ ë‹¤ìŒ ì‹œë¦¬ì¦ˆ:</strong></p>
<ul>
  <li><strong>ì‹¤ì‹œê°„ ë°ì´í„° íŒŒì´í”„ë¼ì¸</strong>: Apache Kafka, Flinkë¥¼ í™œìš©í•œ ì‹¤ì‹œê°„ ì²˜ë¦¬</li>
  <li><strong>ë°ì´í„° ì‹œê°í™” ë§ˆìŠ¤í„°</strong>: D3.js, Tableauë¥¼ í™œìš©í•œ ê³ ê¸‰ ì‹œê°í™”</li>
  <li><strong>ë¨¸ì‹ ëŸ¬ë‹ ê¸°ë°˜ BI</strong>: ì˜ˆì¸¡ ë¶„ì„ê³¼ ìë™í™”ëœ ì¸ì‚¬ì´íŠ¸ ìƒì„±</li>
</ul>

<p>HyperLogLogì™€ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•œ í˜„ëŒ€ì  BI ì‹œìŠ¤í…œ êµ¬ì¶•ì˜ ì™„ì „í•œ ì—¬ì •ì„ ë§ˆì³¤ìŠµë‹ˆë‹¤! ğŸ‰</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
      
        
          
          
      
      
        
        
        <a href="/bi-engineering/2025/09/24/hyperloglog-production-optimization.html" class="nav-link prev">
          â† ì´ì „: Part 2: HyperLogLog ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™” - í”„ë¡œë•ì…˜ê¸‰ BI ì‹œìŠ¤í…œ êµ¬ì¶•
        </a>
      
      
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/bi-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2026 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

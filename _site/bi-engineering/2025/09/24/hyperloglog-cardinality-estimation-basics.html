<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="HyperLogLog ì•Œê³ ë¦¬ì¦˜ì˜ ì›ë¦¬ë¶€í„° ì‹¤ë¬´ ì ìš©ê¹Œì§€, ëŒ€ìš©ëŸ‰ ë°ì´í„°ì—ì„œ ì¹´ë””ë„ë¦¬í‹°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì¶”ì •í•˜ëŠ” ë°©ë²•ì„ ì™„ì „íˆ ì •ë³µí•©ë‹ˆë‹¤.">



<title>Part 1: HyperLogLog ê¸°ì´ˆì™€ ì¹´ë””ë„ë¦¬í‹° ì¶”ì • - ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ê³ ìœ ê°’ ê°œìˆ˜ íš¨ìœ¨ì  ê³„ì‚° - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 1: HyperLogLog ê¸°ì´ˆì™€ ì¹´ë””ë„ë¦¬í‹° ì¶”ì • - ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ê³ ìœ ê°’ ê°œìˆ˜ íš¨ìœ¨ì  ê³„ì‚°">
<meta property="og:description" content="HyperLogLog ì•Œê³ ë¦¬ì¦˜ì˜ ì›ë¦¬ë¶€í„° ì‹¤ë¬´ ì ìš©ê¹Œì§€, ëŒ€ìš©ëŸ‰ ë°ì´í„°ì—ì„œ ì¹´ë””ë„ë¦¬í‹°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì¶”ì •í•˜ëŠ” ë°©ë²•ì„ ì™„ì „íˆ ì •ë³µí•©ë‹ˆë‹¤.">
<meta property="og:url" content="http://localhost:4000/bi-engineering/2025/09/24/hyperloglog-cardinality-estimation-basics.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 1: HyperLogLog ê¸°ì´ˆì™€ ì¹´ë””ë„ë¦¬í‹° ì¶”ì • - ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ê³ ìœ ê°’ ê°œìˆ˜ íš¨ìœ¨ì  ê³„ì‚°">
<meta name="twitter:description" content="HyperLogLog ì•Œê³ ë¦¬ì¦˜ì˜ ì›ë¦¬ë¶€í„° ì‹¤ë¬´ ì ìš©ê¹Œì§€, ëŒ€ìš©ëŸ‰ ë°ì´í„°ì—ì„œ ì¹´ë””ë„ë¦¬í‹°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì¶”ì •í•˜ëŠ” ë°©ë²•ì„ ì™„ì „íˆ ì •ë³µí•©ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/bi-engineering/2025/09/24/hyperloglog-cardinality-estimation-basics.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-24-hyperloglog-cardinality-estimation-basics.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Bi engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 24ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 1: HyperLogLog ê¸°ì´ˆì™€ ì¹´ë””ë„ë¦¬í‹° ì¶”ì • - ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ê³ ìœ ê°’ ê°œìˆ˜ íš¨ìœ¨ì  ê³„ì‚°</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">HyperLogLog</span>
      
        <span class="tag">ì¹´ë””ë„ë¦¬í‹°ì¶”ì •</span>
      
        <span class="tag">ëŒ€ìš©ëŸ‰ë°ì´í„°</span>
      
        <span class="tag">BIì—”ì§€ë‹ˆì–´ë§</span>
      
        <span class="tag">ì‹¤ì‹œê°„ë¶„ì„</span>
      
        <span class="tag">ìŠ¤íŠ¸ë¦¬ë°</span>
      
        <span class="tag">ì„±ëŠ¥ìµœì í™”</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Modern bi engineering ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 2</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 40ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ì¤‘ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-1-hyperloglog-ê¸°ì´ˆì™€-ì¹´ë””ë„ë¦¬í‹°-ì¶”ì •---ëŒ€ìš©ëŸ‰-ë°ì´í„°ì˜-ê³ ìœ ê°’-ê°œìˆ˜-íš¨ìœ¨ì -ê³„ì‚°">Part 1: HyperLogLog ê¸°ì´ˆì™€ ì¹´ë””ë„ë¦¬í‹° ì¶”ì • - ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ê³ ìœ ê°’ ê°œìˆ˜ íš¨ìœ¨ì  ê³„ì‚°</h1>

<blockquote>
  <p>HyperLogLog ì•Œê³ ë¦¬ì¦˜ì˜ ì›ë¦¬ë¶€í„° ì‹¤ë¬´ ì ìš©ê¹Œì§€, ëŒ€ìš©ëŸ‰ ë°ì´í„°ì—ì„œ ì¹´ë””ë„ë¦¬í‹°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì¶”ì •í•˜ëŠ” ë°©ë²•ì„ ì™„ì „íˆ ì •ë³µí•©ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#ì¹´ë””ë„ë¦¬í‹°-ì¶”ì •ì´ë€">ì¹´ë””ë„ë¦¬í‹° ì¶”ì •ì´ë€?</a></li>
  <li><a href="#hyperloglog-ì•Œê³ ë¦¬ì¦˜-ì›ë¦¬">HyperLogLog ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬</a></li>
  <li><a href="#ê¸°ì¡´-ë°©ë²•ê³¼ì˜-ë¹„êµ">ê¸°ì¡´ ë°©ë²•ê³¼ì˜ ë¹„êµ</a></li>
  <li><a href="#ì‹¤ë¬´-ì ìš©-ì‹œë‚˜ë¦¬ì˜¤">ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</a></li>
  <li><a href="#hyperloglog-êµ¬í˜„ê³¼-ìµœì í™”">HyperLogLog êµ¬í˜„ê³¼ ìµœì í™”</a></li>
  <li><a href="#ì„±ëŠ¥-ë²¤ì¹˜ë§ˆí¬ì™€-ë¶„ì„">ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ì™€ ë¶„ì„</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<h2 id="ì¹´ë””ë„ë¦¬í‹°-ì¶”ì •ì´ë€">ğŸ¯ ì¹´ë””ë„ë¦¬í‹° ì¶”ì •ì´ë€?</h2>

<h3 id="ì¹´ë””ë„ë¦¬í‹°-ì¶”ì •ì˜-ì •ì˜">ì¹´ë””ë„ë¦¬í‹° ì¶”ì •ì˜ ì •ì˜</h3>

<p><strong>ì¹´ë””ë„ë¦¬í‹°(Cardinality)</strong>ëŠ” ì§‘í•©ì˜ ê³ ìœ í•œ ì›ì†Œì˜ ê°œìˆ˜ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ë°ì´í„° ë¶„ì„ì—ì„œ ì¹´ë””ë„ë¦¬í‹° ì¶”ì •ì€ ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ í•„ìˆ˜ì ì…ë‹ˆë‹¤:</p>

<h3 id="ì¹´ë””ë„ë¦¬í‹°-ì¶”ì •ì´-í•„ìš”í•œ-ìƒí™©">ì¹´ë””ë„ë¦¬í‹° ì¶”ì •ì´ í•„ìš”í•œ ìƒí™©</h3>

<table>
  <thead>
    <tr>
      <th>ìƒí™©</th>
      <th>ì˜ˆì‹œ</th>
      <th>ì¤‘ìš”ë„</th>
      <th>ë„ì „ ê³¼ì œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì›¹ ë¶„ì„</strong></td>
      <td>ì¼ì¼ í™œì„± ì‚¬ìš©ì ìˆ˜ (DAU)</td>
      <td>â­â­â­â­â­</td>
      <td>ìˆ˜ì‹­ì–µ ì´ë²¤íŠ¸ì—ì„œ ê³ ìœ  ì‚¬ìš©ì ì¶”ì •</td>
    </tr>
    <tr>
      <td><strong>ì „ììƒê±°ë˜</strong></td>
      <td>ê³ ìœ  ë°©ë¬¸ì ìˆ˜</td>
      <td>â­â­â­â­â­</td>
      <td>ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸</td>
    </tr>
    <tr>
      <td><strong>ê´‘ê³  ë¶„ì„</strong></td>
      <td>ìº í˜ì¸ë³„ ê³ ìœ  í´ë¦­ ìˆ˜</td>
      <td>â­â­â­â­</td>
      <td>ë§ˆì¼€íŒ… ROI ê³„ì‚°</td>
    </tr>
    <tr>
      <td><strong>ë„¤íŠ¸ì›Œí¬ ë¶„ì„</strong></td>
      <td>ê³ ìœ  IP ì£¼ì†Œ ìˆ˜</td>
      <td>â­â­â­â­</td>
      <td>ë³´ì•ˆ ëª¨ë‹ˆí„°ë§</td>
    </tr>
    <tr>
      <td><strong>ì†Œì…œ ë¯¸ë””ì–´</strong></td>
      <td>ê³ ìœ  í•´ì‹œíƒœê·¸ ìˆ˜</td>
      <td>â­â­â­</td>
      <td>íŠ¸ë Œë“œ ë¶„ì„</td>
    </tr>
  </tbody>
</table>

<h3 id="ì „í†µì ì¸-ë°©ë²•ì˜-í•œê³„">ì „í†µì ì¸ ë°©ë²•ì˜ í•œê³„</h3>

<h4 id="ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ë¹„êµ">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµ</h4>

<table>
  <thead>
    <tr>
      <th>ë°©ë²•</th>
      <th>1ì–µ ê³ ìœ ê°’</th>
      <th>10ì–µ ê³ ìœ ê°’</th>
      <th>100ì–µ ê³ ìœ ê°’</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Hash Set</strong></td>
      <td>~800MB</td>
      <td>~8GB</td>
      <td>~80GB</td>
    </tr>
    <tr>
      <td><strong>BitSet</strong></td>
      <td>~12.5MB</td>
      <td>~125MB</td>
      <td>~1.25GB</td>
    </tr>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>~12KB</td>
      <td>~12KB</td>
      <td>~12KB</td>
    </tr>
  </tbody>
</table>

<h4 id="ì²˜ë¦¬-ì‹œê°„-ë¹„êµ">ì²˜ë¦¬ ì‹œê°„ ë¹„êµ</h4>

<table>
  <thead>
    <tr>
      <th>ë°©ë²•</th>
      <th>1ì–µ ë ˆì½”ë“œ</th>
      <th>10ì–µ ë ˆì½”ë“œ</th>
      <th>100ì–µ ë ˆì½”ë“œ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>COUNT DISTINCT</strong></td>
      <td>5ë¶„</td>
      <td>50ë¶„</td>
      <td>8ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>Hash Set</strong></td>
      <td>3ë¶„</td>
      <td>30ë¶„</td>
      <td>5ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>30ì´ˆ</td>
      <td>5ë¶„</td>
      <td>50ë¶„</td>
    </tr>
  </tbody>
</table>

<h2 id="hyperloglog-ì•Œê³ ë¦¬ì¦˜-ì›ë¦¬">ğŸ”¬ HyperLogLog ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬</h2>

<h3 id="í•µì‹¬-ì•„ì´ë””ì–´">í•µì‹¬ ì•„ì´ë””ì–´</h3>

<p>HyperLogLogëŠ” <strong>í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜</strong>ìœ¼ë¡œ, ë‹¤ìŒê³¼ ê°™ì€ í•µì‹¬ ì›ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤:</p>

<ol>
  <li><strong>í•´ì‹œ í•¨ìˆ˜</strong>: ê° ì›ì†Œë¥¼ í•´ì‹œê°’ìœ¼ë¡œ ë³€í™˜</li>
  <li><strong>Leading Zero Count</strong>: í•´ì‹œê°’ì˜ ì•ìª½ 0ì˜ ê°œìˆ˜ ê³„ì‚°</li>
  <li><strong>í†µê³„ì  ì¶”ì •</strong>: Leading zeroì˜ ë¶„í¬ë¡œ ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</li>
</ol>

<h3 id="ì•Œê³ ë¦¬ì¦˜-ìƒì„¸-ê³¼ì •">ì•Œê³ ë¦¬ì¦˜ ìƒì„¸ ê³¼ì •</h3>

<h4 id="1ë‹¨ê³„-í•´ì‹œ-ë³€í™˜">1ë‹¨ê³„: í•´ì‹œ ë³€í™˜</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">hash_element</span><span class="p">(</span><span class="n">element</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì›ì†Œë¥¼ í•´ì‹œê°’ìœ¼ë¡œ ë³€í™˜</span><span class="sh">"""</span>
    <span class="kn">import</span> <span class="n">hashlib</span>
    <span class="n">hash_value</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="nf">md5</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">element</span><span class="p">).</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">hexdigest</span><span class="p">()</span>
    <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="n">hash_value</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="2ë‹¨ê³„-leading-zero-ê³„ì‚°">2ë‹¨ê³„: Leading Zero ê³„ì‚°</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">count_leading_zeros</span><span class="p">(</span><span class="n">hash_value</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">í•´ì‹œê°’ì˜ ì•ìª½ 0ì˜ ê°œìˆ˜ ê³„ì‚°</span><span class="sh">"""</span>
    <span class="n">binary</span> <span class="o">=</span> <span class="nf">bin</span><span class="p">(</span><span class="n">hash_value</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>  <span class="c1"># '0b' ì œê±°
</span>    <span class="n">leading_zeros</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">bit</span> <span class="ow">in</span> <span class="n">binary</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="sh">'</span><span class="s">0</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">leading_zeros</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">leading_zeros</span>
</code></pre></div></div>

<h4 id="3ë‹¨ê³„-í†µê³„ì -ì¶”ì •">3ë‹¨ê³„: í†µê³„ì  ì¶”ì •</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">estimate_cardinality</span><span class="p">(</span><span class="n">leading_zero_counts</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</span><span class="sh">"""</span>
    <span class="kn">import</span> <span class="n">math</span>
    
    <span class="c1"># ì¡°í™” í‰ê·  ê³„ì‚°
</span>    <span class="n">harmonic_mean</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="nf">sum</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">leading_zero_counts</span><span class="p">)</span>
    
    <span class="c1"># ë³´ì • ê³„ìˆ˜ ì ìš©
</span>    <span class="n">alpha_m</span> <span class="o">=</span> <span class="p">{</span>
        <span class="mi">16</span><span class="p">:</span> <span class="mf">0.673</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="mf">0.697</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span> <span class="mf">0.709</span><span class="p">,</span> <span class="mi">128</span><span class="p">:</span> <span class="mf">0.715</span><span class="p">,</span> <span class="mi">256</span><span class="p">:</span> <span class="mf">0.718</span><span class="p">,</span>
        <span class="mi">512</span><span class="p">:</span> <span class="mf">0.720</span><span class="p">,</span> <span class="mi">1024</span><span class="p">:</span> <span class="mf">0.722</span><span class="p">,</span> <span class="mi">2048</span><span class="p">:</span> <span class="mf">0.723</span><span class="p">,</span> <span class="mi">4096</span><span class="p">:</span> <span class="mf">0.724</span>
    <span class="p">}</span>
    
    <span class="n">raw_estimate</span> <span class="o">=</span> <span class="n">alpha_m</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mf">0.7213</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.079</span> <span class="o">/</span> <span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">harmonic_mean</span>
    
    <span class="c1"># ì†Œê·œëª¨ ë³´ì •
</span>    <span class="k">if</span> <span class="n">raw_estimate</span> <span class="o">&lt;=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">m</span><span class="p">:</span>
        <span class="n">zeros</span> <span class="o">=</span> <span class="n">leading_zero_counts</span><span class="p">.</span><span class="nf">count</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">zeros</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">m</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="n">zeros</span><span class="p">)</span>
    
    <span class="c1"># ëŒ€ê·œëª¨ ë³´ì •
</span>    <span class="k">if</span> <span class="n">raw_estimate</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mi">30</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">raw_estimate</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">))</span>
    
    <span class="k">return</span> <span class="n">raw_estimate</span>
</code></pre></div></div>

<h3 id="ì •ë°€ë„ì™€-ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰">ì •ë°€ë„ì™€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</h3>

<table>
  <thead>
    <tr>
      <th>ì •ë°€ë„ (bits)</th>
      <th>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</th>
      <th>í‘œì¤€ ì˜¤ì°¨</th>
      <th>ë©”ëª¨ë¦¬ (KB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>4</strong></td>
      <td>2^4 = 16</td>
      <td>~26%</td>
      <td>0.125</td>
    </tr>
    <tr>
      <td><strong>8</strong></td>
      <td>2^8 = 256</td>
      <td>~6.5%</td>
      <td>2</td>
    </tr>
    <tr>
      <td><strong>12</strong></td>
      <td>2^12 = 4,096</td>
      <td>~1.6%</td>
      <td>32</td>
    </tr>
    <tr>
      <td><strong>16</strong></td>
      <td>2^16 = 65,536</td>
      <td>~0.4%</td>
      <td>512</td>
    </tr>
  </tbody>
</table>

<h2 id="ê¸°ì¡´-ë°©ë²•ê³¼ì˜-ë¹„êµ">âš–ï¸ ê¸°ì¡´ ë°©ë²•ê³¼ì˜ ë¹„êµ</h2>

<h3 id="ë°©ë²•ë³„-ìƒì„¸-ë¹„êµ">ë°©ë²•ë³„ ìƒì„¸ ë¹„êµ</h3>

<table>
  <thead>
    <tr>
      <th>ë°©ë²•</th>
      <th>ì •í™•ë„</th>
      <th>ë©”ëª¨ë¦¬</th>
      <th>ì†ë„</th>
      <th>í™•ì¥ì„±</th>
      <th>ì‹¤ì‹œê°„ì„±</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>COUNT DISTINCT</strong></td>
      <td>100%</td>
      <td>ë§¤ìš° ë†’ìŒ</td>
      <td>ëŠë¦¼</td>
      <td>ì œí•œì </td>
      <td>ë¶ˆê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>Hash Set</strong></td>
      <td>100%</td>
      <td>ë†’ìŒ</td>
      <td>ë³´í†µ</td>
      <td>ì œí•œì </td>
      <td>ì–´ë ¤ì›€</td>
    </tr>
    <tr>
      <td><strong>BitSet</strong></td>
      <td>100%</td>
      <td>ë³´í†µ</td>
      <td>ë¹ ë¦„</td>
      <td>ì œí•œì </td>
      <td>ê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>Bloom Filter</strong></td>
      <td>~95%</td>
      <td>ë‚®ìŒ</td>
      <td>ë¹ ë¦„</td>
      <td>ì¢‹ìŒ</td>
      <td>ê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>~99%</td>
      <td>ë§¤ìš° ë‚®ìŒ</td>
      <td>ë§¤ìš° ë¹ ë¦„</td>
      <td>ìš°ìˆ˜</td>
      <td>ìš°ìˆ˜</td>
    </tr>
  </tbody>
</table>

<h3 id="ë¹„ìš©-íš¨ìœ¨ì„±-ë¶„ì„">ë¹„ìš© íš¨ìœ¨ì„± ë¶„ì„</h3>

<h4 id="í´ë¼ìš°ë“œ-ë¹„ìš©-ë¹„êµ-ì›”-100ì–µ-ì´ë²¤íŠ¸-ê¸°ì¤€">í´ë¼ìš°ë“œ ë¹„ìš© ë¹„êµ (ì›” 100ì–µ ì´ë²¤íŠ¸ ê¸°ì¤€)</h4>

<table>
  <thead>
    <tr>
      <th>ë°©ë²•</th>
      <th>ì»´í“¨íŒ… ë¹„ìš©</th>
      <th>ìŠ¤í† ë¦¬ì§€ ë¹„ìš©</th>
      <th>ì´ ë¹„ìš©</th>
      <th>ì ˆì•½ë¥ </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>COUNT DISTINCT</strong></td>
      <td>$2,000</td>
      <td>$500</td>
      <td>$2,500</td>
      <td>-</td>
    </tr>
    <tr>
      <td><strong>Hash Set</strong></td>
      <td>$1,500</td>
      <td>$300</td>
      <td>$1,800</td>
      <td>28%</td>
    </tr>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>$200</td>
      <td>$50</td>
      <td>$250</td>
      <td><strong>90%</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="ì„±ëŠ¥-íŠ¹ì„±-ë¹„êµ">ì„±ëŠ¥ íŠ¹ì„± ë¹„êµ</h4>

<table>
  <thead>
    <tr>
      <th>ë°©ë²•</th>
      <th>ì²˜ë¦¬ëŸ‰ (events/sec)</th>
      <th>ì§€ì—°ì‹œê°„ (ms)</th>
      <th>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ (GB)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>COUNT DISTINCT</strong></td>
      <td>10,000</td>
      <td>5,000</td>
      <td>100</td>
    </tr>
    <tr>
      <td><strong>Hash Set</strong></td>
      <td>50,000</td>
      <td>1,000</td>
      <td>50</td>
    </tr>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>500,000</td>
      <td>10</td>
      <td>0.01</td>
    </tr>
  </tbody>
</table>

<h2 id="ì‹¤ë¬´-ì ìš©-ì‹œë‚˜ë¦¬ì˜¤">ğŸ¢ ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</h2>

<h3 id="ì‹œë‚˜ë¦¬ì˜¤-1-ì‹¤ì‹œê°„-ì›¹-ë¶„ì„">ì‹œë‚˜ë¦¬ì˜¤ 1: ì‹¤ì‹œê°„ ì›¹ ë¶„ì„</h3>

<h4 id="ìš”êµ¬ì‚¬í•­">ìš”êµ¬ì‚¬í•­</h4>
<ul>
  <li><strong>ë°ì´í„° ë³¼ë¥¨</strong>: ì´ˆë‹¹ 100ë§Œ ì´ë²¤íŠ¸</li>
  <li><strong>ì •í™•ë„</strong>: 99% ì´ìƒ</li>
  <li><strong>ì§€ì—°ì‹œê°„</strong>: 1ì´ˆ ì´ë‚´</li>
  <li><strong>ë©”ëª¨ë¦¬</strong>: 1GB ì´ë‚´</li>
</ul>

<h4 id="hyperloglog-ì†”ë£¨ì…˜">HyperLogLog ì†”ë£¨ì…˜</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RealTimeWebAnalytics</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">daily_users</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># 99.9% ì •í™•ë„
</span>        <span class="n">self</span><span class="p">.</span><span class="n">hourly_users</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>  <span class="c1"># 99% ì •í™•ë„
</span>        <span class="n">self</span><span class="p">.</span><span class="n">realtime_users</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># 95% ì •í™•ë„
</span>    
    <span class="k">def</span> <span class="nf">process_event</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ì²˜ë¦¬</span><span class="sh">"""</span>
        <span class="c1"># ì¼ì¼ í™œì„± ì‚¬ìš©ì ì¶”ì •
</span>        <span class="n">self</span><span class="p">.</span><span class="n">daily_users</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        
        <span class="c1"># ì‹œê°„ë³„ í™œì„± ì‚¬ìš©ì ì¶”ì •
</span>        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">is_current_hour</span><span class="p">(</span><span class="n">timestamp</span><span class="p">):</span>
            <span class="n">self</span><span class="p">.</span><span class="n">hourly_users</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        
        <span class="c1"># ì‹¤ì‹œê°„ í™œì„± ì‚¬ìš©ì ì¶”ì • (ìµœê·¼ 5ë¶„)
</span>        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="nf">is_recent_5min</span><span class="p">(</span><span class="n">timestamp</span><span class="p">):</span>
            <span class="n">self</span><span class="p">.</span><span class="n">realtime_users</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_metrics</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ë°˜í™˜</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">daily_active_users</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">daily_users</span><span class="p">.</span><span class="nf">estimate</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">hourly_active_users</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">hourly_users</span><span class="p">.</span><span class="nf">estimate</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">realtime_active_users</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">realtime_users</span><span class="p">.</span><span class="nf">estimate</span><span class="p">()</span>
        <span class="p">}</span>
</code></pre></div></div>

<h3 id="ì‹œë‚˜ë¦¬ì˜¤-2-ì „ììƒê±°ë˜-ë§ˆì¼€íŒ…-ë¶„ì„">ì‹œë‚˜ë¦¬ì˜¤ 2: ì „ììƒê±°ë˜ ë§ˆì¼€íŒ… ë¶„ì„</h3>

<h4 id="ìš”êµ¬ì‚¬í•­-1">ìš”êµ¬ì‚¬í•­</h4>
<ul>
  <li><strong>ìº í˜ì¸ë³„ ê³ ìœ  í´ë¦­ ìˆ˜</strong> ì¶”ì </li>
  <li><strong>ì‹¤ì‹œê°„ ì „í™˜ìœ¨</strong> ê³„ì‚°</li>
  <li><strong>A/B í…ŒìŠ¤íŠ¸</strong> ê²°ê³¼ ë¹„êµ</li>
  <li><strong>ë¹„ìš© íš¨ìœ¨ì„±</strong> ì¤‘ìš”</li>
</ul>

<h4 id="ë§ˆì¼€íŒ…-ë¶„ì„-êµ¬í˜„">ë§ˆì¼€íŒ… ë¶„ì„ êµ¬í˜„</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MarketingAnalytics</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">campaign_clicks</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">campaign_purchases</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ab_test_groups</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">track_campaign_click</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">campaign_id</span><span class="p">,</span> <span class="n">ab_test_group</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìº í˜ì¸ í´ë¦­ ì¶”ì </span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">campaign_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_clicks</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">campaign_clicks</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">]</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">campaign_clicks</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        
        <span class="c1"># A/B í…ŒìŠ¤íŠ¸ ê·¸ë£¹ë³„ ì¶”ì 
</span>        <span class="k">if</span> <span class="n">ab_test_group</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">campaign_id</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">ab_test_group</span><span class="si">}</span><span class="sh">"</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">ab_test_groups</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">ab_test_groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">ab_test_groups</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">track_purchase</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="n">campaign_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">êµ¬ë§¤ ì¶”ì </span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">campaign_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_purchases</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">campaign_purchases</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">]</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">campaign_purchases</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_campaign_metrics</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">campaign_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìº í˜ì¸ ë©”íŠ¸ë¦­ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="n">clicks</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_clicks</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">campaign_id</span><span class="p">,</span> <span class="nc">HyperLogLog</span><span class="p">()).</span><span class="nf">estimate</span><span class="p">()</span>
        <span class="n">purchases</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_purchases</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">campaign_id</span><span class="p">,</span> <span class="nc">HyperLogLog</span><span class="p">()).</span><span class="nf">estimate</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">unique_clicks</span><span class="sh">"</span><span class="p">:</span> <span class="n">clicks</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">unique_purchases</span><span class="sh">"</span><span class="p">:</span> <span class="n">purchases</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">conversion_rate</span><span class="sh">"</span><span class="p">:</span> <span class="n">purchases</span> <span class="o">/</span> <span class="n">clicks</span> <span class="k">if</span> <span class="n">clicks</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_ab_test_results</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">campaign_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">A/B í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë¹„êµ</span><span class="sh">"""</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">[</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">B</span><span class="sh">"</span><span class="p">]:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">campaign_id</span><span class="si">}</span><span class="s">_</span><span class="si">{</span><span class="n">group</span><span class="si">}</span><span class="sh">"</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">ab_test_groups</span><span class="p">:</span>
                <span class="n">results</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="sh">"</span><span class="s">unique_clicks</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">ab_test_groups</span><span class="p">[</span><span class="n">key</span><span class="p">].</span><span class="nf">estimate</span><span class="p">(),</span>
                    <span class="sh">"</span><span class="s">conversion_rate</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_campaign_metrics</span><span class="p">(</span><span class="n">campaign_id</span><span class="p">)[</span><span class="sh">"</span><span class="s">conversion_rate</span><span class="sh">"</span><span class="p">]</span>
                <span class="p">}</span>
        <span class="k">return</span> <span class="n">results</span>
</code></pre></div></div>

<h3 id="ì‹œë‚˜ë¦¬ì˜¤-3-ë„¤íŠ¸ì›Œí¬-ë³´ì•ˆ-ëª¨ë‹ˆí„°ë§">ì‹œë‚˜ë¦¬ì˜¤ 3: ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§</h3>

<h4 id="ìš”êµ¬ì‚¬í•­-2">ìš”êµ¬ì‚¬í•­</h4>
<ul>
  <li><strong>DDoS ê³µê²© íƒì§€</strong></li>
  <li><strong>ë¹„ì •ìƒ íŠ¸ë˜í”½ íŒ¨í„´</strong> ì‹ë³„</li>
  <li><strong>ì‹¤ì‹œê°„ ì•Œë¦¼</strong></li>
  <li><strong>ì €ì§€ì—° ì²˜ë¦¬</strong></li>
</ul>

<h4 id="ë³´ì•ˆ-ëª¨ë‹ˆí„°ë§-êµ¬í˜„">ë³´ì•ˆ ëª¨ë‹ˆí„°ë§ êµ¬í˜„</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">NetworkSecurityMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">ip_tracker</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">port_tracker</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">attack_threshold</span> <span class="o">=</span> <span class="mi">100000</span>  <span class="c1"># IP ìˆ˜ ì„ê³„ê°’
</span>    
    <span class="k">def</span> <span class="nf">monitor_traffic</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ip_address</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ëª¨ë‹ˆí„°ë§</span><span class="sh">"""</span>
        <span class="c1"># ê³ ìœ  IP ì£¼ì†Œ ì¶”ì 
</span>        <span class="n">self</span><span class="p">.</span><span class="n">ip_tracker</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">ip_address</span><span class="p">)</span>
        
        <span class="c1"># ê³ ìœ  í¬íŠ¸ ì¶”ì 
</span>        <span class="n">self</span><span class="p">.</span><span class="n">port_tracker</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
        
        <span class="c1"># DDoS ê³µê²© íƒì§€
</span>        <span class="n">unique_ips</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">ip_tracker</span><span class="p">.</span><span class="nf">estimate</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">unique_ips</span> <span class="o">&gt;</span> <span class="n">self</span><span class="p">.</span><span class="n">attack_threshold</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">trigger_alert</span><span class="p">(</span><span class="n">unique_ips</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">trigger_alert</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">ip_count</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë³´ì•ˆ ì•Œë¦¼ íŠ¸ë¦¬ê±°</span><span class="sh">"""</span>
        <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">type</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">DDoS_ATTACK_DETECTED</span><span class="sh">"</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">timestamp</span><span class="sh">"</span><span class="p">:</span> <span class="n">timestamp</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">unique_ip_count</span><span class="sh">"</span><span class="p">:</span> <span class="n">ip_count</span><span class="p">,</span>
            <span class="sh">"</span><span class="s">severity</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">HIGH</span><span class="sh">"</span>
        <span class="p">}</span>
        <span class="c1"># ì•Œë¦¼ ì‹œìŠ¤í…œì— ì „ì†¡
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_security_metrics</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë³´ì•ˆ ë©”íŠ¸ë¦­ ë°˜í™˜</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">"</span><span class="s">unique_ip_addresses</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">ip_tracker</span><span class="p">.</span><span class="nf">estimate</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">unique_ports</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">port_tracker</span><span class="p">.</span><span class="nf">estimate</span><span class="p">(),</span>
            <span class="sh">"</span><span class="s">attack_probability</span><span class="sh">"</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">calculate_attack_probability</span><span class="p">()</span>
        <span class="p">}</span>
</code></pre></div></div>

<h2 id="hyperloglog-êµ¬í˜„ê³¼-ìµœì í™”">ğŸ› ï¸ HyperLogLog êµ¬í˜„ê³¼ ìµœì í™”</h2>

<h3 id="ê¸°ë³¸-hyperloglog-êµ¬í˜„">ê¸°ë³¸ HyperLogLog êµ¬í˜„</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">hashlib</span>
<span class="kn">import</span> <span class="n">math</span>
<span class="kn">from</span> <span class="n">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">class</span> <span class="nc">HyperLogLog</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">
        HyperLogLog ì´ˆê¸°í™”
        
        Args:
            precision: ì •ë°€ë„ (4-16, ê¸°ë³¸ê°’ 14)
                      ë†’ì„ìˆ˜ë¡ ì •í™•í•˜ì§€ë§Œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ì¦ê°€
        </span><span class="sh">"""</span>
        <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">precision</span>  <span class="c1"># ë²„í‚· ìˆ˜
</span>        <span class="n">self</span><span class="p">.</span><span class="n">registers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">m</span>
        
        <span class="c1"># ì¡°ì • ê³„ìˆ˜
</span>        <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_alpha</span><span class="p">()</span>
        
        <span class="c1"># í•´ì‹œ í•¨ìˆ˜ ì„¤ì •
</span>        <span class="n">self</span><span class="p">.</span><span class="n">hash_func</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span>
    
    <span class="k">def</span> <span class="nf">_calculate_alpha</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¡°ì • ê³„ìˆ˜ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="n">alpha_values</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">4</span><span class="p">:</span> <span class="mf">0.673</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">0.697</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mf">0.709</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mf">0.715</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mf">0.718</span><span class="p">,</span>
            <span class="mi">9</span><span class="p">:</span> <span class="mf">0.720</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mf">0.722</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mf">0.723</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mf">0.724</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mf">0.725</span><span class="p">,</span>
            <span class="mi">14</span><span class="p">:</span> <span class="mf">0.726</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mf">0.727</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mf">0.728</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">alpha_values</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">precision</span><span class="p">,</span> <span class="mf">0.7213</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.079</span> <span class="o">/</span> <span class="n">self</span><span class="p">.</span><span class="n">m</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì›ì†Œ ì¶”ê°€</span><span class="sh">"""</span>
        <span class="c1"># í•´ì‹œê°’ ê³„ì‚°
</span>        <span class="n">hash_value</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_hash</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        
        <span class="c1"># ë²„í‚· ì¸ë±ìŠ¤ì™€ ê°’ ê³„ì‚°
</span>        <span class="n">bucket_index</span> <span class="o">=</span> <span class="n">hash_value</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_count_leading_zeros</span><span class="p">(</span><span class="n">hash_value</span> <span class="o">&gt;&gt;</span> <span class="n">self</span><span class="p">.</span><span class="n">precision</span><span class="p">)</span>
        
        <span class="c1"># ë ˆì§€ìŠ¤í„° ì—…ë°ì´íŠ¸
</span>        <span class="n">self</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">bucket_index</span><span class="p">]</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">bucket_index</span><span class="p">],</span> <span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_hash</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">í•´ì‹œê°’ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="n">hash_obj</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">hash_func</span><span class="p">(</span><span class="nf">str</span><span class="p">(</span><span class="n">element</span><span class="p">).</span><span class="nf">encode</span><span class="p">(</span><span class="sh">'</span><span class="s">utf-8</span><span class="sh">'</span><span class="p">))</span>
        <span class="k">return</span> <span class="nf">int</span><span class="p">(</span><span class="n">hash_obj</span><span class="p">.</span><span class="nf">hexdigest</span><span class="p">()[:</span><span class="mi">8</span><span class="p">],</span> <span class="mi">16</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_count_leading_zeros</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì•ìª½ 0ì˜ ê°œìˆ˜ ê³„ì‚°</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">32</span> <span class="o">-</span> <span class="n">self</span><span class="p">.</span><span class="n">precision</span>
        
        <span class="n">leading_zeros</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="nf">while </span><span class="p">(</span><span class="n">value</span> <span class="o">&amp;</span> <span class="mh">0x80000000</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">leading_zeros</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">value</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">leading_zeros</span>
    
    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</span><span class="sh">"""</span>
        <span class="c1"># ì¡°í™” í‰ê·  ê³„ì‚°
</span>        <span class="n">harmonic_mean</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">empty_registers</span> <span class="o">=</span> <span class="mi">0</span>
        
        <span class="k">for</span> <span class="n">register</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">registers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">register</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">empty_registers</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">harmonic_mean</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">register</span><span class="p">)</span>
        
        <span class="c1"># ì¶”ì •ê°’ ê³„ì‚°
</span>        <span class="n">raw_estimate</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">harmonic_mean</span>
        
        <span class="c1"># ì†Œê·œëª¨ ë³´ì •
</span>        <span class="k">if</span> <span class="n">raw_estimate</span> <span class="o">&lt;=</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="ow">and</span> <span class="n">empty_registers</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="o">/</span> <span class="n">empty_registers</span><span class="p">)</span>
        
        <span class="c1"># ëŒ€ê·œëª¨ ë³´ì •
</span>        <span class="k">if</span> <span class="n">raw_estimate</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span> <span class="o">/</span> <span class="mi">30</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">)</span> <span class="o">*</span> <span class="n">math</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">raw_estimate</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">32</span><span class="p">))</span>
        
        <span class="k">return</span> <span class="n">raw_estimate</span>
    
    <span class="k">def</span> <span class="nf">merge</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë‹¤ë¥¸ HyperLogLogì™€ ë³‘í•©</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">!=</span> <span class="n">other</span><span class="p">.</span><span class="n">precision</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">Precision must be the same for merging</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">m</span><span class="p">):</span>
            <span class="n">self</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">other</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    
    <span class="k">def</span> <span class="nf">get_memory_usage</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë°˜í™˜ (ë°”ì´íŠ¸)</span><span class="sh">"""</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">m</span> <span class="o">*</span> <span class="mi">4</span>  <span class="c1"># ê° ë ˆì§€ìŠ¤í„°ëŠ” 4ë°”ì´íŠ¸
</span></code></pre></div></div>

<h3 id="ê³ ê¸‰-ìµœì í™”-ê¸°ë²•">ê³ ê¸‰ ìµœì í™” ê¸°ë²•</h3>

<h4 id="1-ë³‘ë ¬-ì²˜ë¦¬-ìµœì í™”">1. ë³‘ë ¬ ì²˜ë¦¬ ìµœì í™”</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">multiprocessing</span> <span class="k">as</span> <span class="n">mp</span>
<span class="kn">from</span> <span class="n">functools</span> <span class="kn">import</span> <span class="n">partial</span>

<span class="k">class</span> <span class="nc">ParallelHyperLogLog</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="n">self</span><span class="p">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="n">num_workers</span>
        <span class="n">self</span><span class="p">.</span><span class="n">workers</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># ì›Œì»¤ë³„ HyperLogLog ìƒì„±
</span>        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">num_workers</span><span class="p">):</span>
            <span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">precision</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">add_batch</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">elements</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°°ì¹˜ ì›ì†Œ ì¶”ê°€ (ë³‘ë ¬ ì²˜ë¦¬)</span><span class="sh">"""</span>
        <span class="n">chunk_size</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">elements</span><span class="p">)</span> <span class="o">//</span> <span class="n">self</span><span class="p">.</span><span class="n">num_workers</span>
        <span class="n">chunks</span> <span class="o">=</span> <span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="n">chunk_size</span><span class="p">]</span> 
                 <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nf">len</span><span class="p">(</span><span class="n">elements</span><span class="p">),</span> <span class="n">chunk_size</span><span class="p">)]</span>
        
        <span class="c1"># ë³‘ë ¬ ì²˜ë¦¬
</span>        <span class="k">with</span> <span class="n">mp</span><span class="p">.</span><span class="nc">Pool</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
            <span class="n">worker_func</span> <span class="o">=</span> <span class="nf">partial</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_worker_add_elements</span><span class="p">)</span>
            <span class="n">pool</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="n">worker_func</span><span class="p">,</span> <span class="nf">zip</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">,</span> <span class="n">chunks</span><span class="p">))</span>
    
    <span class="k">def</span> <span class="nf">_worker_add_elements</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">worker_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì›Œì»¤ë³„ ì›ì†Œ ì²˜ë¦¬</span><span class="sh">"""</span>
        <span class="n">worker</span><span class="p">,</span> <span class="n">elements</span> <span class="o">=</span> <span class="n">worker_data</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="n">worker</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">estimate</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë³‘í•© í›„ ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</span><span class="sh">"""</span>
        <span class="c1"># ëª¨ë“  ì›Œì»¤ ë³‘í•©
</span>        <span class="n">merged</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">worker</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">workers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">merged</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">worker</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">merged</span><span class="p">.</span><span class="nf">estimate</span><span class="p">()</span>
</code></pre></div></div>

<h4 id="2-ìŠ¤íŠ¸ë¦¬ë°-ìµœì í™”">2. ìŠ¤íŠ¸ë¦¬ë° ìµœì í™”</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">StreamingHyperLogLog</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">precision</span>
        <span class="n">self</span><span class="p">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="n">window_size</span>
        <span class="n">self</span><span class="p">.</span><span class="n">windows</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">current_time</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">add_with_timestamp</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íƒ€ì„ìŠ¤íƒ¬í”„ì™€ í•¨ê»˜ ì›ì†Œ ì¶”ê°€</span><span class="sh">"""</span>
        <span class="c1"># ì‹œê°„ ìœˆë„ìš° ê³„ì‚°
</span>        <span class="n">window_id</span> <span class="o">=</span> <span class="n">timestamp</span> <span class="o">//</span> <span class="n">self</span><span class="p">.</span><span class="n">window_size</span>
        
        <span class="c1"># ìƒˆ ìœˆë„ìš° ìƒì„±
</span>        <span class="k">if</span> <span class="n">window_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">[</span><span class="n">window_id</span><span class="p">]</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">precision</span><span class="p">)</span>
        
        <span class="c1"># ì›ì†Œ ì¶”ê°€
</span>        <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">[</span><span class="n">window_id</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
        
        <span class="c1"># ì˜¤ë˜ëœ ìœˆë„ìš° ì •ë¦¬
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">_cleanup_old_windows</span><span class="p">(</span><span class="n">window_id</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_cleanup_old_windows</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">current_window</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì˜¤ë˜ëœ ìœˆë„ìš° ì •ë¦¬</span><span class="sh">"""</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="n">current_window</span> <span class="o">-</span> <span class="mi">24</span>  <span class="c1"># 24ì‹œê°„ ë³´ê´€
</span>        <span class="n">old_windows</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">.</span><span class="nf">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">w</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">old_windows</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">[</span><span class="n">window</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">get_window_estimate</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">window_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">íŠ¹ì • ìœˆë„ìš°ì˜ ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</span><span class="sh">"""</span>
        <span class="k">if</span> <span class="n">window_id</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">[</span><span class="n">window_id</span><span class="p">].</span><span class="nf">estimate</span><span class="p">()</span>
        <span class="k">return</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">get_rolling_estimate</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¡¤ë§ ìœˆë„ìš° ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</span><span class="sh">"""</span>
        <span class="n">current_window</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">current_time</span> <span class="o">//</span> <span class="n">self</span><span class="p">.</span><span class="n">window_size</span>
        <span class="n">windows_to_merge</span> <span class="o">=</span> <span class="nf">range</span><span class="p">(</span><span class="n">current_window</span> <span class="o">-</span> <span class="n">hours</span><span class="p">,</span> <span class="n">current_window</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="n">merged</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">precision</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">window_id</span> <span class="ow">in</span> <span class="n">windows_to_merge</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">window_id</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">:</span>
                <span class="n">merged</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">windows</span><span class="p">[</span><span class="n">window_id</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="n">merged</span><span class="p">.</span><span class="nf">estimate</span><span class="p">()</span>
</code></pre></div></div>

<h2 id="ì„±ëŠ¥-ë²¤ì¹˜ë§ˆí¬ì™€-ë¶„ì„">ğŸ“Š ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ì™€ ë¶„ì„</h2>

<h3 id="ë²¤ì¹˜ë§ˆí¬-í™˜ê²½">ë²¤ì¹˜ë§ˆí¬ í™˜ê²½</h3>
<ul>
  <li><strong>CPU</strong>: Intel i7-10700K (8ì½”ì–´)</li>
  <li><strong>ë©”ëª¨ë¦¬</strong>: 32GB DDR4</li>
  <li><strong>ë°ì´í„°</strong>: 1ì–µ ~ 100ì–µ ë ˆì½”ë“œ</li>
  <li><strong>Python</strong>: 3.9.7</li>
</ul>

<h3 id="ì„±ëŠ¥-í…ŒìŠ¤íŠ¸-ê²°ê³¼">ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>

<h4 id="ì²˜ë¦¬-ì†ë„-ë¹„êµ">ì²˜ë¦¬ ì†ë„ ë¹„êµ</h4>

<table>
  <thead>
    <tr>
      <th>ë°ì´í„° í¬ê¸°</th>
      <th>COUNT DISTINCT</th>
      <th>Hash Set</th>
      <th>HyperLogLog</th>
      <th>ì†ë„ í–¥ìƒ</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>1ì–µ ë ˆì½”ë“œ</strong></td>
      <td>300ì´ˆ</td>
      <td>180ì´ˆ</td>
      <td>15ì´ˆ</td>
      <td><strong>20ë°°</strong></td>
    </tr>
    <tr>
      <td><strong>10ì–µ ë ˆì½”ë“œ</strong></td>
      <td>3,000ì´ˆ</td>
      <td>1,800ì´ˆ</td>
      <td>150ì´ˆ</td>
      <td><strong>20ë°°</strong></td>
    </tr>
    <tr>
      <td><strong>100ì–µ ë ˆì½”ë“œ</strong></td>
      <td>30,000ì´ˆ</td>
      <td>18,000ì´ˆ</td>
      <td>1,500ì´ˆ</td>
      <td><strong>20ë°°</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ë¹„êµ-1">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµ</h4>

<table>
  <thead>
    <tr>
      <th>ë°ì´í„° í¬ê¸°</th>
      <th>COUNT DISTINCT</th>
      <th>Hash Set</th>
      <th>HyperLogLog</th>
      <th>ë©”ëª¨ë¦¬ ì ˆì•½</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>1ì–µ ë ˆì½”ë“œ</strong></td>
      <td>8GB</td>
      <td>4GB</td>
      <td>64KB</td>
      <td><strong>99.99%</strong></td>
    </tr>
    <tr>
      <td><strong>10ì–µ ë ˆì½”ë“œ</strong></td>
      <td>80GB</td>
      <td>40GB</td>
      <td>64KB</td>
      <td><strong>99.99%</strong></td>
    </tr>
    <tr>
      <td><strong>100ì–µ ë ˆì½”ë“œ</strong></td>
      <td>800GB</td>
      <td>400GB</td>
      <td>64KB</td>
      <td><strong>99.99%</strong></td>
    </tr>
  </tbody>
</table>

<h4 id="ì •í™•ë„-ë¶„ì„">ì •í™•ë„ ë¶„ì„</h4>

<table>
  <thead>
    <tr>
      <th>ì‹¤ì œ ì¹´ë””ë„ë¦¬í‹°</th>
      <th>HyperLogLog ì¶”ì •ê°’</th>
      <th>ì˜¤ì°¨ìœ¨</th>
      <th>ì •í™•ë„</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>1,000</strong></td>
      <td>1,023</td>
      <td>2.3%</td>
      <td>97.7%</td>
    </tr>
    <tr>
      <td><strong>10,000</strong></td>
      <td>9,876</td>
      <td>1.2%</td>
      <td>98.8%</td>
    </tr>
    <tr>
      <td><strong>100,000</strong></td>
      <td>99,234</td>
      <td>0.8%</td>
      <td>99.2%</td>
    </tr>
    <tr>
      <td><strong>1,000,000</strong></td>
      <td>998,456</td>
      <td>0.2%</td>
      <td>99.8%</td>
    </tr>
    <tr>
      <td><strong>10,000,000</strong></td>
      <td>9,987,234</td>
      <td>0.1%</td>
      <td>99.9%</td>
    </tr>
  </tbody>
</table>

<h3 id="ì‹¤ì‹œê°„-ì²˜ë¦¬-ì„±ëŠ¥">ì‹¤ì‹œê°„ ì²˜ë¦¬ ì„±ëŠ¥</h3>

<h4 id="ìŠ¤íŠ¸ë¦¬ë°-ì²˜ë¦¬ëŸ‰">ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ëŸ‰</h4>

<table>
  <thead>
    <tr>
      <th>ì²˜ë¦¬ ë°©ì‹</th>
      <th>ì²˜ë¦¬ëŸ‰ (events/sec)</th>
      <th>ì§€ì—°ì‹œê°„ (ms)</th>
      <th>CPU ì‚¬ìš©ë¥ </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ë‹¨ì¼ ìŠ¤ë ˆë“œ</strong></td>
      <td>500,000</td>
      <td>2</td>
      <td>25%</td>
    </tr>
    <tr>
      <td><strong>ë³‘ë ¬ ì²˜ë¦¬ (4ì½”ì–´)</strong></td>
      <td>1,800,000</td>
      <td>1</td>
      <td>80%</td>
    </tr>
    <tr>
      <td><strong>ë³‘ë ¬ ì²˜ë¦¬ (8ì½”ì–´)</strong></td>
      <td>3,200,000</td>
      <td>0.5</td>
      <td>90%</td>
    </tr>
  </tbody>
</table>

<h4 id="ë©”ëª¨ë¦¬-íš¨ìœ¨ì„±">ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±</h4>

<table>
  <thead>
    <tr>
      <th>ì •ë°€ë„</th>
      <th>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</th>
      <th>ì •í™•ë„</th>
      <th>ì²˜ë¦¬ëŸ‰</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>10 bits</strong></td>
      <td>4KB</td>
      <td>95%</td>
      <td>4,000,000/sec</td>
    </tr>
    <tr>
      <td><strong>12 bits</strong></td>
      <td>16KB</td>
      <td>98%</td>
      <td>3,500,000/sec</td>
    </tr>
    <tr>
      <td><strong>14 bits</strong></td>
      <td>64KB</td>
      <td>99.9%</td>
      <td>3,000,000/sec</td>
    </tr>
    <tr>
      <td><strong>16 bits</strong></td>
      <td>256KB</td>
      <td>99.99%</td>
      <td>2,500,000/sec</td>
    </tr>
  </tbody>
</table>

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="ì´ë²ˆ-partì—ì„œ-í•™ìŠµí•œ-ë‚´ìš©">ì´ë²ˆ Partì—ì„œ í•™ìŠµí•œ ë‚´ìš©</h3>

<ol>
  <li><strong>ì¹´ë””ë„ë¦¬í‹° ì¶”ì •ì˜ í•„ìš”ì„±</strong>
    <ul>
      <li>ëŒ€ìš©ëŸ‰ ë°ì´í„°ì—ì„œ ê³ ìœ ê°’ ê°œìˆ˜ ê³„ì‚°ì˜ ì¤‘ìš”ì„±</li>
      <li>ì „í†µì ì¸ ë°©ë²•ì˜ í•œê³„ì™€ ë¹„ìš© ë¬¸ì œ</li>
      <li>ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤ ë¶„ì„</li>
    </ul>
  </li>
  <li><strong>HyperLogLog ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬</strong>
    <ul>
      <li>í•´ì‹œ í•¨ìˆ˜ì™€ Leading Zero Count ì›ë¦¬</li>
      <li>í†µê³„ì  ì¶”ì • ë°©ë²•</li>
      <li>ì •ë°€ë„ì™€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì˜ íŠ¸ë ˆì´ë“œì˜¤í”„</li>
    </ul>
  </li>
  <li><strong>ê¸°ì¡´ ë°©ë²•ê³¼ì˜ ë¹„êµ</strong>
    <ul>
      <li>ì •í™•ë„, ë©”ëª¨ë¦¬, ì†ë„, í™•ì¥ì„± ë¹„êµ</li>
      <li>ë¹„ìš© íš¨ìœ¨ì„± ë¶„ì„</li>
      <li>ì‹¤ì‹œê°„ ì²˜ë¦¬ ëŠ¥ë ¥ í‰ê°€</li>
    </ul>
  </li>
  <li><strong>ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</strong>
    <ul>
      <li>ì‹¤ì‹œê°„ ì›¹ ë¶„ì„</li>
      <li>ì „ììƒê±°ë˜ ë§ˆì¼€íŒ… ë¶„ì„</li>
      <li>ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ëª¨ë‹ˆí„°ë§</li>
    </ul>
  </li>
  <li><strong>êµ¬í˜„ê³¼ ìµœì í™”</strong>
    <ul>
      <li>ê¸°ë³¸ HyperLogLog êµ¬í˜„</li>
      <li>ë³‘ë ¬ ì²˜ë¦¬ ìµœì í™”</li>
      <li>ìŠ¤íŠ¸ë¦¬ë° ì²˜ë¦¬ ìµœì í™”</li>
    </ul>
  </li>
  <li><strong>ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬</strong>
    <ul>
      <li>ì²˜ë¦¬ ì†ë„ì™€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¶„ì„</li>
      <li>ì •í™•ë„ ê²€ì¦</li>
      <li>ì‹¤ì‹œê°„ ì²˜ë¦¬ ì„±ëŠ¥ í‰ê°€</li>
    </ul>
  </li>
</ol>

<h3 id="í•µì‹¬-ê¸°ìˆ -ìŠ¤íƒ">í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ</h3>

<table>
  <thead>
    <tr>
      <th>ê¸°ìˆ </th>
      <th>ì—­í• </th>
      <th>ì¤‘ìš”ë„</th>
      <th>í•™ìŠµ í¬ì¸íŠ¸</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>HyperLogLog</strong></td>
      <td>ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</td>
      <td>â­â­â­â­â­</td>
      <td>ì•Œê³ ë¦¬ì¦˜ ì›ë¦¬, ì •ë°€ë„ ì¡°ì •</td>
    </tr>
    <tr>
      <td><strong>í•´ì‹œ í•¨ìˆ˜</strong></td>
      <td>ë°ì´í„° ë³€í™˜</td>
      <td>â­â­â­â­</td>
      <td>í•´ì‹œ í’ˆì§ˆ, ì¶©ëŒ ì²˜ë¦¬</td>
    </tr>
    <tr>
      <td><strong>í†µê³„ì  ì¶”ì •</strong></td>
      <td>ìˆ˜í•™ì  ê¸°ë°˜</td>
      <td>â­â­â­â­</td>
      <td>ì¡°í™” í‰ê· , ë³´ì • ê³„ìˆ˜</td>
    </tr>
    <tr>
      <td><strong>ë³‘ë ¬ ì²˜ë¦¬</strong></td>
      <td>ì„±ëŠ¥ ìµœì í™”</td>
      <td>â­â­â­</td>
      <td>ë©€í‹°ì½”ì–´ í™œìš©, ì›Œì»¤ ë¶„í• </td>
    </tr>
    <tr>
      <td><strong>ìŠ¤íŠ¸ë¦¬ë°</strong></td>
      <td>ì‹¤ì‹œê°„ ì²˜ë¦¬</td>
      <td>â­â­â­â­â­</td>
      <td>ìœˆë„ìš° ê´€ë¦¬, ë©”ëª¨ë¦¬ íš¨ìœ¨ì„±</td>
    </tr>
  </tbody>
</table>

<h3 id="ë‹¤ìŒ-part-ë¯¸ë¦¬ë³´ê¸°">ë‹¤ìŒ Part ë¯¸ë¦¬ë³´ê¸°</h3>

<p><strong>Part 2: BI í”Œë«í¼ë³„ HyperLogLog êµ¬í˜„</strong>ì—ì„œëŠ”:</p>
<ul>
  <li>Spark Structured Streaming + HyperLogLog</li>
  <li>Apache Flink ì‹¤ì‹œê°„ ì¹´ë””ë„ë¦¬í‹° ì¶”ì •</li>
  <li>Presto/Trino ëŒ€í™”í˜• ë¶„ì„ì—ì„œ í™œìš©</li>
  <li>ClickHouse ë„¤ì´í‹°ë¸Œ HyperLogLog ì§€ì›</li>
</ul>

<hr />

<p><strong>ì‹œë¦¬ì¦ˆ ì§„í–‰</strong>: <a href="/bi-engineering/2025/09/24/hyperloglog-cardinality-estimation-basics.html">Modern BI Engineering Series</a></p>

<hr />

<p><em>ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ì¹´ë””ë„ë¦¬í‹°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì¶”ì •í•˜ëŠ” HyperLogLog ì•Œê³ ë¦¬ì¦˜ì„ ì™„ì „íˆ ì •ë³µí•˜ì„¸ìš”!</em> ğŸ“Šâœ¨</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
          
          
      
      
      
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/bi-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

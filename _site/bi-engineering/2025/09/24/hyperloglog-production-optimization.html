<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸">



<title>Part 2: HyperLogLog ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™” - í”„ë¡œë•ì…˜ê¸‰ BI ì‹œìŠ¤í…œ êµ¬ì¶• - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="Part 2: HyperLogLog ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™” - í”„ë¡œë•ì…˜ê¸‰ BI ì‹œìŠ¤í…œ êµ¬ì¶•">
<meta property="og:description" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸">
<meta property="og:url" content="http://localhost:4000/bi-engineering/2025/09/24/hyperloglog-production-optimization.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Part 2: HyperLogLog ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™” - í”„ë¡œë•ì…˜ê¸‰ BI ì‹œìŠ¤í…œ êµ¬ì¶•">
<meta name="twitter:description" content="ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/bi-engineering/2025/09/24/hyperloglog-production-optimization.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-24-hyperloglog-production-optimization.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Bi engineering</span>
      <span class="post-date">2025ë…„ 09ì›” 24ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">Part 2: HyperLogLog ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™” - í”„ë¡œë•ì…˜ê¸‰ BI ì‹œìŠ¤í…œ êµ¬ì¶•</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">HyperLogLog</span>
      
        <span class="tag">ì‹¤ë¬´ì ìš©</span>
      
        <span class="tag">ì„±ëŠ¥ìµœì í™”</span>
      
        <span class="tag">BIì‹œìŠ¤í…œ</span>
      
        <span class="tag">í”„ë¡œë•ì…˜</span>
      
        <span class="tag">ìŠ¤íŠ¸ë¦¬ë°</span>
      
        <span class="tag">ì‹¤ì‹œê°„ë¶„ì„</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Modern bi engineering ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 3</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 45ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ê³ ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="part-2-hyperloglog-ì‹¤ë¬´-ì ìš©ê³¼-ìµœì í™”---í”„ë¡œë•ì…˜ê¸‰-bi-ì‹œìŠ¤í…œ-êµ¬ì¶•">Part 2: HyperLogLog ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™” - í”„ë¡œë•ì…˜ê¸‰ BI ì‹œìŠ¤í…œ êµ¬ì¶•</h1>

<blockquote>
  <p>HyperLogLogë¥¼ ì‹¤ì œ í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œ ì ìš©í•˜ëŠ” ë°©ë²•ë¶€í„° ì„±ëŠ¥ ìµœì í™”, ëª¨ë‹ˆí„°ë§, ê·¸ë¦¬ê³  ëŒ€ê·œëª¨ BI ì‹œìŠ¤í…œ êµ¬ì¶•ê¹Œì§€ ì™„ì „í•œ ì‹¤ë¬´ ê°€ì´ë“œì…ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="ëª©ì°¨">ğŸ“‹ ëª©ì°¨</h2>

<ol>
  <li><a href="#ì‹¤ë¬´-ì ìš©-ì‹œë‚˜ë¦¬ì˜¤">ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</a></li>
  <li><a href="#ì„±ëŠ¥-ìµœì í™”-ì „ëµ">ì„±ëŠ¥ ìµœì í™” ì „ëµ</a></li>
  <li><a href="#ëª¨ë‹ˆí„°ë§ê³¼-í’ˆì§ˆ-ê´€ë¦¬">ëª¨ë‹ˆí„°ë§ê³¼ í’ˆì§ˆ ê´€ë¦¬</a></li>
  <li><a href="#ëŒ€ê·œëª¨-bi-ì‹œìŠ¤í…œ-êµ¬ì¶•">ëŒ€ê·œëª¨ BI ì‹œìŠ¤í…œ êµ¬ì¶•</a></li>
  <li><a href="#ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì‹¤ì‹œê°„-ë¶„ì„-í”Œë«í¼">ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì‹¤ì‹œê°„ ë¶„ì„ í”Œë«í¼</a></li>
  <li><a href="#í•™ìŠµ-ìš”ì•½">í•™ìŠµ ìš”ì•½</a></li>
</ol>

<hr />

<h2 id="ì‹¤ë¬´-ì ìš©-ì‹œë‚˜ë¦¬ì˜¤">ğŸ¯ ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</h2>

<h3 id="ì›¹-ë¶„ì„ì—ì„œì˜-hyperloglog-í™œìš©">ì›¹ ë¶„ì„ì—ì„œì˜ HyperLogLog í™œìš©</h3>

<p>ì›¹ ë¶„ì„ì€ HyperLogLogê°€ ê°€ì¥ íš¨ê³¼ì ìœ¼ë¡œ í™œìš©ë˜ëŠ” ë¶„ì•¼ ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤.</p>

<h4 id="ì‚¬ìš©ì-í–‰ë™-ë¶„ì„">ì‚¬ìš©ì í–‰ë™ ë¶„ì„</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">WebAnalyticsEngine</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">daily_unique_visitors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">page_view_analytics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">conversion_funnels</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">track_daily_visitors</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">visitor_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¼ë³„ ê³ ìœ  ë°©ë¬¸ì ì¶”ì </span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">date</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">daily_unique_visitors</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">daily_unique_visitors</span><span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">total_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">mobile_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">desktop_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">new_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">returning_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            <span class="p">}</span>
        
        <span class="n">hll</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">daily_unique_visitors</span><span class="p">[</span><span class="n">date</span><span class="p">]</span>
        
        <span class="c1"># ì „ì²´ ë°©ë¬¸ì
</span>        <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">total_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="c1"># ë””ë°”ì´ìŠ¤ë³„ ë¶„ë¥˜
</span>        <span class="k">if</span> <span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">device_type</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">mobile</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">mobile_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">desktop_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="c1"># ì‹ ê·œ/ì¬ë°©ë¬¸ ë¶„ë¥˜
</span>        <span class="k">if</span> <span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">is_new_visitor</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">new_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">returning_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">date</span><span class="sh">'</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">total_unique_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">total_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">mobile_unique_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">mobile_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">desktop_unique_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">desktop_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">new_unique_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">new_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">returning_unique_visitors</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll</span><span class="p">[</span><span class="sh">'</span><span class="s">returning_visitors</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">analyze_user_journey</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">user_events</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‚¬ìš©ì ì—¬ì • ë¶„ì„</span><span class="sh">"""</span>
        
        <span class="n">journey_analysis</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">funnel_steps</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">landing</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">product_view</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">add_to_cart</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">checkout</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">purchase</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">conversion_rates</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">drop_off_analysis</span><span class="sh">'</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
        
        <span class="c1"># ê° ë‹¨ê³„ë³„ ê³ ìœ  ì‚¬ìš©ì ìˆ˜ì§‘
</span>        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">user_events</span><span class="p">:</span>
            <span class="n">user_id</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">]</span>
            <span class="n">event_type</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="sh">'</span><span class="s">event_type</span><span class="sh">'</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="n">event_type</span> <span class="ow">in</span> <span class="n">journey_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">funnel_steps</span><span class="sh">'</span><span class="p">]:</span>
                <span class="n">journey_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">funnel_steps</span><span class="sh">'</span><span class="p">][</span><span class="n">event_type</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span>
        
        <span class="c1"># ì „í™˜ìœ¨ ê³„ì‚°
</span>        <span class="n">steps</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">landing</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">product_view</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">add_to_cart</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">checkout</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">purchase</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">previous_count</span> <span class="o">=</span> <span class="bp">None</span>
        
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
            <span class="n">current_count</span> <span class="o">=</span> <span class="n">journey_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">funnel_steps</span><span class="sh">'</span><span class="p">][</span><span class="n">step</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
            
            <span class="k">if</span> <span class="n">previous_count</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">conversion_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">current_count</span> <span class="o">/</span> <span class="n">previous_count</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="n">journey_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">conversion_rates</span><span class="sh">'</span><span class="p">][</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">previous_step</span><span class="si">}</span><span class="s">_to_</span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">conversion_rate</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">users</span><span class="sh">'</span><span class="p">:</span> <span class="n">current_count</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">previous_users</span><span class="sh">'</span><span class="p">:</span> <span class="n">previous_count</span>
                <span class="p">}</span>
            
            <span class="n">previous_count</span> <span class="o">=</span> <span class="n">current_count</span>
            <span class="n">previous_step</span> <span class="o">=</span> <span class="n">step</span>
        
        <span class="k">return</span> <span class="n">journey_analysis</span>
</code></pre></div></div>

<h4 id="ì‹¤ì‹œê°„-ëŒ€ì‹œë³´ë“œ-êµ¬í˜„">ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ êµ¬í˜„</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RealTimeDashboard</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">metrics_store</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">update_interval</span> <span class="o">=</span> <span class="mi">60</span>  <span class="c1"># 60ì´ˆë§ˆë‹¤ ì—…ë°ì´íŠ¸
</span>    
    <span class="k">def</span> <span class="nf">generate_realtime_metrics</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹¤ì‹œê°„ ë©”íŠ¸ë¦­ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">current_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
        <span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">current_time</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">unique_visitors_1h</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_unique_visitors</span><span class="p">(</span><span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">unique_visitors_24h</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_unique_visitors</span><span class="p">(</span><span class="sh">'</span><span class="s">24h</span><span class="sh">'</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">page_views_1h</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_page_views</span><span class="p">(</span><span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">conversion_rate_24h</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_conversion_rate</span><span class="p">(</span><span class="sh">'</span><span class="s">24h</span><span class="sh">'</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">top_pages</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_top_pages</span><span class="p">(</span><span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">device_breakdown</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_device_breakdown</span><span class="p">(</span><span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">metrics</span>
    
    <span class="k">def</span> <span class="nf">_calculate_unique_visitors</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">time_window</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹œê°„ ìœˆë„ìš°ë³„ ê³ ìœ  ë°©ë¬¸ì ê³„ì‚°</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">time_window</span> <span class="o">==</span> <span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># ì§€ë‚œ 1ì‹œê°„ ë°ì´í„°
</span>            <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
            
            <span class="c1"># 1ì‹œê°„ ë‚´ ë°©ë¬¸ì ë°ì´í„° ìˆ˜ì§‘
</span>            <span class="k">for</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">visitor_data</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_visitor_data_since</span><span class="p">(</span><span class="n">cutoff_time</span><span class="p">):</span>
                <span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
            
            <span class="k">return</span> <span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">()</span>
        
        <span class="k">elif</span> <span class="n">time_window</span> <span class="o">==</span> <span class="sh">'</span><span class="s">24h</span><span class="sh">'</span><span class="p">:</span>
            <span class="c1"># ì§€ë‚œ 24ì‹œê°„ ë°ì´í„°
</span>            <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
            <span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># ë” í° ì •ë°€ë„
</span>            
            <span class="k">for</span> <span class="n">timestamp</span><span class="p">,</span> <span class="n">visitor_data</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_visitor_data_since</span><span class="p">(</span><span class="n">cutoff_time</span><span class="p">):</span>
                <span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">visitor_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
            
            <span class="k">return</span> <span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">()</span>
</code></pre></div></div>

<h3 id="ë§ˆì¼€íŒ…-ë¶„ì„ì—ì„œì˜-í™œìš©">ë§ˆì¼€íŒ… ë¶„ì„ì—ì„œì˜ í™œìš©</h3>

<h4 id="ìº í˜ì¸-íš¨ê³¼-ì¸¡ì •">ìº í˜ì¸ íš¨ê³¼ ì¸¡ì •</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">MarketingCampaignAnalyzer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">campaign_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">attribution_models</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">track_campaign_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">campaign_data</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìº í˜ì¸ ì„±ê³¼ ì¶”ì </span><span class="sh">"""</span>
        
        <span class="n">campaign_id</span> <span class="o">=</span> <span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">campaign_id</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">campaign_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_metrics</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">campaign_metrics</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">impressions</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">clicks</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">conversions</span><span class="sh">'</span><span class="p">:</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">revenue</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span>
            <span class="p">}</span>
        
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_metrics</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">]</span>
        
        <span class="c1"># ë…¸ì¶œ ìˆ˜ (ì¤‘ë³µ ì œê±°)
</span>        <span class="k">if</span> <span class="sh">'</span><span class="s">impression</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">event_type</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">impressions</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="c1"># í´ë¦­ ìˆ˜
</span>        <span class="k">if</span> <span class="sh">'</span><span class="s">click</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">event_type</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">clicks</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="c1"># ì „í™˜ ìˆ˜
</span>        <span class="k">if</span> <span class="sh">'</span><span class="s">conversion</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">event_type</span><span class="sh">'</span><span class="p">]:</span>
            <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">conversions</span><span class="sh">'</span><span class="p">].</span><span class="nf">add</span><span class="p">(</span><span class="n">campaign_data</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
            <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">revenue</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="n">campaign_data</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">revenue</span><span class="sh">'</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        
        <span class="c1"># ì„±ê³¼ ì§€í‘œ ê³„ì‚°
</span>        <span class="n">performance</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_campaign_performance</span><span class="p">(</span><span class="n">campaign_id</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">performance</span>
    
    <span class="k">def</span> <span class="nf">_calculate_campaign_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">campaign_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìº í˜ì¸ ì„±ê³¼ ì§€í‘œ ê³„ì‚°</span><span class="sh">"""</span>
        
        <span class="n">metrics</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">campaign_metrics</span><span class="p">[</span><span class="n">campaign_id</span><span class="p">]</span>
        
        <span class="n">unique_impressions</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">impressions</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
        <span class="n">unique_clicks</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">clicks</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
        <span class="n">unique_conversions</span> <span class="o">=</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">conversions</span><span class="sh">'</span><span class="p">].</span><span class="nf">count</span><span class="p">()</span>
        
        <span class="n">performance</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">campaign_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">campaign_id</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">unique_impressions</span><span class="sh">'</span><span class="p">:</span> <span class="n">unique_impressions</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">unique_clicks</span><span class="sh">'</span><span class="p">:</span> <span class="n">unique_clicks</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">unique_conversions</span><span class="sh">'</span><span class="p">:</span> <span class="n">unique_conversions</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">ctr</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="n">unique_clicks</span> <span class="o">/</span> <span class="n">unique_impressions</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">unique_impressions</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">conversion_rate</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="n">unique_conversions</span> <span class="o">/</span> <span class="n">unique_clicks</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">unique_clicks</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">cpc</span><span class="sh">'</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">unique_clicks</span> <span class="k">if</span> <span class="n">unique_clicks</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">cpa</span><span class="sh">'</span><span class="p">:</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">unique_conversions</span> <span class="k">if</span> <span class="n">unique_conversions</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">roi</span><span class="sh">'</span><span class="p">:</span> <span class="p">(</span><span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">revenue</span><span class="sh">'</span><span class="p">]</span> <span class="o">-</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">])</span> <span class="o">/</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">cost</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">performance</span>
</code></pre></div></div>

<hr />

<h2 id="ì„±ëŠ¥-ìµœì í™”-ì „ëµ">âš¡ ì„±ëŠ¥ ìµœì í™” ì „ëµ</h2>

<h3 id="ì„±ëŠ¥-ìµœì í™”-ì „ëµ-ë¹„êµ">ì„±ëŠ¥ ìµœì í™” ì „ëµ ë¹„êµ</h3>

<table>
  <thead>
    <tr>
      <th>ìµœì í™” ì˜ì—­</th>
      <th>ì „ëµ</th>
      <th>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰</th>
      <th>ì •í™•ë„</th>
      <th>ë³µì¡ë„</th>
      <th>ì ìš© ì‹œì </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì •ë°€ë„ ì¡°ì •</strong></td>
      <td>ì ì‘ì  ì •ë°€ë„</td>
      <td>ë‚®ìŒ â†’ ë†’ìŒ</td>
      <td>ë†’ìŒ â†’ ë§¤ìš° ë†’ìŒ</td>
      <td>ì¤‘ê°„</td>
      <td>ëŸ°íƒ€ì„</td>
    </tr>
    <tr>
      <td><strong>ì••ì¶• ì €ì¥</strong></td>
      <td>gzip/lz4/zstd</td>
      <td>ë§¤ìš° ë‚®ìŒ</td>
      <td>ë™ì¼</td>
      <td>ë‚®ìŒ</td>
      <td>ì €ì¥ ì‹œ</td>
    </tr>
    <tr>
      <td><strong>ë³‘ë ¬ ì²˜ë¦¬</strong></td>
      <td>ë¶„ì‚° HLL ë³‘í•©</td>
      <td>ë†’ìŒ</td>
      <td>ë™ì¼</td>
      <td>ë†’ìŒ</td>
      <td>ì²˜ë¦¬ ì‹œ</td>
    </tr>
    <tr>
      <td><strong>ìºì‹±</strong></td>
      <td>ë©”ëª¨ë¦¬/Redis</td>
      <td>ì¤‘ê°„</td>
      <td>ë™ì¼</td>
      <td>ì¤‘ê°„</td>
      <td>ì¡°íšŒ ì‹œ</td>
    </tr>
  </tbody>
</table>

<h3 id="ë©”ëª¨ë¦¬-ì‚¬ìš©ëŸ‰-ìµœì í™”">ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”</h3>

<h4 id="ì ì‘ì -ì •ë°€ë„-ì¡°ì •">ì ì‘ì  ì •ë°€ë„ ì¡°ì •</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">AdaptivePrecisionHLL</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">initial_precision</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">initial_precision</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">initial_precision</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cardinality_threshold</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">initial_precision</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">self</span><span class="p">.</span><span class="n">max_precision</span> <span class="o">=</span> <span class="mi">16</span>
    
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê°’ ì¶”ê°€ ì‹œ ì •ë°€ë„ ìë™ ì¡°ì •</span><span class="sh">"""</span>
        
        <span class="n">current_count</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">()</span>
        
        <span class="c1"># ì¹´ë””ë„ë¦¬í‹°ê°€ ì„ê³„ê°’ì„ ì´ˆê³¼í•˜ë©´ ì •ë°€ë„ ì¦ê°€
</span>        <span class="k">if</span> <span class="n">current_count</span> <span class="o">&gt;</span> <span class="n">self</span><span class="p">.</span><span class="n">cardinality_threshold</span> <span class="ow">and</span> <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">&lt;</span> <span class="n">self</span><span class="p">.</span><span class="n">max_precision</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">_increase_precision</span><span class="p">()</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_increase_precision</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì •ë°€ë„ ì¦ê°€ ë° ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜</span><span class="sh">"""</span>
        
        <span class="n">old_precision</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">precision</span>
        <span class="n">new_precision</span> <span class="o">=</span> <span class="nf">min</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">max_precision</span><span class="p">)</span>
        
        <span class="c1"># ìƒˆë¡œìš´ HLL ìƒì„±
</span>        <span class="n">new_hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">new_precision</span><span class="p">)</span>
        
        <span class="c1"># ê¸°ì¡´ ë ˆì§€ìŠ¤í„° ê°’ë“¤ì„ ìƒˆë¡œìš´ HLLë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
</span>        <span class="k">for</span> <span class="n">register_value</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">hll</span><span class="p">.</span><span class="n">registers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">register_value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># ë ˆì§€ìŠ¤í„° ê°’ì„ ìƒˆë¡œìš´ ì •ë°€ë„ë¡œ ë³€í™˜
</span>                <span class="n">new_hll</span><span class="p">.</span><span class="n">registers</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">register_value</span><span class="p">)</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">hll</span> <span class="o">=</span> <span class="n">new_hll</span>
        <span class="n">self</span><span class="p">.</span><span class="n">precision</span> <span class="o">=</span> <span class="n">new_precision</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cardinality_threshold</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">new_precision</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Precision increased from </span><span class="si">{</span><span class="n">old_precision</span><span class="si">}</span><span class="s"> to </span><span class="si">{</span><span class="n">new_precision</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div>

<h4 id="ì••ì¶•-ê¸°ë°˜-ì €ì¥">ì••ì¶• ê¸°ë°˜ ì €ì¥</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">CompressedHLLStorage</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">compression_algorithms</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">gzip</span><span class="sh">'</span><span class="p">:</span> <span class="n">gzip</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">lz4</span><span class="sh">'</span><span class="p">:</span> <span class="n">lz4</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">zstd</span><span class="sh">'</span><span class="p">:</span> <span class="n">zstd</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">compress_hll_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hll_data</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="sh">'</span><span class="s">zstd</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ë°ì´í„° ì••ì¶•</span><span class="sh">"""</span>
        
        <span class="c1"># HLL ë ˆì§€ìŠ¤í„° ë°ì´í„° ì§ë ¬í™”
</span>        <span class="n">serialized_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">hll_data</span><span class="p">)</span>
        
        <span class="c1"># ì••ì¶• ì ìš©
</span>        <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="sh">'</span><span class="s">gzip</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">compressed_data</span> <span class="o">=</span> <span class="n">gzip</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">serialized_data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="sh">'</span><span class="s">lz4</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">compressed_data</span> <span class="o">=</span> <span class="n">lz4</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">serialized_data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="sh">'</span><span class="s">zstd</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">compressed_data</span> <span class="o">=</span> <span class="n">zstd</span><span class="p">.</span><span class="nf">compress</span><span class="p">(</span><span class="n">serialized_data</span><span class="p">)</span>
        
        <span class="n">compression_ratio</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">compressed_data</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">serialized_data</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">compressed_data</span><span class="sh">'</span><span class="p">:</span> <span class="n">compressed_data</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">algorithm</span><span class="sh">'</span><span class="p">:</span> <span class="n">algorithm</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">compression_ratio</span><span class="sh">'</span><span class="p">:</span> <span class="n">compression_ratio</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">original_size</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">serialized_data</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">compressed_size</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">compressed_data</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">decompress_hll_data</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">compressed_info</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ë°ì´í„° ì••ì¶• í•´ì œ</span><span class="sh">"""</span>
        
        <span class="n">compressed_data</span> <span class="o">=</span> <span class="n">compressed_info</span><span class="p">[</span><span class="sh">'</span><span class="s">compressed_data</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">algorithm</span> <span class="o">=</span> <span class="n">compressed_info</span><span class="p">[</span><span class="sh">'</span><span class="s">algorithm</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="c1"># ì••ì¶• í•´ì œ
</span>        <span class="k">if</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="sh">'</span><span class="s">gzip</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">serialized_data</span> <span class="o">=</span> <span class="n">gzip</span><span class="p">.</span><span class="nf">decompress</span><span class="p">(</span><span class="n">compressed_data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="sh">'</span><span class="s">lz4</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">serialized_data</span> <span class="o">=</span> <span class="n">lz4</span><span class="p">.</span><span class="nf">decompress</span><span class="p">(</span><span class="n">compressed_data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">algorithm</span> <span class="o">==</span> <span class="sh">'</span><span class="s">zstd</span><span class="sh">'</span><span class="p">:</span>
            <span class="n">serialized_data</span> <span class="o">=</span> <span class="n">zstd</span><span class="p">.</span><span class="nf">decompress</span><span class="p">(</span><span class="n">compressed_data</span><span class="p">)</span>
        
        <span class="c1"># HLL ê°ì²´ ë³µì›
</span>        <span class="n">hll_data</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">serialized_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">hll_data</span>
</code></pre></div></div>

<h3 id="ë³‘ë ¬-ì²˜ë¦¬-ìµœì í™”">ë³‘ë ¬ ì²˜ë¦¬ ìµœì í™”</h3>

<h4 id="ë¶„ì‚°-hll-ë³‘í•©">ë¶„ì‚° HLL ë³‘í•©</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DistributedHLLProcessor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">4</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">num_workers</span> <span class="o">=</span> <span class="n">num_workers</span>
        <span class="n">self</span><span class="p">.</span><span class="n">worker_pools</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">process_large_dataset</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëŒ€ìš©ëŸ‰ ë°ì´í„°ì…‹ ë³‘ë ¬ ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="c1"># ë°ì´í„° ì²­í¬ ë¶„í• 
</span>        <span class="n">chunks</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_split_data_into_chunks</span><span class="p">(</span><span class="n">data_stream</span><span class="p">,</span> <span class="n">chunk_size</span><span class="p">)</span>
        
        <span class="c1"># ë³‘ë ¬ ì²˜ë¦¬
</span>        <span class="k">with</span> <span class="nc">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">num_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
            <span class="n">futures</span> <span class="o">=</span> <span class="p">[]</span>
            
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">chunks</span><span class="p">):</span>
                <span class="n">future</span> <span class="o">=</span> <span class="n">executor</span><span class="p">.</span><span class="nf">submit</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_process_chunk</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
                <span class="n">futures</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">future</span><span class="p">)</span>
            
            <span class="c1"># ê²°ê³¼ ìˆ˜ì§‘
</span>            <span class="n">chunk_results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="nf">as_completed</span><span class="p">(</span><span class="n">futures</span><span class="p">):</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">future</span><span class="p">.</span><span class="nf">result</span><span class="p">()</span>
                <span class="n">chunk_results</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        
        <span class="c1"># HLL ë³‘í•©
</span>        <span class="n">final_hll</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_merge_hll_results</span><span class="p">(</span><span class="n">chunk_results</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">final_hll</span>
    
    <span class="k">def</span> <span class="nf">_process_chunk</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">chunk</span><span class="p">,</span> <span class="n">chunk_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ê°œë³„ ì²­í¬ ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">chunk</span><span class="p">:</span>
            <span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">chunk_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">chunk_id</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">processed_count</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">_merge_hll_results</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">chunk_results</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ê²°ê³¼ ë³‘í•©</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">chunk_results</span><span class="p">:</span>
            <span class="k">return</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
        
        <span class="c1"># ì²« ë²ˆì§¸ HLLì„ ê¸°ì¤€ìœ¼ë¡œ ë³‘í•©
</span>        <span class="n">merged_hll</span> <span class="o">=</span> <span class="n">chunk_results</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">chunk_results</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">merged_hll</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_union_hll</span><span class="p">(</span><span class="n">merged_hll</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="sh">'</span><span class="s">hll</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="n">merged_hll</span>
    
    <span class="k">def</span> <span class="nf">_union_hll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hll1</span><span class="p">,</span> <span class="n">hll2</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë‘ HLLì˜ í•©ì§‘í•© ê³„ì‚°</span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">hll1</span><span class="p">.</span><span class="n">precision</span> <span class="o">!=</span> <span class="n">hll2</span><span class="p">.</span><span class="n">precision</span><span class="p">:</span>
            <span class="k">raise</span> <span class="nc">ValueError</span><span class="p">(</span><span class="sh">"</span><span class="s">HLL precision mismatch</span><span class="sh">"</span><span class="p">)</span>
        
        <span class="n">union_hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="n">hll1</span><span class="p">.</span><span class="n">precision</span><span class="p">)</span>
        
        <span class="c1"># ë ˆì§€ìŠ¤í„°ë³„ ìµœëŒ€ê°’ ì„ íƒ
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">hll1</span><span class="p">.</span><span class="n">registers</span><span class="p">)):</span>
            <span class="n">union_hll</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">hll1</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">hll2</span><span class="p">.</span><span class="n">registers</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="n">union_hll</span>
</code></pre></div></div>

<hr />

<h2 id="ëª¨ë‹ˆí„°ë§ê³¼-í’ˆì§ˆ-ê´€ë¦¬">ğŸ“Š ëª¨ë‹ˆí„°ë§ê³¼ í’ˆì§ˆ ê´€ë¦¬</h2>

<h3 id="ëª¨ë‹ˆí„°ë§-ë©”íŠ¸ë¦­-ì²´ê³„">ëª¨ë‹ˆí„°ë§ ë©”íŠ¸ë¦­ ì²´ê³„</h3>

<table>
  <thead>
    <tr>
      <th>ëª¨ë‹ˆí„°ë§ ì˜ì—­</th>
      <th>í•µì‹¬ ë©”íŠ¸ë¦­</th>
      <th>ì„ê³„ê°’</th>
      <th>ì•Œë¦¼ ë ˆë²¨</th>
      <th>ëŒ€ì‘ ì¡°ì¹˜</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì •í™•ë„</strong></td>
      <td>ì˜¤ì°¨ìœ¨</td>
      <td>5% (ê²½ê³ ), 10% (ìœ„í—˜)</td>
      <td>WARNING/CRITICAL</td>
      <td>ì •ë°€ë„ ì¡°ì •</td>
    </tr>
    <tr>
      <td><strong>ì„±ëŠ¥</strong></td>
      <td>ì§€ì—°ì‹œê°„</td>
      <td>100ms</td>
      <td>WARNING</td>
      <td>ë³‘ë ¬ ì²˜ë¦¬ ë„ì…</td>
    </tr>
    <tr>
      <td><strong>ì²˜ë¦¬ëŸ‰</strong></td>
      <td>TPS</td>
      <td>1000 req/s</td>
      <td>WARNING</td>
      <td>ìŠ¤ì¼€ì¼ë§</td>
    </tr>
    <tr>
      <td><strong>ë©”ëª¨ë¦¬</strong></td>
      <td>ì‚¬ìš©ë¥ </td>
      <td>80%</td>
      <td>WARNING</td>
      <td>ì••ì¶•/ìºì‹œ ì •ë¦¬</td>
    </tr>
    <tr>
      <td><strong>CPU</strong></td>
      <td>ì‚¬ìš©ë¥ </td>
      <td>85%</td>
      <td>WARNING</td>
      <td>ìµœì í™”</td>
    </tr>
  </tbody>
</table>

<h3 id="ì•Œë¦¼-ê·œì¹™-ì„¤ì •">ì•Œë¦¼ ê·œì¹™ ì„¤ì •</h3>

<table>
  <thead>
    <tr>
      <th>ê·œì¹™ ì´ë¦„</th>
      <th>ì¡°ê±´</th>
      <th>ì‹¬ê°ë„</th>
      <th>ì•Œë¦¼ ì±„ë„</th>
      <th>ìë™ ëŒ€ì‘</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì •í™•ë„ ì €í•˜</strong></td>
      <td>error_rate &gt; 5%</td>
      <td>WARNING</td>
      <td>Slack/Email</td>
      <td>-</td>
    </tr>
    <tr>
      <td><strong>ì •í™•ë„ ê¸‰ê²© ì €í•˜</strong></td>
      <td>error_rate &gt; 10%</td>
      <td>CRITICAL</td>
      <td>PagerDuty</td>
      <td>ì •ë°€ë„ ìë™ ì¦ê°€</td>
    </tr>
    <tr>
      <td><strong>ì„±ëŠ¥ ì €í•˜</strong></td>
      <td>latency &gt; 100ms</td>
      <td>WARNING</td>
      <td>Slack</td>
      <td>-</td>
    </tr>
    <tr>
      <td><strong>ë©”ëª¨ë¦¬ ë¶€ì¡±</strong></td>
      <td>memory_usage &gt; 80%</td>
      <td>WARNING</td>
      <td>Email</td>
      <td>ìºì‹œ ì •ë¦¬</td>
    </tr>
    <tr>
      <td><strong>ì„œë¹„ìŠ¤ ì¤‘ë‹¨</strong></td>
      <td>health_check = FAIL</td>
      <td>CRITICAL</td>
      <td>PagerDuty</td>
      <td>ìë™ ì¬ì‹œì‘</td>
    </tr>
  </tbody>
</table>

<h3 id="ì •í™•ë„-ëª¨ë‹ˆí„°ë§">ì •í™•ë„ ëª¨ë‹ˆí„°ë§</h3>

<h4 id="ì˜¤ì°¨ìœ¨-ì¶”ì -ì‹œìŠ¤í…œ">ì˜¤ì°¨ìœ¨ ì¶”ì  ì‹œìŠ¤í…œ</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HLLAccuracyMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">accuracy_metrics</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">baseline_counts</span> <span class="o">=</span> <span class="p">{}</span>
    
    <span class="k">def</span> <span class="nf">track_accuracy</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hll_result</span><span class="p">,</span> <span class="n">exact_count</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ì •í™•ë„ ì¶”ì </span><span class="sh">"""</span>
        
        <span class="k">if</span> <span class="n">exact_count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        
        <span class="n">error_rate</span> <span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">hll_result</span> <span class="o">-</span> <span class="n">exact_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_count</span>
        <span class="n">relative_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">hll_result</span> <span class="o">-</span> <span class="n">exact_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">exact_count</span>
        
        <span class="n">accuracy_record</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">hll_count</span><span class="sh">'</span><span class="p">:</span> <span class="n">hll_result</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">exact_count</span><span class="sh">'</span><span class="p">:</span> <span class="n">exact_count</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">error_rate</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">relative_error</span><span class="sh">'</span><span class="p">:</span> <span class="n">relative_error</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">context</span><span class="sh">'</span><span class="p">:</span> <span class="n">context</span>
        <span class="p">}</span>
        
        <span class="c1"># ì»¨í…ìŠ¤íŠ¸ë³„ ì •í™•ë„ ì¶”ì 
</span>        <span class="k">if</span> <span class="n">context</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">accuracy_metrics</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">accuracy_metrics</span><span class="p">[</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">accuracy_metrics</span><span class="p">[</span><span class="n">context</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">accuracy_record</span><span class="p">)</span>
        
        <span class="c1"># ì•Œë¦¼ ì¡°ê±´ í™•ì¸
</span>        <span class="n">self</span><span class="p">.</span><span class="nf">_check_accuracy_alerts</span><span class="p">(</span><span class="n">accuracy_record</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">accuracy_record</span>
    
    <span class="k">def</span> <span class="nf">_check_accuracy_alerts</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì •í™•ë„ ì•Œë¦¼ ì¡°ê±´ í™•ì¸</span><span class="sh">"""</span>
        
        <span class="n">error_rate</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="c1"># ì˜¤ì°¨ìœ¨ì´ ì„ê³„ê°’ì„ ì´ˆê³¼í•˜ë©´ ì•Œë¦¼
</span>        <span class="k">if</span> <span class="n">error_rate</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>  <span class="c1"># 5% ì˜¤ì°¨
</span>            <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">level</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">WARNING</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">HLL accuracy degraded in </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">error_rate</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">_send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
        
        <span class="k">elif</span> <span class="n">error_rate</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>  <span class="c1"># 10% ì˜¤ì°¨
</span>            <span class="n">alert</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">level</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">CRITICAL</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">"</span><span class="s">HLL accuracy critically low in </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">error_rate</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
            <span class="n">self</span><span class="p">.</span><span class="nf">_send_alert</span><span class="p">(</span><span class="n">alert</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">generate_accuracy_report</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="sh">'</span><span class="s">24h</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì •í™•ë„ ë¦¬í¬íŠ¸ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span> <span class="k">if</span> <span class="n">time_window</span> <span class="o">==</span> <span class="sh">'</span><span class="s">24h</span><span class="sh">'</span> <span class="k">else</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        
        <span class="n">report</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">time_window</span><span class="sh">'</span><span class="p">:</span> <span class="n">time_window</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">overall_accuracy</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">context_breakdown</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">recommendations</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">context</span><span class="p">,</span> <span class="n">records</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">accuracy_metrics</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="c1"># ì‹œê°„ ìœˆë„ìš° ë‚´ ë ˆì½”ë“œ í•„í„°ë§
</span>            <span class="n">recent_records</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">]</span>
            
            <span class="k">if</span> <span class="ow">not</span> <span class="n">recent_records</span><span class="p">:</span>
                <span class="k">continue</span>
            
            <span class="c1"># í‰ê·  ì˜¤ì°¨ìœ¨ ê³„ì‚°
</span>            <span class="n">avg_error_rate</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recent_records</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">recent_records</span><span class="p">)</span>
            <span class="n">max_error_rate</span> <span class="o">=</span> <span class="nf">max</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recent_records</span><span class="p">)</span>
            
            <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">context_breakdown</span><span class="sh">'</span><span class="p">][</span><span class="n">context</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">avg_error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">avg_error_rate</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">max_error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">max_error_rate</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">sample_count</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">recent_records</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">accuracy_score</span><span class="sh">'</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="p">(</span><span class="n">avg_error_rate</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
            <span class="p">}</span>
        
        <span class="c1"># ì „ì²´ ì •í™•ë„ ê³„ì‚°
</span>        <span class="n">all_records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">records</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">accuracy_metrics</span><span class="p">.</span><span class="nf">values</span><span class="p">():</span>
            <span class="n">all_records</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">all_records</span><span class="p">:</span>
            <span class="n">overall_avg_error</span> <span class="o">=</span> <span class="nf">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">error_rate</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">all_records</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">all_records</span><span class="p">)</span>
            <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">overall_accuracy</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">avg_error_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">overall_avg_error</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">accuracy_score</span><span class="sh">'</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span> <span class="o">-</span> <span class="p">(</span><span class="n">overall_avg_error</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)),</span>
                <span class="sh">'</span><span class="s">total_samples</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">all_records</span><span class="p">)</span>
            <span class="p">}</span>
        
        <span class="c1"># ê¶Œì¥ì‚¬í•­ ìƒì„±
</span>        <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">recommendations</span><span class="sh">'</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_recommendations</span><span class="p">(</span><span class="n">report</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">report</span>
    
    <span class="k">def</span> <span class="nf">_generate_recommendations</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">report</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì •í™•ë„ ê°œì„  ê¶Œì¥ì‚¬í•­ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">recommendations</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">context</span><span class="p">,</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">report</span><span class="p">[</span><span class="sh">'</span><span class="s">context_breakdown</span><span class="sh">'</span><span class="p">].</span><span class="nf">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">avg_error_rate</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
                <span class="n">recommendations</span><span class="p">.</span><span class="nf">append</span><span class="p">({</span>
                    <span class="sh">'</span><span class="s">context</span><span class="sh">'</span><span class="p">:</span> <span class="n">context</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">issue</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">High error rate detected</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">recommendation</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Consider increasing HLL precision for </span><span class="si">{</span><span class="n">context</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">priority</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">HIGH</span><span class="sh">'</span> <span class="k">if</span> <span class="n">metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">avg_error_rate</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.1</span> <span class="k">else</span> <span class="sh">'</span><span class="s">MEDIUM</span><span class="sh">'</span>
                <span class="p">})</span>
        
        <span class="k">return</span> <span class="n">recommendations</span>
</code></pre></div></div>

<h3 id="ì„±ëŠ¥-ëª¨ë‹ˆí„°ë§">ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§</h3>

<h4 id="ì²˜ë¦¬ëŸ‰-ë°-ì§€ì—°ì‹œê°„-ì¶”ì ">ì²˜ë¦¬ëŸ‰ ë° ì§€ì—°ì‹œê°„ ì¶”ì </h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HLLPerformanceMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">performance_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">throughput</span><span class="sh">'</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">'</span><span class="s">latency</span><span class="sh">'</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">'</span><span class="s">memory_usage</span><span class="sh">'</span><span class="p">:</span> <span class="p">[],</span>
            <span class="sh">'</span><span class="s">cpu_usage</span><span class="sh">'</span><span class="p">:</span> <span class="p">[]</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">track_operation_performance</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">operation_type</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> <span class="n">memory_usage</span><span class="p">,</span> <span class="n">cpu_usage</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ì—°ì‚° ì„±ëŠ¥ ì¶”ì </span><span class="sh">"""</span>
        
        <span class="n">duration</span> <span class="o">=</span> <span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">).</span><span class="nf">total_seconds</span><span class="p">()</span>
        
        <span class="n">performance_record</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">(),</span>
            <span class="sh">'</span><span class="s">operation_type</span><span class="sh">'</span><span class="p">:</span> <span class="n">operation_type</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">:</span> <span class="n">duration</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">memory_usage</span><span class="sh">'</span><span class="p">:</span> <span class="n">memory_usage</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">cpu_usage</span><span class="sh">'</span><span class="p">:</span> <span class="n">cpu_usage</span>
        <span class="p">}</span>
        
        <span class="n">self</span><span class="p">.</span><span class="n">performance_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">latency</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">performance_record</span><span class="p">)</span>
        
        <span class="c1"># ì²˜ë¦¬ëŸ‰ ê³„ì‚° (ì´ˆë‹¹ ì²˜ë¦¬ í•­ëª© ìˆ˜)
</span>        <span class="k">if</span> <span class="n">duration</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">throughput</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">duration</span>  <span class="c1"># ë‹¨ì¼ ì—°ì‚° ê¸°ì¤€
</span>            <span class="n">self</span><span class="p">.</span><span class="n">performance_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">throughput</span><span class="sh">'</span><span class="p">].</span><span class="nf">append</span><span class="p">({</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">performance_record</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">operation_type</span><span class="sh">'</span><span class="p">:</span> <span class="n">operation_type</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">throughput</span><span class="sh">'</span><span class="p">:</span> <span class="n">throughput</span>
            <span class="p">})</span>
    
    <span class="k">def</span> <span class="nf">analyze_performance_trends</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">time_window</span><span class="o">=</span><span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì„±ëŠ¥ íŠ¸ë Œë“œ ë¶„ì„</span><span class="sh">"""</span>
        
        <span class="n">cutoff_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">time_window</span> <span class="o">==</span> <span class="sh">'</span><span class="s">1h</span><span class="sh">'</span> <span class="k">else</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">-</span> <span class="nf">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">)</span>
        
        <span class="c1"># ì§€ì—°ì‹œê°„ ë¶„ì„
</span>        <span class="n">recent_latency</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">performance_metrics</span><span class="p">[</span><span class="sh">'</span><span class="s">latency</span><span class="sh">'</span><span class="p">]</span> <span class="k">if</span> <span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">cutoff_time</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">recent_latency</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        
        <span class="n">latency_by_operation</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">recent_latency</span><span class="p">:</span>
            <span class="n">op_type</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">operation_type</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">op_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">latency_by_operation</span><span class="p">:</span>
                <span class="n">latency_by_operation</span><span class="p">[</span><span class="n">op_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">latency_by_operation</span><span class="p">[</span><span class="n">op_type</span><span class="p">].</span><span class="nf">append</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="c1"># í†µê³„ ê³„ì‚°
</span>        <span class="n">performance_analysis</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">time_window</span><span class="sh">'</span><span class="p">:</span> <span class="n">time_window</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">operation_breakdown</span><span class="sh">'</span><span class="p">:</span> <span class="p">{},</span>
            <span class="sh">'</span><span class="s">overall_metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">avg_latency</span><span class="sh">'</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recent_latency</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">recent_latency</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">max_latency</span><span class="sh">'</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recent_latency</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">min_latency</span><span class="sh">'</span><span class="p">:</span> <span class="nf">min</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="sh">'</span><span class="s">duration</span><span class="sh">'</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">recent_latency</span><span class="p">)</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">for</span> <span class="n">op_type</span><span class="p">,</span> <span class="n">latencies</span> <span class="ow">in</span> <span class="n">latency_by_operation</span><span class="p">.</span><span class="nf">items</span><span class="p">():</span>
            <span class="n">performance_analysis</span><span class="p">[</span><span class="sh">'</span><span class="s">operation_breakdown</span><span class="sh">'</span><span class="p">][</span><span class="n">op_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">avg_latency</span><span class="sh">'</span><span class="p">:</span> <span class="nf">sum</span><span class="p">(</span><span class="n">latencies</span><span class="p">)</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">latencies</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">max_latency</span><span class="sh">'</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="n">latencies</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">min_latency</span><span class="sh">'</span><span class="p">:</span> <span class="nf">min</span><span class="p">(</span><span class="n">latencies</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">operation_count</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">latencies</span><span class="p">)</span>
            <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">performance_analysis</span>
</code></pre></div></div>

<hr />

<h2 id="ëŒ€ê·œëª¨-bi-ì‹œìŠ¤í…œ-êµ¬ì¶•">ğŸ—ï¸ ëŒ€ê·œëª¨ BI ì‹œìŠ¤í…œ êµ¬ì¶•</h2>

<h3 id="ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜-êµ¬ì„±ìš”ì†Œ">ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ êµ¬ì„±ìš”ì†Œ</h3>

<table>
  <thead>
    <tr>
      <th>ê³„ì¸µ</th>
      <th>êµ¬ì„±ìš”ì†Œ</th>
      <th>ê¸°ìˆ  ìŠ¤íƒ</th>
      <th>ì—­í• </th>
      <th>í™•ì¥ì„±</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>í”„ë ˆì  í…Œì´ì…˜</strong></td>
      <td>ëŒ€ì‹œë³´ë“œ</td>
      <td>React/Vue.js, D3.js</td>
      <td>ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>API ê²Œì´íŠ¸ì›¨ì´</strong></td>
      <td>ë¼ìš°íŒ…</td>
      <td>Kong/Nginx, Auth0</td>
      <td>ìš”ì²­ ë¼ìš°íŒ…, ì¸ì¦</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§</strong></td>
      <td>HLL ì„œë¹„ìŠ¤</td>
      <td>Python/Node.js, FastAPI</td>
      <td>ì¹´ë””ë„ë¦¬í‹° ê³„ì‚°</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>ë°ì´í„° ì²˜ë¦¬</strong></td>
      <td>ìŠ¤íŠ¸ë¦¬ë°</td>
      <td>Apache Flink, Kafka</td>
      <td>ì‹¤ì‹œê°„ ì²˜ë¦¬</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>ìºì‹±</strong></td>
      <td>ë¶„ì‚° ìºì‹œ</td>
      <td>Redis Cluster</td>
      <td>ì„±ëŠ¥ ìµœì í™”</td>
      <td>ìˆ˜í‰ í™•ì¥</td>
    </tr>
    <tr>
      <td><strong>ì €ì¥ì†Œ</strong></td>
      <td>ë°ì´í„°ë² ì´ìŠ¤</td>
      <td>PostgreSQL, MongoDB</td>
      <td>ë°ì´í„° ì €ì¥</td>
      <td>ìˆ˜ì§/ìˆ˜í‰ í™•ì¥</td>
    </tr>
  </tbody>
</table>

<h3 id="ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤-ì•„í‚¤í…ì²˜">ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜</h3>

<table>
  <thead>
    <tr>
      <th>ì„œë¹„ìŠ¤ëª…</th>
      <th>í¬íŠ¸</th>
      <th>ì˜ì¡´ì„±</th>
      <th>ë ˆí”Œë¦¬ì¹´</th>
      <th>ë¦¬ì†ŒìŠ¤</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>hll-api</strong></td>
      <td>8080</td>
      <td>Redis, DB</td>
      <td>3</td>
      <td>2CPU, 4GB</td>
    </tr>
    <tr>
      <td><strong>hll-processor</strong></td>
      <td>8081</td>
      <td>Kafka, Redis</td>
      <td>5</td>
      <td>4CPU, 8GB</td>
    </tr>
    <tr>
      <td><strong>hll-cache</strong></td>
      <td>6379</td>
      <td>-</td>
      <td>3</td>
      <td>1CPU, 2GB</td>
    </tr>
    <tr>
      <td><strong>hll-monitor</strong></td>
      <td>9090</td>
      <td>Prometheus</td>
      <td>2</td>
      <td>1CPU, 2GB</td>
    </tr>
  </tbody>
</table>

<h3 id="ì•„í‚¤í…ì²˜-ì„¤ê³„">ì•„í‚¤í…ì²˜ ì„¤ê³„</h3>

<h4 id="ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤-ê¸°ë°˜-hll-ì„œë¹„ìŠ¤">ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê¸°ë°˜ HLL ì„œë¹„ìŠ¤</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">HLLMicroservice</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">service_name</span><span class="p">,</span> <span class="n">redis_client</span><span class="p">,</span> <span class="n">kafka_producer</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">service_name</span> <span class="o">=</span> <span class="n">service_name</span>
        <span class="n">self</span><span class="p">.</span><span class="n">redis_client</span> <span class="o">=</span> <span class="n">redis_client</span>
        <span class="n">self</span><span class="p">.</span><span class="n">kafka_producer</span> <span class="o">=</span> <span class="n">kafka_producer</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hll_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">metrics_collector</span> <span class="o">=</span> <span class="nc">HLLPerformanceMonitor</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">process_cardinality_request</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¹´ë””ë„ë¦¬í‹° ê³„ì‚° ìš”ì²­ ì²˜ë¦¬</span><span class="sh">"""</span>
        
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ìš”ì²­ íŒŒì‹±
</span>            <span class="n">dataset_id</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="sh">'</span><span class="s">dataset_id</span><span class="sh">'</span><span class="p">]</span>
            <span class="n">time_range</span> <span class="o">=</span> <span class="n">request</span><span class="p">[</span><span class="sh">'</span><span class="s">time_range</span><span class="sh">'</span><span class="p">]</span>
            <span class="n">filters</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">'</span><span class="s">filters</span><span class="sh">'</span><span class="p">,</span> <span class="p">{})</span>
            
            <span class="c1"># HLL ì¡°íšŒ ë˜ëŠ” ìƒì„±
</span>            <span class="n">hll_key</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_generate_hll_key</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
            <span class="n">hll</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_or_create_hll</span><span class="p">(</span><span class="n">hll_key</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
            
            <span class="c1"># ì¹´ë””ë„ë¦¬í‹° ê³„ì‚°
</span>            <span class="n">cardinality</span> <span class="o">=</span> <span class="n">hll</span><span class="p">.</span><span class="nf">count</span><span class="p">()</span>
            
            <span class="c1"># ê²°ê³¼ ë°˜í™˜
</span>            <span class="n">result</span> <span class="o">=</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">dataset_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">dataset_id</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">time_range</span><span class="sh">'</span><span class="p">:</span> <span class="n">time_range</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">filters</span><span class="sh">'</span><span class="p">:</span> <span class="n">filters</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">cardinality</span><span class="sh">'</span><span class="p">:</span> <span class="n">cardinality</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">confidence_interval</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="nf">_calculate_confidence_interval</span><span class="p">(</span><span class="n">cardinality</span><span class="p">,</span> <span class="n">hll</span><span class="p">.</span><span class="n">precision</span><span class="p">),</span>
                <span class="sh">'</span><span class="s">timestamp</span><span class="sh">'</span><span class="p">:</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
            <span class="p">}</span>
            
            <span class="c1"># ì„±ëŠ¥ ë©”íŠ¸ë¦­ ê¸°ë¡
</span>            <span class="n">end_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">now</span><span class="p">()</span>
            <span class="n">self</span><span class="p">.</span><span class="n">metrics_collector</span><span class="p">.</span><span class="nf">track_operation_performance</span><span class="p">(</span>
                <span class="sh">'</span><span class="s">cardinality_calculation</span><span class="sh">'</span><span class="p">,</span> <span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">,</span> 
                <span class="n">self</span><span class="p">.</span><span class="nf">_get_memory_usage</span><span class="p">(),</span> <span class="n">self</span><span class="p">.</span><span class="nf">_get_cpu_usage</span><span class="p">()</span>
            <span class="p">)</span>
            
            <span class="k">return</span> <span class="n">result</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># ì—ëŸ¬ ë¡œê¹… ë° ì•Œë¦¼
</span>            <span class="n">self</span><span class="p">.</span><span class="nf">_handle_error</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">request</span><span class="p">)</span>
            <span class="k">raise</span>
    
    <span class="k">def</span> <span class="nf">_get_or_create_hll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">hll_key</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ì¡°íšŒ ë˜ëŠ” ìƒì„±</span><span class="sh">"""</span>
        
        <span class="c1"># ìºì‹œì—ì„œ ì¡°íšŒ
</span>        <span class="k">if</span> <span class="n">hll_key</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">hll_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">hll_cache</span><span class="p">[</span><span class="n">hll_key</span><span class="p">]</span>
        
        <span class="c1"># Redisì—ì„œ ì¡°íšŒ
</span>        <span class="n">cached_hll</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_load_hll_from_redis</span><span class="p">(</span><span class="n">hll_key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cached_hll</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">hll_cache</span><span class="p">[</span><span class="n">hll_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">cached_hll</span>
            <span class="k">return</span> <span class="n">cached_hll</span>
        
        <span class="c1"># ìƒˆë¡œìš´ HLL ìƒì„±
</span>        <span class="n">hll</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_create_new_hll</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
        
        <span class="c1"># ìºì‹œ ë° Redisì— ì €ì¥
</span>        <span class="n">self</span><span class="p">.</span><span class="n">hll_cache</span><span class="p">[</span><span class="n">hll_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">hll</span>
        <span class="n">self</span><span class="p">.</span><span class="nf">_save_hll_to_redis</span><span class="p">(</span><span class="n">hll_key</span><span class="p">,</span> <span class="n">hll</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">hll</span>
    
    <span class="k">def</span> <span class="nf">_create_new_hll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">dataset_id</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="n">filters</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìƒˆë¡œìš´ HLL ìƒì„±</span><span class="sh">"""</span>
        
        <span class="c1"># ë°ì´í„° ì†ŒìŠ¤ì—ì„œ ë°ì´í„° ì¡°íšŒ
</span>        <span class="n">raw_data</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">_fetch_data_from_source</span><span class="p">(</span><span class="n">dataset_id</span><span class="p">,</span> <span class="n">time_range</span><span class="p">,</span> <span class="n">filters</span><span class="p">)</span>
        
        <span class="c1"># HLL ìƒì„± ë° ë°ì´í„° ì¶”ê°€
</span>        <span class="n">hll</span> <span class="o">=</span> <span class="nc">HyperLogLog</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>  <span class="c1"># ì ì ˆí•œ ì •ë°€ë„ ì„¤ì •
</span>        
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">raw_data</span><span class="p">:</span>
            <span class="n">hll</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="sh">'</span><span class="s">user_id</span><span class="sh">'</span><span class="p">])</span>
        
        <span class="k">return</span> <span class="n">hll</span>
    
    <span class="k">def</span> <span class="nf">_calculate_confidence_interval</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cardinality</span><span class="p">,</span> <span class="n">precision</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹ ë¢°êµ¬ê°„ ê³„ì‚°</span><span class="sh">"""</span>
        
        <span class="c1"># HyperLogLogì˜ í‘œì¤€ ì˜¤ì°¨ ê³„ì‚°
</span>        <span class="n">standard_error</span> <span class="o">=</span> <span class="mf">1.04</span> <span class="o">/</span> <span class="n">math</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">precision</span><span class="p">)</span>
        <span class="n">margin_of_error</span> <span class="o">=</span> <span class="n">cardinality</span> <span class="o">*</span> <span class="n">standard_error</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">lower_bound</span><span class="sh">'</span><span class="p">:</span> <span class="nf">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">cardinality</span> <span class="o">-</span> <span class="n">margin_of_error</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">upper_bound</span><span class="sh">'</span><span class="p">:</span> <span class="n">cardinality</span> <span class="o">+</span> <span class="n">margin_of_error</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">margin_of_error</span><span class="sh">'</span><span class="p">:</span> <span class="n">margin_of_error</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">confidence_level</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.95</span>
        <span class="p">}</span>
</code></pre></div></div>

<h4 id="ë¶„ì‚°-ìºì‹±-ì‹œìŠ¤í…œ">ë¶„ì‚° ìºì‹± ì‹œìŠ¤í…œ</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">DistributedHLLCache</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">redis_cluster</span><span class="p">,</span> <span class="n">cache_ttl</span><span class="o">=</span><span class="mi">3600</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">redis_cluster</span> <span class="o">=</span> <span class="n">redis_cluster</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cache_ttl</span> <span class="o">=</span> <span class="n">cache_ttl</span>
        <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">hits</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">misses</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">evictions</span><span class="sh">'</span><span class="p">:</span> <span class="mi">0</span>
        <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">get_hll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ìºì‹œ ì¡°íšŒ</span><span class="sh">"""</span>
        
        <span class="c1"># ë¡œì»¬ ìºì‹œ ë¨¼ì € í™•ì¸
</span>        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">:</span>
            <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">hits</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
        
        <span class="c1"># Redisì—ì„œ ì¡°íšŒ
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">redis_key</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">hll:</span><span class="si">{</span><span class="n">cache_key</span><span class="si">}</span><span class="sh">"</span>
            <span class="n">cached_data</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">redis_cluster</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">redis_key</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">cached_data</span><span class="p">:</span>
                <span class="n">hll</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="nf">loads</span><span class="p">(</span><span class="n">cached_data</span><span class="p">)</span>
                <span class="c1"># ë¡œì»¬ ìºì‹œì— ì €ì¥
</span>                <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">hll</span>
                <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">hits</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="n">hll</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">misses</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="bp">None</span>
                
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Redis cache error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">misses</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">set_hll</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">,</span> <span class="n">hll</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">HLL ìºì‹œ ì €ì¥</span><span class="sh">"""</span>
        
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># ë¡œì»¬ ìºì‹œì— ì €ì¥
</span>            <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">hll</span>
            
            <span class="c1"># Redisì— ì €ì¥
</span>            <span class="n">redis_key</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">hll:</span><span class="si">{</span><span class="n">cache_key</span><span class="si">}</span><span class="sh">"</span>
            <span class="n">serialized_hll</span> <span class="o">=</span> <span class="n">pickle</span><span class="p">.</span><span class="nf">dumps</span><span class="p">(</span><span class="n">hll</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">redis_cluster</span><span class="p">.</span><span class="nf">setex</span><span class="p">(</span><span class="n">redis_key</span><span class="p">,</span> <span class="n">self</span><span class="p">.</span><span class="n">cache_ttl</span><span class="p">,</span> <span class="n">serialized_hll</span><span class="p">)</span>
            
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Cache storage error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">evict_cache</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">cache_key</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìºì‹œ ì œê±°</span><span class="sh">"""</span>
        
        <span class="c1"># ë¡œì»¬ ìºì‹œì—ì„œ ì œê±°
</span>        <span class="k">if</span> <span class="n">cache_key</span> <span class="ow">in</span> <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">[</span><span class="n">cache_key</span><span class="p">]</span>
        
        <span class="c1"># Redisì—ì„œ ì œê±°
</span>        <span class="k">try</span><span class="p">:</span>
            <span class="n">redis_key</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">hll:</span><span class="si">{</span><span class="n">cache_key</span><span class="si">}</span><span class="sh">"</span>
            <span class="n">self</span><span class="p">.</span><span class="n">redis_cluster</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="n">redis_key</span><span class="p">)</span>
            <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">evictions</span><span class="sh">'</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Cache eviction error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">get_cache_stats</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìºì‹œ í†µê³„ ë°˜í™˜</span><span class="sh">"""</span>
        
        <span class="n">total_requests</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">hits</span><span class="sh">'</span><span class="p">]</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">misses</span><span class="sh">'</span><span class="p">]</span>
        <span class="n">hit_rate</span> <span class="o">=</span> <span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span><span class="p">[</span><span class="sh">'</span><span class="s">hits</span><span class="sh">'</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_requests</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="k">if</span> <span class="n">total_requests</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>
        
        <span class="k">return</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">hit_rate</span><span class="sh">'</span><span class="p">:</span> <span class="n">hit_rate</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">total_requests</span><span class="sh">'</span><span class="p">:</span> <span class="n">total_requests</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">local_cache_size</span><span class="sh">'</span><span class="p">:</span> <span class="nf">len</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">local_cache</span><span class="p">),</span>
            <span class="sh">'</span><span class="s">stats</span><span class="sh">'</span><span class="p">:</span> <span class="n">self</span><span class="p">.</span><span class="n">cache_stats</span>
        <span class="p">}</span>
</code></pre></div></div>

<hr />

<h2 id="ì‹¤ë¬´-í”„ë¡œì íŠ¸-ì‹¤ì‹œê°„-ë¶„ì„-í”Œë«í¼">ğŸš€ ì‹¤ë¬´ í”„ë¡œì íŠ¸: ì‹¤ì‹œê°„ ë¶„ì„ í”Œë«í¼</h2>

<h3 id="í”„ë¡œì íŠ¸-ê°œìš”">í”„ë¡œì íŠ¸ ê°œìš”</h3>

<p>ëŒ€ê·œëª¨ ì „ììƒê±°ë˜ í”Œë«í¼ì„ ìœ„í•œ ì‹¤ì‹œê°„ ì‚¬ìš©ì ë¶„ì„ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•©ë‹ˆë‹¤.</p>

<h4 id="ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜">ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">RealTimeAnalyticsPlatform</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">data_pipeline</span> <span class="o">=</span> <span class="nc">DataPipeline</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">hll_processor</span> <span class="o">=</span> <span class="nc">DistributedHLLProcessor</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">cache_system</span> <span class="o">=</span> <span class="nc">DistributedHLLCache</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">monitoring_system</span> <span class="o">=</span> <span class="nc">HLLAccuracyMonitor</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">alert_system</span> <span class="o">=</span> <span class="nc">AlertSystem</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_analytics_pipeline</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¶„ì„ íŒŒì´í”„ë¼ì¸ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">pipeline_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">data_sources</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">user_events</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">source</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Kafka</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">topics</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">user-page-views</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user-clicks</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">user-purchases</span><span class="sh">'</span><span class="p">],</span>
                    <span class="sh">'</span><span class="s">processing_mode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">streaming</span><span class="sh">'</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">user_profiles</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">source</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Database</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">table</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">user_profiles</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">processing_mode</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">batch</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">hll_processing</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">precision_levels</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">hourly</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">daily</span><span class="sh">'</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">weekly</span><span class="sh">'</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">monthly</span><span class="sh">'</span><span class="p">:</span> <span class="mi">16</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">aggregation_windows</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">1h</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">24h</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">7d</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">30d</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">cache_strategy</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">distributed</span><span class="sh">'</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">output_targets</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">real_time_dashboard</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">update_interval</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">1m</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">metrics</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">unique_visitors</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">page_views</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">conversion_rate</span><span class="sh">'</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">data_warehouse</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">storage_format</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Parquet</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">partition_strategy</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">daily</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">pipeline_config</span>
    
    <span class="k">def</span> <span class="nf">implement_real_time_processing</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì‹¤ì‹œê°„ ì²˜ë¦¬ êµ¬í˜„</span><span class="sh">"""</span>
        
        <span class="n">processing_engine</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">stream_processing</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">framework</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Apache Flink</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">configuration</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">parallelism</span><span class="sh">'</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">checkpoint_interval</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">60s</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">state_backend</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">RocksDB</span><span class="sh">'</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">operators</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">event_parser</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">JSONParser</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">user_id_extractor</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">UserIDExtractor</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">hll_aggregator</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">HLLAggregator</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">result_sink</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">KafkaSink</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">batch_processing</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">framework</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Apache Spark</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">configuration</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">executor_instances</span><span class="sh">'</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">executor_memory</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">4g</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">driver_memory</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">2g</span><span class="sh">'</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">jobs</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">daily_aggregation</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">DailyHLLAggregation</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">weekly_rollup</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">WeeklyRollup</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">monthly_archive</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">MonthlyArchive</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">processing_engine</span>
    
    <span class="k">def</span> <span class="nf">setup_monitoring_and_alerts</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ëª¨ë‹ˆí„°ë§ ë° ì•Œë¦¼ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">monitoring_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">accuracy_monitoring</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">check_interval</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">5m</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">error_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">critical_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">baseline_comparison</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">performance_monitoring</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">latency_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">100ms</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">throughput_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">memory_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">80%</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">cpu_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">85%</span><span class="sh">'</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">alert_channels</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">email</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">admin@company.com</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">slack</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">#data-alerts</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">pagerduty</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">data-team</span><span class="sh">'</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">monitoring_config</span>
    
    <span class="k">def</span> <span class="nf">generate_business_insights</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ ìƒì„±</span><span class="sh">"""</span>
        
        <span class="n">insights_engine</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">user_behavior_analysis</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">retention_cohorts</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">CohortAnalysis</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">user_segmentation</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">UserSegmentation</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">conversion_funnels</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">ConversionFunnelAnalysis</span><span class="sh">'</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">marketing_effectiveness</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">campaign_attribution</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">CampaignAttribution</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">channel_performance</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">ChannelPerformance</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">roi_analysis</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">ROIAnalysis</span><span class="sh">'</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">product_analytics</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">feature_adoption</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">FeatureAdoption</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">user_engagement</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">EngagementMetrics</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">churn_prediction</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">ChurnPrediction</span><span class="sh">'</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">insights_engine</span>
</code></pre></div></div>

<h3 id="ìš´ì˜-ë°-ìœ ì§€ë³´ìˆ˜">ìš´ì˜ ë° ìœ ì§€ë³´ìˆ˜</h3>

<h4 id="ìë™í™”ëœ-ìš´ì˜-ì‹œìŠ¤í…œ">ìë™í™”ëœ ìš´ì˜ ì‹œìŠ¤í…œ</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">AutomatedOperationsSystem</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">scheduler</span> <span class="o">=</span> <span class="nc">APScheduler</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">health_checker</span> <span class="o">=</span> <span class="nc">HealthChecker</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">auto_scaler</span> <span class="o">=</span> <span class="nc">AutoScaler</span><span class="p">()</span>
        <span class="n">self</span><span class="p">.</span><span class="n">backup_manager</span> <span class="o">=</span> <span class="nc">BackupManager</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">setup_automated_operations</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìë™í™”ëœ ìš´ì˜ ì„¤ì •</span><span class="sh">"""</span>
        
        <span class="n">operations</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">scheduled_tasks</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">daily_hll_refresh</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">schedule</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">0 2 * * *</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># ë§¤ì¼ ì˜¤ì „ 2ì‹œ
</span>                    <span class="sh">'</span><span class="s">task</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">refresh_daily_hll_metrics</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">retry_count</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">weekly_accuracy_check</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">schedule</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">0 3 * * 1</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># ë§¤ì£¼ ì›”ìš”ì¼ ì˜¤ì „ 3ì‹œ
</span>                    <span class="sh">'</span><span class="s">task</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">validate_hll_accuracy</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">alert_on_failure</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">monthly_archive</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">schedule</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">0 4 1 * *</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># ë§¤ì›” 1ì¼ ì˜¤ì „ 4ì‹œ
</span>                    <span class="sh">'</span><span class="s">task</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">archive_old_hll_data</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">retention_days</span><span class="sh">'</span><span class="p">:</span> <span class="mi">365</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">health_checks</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_service_health</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">check_interval</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">30s</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">endpoints</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="sh">'</span><span class="s">/health</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">/metrics</span><span class="sh">'</span><span class="p">],</span>
                    <span class="sh">'</span><span class="s">failure_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="mi">3</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">cache_health</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">check_interval</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">1m</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">redis_cluster_check</span><span class="sh">'</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">cache_hit_rate_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="mf">0.8</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">auto_scaling</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_processing_nodes</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">min_instances</span><span class="sh">'</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">max_instances</span><span class="sh">'</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">scale_up_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">cpu &gt; 70%</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">scale_down_threshold</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">cpu &lt; 30%</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">operations</span>
    
    <span class="k">def</span> <span class="nf">implement_disaster_recovery</span><span class="p">(</span><span class="n">self</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì¬í•´ ë³µêµ¬ êµ¬í˜„</span><span class="sh">"""</span>
        
        <span class="n">dr_config</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">backup_strategy</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">hll_data_backup</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">hourly</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">retention</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">7 days</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">storage</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">S3</span><span class="sh">'</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">configuration_backup</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">daily</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">retention</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">30 days</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">storage</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Git repository</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">failover_procedures</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">primary_failure</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">detection_time</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">30s</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">failover_time</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">2m</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">secondary_region</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">us-west-2</span><span class="sh">'</span>
                <span class="p">},</span>
                <span class="sh">'</span><span class="s">data_corruption</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">detection_method</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">checksum_validation</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">recovery_time</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">5m</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">backup_source</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">latest_known_good</span><span class="sh">'</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="sh">'</span><span class="s">recovery_testing</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">frequency</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">monthly</span><span class="sh">'</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">test_scenarios</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span>
                    <span class="sh">'</span><span class="s">primary_region_failure</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">database_corruption</span><span class="sh">'</span><span class="p">,</span>
                    <span class="sh">'</span><span class="s">cache_failure</span><span class="sh">'</span>
                <span class="p">],</span>
                <span class="sh">'</span><span class="s">success_criteria</span><span class="sh">'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="sh">'</span><span class="s">rto</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">5 minutes</span><span class="sh">'</span><span class="p">,</span>  <span class="c1"># Recovery Time Objective
</span>                    <span class="sh">'</span><span class="s">rpo</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">1 minute</span><span class="sh">'</span>    <span class="c1"># Recovery Point Objective
</span>                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">dr_config</span>
</code></pre></div></div>

<hr />

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“š í•™ìŠµ ìš”ì•½</h2>

<h3 id="í•µì‹¬-ê°œë…-ì •ë¦¬">í•µì‹¬ ê°œë… ì •ë¦¬</h3>

<ol>
  <li><strong>ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤</strong>
    <ul>
      <li>ì›¹ ë¶„ì„: ì‚¬ìš©ì í–‰ë™ ì¶”ì , ì „í™˜ìœ¨ ë¶„ì„</li>
      <li>ë§ˆì¼€íŒ… ë¶„ì„: ìº í˜ì¸ íš¨ê³¼ ì¸¡ì •, ROI ê³„ì‚°</li>
      <li>ì‹¤ì‹œê°„ ëŒ€ì‹œë³´ë“œ: ë¼ì´ë¸Œ ë©”íŠ¸ë¦­ ì œê³µ</li>
    </ul>
  </li>
  <li><strong>ì„±ëŠ¥ ìµœì í™” ì „ëµ</strong>
    <ul>
      <li>ì ì‘ì  ì •ë°€ë„ ì¡°ì •ìœ¼ë¡œ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± í–¥ìƒ</li>
      <li>ì••ì¶• ê¸°ë°˜ ì €ì¥ìœ¼ë¡œ ìŠ¤í† ë¦¬ì§€ ìµœì í™”</li>
      <li>ë³‘ë ¬ ì²˜ë¦¬ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ê°€ì†í™”</li>
    </ul>
  </li>
  <li><strong>ëª¨ë‹ˆí„°ë§ê³¼ í’ˆì§ˆ ê´€ë¦¬</strong>
    <ul>
      <li>ì •í™•ë„ ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ê²°ê³¼ ì‹ ë¢°ì„± ë³´ì¥</li>
      <li>ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ìœ¼ë¡œ ì‹œìŠ¤í…œ ì•ˆì •ì„± ìœ ì§€</li>
      <li>ìë™í™”ëœ ì•Œë¦¼ ì‹œìŠ¤í…œìœ¼ë¡œ ë¬¸ì œ ì¡°ê¸° ë°œê²¬</li>
    </ul>
  </li>
  <li><strong>ëŒ€ê·œëª¨ BI ì‹œìŠ¤í…œ êµ¬ì¶•</strong>
    <ul>
      <li>ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ë¡œ í™•ì¥ì„± í™•ë³´</li>
      <li>ë¶„ì‚° ìºì‹±ìœ¼ë¡œ ì‘ë‹µ ì‹œê°„ ìµœì í™”</li>
      <li>ì‹¤ì‹œê°„ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì§€ì—°ì‹œê°„ ìµœì†Œí™”</li>
    </ul>
  </li>
</ol>

<h3 id="ì‹¤ë¬´-ì ìš©-ê°€ì´ë“œ">ì‹¤ë¬´ ì ìš© ê°€ì´ë“œ</h3>

<ol>
  <li><strong>ì‹œìŠ¤í…œ ì„¤ê³„ ì‹œ ê³ ë ¤ì‚¬í•­</strong>
    <ul>
      <li>ë°ì´í„° ë³¼ë¥¨ê³¼ ì •í™•ë„ ìš”êµ¬ì‚¬í•­ ë¶„ì„</li>
      <li>ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ê³¼ ì²˜ë¦¬ ì„±ëŠ¥ì˜ ê· í˜•</li>
      <li>í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„± ê³ ë ¤</li>
    </ul>
  </li>
  <li><strong>ìš´ì˜ ëª¨ë²” ì‚¬ë¡€</strong>
    <ul>
      <li>ì •ê¸°ì ì¸ ì •í™•ë„ ê²€ì¦</li>
      <li>ì„±ëŠ¥ ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§</li>
      <li>ìë™í™”ëœ ë°±ì—… ë° ë³µêµ¬ ì‹œìŠ¤í…œ</li>
    </ul>
  </li>
  <li><strong>ë¬¸ì œ í•´ê²° ë°©ë²•</strong>
    <ul>
      <li>ì •í™•ë„ ì €í•˜ ì‹œ ì •ë°€ë„ ì¡°ì •</li>
      <li>ì„±ëŠ¥ ì €í•˜ ì‹œ ë³‘ë ¬ ì²˜ë¦¬ ë„ì…</li>
      <li>ë©”ëª¨ë¦¬ ë¶€ì¡± ì‹œ ì••ì¶• ê¸°ë²• ì ìš©</li>
    </ul>
  </li>
</ol>

<h3 id="ë‹¤ìŒ-ë‹¨ê³„">ë‹¤ìŒ ë‹¨ê³„</h3>

<p>HyperLogLogì˜ ì‹¤ë¬´ ì ìš©ê³¼ ìµœì í™”ë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ Part 3ì—ì„œëŠ” HyperLogLogì™€ í•¨ê»˜ ì‚¬ìš©ë˜ëŠ” ë‹¤ë¥¸ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ë“¤ê³¼ ê³ ê¸‰ ë¶„ì„ ê¸°ë²•ì— ëŒ€í•´ ë‹¤ë£° ì˜ˆì •ì…ë‹ˆë‹¤.</p>

<p><strong>ì£¼ìš” í•™ìŠµ í¬ì¸íŠ¸:</strong></p>
<ul>
  <li>âœ… ì‹¤ë¬´ í™˜ê²½ì—ì„œì˜ HyperLogLog ì ìš© ë°©ë²•</li>
  <li>âœ… ì„±ëŠ¥ ìµœì í™”ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ì „ëµ</li>
  <li>âœ… ëª¨ë‹ˆí„°ë§ê³¼ í’ˆì§ˆ ê´€ë¦¬ ì‹œìŠ¤í…œ êµ¬ì¶•</li>
  <li>âœ… ëŒ€ê·œëª¨ BI ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì„¤ê³„</li>
  <li>âœ… ìë™í™”ëœ ìš´ì˜ ì‹œìŠ¤í…œ êµ¬í˜„</li>
</ul>

<p>HyperLogLogë¥¼ í™œìš©í•œ í˜„ëŒ€ì ì¸ BI ì‹œìŠ¤í…œ êµ¬ì¶•ì˜ í•µì‹¬ì„ ëª¨ë‘ í•™ìŠµí–ˆìŠµë‹ˆë‹¤! ğŸ‰</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
      
        
          
          
      
      
        
        
        <a href="/bi-engineering/2025/09/24/hyperloglog-cardinality-estimation-basics.html" class="nav-link prev">
          â† ì´ì „: Part 1: HyperLogLog ê¸°ì´ˆì™€ ì¹´ë””ë„ë¦¬í‹° ì¶”ì • - ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ê³ ìœ ê°’ ê°œìˆ˜ íš¨ìœ¨ì  ê³„ì‚°
        </a>
      
      
      
        
        
        <a href="/bi-engineering/2025/09/25/hyperloglog-advanced-probabilistic-algorithms.html" class="nav-link next">
          ë‹¤ìŒ: Part 3: HyperLogLogì™€ ê³ ê¸‰ í™•ë¥ ì  ì•Œê³ ë¦¬ì¦˜ - í˜„ëŒ€ì  BI ë¶„ì„ì˜ ì™„ì„± â†’
        </a>
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/bi-engineering/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee-a61ab2193/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>

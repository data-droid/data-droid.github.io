<!DOCTYPE html>
<html lang="ko">
<head>
  <link rel="stylesheet" href="/assets/css/style.css">
  <!-- Head includes for Jekyll -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- SEO -->

<meta name="description" content="dbtì™€ ì£¼ìš” ë°ì´í„° í”Œë«í¼ì„ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ì˜ ëª¨ë“  ê²ƒ. Snowflake, BigQuery, Redshiftì™€ í•¨ê»˜í•˜ëŠ” ì‹¤ë¬´ ì¤‘ì‹¬ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">



<title>dbtë¥¼ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì™„ì „ ê°€ì´ë“œ - í˜„ëŒ€ì  ë°ì´í„° íŒŒì´í”„ë¼ì¸ì˜ í•µì‹¬ - Data Droid Blog</title>


<!-- Open Graph -->
<meta property="og:title" content="dbtë¥¼ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì™„ì „ ê°€ì´ë“œ - í˜„ëŒ€ì  ë°ì´í„° íŒŒì´í”„ë¼ì¸ì˜ í•µì‹¬">
<meta property="og:description" content="dbtì™€ ì£¼ìš” ë°ì´í„° í”Œë«í¼ì„ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ì˜ ëª¨ë“  ê²ƒ. Snowflake, BigQuery, Redshiftì™€ í•¨ê»˜í•˜ëŠ” ì‹¤ë¬´ ì¤‘ì‹¬ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">
<meta property="og:url" content="http://localhost:4000/data-quality/2025/09/30/dbt-data-quality-management.html">
<meta property="og:type" content="website">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="dbtë¥¼ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì™„ì „ ê°€ì´ë“œ - í˜„ëŒ€ì  ë°ì´í„° íŒŒì´í”„ë¼ì¸ì˜ í•µì‹¬">
<meta name="twitter:description" content="dbtì™€ ì£¼ìš” ë°ì´í„° í”Œë«í¼ì„ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ì˜ ëª¨ë“  ê²ƒ. Snowflake, BigQuery, Redshiftì™€ í•¨ê»˜í•˜ëŠ” ì‹¤ë¬´ ì¤‘ì‹¬ì˜ ì™„ì „í•œ ê°€ì´ë“œì…ë‹ˆë‹¤.">

<!-- Favicon -->
<link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
<link rel="icon" type="image/x-icon" href="/favicon.ico">

<!-- RSS Feed -->
<link rel="alternate" type="application/rss+xml" title="Data Droid Blog" href="/feed.xml">

<!-- Google Analytics -->

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GP9LT745PP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-GP9LT745PP');
</script>


</head>
<body>
  <header class="site-header">
  <div class="container">
    <div class="site-title">
      <a href="/">Data Droid Blog</a>
    </div>
    
    <!-- Mobile menu toggle button -->
    <button class="mobile-menu-toggle" aria-label="ë©”ë‰´ ì—´ê¸°/ë‹«ê¸°">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    
    <nav class="site-nav">
      <ul class="nav-list">
        <li><a href="/">í™ˆ</a></li>
                  <li class="dropdown">
            <a href="#" class="dropdown-toggle">ì¹´í…Œê³ ë¦¬</a>
            <ul class="dropdown-menu">

              <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
              <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
              <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
              <li><a href="/categories/data-ai/">Data AI</a></li>
            </ul>
          </li>
        <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
        <li><a href="/about/">ì†Œê°œ</a></li>
      </ul>
    </nav>
    
    <div class="language-switcher">
      
        <!-- í¬ìŠ¤íŠ¸ìš© ì–¸ì–´ ì „í™˜ -->
        
          <a href="/data-quality/2025/09/30/dbt-data-quality-management.html" class="lang-btn active">í•œêµ­ì–´</a>
          
          <a href="/en_posts/2025-09-30-dbt-data-quality-management.html" class="lang-btn">English</a>
        
      
    </div>
  </div>
</header>

  
  <main class="site-main">
    <div class="container">
      <article class="post">
  <header class="post-header">
    <div class="post-meta">
      <span class="post-category">Data quality</span>
      <span class="post-date">2025ë…„ 09ì›” 30ì¼</span>
      <span class="post-author">Data Droid</span>
    </div>
    
    <h1 class="post-title">dbtë¥¼ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì™„ì „ ê°€ì´ë“œ - í˜„ëŒ€ì  ë°ì´í„° íŒŒì´í”„ë¼ì¸ì˜ í•µì‹¬</h1>
    
    
    <div class="post-tags">
      
        <span class="tag">dbt</span>
      
        <span class="tag">ë°ì´í„°í’ˆì§ˆ</span>
      
        <span class="tag">DataQuality</span>
      
        <span class="tag">Snowflake</span>
      
        <span class="tag">BigQuery</span>
      
        <span class="tag">Redshift</span>
      
        <span class="tag">Databricks</span>
      
        <span class="tag">dbtCloud</span>
      
        <span class="tag">ë°ì´í„°íŒŒì´í”„ë¼ì¸</span>
      
    </div>
    
    
    
    <div class="post-series">
      <span class="series-badge">ğŸ“š Modern data stack ì‹œë¦¬ì¦ˆ</span>
      <span class="series-order">Part 2</span>
    </div>
    
    
    
    <div class="post-info">
      
        <span class="reading-time">â±ï¸ 60ë¶„</span>
      
      
        <span class="difficulty">ğŸ“Š ì¤‘ê¸‰</span>
      
    </div>
    
  </header>

  <div class="post-content">
    <h1 id="dbtë¥¼-í™œìš©í•œ-ë°ì´í„°-í’ˆì§ˆ-ê´€ë¦¬-ì™„ì „-ê°€ì´ë“œ---í˜„ëŒ€ì -ë°ì´í„°-íŒŒì´í”„ë¼ì¸ì˜-í•µì‹¬">dbtë¥¼ í™œìš©í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì™„ì „ ê°€ì´ë“œ - í˜„ëŒ€ì  ë°ì´í„° íŒŒì´í”„ë¼ì¸ì˜ í•µì‹¬</h1>

<blockquote>
  <p><strong>â€œë°ì´í„°ëŠ” ìƒˆë¡œìš´ ì„ìœ ë‹¤â€</strong>ë¼ëŠ” ë§ì´ ìˆì§€ë§Œ, ì •ì œë˜ì§€ ì•Šì€ ì„ìœ ëŠ” ì•„ë¬´ ì“¸ëª¨ê°€ ì—†ìŠµë‹ˆë‹¤. dbtëŠ” ë°”ë¡œ ê·¸ <strong>ë°ì´í„° ì •ì œ ê³µì¥</strong>ì˜ í•µì‹¬ ë„êµ¬ì…ë‹ˆë‹¤.</p>
</blockquote>

<p>í˜„ëŒ€ì  ë°ì´í„° ìŠ¤íƒì—ì„œ dbtëŠ” ë‹¨ìˆœí•œ ë³€í™˜ ë„êµ¬ë¥¼ ë„˜ì–´ <strong>ë°ì´í„° í’ˆì§ˆì˜ ìˆ˜í˜¸ì</strong> ì—­í• ì„ í•©ë‹ˆë‹¤. ì´ í¬ìŠ¤íŠ¸ì—ì„œëŠ” dbtì™€ ì£¼ìš” ë°ì´í„° í”Œë«í¼ë“¤ì„ í™œìš©í•œ ì™„ì „í•œ ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ë°©ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤.</p>

<hr />

<h2 id="-ëª©ì°¨">ğŸ¯ ëª©ì°¨</h2>

<ul>
  <li><a href="#dbtì™€-í˜„ëŒ€ì -ë°ì´í„°-ìŠ¤íƒ">dbtì™€ í˜„ëŒ€ì  ë°ì´í„° ìŠ¤íƒ</a></li>
  <li><a href="#dbt-ìƒíƒœê³„ì™€-ì£¼ìš”-í”Œë«í¼">dbt ìƒíƒœê³„ì™€ ì£¼ìš” í”Œë«í¼</a></li>
  <li><a href="#ë°ì´í„°-í’ˆì§ˆ-í…ŒìŠ¤íŠ¸-í”„ë ˆì„ì›Œí¬">ë°ì´í„° í’ˆì§ˆ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬</a></li>
  <li><a href="#ì‹¤ë¬´-ë°ì´í„°-í’ˆì§ˆ-íŒŒì´í”„ë¼ì¸-êµ¬ì¶•">ì‹¤ë¬´ ë°ì´í„° í’ˆì§ˆ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•</a></li>
  <li><a href="#ê³ ê¸‰-ë°ì´í„°-í’ˆì§ˆ-ì „ëµ">ê³ ê¸‰ ë°ì´í„° í’ˆì§ˆ ì „ëµ</a></li>
  <li><a href="#ì‹¤ìŠµ-ì™„ì „í•œ-dbt-ë°ì´í„°-í’ˆì§ˆ-ì‹œìŠ¤í…œ">ì‹¤ìŠµ: ì™„ì „í•œ dbt ë°ì´í„° í’ˆì§ˆ ì‹œìŠ¤í…œ</a></li>
</ul>

<hr />

<h2 id="dbtì™€-í˜„ëŒ€ì -ë°ì´í„°-ìŠ¤íƒ">ğŸ—ï¸ dbtì™€ í˜„ëŒ€ì  ë°ì´í„° ìŠ¤íƒ</h2>

<h3 id="dbtë€-ë¬´ì—‡ì¸ê°€">dbtë€ ë¬´ì—‡ì¸ê°€?</h3>

<p><strong>dbt (Data Build Tool)</strong>ëŠ” SQL ê¸°ë°˜ì˜ ë°ì´í„° ë³€í™˜ ë„êµ¬ë¡œ, í˜„ëŒ€ì  ë°ì´í„° ìŠ¤íƒì˜ í•µì‹¬ êµ¬ì„± ìš”ì†Œì…ë‹ˆë‹¤.</p>

<table>
  <thead>
    <tr>
      <th><strong>íŠ¹ì§•</strong></th>
      <th><strong>ì„¤ëª…</strong></th>
      <th><strong>ì¥ì </strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>SQL ì¤‘ì‹¬</strong></td>
      <td>Python/R ëŒ€ì‹  SQLë¡œ ë°ì´í„° ë³€í™˜</td>
      <td>ë¶„ì„ê°€ë„ ì‰½ê²Œ ì‚¬ìš© ê°€ëŠ¥</td>
    </tr>
    <tr>
      <td><strong>ë²„ì „ ê´€ë¦¬</strong></td>
      <td>Gitê³¼ ì—°ë™ëœ ì½”ë“œ ê´€ë¦¬</td>
      <td>í˜‘ì—… ë° ë³€ê²½ ì¶”ì  ìš©ì´</td>
    </tr>
    <tr>
      <td><strong>í…ŒìŠ¤íŠ¸ ìë™í™”</strong></td>
      <td>ë°ì´í„° í’ˆì§ˆ í…ŒìŠ¤íŠ¸ ë‚´ì¥</td>
      <td>í’ˆì§ˆ ë³´ì¥ ë° ì‹ ë¢°ì„± í–¥ìƒ</td>
    </tr>
    <tr>
      <td><strong>ë¬¸ì„œí™”</strong></td>
      <td>ìë™ ìƒì„±ë˜ëŠ” ë°ì´í„° ë¬¸ì„œ</td>
      <td>íŒ€ ê°„ ì†Œí†µ ê°œì„ </td>
    </tr>
    <tr>
      <td><strong>ëª¨ë“ˆí™”</strong></td>
      <td>ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ë§¤í¬ë¡œ</td>
      <td>ê°œë°œ íš¨ìœ¨ì„± ì¦ëŒ€</td>
    </tr>
  </tbody>
</table>

<h3 id="í˜„ëŒ€ì -ë°ì´í„°-ìŠ¤íƒì—ì„œì˜-dbt-ì—­í• ">í˜„ëŒ€ì  ë°ì´í„° ìŠ¤íƒì—ì„œì˜ dbt ì—­í• </h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Raw Data Sources â†’ Data Warehouse â†’ dbt Layer â†’ Analytics Layer
                                      â†“
                              Data Quality Tests
                                      â†“
                              Documentation
</code></pre></div></div>

<h3 id="ë°ì´í„°-í’ˆì§ˆì˜-ì¤‘ìš”ì„±">ë°ì´í„° í’ˆì§ˆì˜ ì¤‘ìš”ì„±</h3>

<p><strong>ë‚˜ìœ ë°ì´í„°ì˜ ë¹„ìš©</strong>ì€ ìƒìƒ ì´ìƒì…ë‹ˆë‹¤:</p>

<ul>
  <li><strong>ì˜ì‚¬ê²°ì • ì˜¤ë¥˜</strong>: ì˜ëª»ëœ ë°ì´í„°ë¡œ ì¸í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ì†ì‹¤</li>
  <li><strong>ì‹ ë¢°ë„ í•˜ë½</strong>: ë°ì´í„°ì— ëŒ€í•œ íŒ€ì˜ ì‹ ë¢° ìƒì‹¤</li>
  <li><strong>ê°œë°œ ì§€ì—°</strong>: ë°ì´í„° ë¬¸ì œ í•´ê²°ì— ì†Œìš”ë˜ëŠ” ì‹œê°„</li>
  <li><strong>ê·œì • ì¤€ìˆ˜ ìœ„í—˜</strong>: ë°ì´í„° ê±°ë²„ë„ŒìŠ¤ ì´ìŠˆ</li>
</ul>

<hr />

<h2 id="dbt-ìƒíƒœê³„ì™€-ì£¼ìš”-í”Œë«í¼">ğŸŒ dbt ìƒíƒœê³„ì™€ ì£¼ìš” í”Œë«í¼</h2>

<h3 id="ì£¼ìš”-ë°ì´í„°-ì›¨ì–´í•˜ìš°ìŠ¤-í”Œë«í¼">ì£¼ìš” ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ í”Œë«í¼</h3>

<h4 id="1-snowflake">1. <strong>Snowflake</strong></h4>
<ul>
  <li><strong>íŠ¹ì§•</strong>: í´ë¼ìš°ë“œ ë„¤ì´í‹°ë¸Œ, ìë™ ìŠ¤ì¼€ì¼ë§</li>
  <li><strong>dbt í†µí•©</strong>: ì™„ë²½í•œ ì§€ì›, ìµœì í™”ëœ ì»¤ë„¥í„°</li>
  <li><strong>ì¥ì </strong>: ì„±ëŠ¥ ìš°ìˆ˜, ì‚¬ìš© í¸ì˜ì„±</li>
</ul>

<h4 id="2-google-bigquery">2. <strong>Google BigQuery</strong></h4>
<ul>
  <li><strong>íŠ¹ì§•</strong>: ì„œë²„ë¦¬ìŠ¤, í˜íƒ€ë°”ì´íŠ¸ ìŠ¤ì¼€ì¼</li>
  <li><strong>dbt í†µí•©</strong>: ë„¤ì´í‹°ë¸Œ ì§€ì›, ë¹ ë¥¸ ì¿¼ë¦¬</li>
  <li><strong>ì¥ì </strong>: ë¹„ìš© íš¨ìœ¨ì„±, ë¨¸ì‹ ëŸ¬ë‹ í†µí•©</li>
</ul>

<h4 id="3-amazon-redshift">3. <strong>Amazon Redshift</strong></h4>
<ul>
  <li><strong>íŠ¹ì§•</strong>: í´ëŸ¬ìŠ¤í„° ê¸°ë°˜, ë†’ì€ ì„±ëŠ¥</li>
  <li><strong>dbt í†µí•©</strong>: ì•ˆì •ì ì¸ ì§€ì›, ë‹¤ì–‘í•œ ì˜µì…˜</li>
  <li><strong>ì¥ì </strong>: AWS ìƒíƒœê³„ í†µí•©, ì„±ìˆ™í•œ í”Œë«í¼</li>
</ul>

<h4 id="4-databricks">4. <strong>Databricks</strong></h4>
<ul>
  <li><strong>íŠ¹ì§•</strong>: ë ˆì´í¬í•˜ìš°ìŠ¤, ë¨¸ì‹ ëŸ¬ë‹ í†µí•©</li>
  <li><strong>dbt í†µí•©</strong>: Unity Catalog ì§€ì›</li>
  <li><strong>ì¥ì </strong>: ë°ì´í„° ë ˆì´í¬ + ì›¨ì–´í•˜ìš°ìŠ¤ í†µí•©</li>
</ul>

<h3 id="dbt-ì‹¤í–‰-í™˜ê²½-ë¹„êµ">dbt ì‹¤í–‰ í™˜ê²½ ë¹„êµ</h3>

<table>
  <thead>
    <tr>
      <th><strong>í™˜ê²½</strong></th>
      <th><strong>íŠ¹ì§•</strong></th>
      <th><strong>ì¥ì </strong></th>
      <th><strong>ë‹¨ì </strong></th>
      <th><strong>ì í•©í•œ ê²½ìš°</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>dbt Cloud</strong></td>
      <td>í´ë¼ìš°ë“œ ê¸°ë°˜ SaaS</td>
      <td>ì„¤ì • ê°„í¸, UI ì œê³µ</td>
      <td>ë¹„ìš© ë°œìƒ</td>
      <td>ì¤‘ì†Œê·œëª¨ íŒ€, ë¹ ë¥¸ ì‹œì‘</td>
    </tr>
    <tr>
      <td><strong>dbt Core</strong></td>
      <td>ì˜¤í”ˆì†ŒìŠ¤, ë¡œì»¬ ì‹¤í–‰</td>
      <td>ë¬´ë£Œ, ì»¤ìŠ¤í„°ë§ˆì´ì§•</td>
      <td>ì„¤ì • ë³µì¡</td>
      <td>ëŒ€ê·œëª¨ íŒ€, ê³ ë„í™” í•„ìš”</td>
    </tr>
  </tbody>
</table>

<hr />

<h2 id="ë°ì´í„°-í’ˆì§ˆ-í…ŒìŠ¤íŠ¸-í”„ë ˆì„ì›Œí¬">ğŸ§ª ë°ì´í„° í’ˆì§ˆ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬</h2>

<h3 id="ê¸°ë³¸-í…ŒìŠ¤íŠ¸-generic-tests">ê¸°ë³¸ í…ŒìŠ¤íŠ¸ (Generic Tests)</h3>

<h4 id="1-not_null-null-ê°’-ê²€ì¦">1. <strong>not_null</strong>: NULL ê°’ ê²€ì¦</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models/schema.yml</span>
<span class="na">models</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">users</span>
    <span class="na">columns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user_id</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">email</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
</code></pre></div></div>

<h4 id="2-unique-ì¤‘ë³µ-ê°’-ê²€ì¦">2. <strong>unique</strong>: ì¤‘ë³µ ê°’ ê²€ì¦</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">models</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">users</span>
    <span class="na">columns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user_id</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">unique</span>
          <span class="pi">-</span> <span class="s">not_null</span>
</code></pre></div></div>

<h4 id="3-accepted_values-í—ˆìš©-ê°’-ê²€ì¦">3. <strong>accepted_values</strong>: í—ˆìš© ê°’ ê²€ì¦</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">models</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">orders</span>
    <span class="na">columns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">status</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">accepted_values</span><span class="pi">:</span>
              <span class="na">values</span><span class="pi">:</span> <span class="pi">[</span><span class="s1">'</span><span class="s">pending'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">completed'</span><span class="pi">,</span> <span class="s1">'</span><span class="s">cancelled'</span><span class="pi">]</span>
</code></pre></div></div>

<h4 id="4-relationships-ì°¸ì¡°-ë¬´ê²°ì„±-ê²€ì¦">4. <strong>relationships</strong>: ì°¸ì¡° ë¬´ê²°ì„± ê²€ì¦</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">models</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">orders</span>
    <span class="na">columns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user_id</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">relationships</span><span class="pi">:</span>
              <span class="na">to</span><span class="pi">:</span> <span class="s">ref('users')</span>
              <span class="na">field</span><span class="pi">:</span> <span class="s">user_id</span>
</code></pre></div></div>

<h3 id="ì»¤ìŠ¤í…€-í…ŒìŠ¤íŠ¸-custom-tests">ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ (Custom Tests)</h3>

<h4 id="1-ë‹¨ì¼-í…ŒìŠ¤íŠ¸-íŒŒì¼">1. <strong>ë‹¨ì¼ í…ŒìŠ¤íŠ¸ íŒŒì¼</strong></h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- tests/assert_positive_amount.sql</span>
<span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'orders'</span><span class="p">)</span>
<span class="k">where</span> <span class="n">amount</span> <span class="o">&lt;=</span> <span class="mi">0</span>
</code></pre></div></div>

<h4 id="2-ë§¤í¬ë¡œ-ê¸°ë°˜-í…ŒìŠ¤íŠ¸">2. <strong>ë§¤í¬ë¡œ ê¸°ë°˜ í…ŒìŠ¤íŠ¸</strong></h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- macros/test_positive_values.sql</span>
<span class="n">test</span> <span class="n">positive_values</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="k">column_name</span><span class="p">)</span>
  <span class="k">select</span> <span class="o">*</span>
  <span class="k">from</span> <span class="n">model</span>
  <span class="k">where</span> <span class="k">column_name</span> <span class="o">&lt;=</span> <span class="mi">0</span>
<span class="n">endtest</span>
</code></pre></div></div>

<h4 id="3-ê³ ê¸‰-ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§-í…ŒìŠ¤íŠ¸">3. <strong>ê³ ê¸‰ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í…ŒìŠ¤íŠ¸</strong></h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- tests/assert_revenue_consistency.sql</span>
<span class="k">with</span> <span class="n">daily_revenue</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="n">date_trunc</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span> <span class="n">created_at</span><span class="p">)</span> <span class="k">as</span> <span class="nb">date</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_revenue</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'orders'</span><span class="p">)</span>
  <span class="k">where</span> <span class="n">status</span> <span class="o">=</span> <span class="s1">'completed'</span>
  <span class="k">group</span> <span class="k">by</span> <span class="mi">1</span>
<span class="p">),</span>
<span class="n">revenue_changes</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="o">*</span><span class="p">,</span>
    <span class="n">lag</span><span class="p">(</span><span class="n">total_revenue</span><span class="p">)</span> <span class="n">over</span> <span class="p">(</span><span class="k">order</span> <span class="k">by</span> <span class="nb">date</span><span class="p">)</span> <span class="k">as</span> <span class="n">prev_revenue</span><span class="p">,</span>
    <span class="k">abs</span><span class="p">(</span><span class="n">total_revenue</span> <span class="o">-</span> <span class="n">lag</span><span class="p">(</span><span class="n">total_revenue</span><span class="p">)</span> <span class="n">over</span> <span class="p">(</span><span class="k">order</span> <span class="k">by</span> <span class="nb">date</span><span class="p">))</span> <span class="o">/</span> 
    <span class="n">lag</span><span class="p">(</span><span class="n">total_revenue</span><span class="p">)</span> <span class="n">over</span> <span class="p">(</span><span class="k">order</span> <span class="k">by</span> <span class="nb">date</span><span class="p">)</span> <span class="k">as</span> <span class="n">change_rate</span>
  <span class="k">from</span> <span class="n">daily_revenue</span>
<span class="p">)</span>
<span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="n">revenue_changes</span>
<span class="k">where</span> <span class="n">change_rate</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span>  <span class="c1">-- 50% ì´ìƒ ê¸‰ê²©í•œ ë³€í™”</span>
</code></pre></div></div>

<h3 id="í…ŒìŠ¤íŠ¸-ì‹¤í–‰-ë°-ëª¨ë‹ˆí„°ë§">í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë° ëª¨ë‹ˆí„°ë§</h3>

<h4 id="í…ŒìŠ¤íŠ¸-ì‹¤í–‰-ëª…ë ¹ì–´">í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ëª…ë ¹ì–´</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰</span>
dbt <span class="nb">test</span>

<span class="c"># íŠ¹ì • ëª¨ë¸ í…ŒìŠ¤íŠ¸ë§Œ ì‹¤í–‰</span>
dbt <span class="nb">test</span> <span class="nt">--models</span> <span class="nb">users</span>

<span class="c"># í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥</span>
dbt <span class="nb">test</span> <span class="nt">--store-failures</span>
</code></pre></div></div>

<hr />

<h2 id="ì‹¤ë¬´-ë°ì´í„°-í’ˆì§ˆ-íŒŒì´í”„ë¼ì¸-êµ¬ì¶•">ğŸ­ ì‹¤ë¬´ ë°ì´í„° í’ˆì§ˆ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•</h2>

<h3 id="1-í”„ë¡œì íŠ¸-êµ¬ì¡°-ì„¤ê³„">1. í”„ë¡œì íŠ¸ êµ¬ì¡° ì„¤ê³„</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dbt_project/
â”œâ”€â”€ dbt_project.yml
â”œâ”€â”€ profiles.yml
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ staging/
â”‚   â”‚   â”œâ”€â”€ stg_users.sql
â”‚   â”‚   â”œâ”€â”€ stg_orders.sql
â”‚   â”‚   â””â”€â”€ schema.yml
â”‚   â”œâ”€â”€ intermediate/
â”‚   â”‚   â”œâ”€â”€ int_user_metrics.sql
â”‚   â”‚   â””â”€â”€ schema.yml
â”‚   â”œâ”€â”€ marts/
â”‚   â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”‚   â”œâ”€â”€ dim_users.sql
â”‚   â”‚   â”‚   â”œâ”€â”€ fact_orders.sql
â”‚   â”‚   â”‚   â””â”€â”€ schema.yml
â”‚   â”‚   â””â”€â”€ marketing/
â”‚   â”‚       â”œâ”€â”€ user_segments.sql
â”‚   â”‚       â””â”€â”€ schema.yml
â”‚   â””â”€â”€ data_quality/
â”‚       â”œâ”€â”€ dq_summary.sql
â”‚       â””â”€â”€ dq_alerts.sql
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ assert_positive_amounts.sql
â”‚   â””â”€â”€ assert_business_rules.sql
â”œâ”€â”€ macros/
â”‚   â”œâ”€â”€ test_positive_values.sql
â”‚   â””â”€â”€ generate_schema_name.sql
â””â”€â”€ snapshots/
    â””â”€â”€ users_snapshot.sql
</code></pre></div></div>

<h3 id="2-ë°ì´í„°-í’ˆì§ˆ-ë©”íŠ¸ë¦­-ì •ì˜">2. ë°ì´í„° í’ˆì§ˆ ë©”íŠ¸ë¦­ ì •ì˜</h3>

<h4 id="í’ˆì§ˆ-ë©”íŠ¸ë¦­-ë¶„ë¥˜">í’ˆì§ˆ ë©”íŠ¸ë¦­ ë¶„ë¥˜</h4>

<table>
  <thead>
    <tr>
      <th><strong>ë©”íŠ¸ë¦­ ì¹´í…Œê³ ë¦¬</strong></th>
      <th><strong>ì¸¡ì • í•­ëª©</strong></th>
      <th><strong>ëª©í‘œ</strong></th>
      <th><strong>ì„ê³„ê°’</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>ì™„ì „ì„±</strong></td>
      <td>NULL ê°’ ë¹„ìœ¨</td>
      <td>&lt; 5%</td>
      <td>5%</td>
    </tr>
    <tr>
      <td><strong>ì •í™•ì„±</strong></td>
      <td>ë°ì´í„° ê²€ì¦ ì‹¤íŒ¨ìœ¨</td>
      <td>&lt; 1%</td>
      <td>1%</td>
    </tr>
    <tr>
      <td><strong>ì¼ê´€ì„±</strong></td>
      <td>ì°¸ì¡° ë¬´ê²°ì„± ìœ„ë°˜</td>
      <td>0%</td>
      <td>0%</td>
    </tr>
    <tr>
      <td><strong>ì ì‹œì„±</strong></td>
      <td>ë°ì´í„° ì§€ì—° ì‹œê°„</td>
      <td>&lt; 1ì‹œê°„</td>
      <td>1ì‹œê°„</td>
    </tr>
    <tr>
      <td><strong>ìœ íš¨ì„±</strong></td>
      <td>í˜•ì‹ ì˜¤ë¥˜ ë¹„ìœ¨</td>
      <td>&lt; 2%</td>
      <td>2%</td>
    </tr>
  </tbody>
</table>

<h3 id="3-ì‹¤ì‹œê°„-í’ˆì§ˆ-ëª¨ë‹ˆí„°ë§">3. ì‹¤ì‹œê°„ í’ˆì§ˆ ëª¨ë‹ˆí„°ë§</h3>

<h4 id="ì•Œë¦¼-ì‹œìŠ¤í…œ-êµ¬ì¶•">ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- models/data_quality/dq_alerts.sql</span>
<span class="k">with</span> <span class="n">quality_violations</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="s1">'high_null_rate'</span> <span class="k">as</span> <span class="n">alert_type</span><span class="p">,</span>
    <span class="s1">'stg_users'</span> <span class="k">as</span> <span class="k">table_name</span><span class="p">,</span>
    <span class="s1">'user_id'</span> <span class="k">as</span> <span class="k">column_name</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">violation_count</span><span class="p">,</span>
    <span class="k">current_timestamp</span> <span class="k">as</span> <span class="n">detected_at</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_users'</span><span class="p">)</span>
  <span class="k">where</span> <span class="n">user_id</span> <span class="k">is</span> <span class="k">null</span>
  <span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span>
  
  <span class="k">union</span> <span class="k">all</span>
  
  <span class="k">select</span> 
    <span class="s1">'invalid_email_format'</span> <span class="k">as</span> <span class="n">alert_type</span><span class="p">,</span>
    <span class="s1">'stg_users'</span> <span class="k">as</span> <span class="k">table_name</span><span class="p">,</span>
    <span class="s1">'email'</span> <span class="k">as</span> <span class="k">column_name</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">violation_count</span><span class="p">,</span>
    <span class="k">current_timestamp</span> <span class="k">as</span> <span class="n">detected_at</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_users'</span><span class="p">)</span>
  <span class="k">where</span> <span class="n">email</span> <span class="k">not</span> <span class="k">like</span> <span class="s1">'%@%'</span>
  <span class="k">having</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">50</span>
<span class="p">)</span>

<span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="n">quality_violations</span>
<span class="k">where</span> <span class="n">violation_count</span> <span class="o">&gt;</span> <span class="mi">0</span>
</code></pre></div></div>

<hr />

<h2 id="ê³ ê¸‰-ë°ì´í„°-í’ˆì§ˆ-ì „ëµ">ğŸš€ ê³ ê¸‰ ë°ì´í„° í’ˆì§ˆ ì „ëµ</h2>

<h3 id="1-ë°ì´í„°-ë“œë¦¬í”„íŠ¸-ê°ì§€">1. ë°ì´í„° ë“œë¦¬í”„íŠ¸ ê°ì§€</h3>

<h4 id="í†µê³„ì -ë“œë¦¬í”„íŠ¸-ê°ì§€">í†µê³„ì  ë“œë¦¬í”„íŠ¸ ê°ì§€</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- models/data_quality/drift_detection.sql</span>
<span class="k">with</span> <span class="n">current_stats</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="k">avg</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">mean_amount</span><span class="p">,</span>
    <span class="n">stddev</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">std_amount</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">record_count</span><span class="p">,</span>
    <span class="k">current_date</span> <span class="k">as</span> <span class="n">measurement_date</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'fact_orders'</span><span class="p">)</span>
  <span class="k">where</span> <span class="n">created_at</span> <span class="o">&gt;=</span> <span class="k">current_date</span> <span class="o">-</span> <span class="mi">7</span>
<span class="p">),</span>
<span class="n">historical_stats</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="k">avg</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">mean_amount</span><span class="p">,</span>
    <span class="n">stddev</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">std_amount</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">record_count</span><span class="p">,</span>
    <span class="k">current_date</span> <span class="o">-</span> <span class="mi">7</span> <span class="k">as</span> <span class="n">measurement_date</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'fact_orders'</span><span class="p">)</span>
  <span class="k">where</span> <span class="n">created_at</span> <span class="o">&gt;=</span> <span class="k">current_date</span> <span class="o">-</span> <span class="mi">14</span>
    <span class="k">and</span> <span class="n">created_at</span> <span class="o">&lt;</span> <span class="k">current_date</span> <span class="o">-</span> <span class="mi">7</span>
<span class="p">),</span>
<span class="n">drift_analysis</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="k">c</span><span class="p">.</span><span class="n">mean_amount</span> <span class="k">as</span> <span class="n">current_mean</span><span class="p">,</span>
    <span class="n">h</span><span class="p">.</span><span class="n">mean_amount</span> <span class="k">as</span> <span class="n">historical_mean</span><span class="p">,</span>
    <span class="k">abs</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">mean_amount</span> <span class="o">-</span> <span class="n">h</span><span class="p">.</span><span class="n">mean_amount</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span><span class="p">.</span><span class="n">mean_amount</span> <span class="k">as</span> <span class="n">mean_drift_ratio</span><span class="p">,</span>
    <span class="k">c</span><span class="p">.</span><span class="n">std_amount</span> <span class="k">as</span> <span class="n">current_std</span><span class="p">,</span>
    <span class="n">h</span><span class="p">.</span><span class="n">std_amount</span> <span class="k">as</span> <span class="n">historical_std</span><span class="p">,</span>
    <span class="k">abs</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">std_amount</span> <span class="o">-</span> <span class="n">h</span><span class="p">.</span><span class="n">std_amount</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span><span class="p">.</span><span class="n">std_amount</span> <span class="k">as</span> <span class="n">std_drift_ratio</span><span class="p">,</span>
    <span class="k">c</span><span class="p">.</span><span class="n">record_count</span> <span class="k">as</span> <span class="n">current_count</span><span class="p">,</span>
    <span class="n">h</span><span class="p">.</span><span class="n">record_count</span> <span class="k">as</span> <span class="n">historical_count</span><span class="p">,</span>
    <span class="k">abs</span><span class="p">(</span><span class="k">c</span><span class="p">.</span><span class="n">record_count</span> <span class="o">-</span> <span class="n">h</span><span class="p">.</span><span class="n">record_count</span><span class="p">)</span> <span class="o">/</span> <span class="n">h</span><span class="p">.</span><span class="n">record_count</span> <span class="k">as</span> <span class="n">count_drift_ratio</span>
  <span class="k">from</span> <span class="n">current_stats</span> <span class="k">c</span>
  <span class="k">cross</span> <span class="k">join</span> <span class="n">historical_stats</span> <span class="n">h</span>
<span class="p">)</span>

<span class="k">select</span> 
  <span class="o">*</span><span class="p">,</span>
  <span class="k">case</span> 
    <span class="k">when</span> <span class="n">mean_drift_ratio</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2</span> <span class="k">or</span> <span class="n">std_drift_ratio</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3</span> <span class="k">or</span> <span class="n">count_drift_ratio</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5</span> 
    <span class="k">then</span> <span class="s1">'drift_detected'</span>
    <span class="k">else</span> <span class="s1">'normal'</span>
  <span class="k">end</span> <span class="k">as</span> <span class="n">drift_status</span>
<span class="k">from</span> <span class="n">drift_analysis</span>
</code></pre></div></div>

<h3 id="2-ìë™í™”ëœ-í’ˆì§ˆ-ê´€ë¦¬">2. ìë™í™”ëœ í’ˆì§ˆ ê´€ë¦¬</h3>

<h4 id="cicd-íŒŒì´í”„ë¼ì¸-í†µí•©">CI/CD íŒŒì´í”„ë¼ì¸ í†µí•©</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># .github/workflows/dbt-quality-check.yml</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">dbt Data Quality Check</span>

<span class="na">on</span><span class="pi">:</span>
  <span class="na">pull_request</span><span class="pi">:</span>
    <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">models/**'</span>
      <span class="pi">-</span> <span class="s1">'</span><span class="s">tests/**'</span>

<span class="na">jobs</span><span class="pi">:</span>
  <span class="na">quality-check</span><span class="pi">:</span>
    <span class="na">runs-on</span><span class="pi">:</span> <span class="s">ubuntu-latest</span>
    
    <span class="na">steps</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/checkout@v2</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Set up Python</span>
      <span class="na">uses</span><span class="pi">:</span> <span class="s">actions/setup-python@v2</span>
      <span class="na">with</span><span class="pi">:</span>
        <span class="na">python-version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">3.8'</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Install dbt</span>
      <span class="na">run</span><span class="pi">:</span> <span class="s">pip install dbt-snowflake</span>
    
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Run dbt tests</span>
      <span class="na">run</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">dbt deps</span>
        <span class="s">dbt test --store-failures</span>
</code></pre></div></div>

<h3 id="3-íŒ€-í˜‘ì—…ê³¼-ê±°ë²„ë„ŒìŠ¤">3. íŒ€ í˜‘ì—…ê³¼ ê±°ë²„ë„ŒìŠ¤</h3>

<h4 id="ë°ì´í„°-ê³„ì•½-data-contracts">ë°ì´í„° ê³„ì•½ (Data Contracts)</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models/schema.yml</span>
<span class="na">models</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">users</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">User</span><span class="nv"> </span><span class="s">dimension</span><span class="nv"> </span><span class="s">table</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">complete</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">information"</span>
    <span class="na">columns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user_id</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Unique</span><span class="nv"> </span><span class="s">identifier</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">each</span><span class="nv"> </span><span class="s">user"</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
          <span class="pi">-</span> <span class="s">unique</span>
        <span class="na">data_type</span><span class="pi">:</span> <span class="s">integer</span>
      
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">email</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">User's</span><span class="nv"> </span><span class="s">email</span><span class="nv"> </span><span class="s">address"</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
          <span class="pi">-</span> <span class="s">not_empty_string</span>
        <span class="na">data_type</span><span class="pi">:</span> <span class="s">string</span>
      
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">created_at</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Timestamp</span><span class="nv"> </span><span class="s">when</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">was</span><span class="nv"> </span><span class="s">created"</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
        <span class="na">data_type</span><span class="pi">:</span> <span class="s">timestamp</span>
</code></pre></div></div>

<hr />

<h2 id="ì‹¤ìŠµ-ì™„ì „í•œ-dbt-ë°ì´í„°-í’ˆì§ˆ-ì‹œìŠ¤í…œ">ğŸ› ï¸ ì‹¤ìŠµ: ì™„ì „í•œ dbt ë°ì´í„° í’ˆì§ˆ ì‹œìŠ¤í…œ</h2>

<h3 id="1-snowflake--dbt-cloud-ì„¤ì •">1. Snowflake + dbt Cloud ì„¤ì •</h3>

<h4 id="í”„ë¡œì íŠ¸-ì´ˆê¸°-ì„¤ì •">í”„ë¡œì íŠ¸ ì´ˆê¸° ì„¤ì •</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># dbt_project.yml</span>
<span class="na">name</span><span class="pi">:</span> <span class="s1">'</span><span class="s">ecommerce_data_quality'</span>
<span class="na">version</span><span class="pi">:</span> <span class="s1">'</span><span class="s">1.0.0'</span>
<span class="na">config-version</span><span class="pi">:</span> <span class="m">2</span>

<span class="na">profile</span><span class="pi">:</span> <span class="s1">'</span><span class="s">snowflake_ecommerce'</span>

<span class="na">model-paths</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">models"</span><span class="pi">]</span>
<span class="na">analysis-paths</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">analysis"</span><span class="pi">]</span>
<span class="na">test-paths</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">tests"</span><span class="pi">]</span>
<span class="na">seed-paths</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">data"</span><span class="pi">]</span>
<span class="na">macro-paths</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">macros"</span><span class="pi">]</span>
<span class="na">snapshot-paths</span><span class="pi">:</span> <span class="pi">[</span><span class="s2">"</span><span class="s">snapshots"</span><span class="pi">]</span>

<span class="na">target-path</span><span class="pi">:</span> <span class="s2">"</span><span class="s">target"</span>
<span class="na">clean-targets</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">target"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">dbt_packages"</span>

<span class="na">models</span><span class="pi">:</span>
  <span class="na">ecommerce_data_quality</span><span class="pi">:</span>
    <span class="na">staging</span><span class="pi">:</span>
      <span class="na">materialized</span><span class="pi">:</span> <span class="s">view</span>
    <span class="na">intermediate</span><span class="pi">:</span>
      <span class="na">materialized</span><span class="pi">:</span> <span class="s">view</span>
    <span class="na">marts</span><span class="pi">:</span>
      <span class="na">materialized</span><span class="pi">:</span> <span class="s">table</span>
    <span class="na">data_quality</span><span class="pi">:</span>
      <span class="na">materialized</span><span class="pi">:</span> <span class="s">table</span>

<span class="na">tests</span><span class="pi">:</span>
  <span class="na">store_failures</span><span class="pi">:</span> <span class="kc">true</span>
</code></pre></div></div>

<h3 id="2-ì‹¤ë¬´-ë°ì´í„°-ëª¨ë¸ë§-ì˜ˆì œ">2. ì‹¤ë¬´ ë°ì´í„° ëª¨ë¸ë§ ì˜ˆì œ</h3>

<h4 id="ìŠ¤í…Œì´ì§•-ëª¨ë¸">ìŠ¤í…Œì´ì§• ëª¨ë¸</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- models/staging/stg_users.sql</span>
<span class="k">select</span> 
  <span class="n">user_id</span><span class="p">,</span>
  <span class="n">email</span><span class="p">,</span>
  <span class="n">first_name</span><span class="p">,</span>
  <span class="n">last_name</span><span class="p">,</span>
  <span class="n">phone</span><span class="p">,</span>
  <span class="n">created_at</span><span class="p">,</span>
  <span class="n">updated_at</span><span class="p">,</span>
  <span class="n">is_active</span>
<span class="k">from</span> <span class="k">source</span><span class="p">(</span><span class="s1">'raw_data'</span><span class="p">,</span> <span class="s1">'users'</span><span class="p">)</span>
<span class="k">where</span> <span class="n">created_at</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span>
</code></pre></div></div>

<h4 id="ì¤‘ê°„-ëª¨ë¸">ì¤‘ê°„ ëª¨ë¸</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- models/intermediate/int_user_orders.sql</span>
<span class="k">with</span> <span class="n">user_orders</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="n">u</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
    <span class="n">u</span><span class="p">.</span><span class="n">email</span><span class="p">,</span>
    <span class="n">u</span><span class="p">.</span><span class="n">created_at</span> <span class="k">as</span> <span class="n">user_created_at</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_orders</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_spent</span><span class="p">,</span>
    <span class="k">avg</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_order_value</span><span class="p">,</span>
    <span class="k">max</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">created_at</span><span class="p">)</span> <span class="k">as</span> <span class="n">last_order_date</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_users'</span><span class="p">)</span> <span class="n">u</span>
  <span class="k">left</span> <span class="k">join</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_orders'</span><span class="p">)</span> <span class="n">o</span> <span class="k">on</span> <span class="n">u</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">user_id</span>
  <span class="k">group</span> <span class="k">by</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
<span class="p">)</span>

<span class="k">select</span> 
  <span class="o">*</span><span class="p">,</span>
  <span class="k">case</span> 
    <span class="k">when</span> <span class="n">total_spent</span> <span class="o">&gt;</span> <span class="mi">1000</span> <span class="k">then</span> <span class="s1">'high_value'</span>
    <span class="k">when</span> <span class="n">total_spent</span> <span class="o">&gt;</span> <span class="mi">500</span> <span class="k">then</span> <span class="s1">'medium_value'</span>
    <span class="k">else</span> <span class="s1">'low_value'</span>
  <span class="k">end</span> <span class="k">as</span> <span class="n">customer_segment</span><span class="p">,</span>
  
  <span class="k">case</span> 
    <span class="k">when</span> <span class="n">last_order_date</span> <span class="o">&gt;=</span> <span class="k">current_date</span> <span class="o">-</span> <span class="mi">30</span> <span class="k">then</span> <span class="s1">'active'</span>
    <span class="k">when</span> <span class="n">last_order_date</span> <span class="o">&gt;=</span> <span class="k">current_date</span> <span class="o">-</span> <span class="mi">90</span> <span class="k">then</span> <span class="s1">'at_risk'</span>
    <span class="k">else</span> <span class="s1">'inactive'</span>
  <span class="k">end</span> <span class="k">as</span> <span class="n">customer_status</span>
<span class="k">from</span> <span class="n">user_orders</span>
</code></pre></div></div>

<h4 id="ë§ˆíŠ¸-ëª¨ë¸">ë§ˆíŠ¸ ëª¨ë¸</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- models/marts/core/dim_users.sql</span>
<span class="k">select</span> 
  <span class="n">user_id</span><span class="p">,</span>
  <span class="n">email</span><span class="p">,</span>
  <span class="n">first_name</span><span class="p">,</span>
  <span class="n">last_name</span><span class="p">,</span>
  <span class="n">phone</span><span class="p">,</span>
  <span class="n">user_created_at</span><span class="p">,</span>
  <span class="n">total_orders</span><span class="p">,</span>
  <span class="n">total_spent</span><span class="p">,</span>
  <span class="n">avg_order_value</span><span class="p">,</span>
  <span class="n">customer_segment</span><span class="p">,</span>
  <span class="n">customer_status</span><span class="p">,</span>
  <span class="k">current_timestamp</span> <span class="k">as</span> <span class="n">dbt_updated_at</span>
<span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'int_user_orders'</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="3-í¬ê´„ì ì¸-í…ŒìŠ¤íŠ¸-ìŠ¤ìœ„íŠ¸">3. í¬ê´„ì ì¸ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸</h3>

<h4 id="ìŠ¤í‚¤ë§ˆ-í…ŒìŠ¤íŠ¸">ìŠ¤í‚¤ë§ˆ í…ŒìŠ¤íŠ¸</h4>
<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># models/staging/schema.yml</span>
<span class="na">version</span><span class="pi">:</span> <span class="m">2</span>

<span class="na">sources</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">raw_data</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Raw</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">source</span><span class="nv"> </span><span class="s">systems"</span>
    <span class="na">tables</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">users</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Raw</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">data"</span>
        <span class="na">columns</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user_id</span>
            <span class="na">tests</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s">not_null</span>
              <span class="pi">-</span> <span class="s">unique</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">email</span>
            <span class="na">tests</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s">not_null</span>
              <span class="pi">-</span> <span class="s">not_empty_string</span>
          <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">created_at</span>
            <span class="na">tests</span><span class="pi">:</span>
              <span class="pi">-</span> <span class="s">not_null</span>

<span class="na">models</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">stg_users</span>
    <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Cleaned</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">data</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">staging</span><span class="nv"> </span><span class="s">layer"</span>
    <span class="na">columns</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">user_id</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Unique</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">identifier"</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
          <span class="pi">-</span> <span class="s">unique</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">email</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">User</span><span class="nv"> </span><span class="s">email</span><span class="nv"> </span><span class="s">address"</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
          <span class="pi">-</span> <span class="s">not_empty_string</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">is_active</span>
        <span class="na">description</span><span class="pi">:</span> <span class="s2">"</span><span class="s">User</span><span class="nv"> </span><span class="s">active</span><span class="nv"> </span><span class="s">status"</span>
        <span class="na">tests</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">not_null</span>
          <span class="pi">-</span> <span class="na">accepted_values</span><span class="pi">:</span>
              <span class="na">values</span><span class="pi">:</span> <span class="pi">[</span><span class="nv">true</span><span class="pi">,</span> <span class="nv">false</span><span class="pi">]</span>
</code></pre></div></div>

<h4 id="ë¹„ì¦ˆë‹ˆìŠ¤-ë¡œì§-í…ŒìŠ¤íŠ¸">ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í…ŒìŠ¤íŠ¸</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- tests/assert_positive_order_amounts.sql</span>
<span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_orders'</span><span class="p">)</span>
<span class="k">where</span> <span class="n">amount</span> <span class="o">&lt;=</span> <span class="mi">0</span>
</code></pre></div></div>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- tests/assert_user_order_consistency.sql</span>
<span class="k">with</span> <span class="n">user_order_check</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="n">u</span><span class="p">.</span><span class="n">user_id</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="k">distinct</span> <span class="n">o</span><span class="p">.</span><span class="n">order_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">order_count</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="n">amount</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_amount</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_users'</span><span class="p">)</span> <span class="n">u</span>
  <span class="k">left</span> <span class="k">join</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'stg_orders'</span><span class="p">)</span> <span class="n">o</span> <span class="k">on</span> <span class="n">u</span><span class="p">.</span><span class="n">user_id</span> <span class="o">=</span> <span class="n">o</span><span class="p">.</span><span class="n">user_id</span>
  <span class="k">group</span> <span class="k">by</span> <span class="mi">1</span>
<span class="p">)</span>

<span class="k">select</span> <span class="o">*</span>
<span class="k">from</span> <span class="n">user_order_check</span>
<span class="k">where</span> <span class="n">total_amount</span> <span class="o">&lt;</span> <span class="mi">0</span>
   <span class="k">or</span> <span class="n">order_count</span> <span class="o">&lt;</span> <span class="mi">0</span>
</code></pre></div></div>

<h3 id="4-ë°ì´í„°-í’ˆì§ˆ-ëª¨ë‹ˆí„°ë§-ëŒ€ì‹œë³´ë“œ">4. ë°ì´í„° í’ˆì§ˆ ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ</h3>

<h4 id="í’ˆì§ˆ-ë©”íŠ¸ë¦­-ì§‘ê³„">í’ˆì§ˆ ë©”íŠ¸ë¦­ ì§‘ê³„</h4>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">-- models/data_quality/quality_metrics_summary.sql</span>
<span class="k">with</span> <span class="n">test_results</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="n">node_name</span><span class="p">,</span>
    <span class="n">status</span><span class="p">,</span>
    <span class="n">execution_time</span><span class="p">,</span>
    <span class="n">rows_affected</span><span class="p">,</span>
    <span class="n">created_at</span>
  <span class="k">from</span> <span class="k">ref</span><span class="p">(</span><span class="s1">'test_results'</span><span class="p">)</span>
  <span class="k">where</span> <span class="n">created_at</span> <span class="o">&gt;=</span> <span class="k">current_date</span> <span class="o">-</span> <span class="mi">7</span>
<span class="p">),</span>

<span class="n">daily_metrics</span> <span class="k">as</span> <span class="p">(</span>
  <span class="k">select</span> 
    <span class="n">date_trunc</span><span class="p">(</span><span class="s1">'day'</span><span class="p">,</span> <span class="n">created_at</span><span class="p">)</span> <span class="k">as</span> <span class="nb">date</span><span class="p">,</span>
    <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">as</span> <span class="n">total_tests</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">status</span> <span class="o">=</span> <span class="s1">'pass'</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">end</span><span class="p">)</span> <span class="k">as</span> <span class="n">passed_tests</span><span class="p">,</span>
    <span class="k">sum</span><span class="p">(</span><span class="k">case</span> <span class="k">when</span> <span class="n">status</span> <span class="o">=</span> <span class="s1">'fail'</span> <span class="k">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">end</span><span class="p">)</span> <span class="k">as</span> <span class="n">failed_tests</span><span class="p">,</span>
    <span class="k">avg</span><span class="p">(</span><span class="n">execution_time</span><span class="p">)</span> <span class="k">as</span> <span class="n">avg_execution_time</span>
  <span class="k">from</span> <span class="n">test_results</span>
  <span class="k">group</span> <span class="k">by</span> <span class="mi">1</span>
<span class="p">)</span>

<span class="k">select</span> 
  <span class="o">*</span><span class="p">,</span>
  <span class="n">round</span><span class="p">(</span><span class="n">passed_tests</span> <span class="o">*</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">total_tests</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="k">as</span> <span class="n">pass_rate</span><span class="p">,</span>
  <span class="k">case</span> 
    <span class="k">when</span> <span class="n">passed_tests</span> <span class="o">*</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">total_tests</span> <span class="o">&gt;=</span> <span class="mi">95</span> <span class="k">then</span> <span class="s1">'excellent'</span>
    <span class="k">when</span> <span class="n">passed_tests</span> <span class="o">*</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">total_tests</span> <span class="o">&gt;=</span> <span class="mi">90</span> <span class="k">then</span> <span class="s1">'good'</span>
    <span class="k">when</span> <span class="n">passed_tests</span> <span class="o">*</span> <span class="mi">100</span><span class="p">.</span><span class="mi">0</span> <span class="o">/</span> <span class="n">total_tests</span> <span class="o">&gt;=</span> <span class="mi">80</span> <span class="k">then</span> <span class="s1">'warning'</span>
    <span class="k">else</span> <span class="s1">'critical'</span>
  <span class="k">end</span> <span class="k">as</span> <span class="n">quality_status</span>
<span class="k">from</span> <span class="n">daily_metrics</span>
<span class="k">order</span> <span class="k">by</span> <span class="nb">date</span> <span class="k">desc</span>
</code></pre></div></div>

<h3 id="5-ìë™í™”ëœ-ë°°í¬-ë°-ëª¨ë‹ˆí„°ë§">5. ìë™í™”ëœ ë°°í¬ ë° ëª¨ë‹ˆí„°ë§</h3>

<h4 id="ìš´ì˜-ëª¨ë‹ˆí„°ë§-ìŠ¤í¬ë¦½íŠ¸">ìš´ì˜ ëª¨ë‹ˆí„°ë§ ìŠ¤í¬ë¦½íŠ¸</h4>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># scripts/quality_monitor.py
</span><span class="kn">import</span> <span class="n">requests</span>
<span class="kn">import</span> <span class="n">json</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>

<span class="k">class</span> <span class="nc">DataQualityMonitor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">dbt_cloud_token</span><span class="p">,</span> <span class="n">account_id</span><span class="p">):</span>
        <span class="n">self</span><span class="p">.</span><span class="n">token</span> <span class="o">=</span> <span class="n">dbt_cloud_token</span>
        <span class="n">self</span><span class="p">.</span><span class="n">account_id</span> <span class="o">=</span> <span class="n">account_id</span>
        <span class="n">self</span><span class="p">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="sh">"</span><span class="s">https://cloud.getdbt.com/api/v2</span><span class="sh">"</span>
    
    <span class="k">def</span> <span class="nf">get_latest_run</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ìµœê·¼ dbt ì‹¤í–‰ ê²°ê³¼ ì¡°íšŒ</span><span class="sh">"""</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
            <span class="sh">'</span><span class="s">Authorization</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Token </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">token</span><span class="si">}</span><span class="sh">'</span><span class="p">,</span>
            <span class="sh">'</span><span class="s">Content-Type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">application/json</span><span class="sh">'</span>
        <span class="p">}</span>
        
        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">base_url</span><span class="si">}</span><span class="s">/accounts/</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">account_id</span><span class="si">}</span><span class="s">/runs/</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
            <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">job_definition_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">job_id</span><span class="p">,</span> <span class="sh">'</span><span class="s">limit</span><span class="sh">'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">runs</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">runs</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">runs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">None</span>
    
    <span class="k">def</span> <span class="nf">check_quality_status</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">job_id</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ë°ì´í„° í’ˆì§ˆ ìƒíƒœ í™•ì¸</span><span class="sh">"""</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">self</span><span class="p">.</span><span class="nf">get_latest_run</span><span class="p">(</span><span class="n">job_id</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">run</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">error</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">No recent runs found</span><span class="sh">'</span><span class="p">}</span>
        
        <span class="n">run_id</span> <span class="o">=</span> <span class="n">run</span><span class="p">[</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">]</span>
        
        <span class="c1"># í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì¡°íšŒ
</span>        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">base_url</span><span class="si">}</span><span class="s">/accounts/</span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">account_id</span><span class="si">}</span><span class="s">/runs/</span><span class="si">{</span><span class="n">run_id</span><span class="si">}</span><span class="s">/</span><span class="sh">"</span><span class="p">,</span>
            <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">Authorization</span><span class="sh">'</span><span class="p">:</span> <span class="sa">f</span><span class="sh">'</span><span class="s">Token </span><span class="si">{</span><span class="n">self</span><span class="p">.</span><span class="n">token</span><span class="si">}</span><span class="sh">'</span><span class="p">}</span>
        <span class="p">)</span>
        
        <span class="k">if</span> <span class="n">response</span><span class="p">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
            <span class="n">run_details</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="nf">json</span><span class="p">()[</span><span class="sh">'</span><span class="s">data</span><span class="sh">'</span><span class="p">]</span>
            
            <span class="k">return</span> <span class="p">{</span>
                <span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="n">run_details</span><span class="p">[</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">finished_at</span><span class="sh">'</span><span class="p">:</span> <span class="n">run_details</span><span class="p">[</span><span class="sh">'</span><span class="s">finished_at</span><span class="sh">'</span><span class="p">],</span>
                <span class="sh">'</span><span class="s">job_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">job_id</span><span class="p">,</span>
                <span class="sh">'</span><span class="s">run_id</span><span class="sh">'</span><span class="p">:</span> <span class="n">run_id</span>
            <span class="p">}</span>
        
        <span class="k">return</span> <span class="p">{</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">error</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">Failed to fetch run details</span><span class="sh">'</span><span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">send_alert</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">severity</span><span class="o">=</span><span class="sh">'</span><span class="s">info</span><span class="sh">'</span><span class="p">):</span>
        <span class="sh">"""</span><span class="s">ì•Œë¦¼ ë°œì†¡ (Slack, Email ë“±)</span><span class="sh">"""</span>
        <span class="c1"># Slack ì›¹í›… ë˜ëŠ” ì´ë©”ì¼ ë°œì†¡ ë¡œì§
</span>        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">[</span><span class="si">{</span><span class="n">severity</span><span class="p">.</span><span class="nf">upper</span><span class="p">()</span><span class="si">}</span><span class="s">] </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>

<span class="c1"># ì‚¬ìš© ì˜ˆì œ
</span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="n">monitor</span> <span class="o">=</span> <span class="nc">DataQualityMonitor</span><span class="p">(</span>
        <span class="n">dbt_cloud_token</span><span class="o">=</span><span class="sh">"</span><span class="s">your_token</span><span class="sh">"</span><span class="p">,</span>
        <span class="n">account_id</span><span class="o">=</span><span class="sh">"</span><span class="s">your_account_id</span><span class="sh">"</span>
    <span class="p">)</span>
    
    <span class="n">quality_status</span> <span class="o">=</span> <span class="n">monitor</span><span class="p">.</span><span class="nf">check_quality_status</span><span class="p">(</span><span class="sh">"</span><span class="s">your_job_id</span><span class="sh">"</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">quality_status</span><span class="p">[</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">]</span> <span class="o">==</span> <span class="sh">'</span><span class="s">error</span><span class="sh">'</span><span class="p">:</span>
        <span class="n">monitor</span><span class="p">.</span><span class="nf">send_alert</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">Data quality check failed: </span><span class="si">{</span><span class="n">quality_status</span><span class="p">[</span><span class="sh">'</span><span class="s">message</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> 
            <span class="sh">'</span><span class="s">critical</span><span class="sh">'</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">monitor</span><span class="p">.</span><span class="nf">send_alert</span><span class="p">(</span>
            <span class="sa">f</span><span class="sh">"</span><span class="s">Data quality check completed: </span><span class="si">{</span><span class="n">quality_status</span><span class="p">[</span><span class="sh">'</span><span class="s">status</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="sh">"</span><span class="p">,</span> 
            <span class="sh">'</span><span class="s">info</span><span class="sh">'</span>
        <span class="p">)</span>
</code></pre></div></div>

<hr />

<h2 id="í•™ìŠµ-ìš”ì•½">ğŸ“Š í•™ìŠµ ìš”ì•½</h2>

<h3 id="í•µì‹¬-í¬ì¸íŠ¸">í•µì‹¬ í¬ì¸íŠ¸</h3>

<ol>
  <li><strong>dbtëŠ” ë°ì´í„° í’ˆì§ˆì˜ í•µì‹¬ ë„êµ¬</strong>
    <ul>
      <li>SQL ê¸°ë°˜ì˜ ì ‘ê·¼ìœ¼ë¡œ ë¶„ì„ê°€ë„ ì‰½ê²Œ ì‚¬ìš©</li>
      <li>ìë™í™”ëœ í…ŒìŠ¤íŠ¸ì™€ ë¬¸ì„œí™”ë¡œ ì‹ ë¢°ì„± í™•ë³´</li>
    </ul>
  </li>
  <li><strong>í”Œë«í¼ë³„ ìµœì í™” ì „ëµ</strong>
    <ul>
      <li>Snowflake, BigQuery, Redshift ë“± ê° í”Œë«í¼ì˜ íŠ¹ì„± í™œìš©</li>
      <li>dbt Cloud vs dbt Core ì„ íƒ ê¸°ì¤€</li>
    </ul>
  </li>
  <li><strong>ì²´ê³„ì ì¸ í’ˆì§ˆ ê´€ë¦¬</strong>
    <ul>
      <li>ê¸°ë³¸ í…ŒìŠ¤íŠ¸ë¶€í„° ì»¤ìŠ¤í…€ í…ŒìŠ¤íŠ¸ê¹Œì§€ ë‹¨ê³„ì  ì ‘ê·¼</li>
      <li>ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ê³¼ ì•Œë¦¼ ì‹œìŠ¤í…œ êµ¬ì¶•</li>
    </ul>
  </li>
  <li><strong>íŒ€ í˜‘ì—…ê³¼ ê±°ë²„ë„ŒìŠ¤</strong>
    <ul>
      <li>ë°ì´í„° ê³„ì•½ì„ í†µí•œ ëª…í™•í•œ í’ˆì§ˆ ê¸°ì¤€</li>
      <li>CI/CD íŒŒì´í”„ë¼ì¸ í†µí•©ìœ¼ë¡œ ìë™í™”</li>
    </ul>
  </li>
</ol>

<h3 id="ë‹¤ìŒ-ë‹¨ê³„">ë‹¤ìŒ ë‹¨ê³„</h3>

<ul>
  <li><strong>dbt íŒ¨í‚¤ì§€ í™œìš©</strong>: dbt-utils, dbt-expectations ë“± í™•ì¥ ê¸°ëŠ¥</li>
  <li><strong>ê³ ê¸‰ ëª¨ë‹ˆí„°ë§</strong>: Grafana, DataDog ë“± ì™¸ë¶€ ëª¨ë‹ˆí„°ë§ ë„êµ¬ ì—°ë™</li>
  <li><strong>ë¨¸ì‹ ëŸ¬ë‹ í†µí•©</strong>: ë°ì´í„° í’ˆì§ˆ ì´ìƒ íƒì§€ ML ëª¨ë¸ êµ¬ì¶•</li>
</ul>

<hr />

<blockquote>
  <p><strong>â€œì¢‹ì€ ë°ì´í„°ëŠ” ì¢‹ì€ ì˜ì‚¬ê²°ì •ì„ ë§Œë“ ë‹¤. dbtëŠ” ê·¸ ì¢‹ì€ ë°ì´í„°ë¥¼ ë³´ì¥í•˜ëŠ” ê°€ì¥ ê°•ë ¥í•œ ë„êµ¬ë‹¤.â€</strong></p>
</blockquote>

<p>ì´ì œ ì—¬ëŸ¬ë¶„ë„ dbtë¥¼ í™œìš©í•´ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤. í˜„ëŒ€ì  ë°ì´í„° ìŠ¤íƒì—ì„œ ë°ì´í„° í’ˆì§ˆì€ ì„ íƒì´ ì•„ë‹Œ í•„ìˆ˜ì…ë‹ˆë‹¤. dbtì™€ í•¨ê»˜ ë°ì´í„°ì˜ í’ˆì§ˆì„ ë³´ì¥í•˜ê³ , ë” ë‚˜ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ì¸ì‚¬ì´íŠ¸ë¥¼ ì–»ì–´ë³´ì„¸ìš”!</p>

  </div>

  
  <div class="post-navigation">
    <div class="nav-links">
      
      
      
        
          
          
      
      
      
      
    </div>
    
    <div class="series-overview">
      <a href="/categories/data-quality/" class="btn btn-secondary">
        ğŸ“š ì‹œë¦¬ì¦ˆ ì „ì²´ ë³´ê¸°
      </a>
    </div>
  </div>
  
</article>

    </div>
  </main>
  
  
  <footer class="site-footer">
  <div class="container">
    <div class="footer-content">
      <div class="footer-section">
        <h3>Data Droid Blog</h3>
        <p>ë°ì´í„° ì—”ì§€ë‹ˆì–´ê°€ ë‹¤ë£¨ëŠ” ê¸°ìˆ  ë¸”ë¡œê·¸</p>
      </div>
      
      <div class="footer-section">
        <h4>ì¹´í…Œê³ ë¦¬</h4>
        <ul>
          <li><a href="/categories/data-engineering/">ë°ì´í„° ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/bi-engineering/">BI ì—”ì§€ë‹ˆì–´ë§</a></li>
          <li><a href="/categories/infrastructure-tools/">ì¸í”„ë¼ & ë„êµ¬</a></li>
          <li><a href="/categories/data-quality/">ë°ì´í„° í’ˆì§ˆ</a></li>
          <li><a href="/categories/data-ai/">Data AI</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ë§í¬</h4>
        <ul>
          <li><a href="/">í™ˆ</a></li>
          <li><a href="/blog/">ë¸”ë¡œê·¸</a></li>
          <li><a href="/about/">ì†Œê°œ</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>ì†Œì…œ</h4>
        <ul>
          
          <li><a href="https://github.com/data-droid">GitHub</a></li>
          
          <li><a href="https://www.linkedin.com/in/jaekyung-lee/">LinkedIn</a></li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2026 Data Droid Blog. ëª¨ë“  ê¶Œë¦¬ ë³´ìœ </p>
    </div>
  </div>
</footer>



  
  <script src="/assets/js/main.js"></script>
</body>
</html>
